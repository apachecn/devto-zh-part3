# éœ€è¦æœ‹å‹å—ï¼Ÿç”¨ Python å†™ä¸€ä¸ª Reddit æœºå™¨äººè·Ÿç€ä½ åˆ°å¤„è·‘ğŸ¤–

> åŸæ–‡:[https://dev . to/Healey codes/need-a-friend-write-a-Reddit-bot-with-python-to-follow-you-around-2d KL](https://dev.to/healeycodes/need-a-friend-write-a-reddit-bot-with-python-to-follow-you-around--2dkl)

æˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ª Reddit æœºå™¨äººæ¥ç›‘å¬ç‰¹å®šçš„çŸ­è¯­ï¼Œå¹¶å¯¹åŒ…å«è¿™äº›çŸ­è¯­çš„è¯„è®ºåšå‡ºå“åº”ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åœ¨ Python ä¸­ä¸ Reddit API äº¤äº’ï¼ŒåŒæ—¶åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„æœºå™¨äººä¼™ä¼´ã€‚

#### [](#bottiquette)ç“¶å­

ä½ å¯èƒ½å¬è¯´è¿‡æœºå™¨äººä¸‰å®šå¾‹ï¼Œä½†æ˜¯ä½ å¬è¯´è¿‡ Reddit çš„ T2 ç“¶ç¤¼ä»ªå—ï¼Ÿè¿™æ˜¯ä¸€ä¸ªè§„åˆ™åˆ—è¡¨ï¼Œå®ƒå°†å¸®åŠ©ä½ åˆ›å»ºä¸€ä¸ªä¸ä¼šå¦¨ç¢ä»»ä½•äººçš„ç¤¼è²Œæœºå™¨äººã€‚æœ€é‡è¦çš„è§„åˆ™æ˜¯ä¸è¦ç”¨ä½ çš„æœºå™¨äººå†’å……äººç±»ã€‚è™½ç„¶å¯ä»¥ä¸Šä¸‹æŠ•ç¥¨ï¼Œä½†è¿™æ ·åšçš„å‘½ä»¤å¿…é¡»ç›´æ¥æ¥è‡ªäººç±»ã€‚

#### [](#setup)è®¾ç½®

ä½ å°†éœ€è¦ [PRAW](https://praw.readthedocs.io/en/latest/index.html) ï¼Œ*Python Reddit API åŒ…è£…å™¨*ã€‚ä½¿ç”¨`pip install praw`å®‰è£…æ­¤è½¯ä»¶åŒ…ã€‚å®ƒæœ‰å¤§é‡çš„æ–‡æ¡£ï¼Œå¦‚æœä½ éœ€è¦æ›´å¤šçš„çµæ„Ÿæˆ–å¸®åŠ©ï¼Œè¿˜æœ‰ä¸€ä¸ª [r/redditdev](https://www.reddit.com/r/redditdev/) å­ç¼–è¾‘ã€‚

åˆ›å»ºä¸€ä¸ª**è„šæœ¬** [Reddit app](https://www.reddit.com/prefs/apps/) ï¼Œè®°ä¸‹å®¢æˆ·ç«¯ id å’Œå®¢æˆ·ç«¯å¯†ç ã€‚

[![](../Images/294ca9246765f23fc0d1f3d4c07a7b92.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--lKJCl_hH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/i8ssgy49eobulnuzgfxm.png)

ç¡®ä¿ä¸è¦å°†è¿™äº›æäº¤ç»™å­˜å‚¨åº“ï¼ä½¿ç”¨ Pythonï¼Œå¯ä»¥ç”¨æ˜ å°„å¯¹è±¡`os.environ`è®¿é—®ç¯å¢ƒå˜é‡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½ å¥½ä¸–ç•Œ PRAW åº”ç”¨ç¨‹åºã€‚ç”±äºæˆ‘ä»¬çš„æœºå™¨äººå°†æ‰§è¡Œå¸æˆ·æ“ä½œï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¸æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ã€‚å¯¹äºè¢«åŠ¨æœºå™¨äººï¼Œè¿™æ˜¯ä¸å¿…è¦çš„ã€‚è¿˜æœ‰[å…¶ä»–æ–¹å¼æ¥è®¤è¯](https://praw.readthedocs.io/en/latest/getting_started/authentication.html)ã€‚

```
# Setting environment variables on different platforms:
Linux/OS X  - export ENV_VAR='data'
Windows Cmd - ENV_VAR='data'
Powershell  - $env:ENV_VAR='data' 
```

```
import os
import praw

# a reddit instance reddit = praw.Reddit(client_id=os.environ['CLIENTID'],
                     client_secret=os.environ['CLIENTSECRET'],
                     user_agent='Reddit bot tutorial v0.1-1',
                     username=os.environ['CLIENTUSER'],
                     password=os.environ['CLIENTPASS'])

# with incorrect authentication information, this will error with:
#   prawcore.exceptions.OAuthException: invalid_grant error processing request print(reddit.user.me()) 
```

å› ä¸ºæˆ‘ä»¬çš„æ•æ„Ÿä¿¡æ¯æ˜¯åœ¨åˆ«å¤„å®šä¹‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ä¸æ³„éœ²ä»»ä½•ç»†èŠ‚çš„æƒ…å†µä¸‹æäº¤å®ƒã€‚å®ƒä¹Ÿæ›´å®¹æ˜“æµ‹è¯•ï¼Œå¹¶è®©å…¶ä»–å¼€å‘äººå‘˜æ›´å®¹æ˜“ä½¿ç”¨è¿™äº›ä»£ç ã€‚

#### [](#all-the-comments)æ‰€æœ‰è¯„è®º

è¿™æ˜¯ä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…ã€‚æˆ‘å¯¹ä½ çš„æŒ‘æˆ˜æ˜¯:è¯•ç€é˜…è¯»å‘å¸ƒåˆ° Reddit ä¸Šçš„æ¯ä¸€æ¡è¯„è®ºã€‚è¿™çœŸçš„è®©ä½ äº†è§£äº†å¯ç”¨æ•°æ®çš„è§„æ¨¡ã€‚

```
# with our reddit instance, get an endless stream of comments for comment in reddit.subreddit('all').stream.comments():
    print(comment.body) 
```

è¿™é‡Œï¼Œ`comments`æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼Œå½“æ–°çš„æ³¨é‡Šå¯ç”¨æ—¶ï¼Œå®ƒä¼šç”Ÿæˆæ–°çš„æ³¨é‡Šã€‚ä¸å¤§å¤šæ•° API ä¸€æ ·ï¼ŒReddit API ä¹Ÿæœ‰é€Ÿç‡é™åˆ¶ã€‚å¹¸è¿çš„æ˜¯ï¼ŒPRAW åœ¨åå°ä¸ºæˆ‘ä»¬ç®¡ç†è¿™äº›ï¼Œå¹¶æ§åˆ¶æˆ‘ä»¬ã€‚

æˆ‘ä»¬æƒ³è¦è¿‡æ»¤ç‰¹å®šçŸ­è¯­çš„è¯„è®ºã€‚æŒ‰ç…§ä¸ç¯å¢ƒå˜é‡ç›¸åŒçš„æ–¹å¼ï¼Œæˆ‘ä»¬ä¹Ÿå°†æ³›åŒ–è¿™ä¸ªç‰¹æ€§ã€‚ [argparse](https://docs.python.org/3/library/argparse.html) ï¼ŒPython æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸å‘½ä»¤è¡Œå‚æ•°è½»æ¾é…ç½®ã€‚

```
import argparse

# setup argparse parser = argparse.ArgumentParser(description='Reply to certain Reddit comments')
parser.add_argument('--search', dest='search',
                    help='Search for these comma-delimited phrases. E.g., "one phrase, another phrase"')
args = parser.parse_args()

# split by commas, strip extra white space search = [phrase.strip() for phrase in args.search.split(',')]

# python args.py --search "test phrase, two, three"
# prints: ['test phrase', 'one', 'two'] print(search) 
```

#### [](#replying-to-comments)å›å¤è¯„è®º

Reddit çš„ [r/test](https://www.reddit.com/r/test/) æ˜¯æ£€éªŒè¿™ä¸€ç‚¹çš„å¥½åœ°æ–¹ã€‚æˆ‘ä»¬å°±ç”¨[è¯„è®º#å›å¤](https://praw.readthedocs.io/en/latest/code_overview/models/comment.html#praw.models.Comment.reply)ã€‚å› ä¸ºæˆ‘ä»¬å°†åœ¨æ³¨é‡Šä½“ä¸­æœç´¢æˆ‘ä»¬çš„çŸ­è¯­ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªå¯¹æ³¨é‡Šå¯¹è±¡çš„å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨å®ƒçš„`reply`æ–¹æ³•ã€‚å¦åˆ™ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ id çš„æ³¨é‡Šå¯¹è±¡ã€‚

```
# with a comment reference comment.reply('hello! signed, a bot.')

# find a comment by id comment = reddit.comment(id='dxolpyc')
comment.reply('hi again!') 
```

ä½ å¯èƒ½éœ€è¦ä¸¤ä¸ªå¸æˆ·æ¥æ­£ç¡®åœ°æµ‹è¯•è¿™ä¸€ç‚¹ï¼Œå› ä¸ºæ–°åˆ›å»ºçš„ Reddit å¸æˆ·ä¸èƒ½ç«‹å³å‘å¸ƒä¸¤ä¸ªè¯„è®ºï¼Œå³å‘å¸ƒä¸€ä¸ªç›®æ ‡çŸ­è¯­ï¼Œç„¶åå‘å¸ƒå¯¹è¯¥è¯„è®ºçš„å›å¤ã€‚

#### [](#where-we-are-so-far)æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢åœ¨å“ªé‡Œ

è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„æœºå™¨äººè¿›å±•å¦‚ä½•ã€‚ä½ ä¼šçœ‹åˆ°æˆ‘ä½¿ç”¨äº†`argparse`æ¥æ¦‚æ‹¬æœç´¢çŸ­è¯­ã€‚æˆ‘ä»¬æ­£åœ¨åˆ¶ä½œä¸€ä¸ªå¯é…ç½®çš„æœºå™¨äººï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå°†æ¥éš¾ä»¥æ‰©å±•å’Œä½¿ç”¨çš„ç¡¬ç¼–ç æœºå™¨äººã€‚

```
import os
import praw
import argparse

# setup argparse parser = argparse.ArgumentParser(description='Reply to certain Reddit comments')
parser.add_argument('--search', dest='search',
                    help='Search for these comma-delimited phrases. E.g., "one phrase, another phrase"')
parser.add_argument('--reply', dest='reply',
                    help='Reply to target comments with this phrase')
args = parser.parse_args()

# our search phrases, also works with a single word search = [phrase.strip() for phrase in args.search.split(',')]
# our reply reply = args.reply

# reddit instance reddit = praw.Reddit(client_id=os.environ['CLIENTID'],
                     client_secret=os.environ['CLIENTSECRET'],
                     user_agent='Reddit bot tutorial v0.1-1',
                     username=os.environ['CLIENTUSER'],
                     password=os.environ['CLIENTPASS'])

# an endless stream of comments for comment in reddit.subreddit('all').stream.comments():
    for phrase in search:
        if phrase in comment.body:
            comment.reply(reply)
            # for debugging
            print(f'Replied to {comment.id}!')
            break 
```

#### [](#where-to-go-from-here)ä½•å»ä½•ä»

*   å…‹éš†[æ•™ç¨‹åº“](https://github.com/healeycodes/Reddit-Bot-Tutorial)è·å¾—é»‘å®¢æ”»å‡»ï¼
*   è·å–å‘å¸–äººçš„åå­—å¹¶åœ¨å›å¤ä¸­ä½¿ç”¨:`comment.author.name`
*   å°†ä½ çš„æœºå™¨äººæ”¾åœ¨ä¸€ä¸ªæ ‘è“å¹³å°ä¸Šï¼Œæˆ–è€…å’Œ Heroku ä¸€èµ·æ”¾åœ¨äº‘ç«¯ã€‚
*   å°†ä½ çš„æœºå™¨äººè¿æ¥åˆ°ä¸€ä¸ªåç«¯æœåŠ¡ï¼Œå°±åƒæˆ‘å¯¹æˆ‘çš„è¡¨æƒ…æµé¡¹ç›®æ‰€åšçš„é‚£æ ·ï¼Œè¯¥é¡¹ç›®å°†å‘å¸ƒåˆ° Reddit çš„æ¯ä¸€ä¸ªè¡¨æƒ…æµã€‚

#### [](#more)æ›´

æˆ‘æœ€è¿‘æˆä¸ºäº†[ç¼–ç æ•™ç»ƒ](https://mentors.codingcoach.io/)çš„å¯¼å¸ˆã€‚å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ª Reddit æœºå™¨äººï¼Œæˆ–è€…éœ€è¦ä¸€èˆ¬çš„å¼€å‘å¸®åŠ©ï¼Œæˆ‘å¯ä»¥å¸®åŠ©ä½ ï¼

* * *

åŠ å…¥æˆ‘çš„å…³äºç¼–ç¨‹å’Œä¸ªäººæˆé•¿çš„[æ—¶äº‹é€šè®¯](https://buttondown.email/healeycodes)çš„ 150 å¤šäººæ³¨å†Œï¼

æˆ‘å‘å…³äºç§‘æŠ€çš„å¾®åšã€‚