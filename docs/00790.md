# å­è¿›ç¨‹ğŸ‘¶

> åŸæ–‡ï¼š<https://dev.to/ruheni/child-processes-2507>

# å­è¿›ç¨‹

å¯¹äºæœ¬æ–‡ï¼Œå‡è®¾æ‚¨å¯¹ NodeJs å’Œ JavaScript ä¸­çº§ç¼–ç¨‹çŸ¥è¯†æœ‰åŸºæœ¬çš„äº†è§£ã€‚ä¸ºäº†èƒ½å¤Ÿç‰¢ç‰¢æŒæ¡å­è¿›ç¨‹ï¼Œæ‚¨éœ€è¦å¯¹æµå’Œäº‹ä»¶å‘å°„å™¨æœ‰ä¸€ä¸ªç›¸å½“å¥½çš„ç†è§£ã€‚æˆ‘è¦åšçš„æœ€åä¸€ä¸ªå‡è®¾æ˜¯ï¼Œä½ å¯¹ç”¨äºæ“ä½œæ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„ç»ˆç«¯å‘½ä»¤æœ‰åŸºæœ¬çš„äº†è§£ã€‚

## åˆ°åº•ä»€ä¹ˆæ˜¯å­è¿›ç¨‹ï¼Ÿ

å­è¿›ç¨‹æ˜¯ç”±å¦ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºçš„è¿›ç¨‹ã€‚å¬èµ·æ¥å¾ˆ meta å§â€¦ï¼Ÿé‡è¦çš„æ˜¯è¦è®°ä½ JavaScript æ˜¯å•çº¿ç¨‹çš„ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¸Œæœ›é˜»å¡ä¸»çº¿ç¨‹çš„è¿è¡Œï¼Œå¦åˆ™æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†ä¼šå¾ˆæ…¢ï¼Œå®ƒå°†ä¸èƒ½åšå¾ˆå¤šäº‹æƒ…ã€‚ä¸‡ä¸€ä½ é—®â€œä»–åˆ°åº•åœ¨è¯´ä»€ä¹ˆâ€¦ï¼Ÿâ€ğŸ˜•å…ˆåˆ«æ…Œã€‚

[JavaScript äº‹ä»¶å¾ªç¯](https://www.youtube.com/watch?v=cCOL7MC4Pl0)è§£é‡Šäº† JavaScript åœ¨æ‰§è¡Œæ—¶åˆ°åº•æ˜¯å¦‚ä½•è¿è¡Œçš„ğŸ˜‰ã€‚

ä½¿ç”¨å­è¿›ç¨‹ï¼Œæ‚¨å¯ä»¥æ— ç¼åœ°è¿è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œå¹¶æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚æ‚¨å¯ä»¥æ§åˆ¶è¾“å…¥æµï¼Œç›‘å¬å®ƒçš„è¾“å‡ºæµï¼Œå¹¶å°†å®ƒä¼ é€’ç»™å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™ä¸ç®¡é“æ“ä½œç¬¦åœ¨ Linux ä¸­çš„å·¥ä½œæ–¹å¼ç›¸åŒ

å­è¿›ç¨‹ä½¿æ‚¨èƒ½å¤Ÿé€šè¿‡åœ¨æ“ä½œç³»ç»Ÿä¸­è¿è¡Œå­è¿›ç¨‹æ¥è®¿é—®æ“ä½œç³»ç»ŸåŠŸèƒ½ã€‚åˆ›å»ºå­è¿›ç¨‹æœ‰å››ç§ä¸åŒçš„æ–¹å¼ï¼Œå®ƒä»¬åœ¨é€Ÿåº¦(æœ‰äº›æ¯”å…¶ä»–çš„ç¨å¾®æ›´æœ‰æ•ˆ)å’ŒåŠŸèƒ½ä¸Šæœ‰æ‰€ä¸åŒã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºå­æµç¨‹:`fork()`ã€`spawn()`ã€`exec()`å’Œ`execFile()`ã€‚

è¦è®¿é—®è¿™ä¸ªæ¨¡å—ï¼Œä½ å¿…é¡»å°†å®ƒå¯¼å…¥åˆ°ä½ çš„ç¨‹åºä¸­ï¼Œå¹¶å¯¹å®ƒè¿›è¡Œææ„ï¼Œä»¥è®¿é—®ä½ æƒ³è¦ä½¿ç”¨çš„ç‰¹å®šå­è¿›ç¨‹ã€‚æˆ‘å°†åœ¨æœ¬æ–‡ä¸­ä½¿ç”¨çš„ä¾‹å­ç›¸å½“ç®€å•ğŸ˜ã€‚

ç”±äºæˆ‘ä¸æƒ³è®©è¿™ä¸ªæ•™ç¨‹å¤ªé•¿ï¼Œæˆ‘å°†åªæ¶‰åŠ`spawn()`ã€‚

```
const { spawn, exec, execFile, fork } = require("child_process"); 
```

Enter fullscreen mode Exit fullscreen mode

## äº§åµ

è¿™å°†åœ¨æ–°è¿›ç¨‹ä¸­å¯åŠ¨æ–°å‘½ä»¤ã€‚ä½¿ç”¨ spawnï¼Œæ‚¨å¯ä»¥å‘å®ƒä¼ é€’ä»»ä½•å‚æ•°æ¥æ‰§è¡Œç»™å®šçš„è¿‡ç¨‹ã€‚`spawn`èƒ½å¤Ÿå¤„ç†äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚¨å¯ä»¥æ³¨å†Œäº‹ä»¶ï¼Œä»¥ä¾¿åœ¨å‘é€ä¿¡å·æ—¶æ‰§è¡Œç»™å®šçš„ä»»åŠ¡ã€‚

ä½¿ç”¨`spawn()`æ—¶ï¼Œå¯ä»¥è®°å½•ä»¥ä¸‹äº‹ä»¶:

1.  `error` -å½“è¿›ç¨‹ä¸èƒ½äº§ç”Ÿæˆ–ç»ˆæ­¢æ—¶å‘å‡ºã€‚
2.  `message` -å½“å­©å­ä½¿ç”¨`process.send()`å‘é€æ¶ˆæ¯æ—¶å‘å‡ºã€‚å®ƒæ”¯æŒå­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚
3.  `disconnect` -å½“çˆ¶è¿›ç¨‹æ‰‹åŠ¨è°ƒç”¨`child.disconnect()`æ—¶
4.  `close` -å½“ç»™å®šè¿›ç¨‹çš„è¾“å…¥å’Œè¾“å‡ºæµå…³é—­æ—¶å‘å‡ºã€‚
5.  `data`â€”`data`äº‹ä»¶åœ¨ç»™å®šçš„æµå¯è¯»æ—¶å‘å‡ºï¼Œæˆ‘ä»¬æƒ³è¦æ“ä½œè¾“å…¥å’Œè¾“å‡ºæ•°æ®ã€‚å®ƒä¹Ÿå¯ä»¥åœ¨å‡ºé”™æ—¶å‘å‡ºã€‚

*å¯¹äºé‚£äº›ä¸ç†Ÿæ‚‰`pwd`å‘½ä»¤çš„äººæ¥è¯´ï¼Œå®ƒç”¨æ¥æ˜¾ç¤ºå½“å‰çš„å·¥ä½œç›®å½•ã€‚*T3ã€‘

```
const { spawn } = require("child_process");
const pwd = spawn("pwd");

pwd.stdout.on("data", data => console.log(`path: ${data}`));

pwd.stderr.on("data", data => {
  console.error(`child stderr: ${data}`);
});

pwd.on("exit", (code, signal) => {
  console.log(`child process exited with ${code} and signal ${signal}`);
}); 
```

Enter fullscreen mode Exit fullscreen mode

è¾“å‡º:

```
path: "/c/Users/Users/Documents/pandora's_box/sandbox/nodejs"
child process exited with 0 and signal null 
```

Enter fullscreen mode Exit fullscreen mode

å¯é€‰åœ°ï¼Œ`spawn`å‡½æ•°èƒ½å¤Ÿæ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯åŒ…å«å­—ç¬¦ä¸²çš„æ•°ç»„ï¼Œè¿™äº›å­—ç¬¦ä¸²æ˜¯åœ¨æ‰§è¡Œç»™å®šå‘½ä»¤æ—¶æƒ³è¦ä½¿ç”¨çš„å‚æ•°ã€‚

```
const { spawn } = require("child_process");
const py = spawn("py", ["--version"]);

py.stdout.on("data", data => console.log(`python version: ${data}`));

py.stderr.on("data", data => {
  console.error(`child stderr: ${data}`);
});

py.on("exit", (code, signal) => {
  console.log(`child process exited with ${code} and signal ${signal}`);
}); 
```

Enter fullscreen mode Exit fullscreen mode

è¾“å‡º:

```
python version: Python 3.7.3
child process exited with 0 and signal null 
```

Enter fullscreen mode Exit fullscreen mode

*è¾“å‡ºå°†éšæ‚¨å½“å‰çš„å·¥ä½œç›®å½•è€Œå˜åŒ–ï¼Œä»£ç  0 è¡¨ç¤ºåœ¨æ‰§è¡Œç¨‹åºæ—¶æ²¡æœ‰é‡åˆ°é”™è¯¯...*

*å¿«ä¹é»‘å®¢ğŸ‰ğŸ˜*