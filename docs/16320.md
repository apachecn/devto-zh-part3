# timsortâ€”â€”ä½ ä»æœªå¬è¯´è¿‡çš„æœ€å¿«çš„æ’åºç®—æ³•

> åŸæ–‡:[https://dev . to/brandonskeritt/Tim sort-the-fast-sorting-algorithm-you-ve-never-heated-of-2 ake](https://dev.to/brandonskerritt/timsort-the-fastest-sorting-algorithm-you-ve-never-heard-of-2ake)

<figure>[![Timsortâ€Šâ€”â€Šthe fastest sorting algorithm youâ€™ve never heard of](../Images/3ceeae94c4a938a155ee74a2831db462.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--Sb8ovmBk--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/600/0%2AkZKyCrzT9YvXBtT9.jpg) 

<figcaption>ä»[åˆ°](https://www.youtube.com/watch?v=1wAOy88WxmY)</figcaption>

</figure>

è’‚å§†Â·çš®ç‰¹çš„å½¢è±¡

Timsort æ˜¯ä¸€ç§æ’åºç®—æ³•ï¼Œå¯¹äºçœŸå®ä¸–ç•Œçš„æ•°æ®éå¸¸æœ‰æ•ˆï¼Œè€Œä¸æ˜¯åœ¨å­¦æœ¯å®éªŒå®¤ä¸­åˆ›å»ºçš„ã€‚Tim Peters åœ¨ 2001 å¹´ä¸º Python ç¼–ç¨‹è¯­è¨€åˆ›å»ºäº† Timsortã€‚Timsort é¦–å…ˆåˆ†æå®ƒè¯•å›¾æ’åºçš„åˆ—è¡¨ï¼Œç„¶åæ ¹æ®å¯¹åˆ—è¡¨çš„åˆ†æé€‰æ‹©ä¸€ç§æ–¹æ³•ã€‚

è‡ªä»è¯¥ç®—æ³•è¢«å‘æ˜ä»¥æ¥ï¼Œå®ƒå·²ç»è¢«ç”¨ä½œ Pythonã€ [Java](https://bugs.java.com/bugdatabase/view_bug.do?bug_id=6804124) ã€ [Android](http://www.kiwidoc.com/java/l/x/android/android/5/p/java.util/c/TimSort) å¹³å°å’Œ GNU Octave ä¸­çš„é»˜è®¤æ’åºç®—æ³•ã€‚

Timsort çš„å¤§ O è®°æ³•æ˜¯ O(n log n)ã€‚è¦äº†è§£å¤§ O ç¬¦å·ï¼Œè¯·é˜…è¯»[è¿™ä¸ª](https://skerritt.blog/you-need-to-understand-big-o-notation-now/)ã€‚

<figure>[![Timsortâ€Šâ€”â€Šthe fastest sorting algorithm youâ€™ve never heard of](../Images/6a1fd116c72eae2ee2ce2f02151a28c5.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--moUT9Idy--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2A1CkG3c4mZGswDShAV9eHbQ.png) 

<figcaption>ä»[åˆ°è¿™é‡Œ](http://bigocheatsheet.com/)</figcaption>

</figure>

Timsort çš„æ’åºæ—¶é—´å’Œ Mergesort ä¸€æ ·ï¼Œæ¯”ä½ å¯èƒ½çŸ¥é“çš„å¤§å¤šæ•°å…¶ä»–æ’åºéƒ½è¦å¿«ã€‚Timsort å®é™…ä¸Šåˆ©ç”¨äº†æ’å…¥æ’åºå’Œåˆå¹¶æ’åºï¼Œæ‚¨å¾ˆå¿«å°±ä¼šçœ‹åˆ°è¿™ä¸€ç‚¹ã€‚

Peters è®¾è®¡ Timsort æ˜¯ä¸ºäº†ä½¿ç”¨å¤§å¤šæ•°çœŸå®æ•°æ®é›†ä¸­å·²ç»å­˜åœ¨çš„æœ‰åºå…ƒç´ ã€‚å®ƒç§°è¿™äº›å·²ç»æœ‰åºçš„å…ƒç´ ä¸ºâ€œè‡ªç„¶è¿è¡Œâ€ã€‚å®ƒéå†æ•°æ®ï¼Œå°†å…ƒç´ æ”¶é›†åˆ°è¿è¡Œä¸­ï¼ŒåŒæ—¶å°†è¿™äº›è¿è¡Œåˆå¹¶æˆä¸€ä¸ªè¿è¡Œã€‚

### [](#the-array-has-fewer-than-64-elements-in-it)**æ•°ç»„ä¸­çš„å…ƒç´ å°‘äº 64 ä¸ª**

å¦‚æœæˆ‘ä»¬è¯•å›¾æ’åºçš„æ•°ç»„ä¸­çš„å…ƒç´ å°‘äº 64 ä¸ªï¼ŒTimsort å°†æ‰§è¡Œæ’å…¥æ’åºã€‚

æ’å…¥æ’åºæ˜¯ä¸€ç§ç®€å•çš„æ’åºï¼Œå¯¹å°åˆ—è¡¨æœ€æœ‰æ•ˆã€‚å¯¹äºè¾ƒå¤§çš„åˆ—è¡¨æ¥è¯´å¾ˆæ…¢ï¼Œä½†æ˜¯å¯¹äºè¾ƒå°çš„åˆ—è¡¨æ¥è¯´éå¸¸å¿«ã€‚æ’å…¥æ’åºçš„æ€æƒ³å¦‚ä¸‹:

*   ä¸€ä¸ªä¸€ä¸ªçœ‹å…ƒç´ 
*   é€šè¿‡åœ¨æ­£ç¡®çš„ä½ç½®æ’å…¥å…ƒç´ æ¥æ„å»ºæ’åºåˆ—è¡¨

<figure>[![Timsortâ€Šâ€”â€Šthe fastest sorting algorithm youâ€™ve never heard of](../Images/622de247bfa7ff9367bbb171650be261.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--7nt3qaAq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2A3bMtqGONwfRvPMvVf8zfJQ.png) 

<figcaption>å›¾ç‰‡ç”±æˆ‘æ‹æ‘„ï¼Œæ¥è‡ªæˆ‘çš„ç½‘ç«™ [skerritt.tech](https://skerritt.tech)</figcaption>

</figure>

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æ–°æ’åºçš„å…ƒç´ æ’å…¥åˆ°ä¸€ä¸ªæ–°çš„å­æ•°ç»„ä¸­ï¼Œè¿™ä¸ªå­æ•°ç»„ä»æ•°ç»„çš„å¼€å¤´å¼€å§‹ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªæ˜¾ç¤ºæ’å…¥æ’åºçš„ gif:

<figure>[![Timsortâ€Šâ€”â€Šthe fastest sorting algorithm youâ€™ve never heard of](../Images/6bfbf32e24cee434e19b6d728bcc6ce1.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--pqhdybaY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/800/0%2AI8VlK7-Zh-2btQP4.gif) 

<figcaption>å–è‡ª[æ­¤å¤„](https://upload.wikimedia.org/wikipedia/commons/9/9c/Insertion-sort-example.gif)</figcaption>

</figure>

### [](#more-about-runs)**æ›´å¤šå…³äºè·‘æ­¥**

å¦‚æœåˆ—è¡¨å¤§äº 64 ä¸ªå…ƒç´ ï¼Œåˆ™ç®—æ³•å°†é¦–å…ˆéå†åˆ—è¡¨ï¼Œå¯»æ‰¾ä¸¥æ ¼å¢åŠ æˆ–å‡å°‘çš„éƒ¨åˆ†ã€‚å¦‚æœè¯¥éƒ¨åˆ†æ­£åœ¨å‡å°‘ï¼Œå®ƒå°†åè½¬è¯¥éƒ¨åˆ†ã€‚

å› æ­¤ï¼Œå¦‚æœæ¸¸ç¨‹åœ¨å‡å°‘ï¼Œå®ƒå°†çœ‹èµ·æ¥åƒè¿™æ ·(å…¶ä¸­æ¸¸ç¨‹ä»¥ç²—ä½“æ˜¾ç¤º):

<figure>[![Timsortâ€Šâ€”â€Šthe fastest sorting algorithm youâ€™ve never heard of](../Images/a333c8a579a35e3ff4106e2501d6bef8.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--kU5w0QFZ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2ALWJSZ8DHZ2DNF8aeVyGpig.png) 

<figcaption>å›¾ç‰‡æ¥è‡ªæˆ‘çš„ç½‘ç«™ï¼Œ [skerritt.tech](https://skerritt.tech/)</figcaption>

</figure>

å¦‚æœä¸å‡å°‘ï¼Œå®ƒä¼šåƒè¿™æ ·:

<figure>[![Timsortâ€Šâ€”â€Šthe fastest sorting algorithm youâ€™ve never heard of](../Images/dc4eb5c07eeeeb58258ba30196eec66b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--PMQExCA9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2Ar96puBtKKiF6-Rj3DKjOUA.png) 

<figcaption>å›¾ç‰‡æ¥è‡ªæˆ‘çš„ç½‘ç«™ï¼Œ [skerritt.tech](https://skerritt.tech/)</figcaption>

</figure>

æœ€å°æ¸¸ç¨‹çš„å¤§å°æ˜¯æ ¹æ®æ•°ç»„çš„å¤§å°ç¡®å®šçš„ã€‚è¯¥ç®—æ³•é€‰æ‹©å®ƒï¼Œä½¿å¾—éšæœºæ•°ç»„ä¸­çš„å¤§å¤šæ•°æ¸¸ç¨‹åœ¨é•¿åº¦ä¸Šç­‰äºæˆ–å˜æˆæœ€å°æ¸¸ç¨‹ã€‚å½“è¿è¡Œæ¬¡æ•°ç­‰äºæˆ–ç•¥å°äº 2 çš„å¹‚æ—¶ï¼Œåˆå¹¶ 2 ä¸ªæ•°ç»„æ›´æœ‰æ•ˆã€‚Timsort é€‰æ‹© minrun æ¥ç¡®ä¿è¿™ç§æ•ˆç‡ï¼Œæ–¹æ³•æ˜¯ç¡®ä¿ minrun ç­‰äºæˆ–å°äº 2 çš„å¹‚ã€‚

è¯¥ç®—æ³•ä» 32 åˆ° 64(åŒ…æ‹¬ 32 å’Œ 64)çš„èŒƒå›´å†…é€‰æ‹© minrunã€‚å®ƒé€‰æ‹© minrunï¼Œä½¿å¾—åŸå§‹æ•°ç»„çš„é•¿åº¦é™¤ä»¥ minrunï¼Œç­‰äºæˆ–ç•¥å°äº 2 çš„å¹‚ã€‚

å¦‚æœæ¸¸ç¨‹çš„é•¿åº¦å°äº minrunï¼Œåˆ™è®¡ç®—è¯¥æ¸¸ç¨‹è¿œç¦» minrun çš„é•¿åº¦ã€‚ä½¿ç”¨è¿™ä¸ªæ–°çš„æ•°å­—ï¼Œæ‚¨å¯ä»¥åœ¨è¿è¡Œä¹‹å‰è·å–è¿™ä¹ˆå¤šçš„é¡¹ç›®ï¼Œå¹¶æ‰§è¡Œæ’å…¥æ’åºæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¿è¡Œã€‚

å› æ­¤ï¼Œå¦‚æœæœ€å°æ¸¸ç¨‹æ˜¯ 63ï¼Œæ¸¸ç¨‹é•¿åº¦æ˜¯ 33ï¼Œåˆ™ 63â€“33 = 30ã€‚ç„¶åï¼Œä»è¿è¡Œç»“æŸå‰è·å– 30 ä¸ªå…ƒç´ ï¼Œå› æ­¤è¿™æ˜¯è¿è¡Œ[33]ä¸­çš„ 30 ä¸ªé¡¹ç›®ï¼Œç„¶åæ‰§è¡Œæ’å…¥æ’åºä»¥åˆ›å»ºæ–°çš„è¿è¡Œã€‚

åœ¨è¿™éƒ¨åˆ†å®Œæˆåï¼Œæˆ‘ä»¬ç°åœ¨åº”è¯¥åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­æœ‰ä¸€å †æ’åºçš„è¿è¡Œã€‚

* * *

### [](#merging)**åˆå¹¶**

[![image showing dragonball z charecters merging](../Images/9b2cc1442f739e486d1ad351cfdb600a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--jNvwwgO4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://media1.tenor.com/images/4a8bba4f59cda65616d27078e7599b87/tenor.gif%3Fitemid%3D4929472)

Timsort ç°åœ¨æ‰§è¡Œ mergesort å°†è¿è¡Œåˆå¹¶åœ¨ä¸€èµ·ã€‚ç„¶è€Œï¼ŒTimsort ç¡®ä¿åœ¨åˆå¹¶æ’åºæ—¶ä¿æŒç¨³å®šæ€§å’Œåˆå¹¶å¹³è¡¡ã€‚

ä¸ºäº†ä¿æŒç¨³å®šï¼Œæˆ‘ä»¬ä¸åº”è¯¥äº¤æ¢ä¸¤ä¸ªç­‰å€¼çš„æ•°å­—ã€‚è¿™ä¸ä»…ä¿æŒäº†å®ƒä»¬åœ¨åˆ—è¡¨ä¸­çš„åŸå§‹ä½ç½®ï¼Œè€Œä¸”ä½¿å¾—ç®—æ³•æ›´å¿«ã€‚æˆ‘ä»¬å°†å¾ˆå¿«è®¨è®ºåˆå¹¶å¹³è¡¡ã€‚

å½“ Timsort æ‰¾åˆ°æ¸¸ç¨‹æ—¶ï¼Œå®ƒå°†å®ƒä»¬æ·»åŠ åˆ°å †æ ˆä¸­ã€‚ä¸€ä¸ªç®€å•çš„å †æ ˆå¦‚ä¸‹æ‰€ç¤º:

<figure>[![Timsortâ€Šâ€”â€Šthe fastest sorting algorithm youâ€™ve never heard of](../Images/d1f14d67c571f9907df513f1cab0d25f.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--srQlFjSx--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2AsJ4GSPsTvUdIYQIR2pbKig.png) 

<figcaption>å›¾ç‰‡æ¥è‡ªæˆ‘çš„ç½‘ç«™ï¼Œ [skerritt.tech](https://skerritt.tech/)</figcaption>

</figure>

æƒ³è±¡ä¸€å †ç›˜å­ã€‚ä½ ä¸èƒ½ä»åº•éƒ¨æ‹¿ç›˜å­ï¼Œæ‰€ä»¥ä½ å¿…é¡»ä»é¡¶éƒ¨æ‹¿ã€‚å †æ ˆä¹Ÿæ˜¯å¦‚æ­¤ã€‚

å½“ mergesort è¿è¡Œæ—¶ï¼ŒTimsort è¯•å›¾å¹³è¡¡ä¸¤ä¸ªç›¸äº’ç«äº‰çš„éœ€æ±‚ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¸Œæœ›å°½å¯èƒ½å»¶è¿Ÿåˆå¹¶ï¼Œä»¥ä¾¿åˆ©ç”¨ä»¥åå¯èƒ½å‡ºç°çš„æ¨¡å¼ã€‚ä½†æ˜¯æˆ‘ä»¬æ›´å¸Œæœ›å°½å¿«è¿›è¡Œåˆå¹¶ï¼Œä»¥åˆ©ç”¨è¿è¡Œåˆšåˆšå‘ç°çš„ä»ç„¶åœ¨å†…å­˜å±‚æ¬¡ç»“æ„ä¸­å¤„äºé«˜ä½çš„è¿è¡Œã€‚æˆ‘ä»¬ä¹Ÿä¸èƒ½å°†åˆå¹¶å»¶è¿Ÿâ€œå¤ªä¹…â€ï¼Œå› ä¸ºå®ƒä¼šæ¶ˆè€—å†…å­˜æ¥è®°ä½ä»æœªåˆå¹¶çš„æ¸¸ç¨‹ï¼Œå¹¶ä¸”å †æ ˆæœ‰å›ºå®šçš„å¤§å°ã€‚

ä¸ºäº†ç¡®ä¿è¿™ç§æŠ˜è¡·ï¼ŒTimsort è·Ÿè¸ªå †æ ˆä¸­æœ€è¿‘çš„ä¸‰ä¸ªé¡¹ç›®ï¼Œå¹¶åˆ›å»ºäº†ä¸¤ä¸ªå¿…é¡»é€‚ç”¨äºè¿™äº›é¡¹ç›®çš„å®šå¾‹:

1.  A > B + C

2.  B > C

å…¶ä¸­ Aã€B å’Œ C æ˜¯å †æ ˆä¸Šæœ€è¿‘çš„ä¸‰ä¸ªé¡¹ç›®ã€‚

ç”¨è’‚å§†Â·å½¼å¾—æ–¯è‡ªå·±çš„è¯è¯´:

> *ä¸€ä¸ªå¥½çš„æŠ˜è¡·æ–¹æ¡ˆæ˜¯åœ¨å †æ ˆæ¡ç›®ä¸Šä¿æŒä¸¤ä¸ªä¸å˜é‡ï¼Œå…¶ä¸­ Aã€B å’Œ C æ˜¯æœ€å‰é¢ä¸‰ä¸ªå°šæœªåˆå¹¶çš„ç‰‡çš„é•¿åº¦*

é€šå¸¸ï¼Œåˆå¹¶ä¸åŒé•¿åº¦çš„ç›¸é‚»çº¿è·¯æ˜¯å¾ˆå›°éš¾çš„ã€‚æ›´å›°éš¾çš„æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»ä¿æŒç¨³å®šã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒTimsort ç•™å‡ºäº†ä¸´æ—¶å†…å­˜ã€‚å®ƒå°†ä¸¤æ¬¡è¿è¡Œä¸­è¾ƒå°çš„ä¸€æ¬¡(åŒæ—¶è°ƒç”¨è¿è¡Œ A å’Œ B)æ”¾å…¥ä¸´æ—¶å†…å­˜ã€‚

### [](#galloping)**é£å¥”**

[![galloping horse gif](../Images/776cc94b15a1e1c3ec4f581d6340cf77.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--B04HcF1c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/http://66.media.tumblr.com/3c0aa162521da6790fb45acc6b6bb5f8/tumblr_mf91h56D7l1s00tolo1_500.gif)

å½“ Timsort æ­£åœ¨åˆå¹¶ A å’Œ B æ—¶ï¼Œå®ƒæ³¨æ„åˆ°ä¸€ä¸ª run å·²ç»è¿ç»­â€œèµ¢â€äº†å¾ˆå¤šæ¬¡ã€‚å¦‚æœç»“æœæ˜¯è¿è¡Œ A åŒ…å«çš„æ•°å­—å®Œå…¨å°äºè¿è¡Œ Bï¼Œé‚£ä¹ˆè¿è¡Œ A å°†ä¼šå›åˆ°åŸæ¥çš„ä½ç½®ã€‚åˆå¹¶è¿™ä¸¤ä¸ªé¡¹ç›®éœ€è¦åšå¤§é‡çš„å·¥ä½œï¼Œä½†å´ä¸€æ— æ‰€è·ã€‚

é€šå¸¸æƒ…å†µä¸‹ï¼Œæ•°æ®ä¼šæœ‰ä¸€äº›é¢„å…ˆå­˜åœ¨çš„å†…éƒ¨ç»“æ„ã€‚Timsort å‡è®¾ï¼Œå¦‚æœå¾ˆå¤š run A çš„å€¼ä½äº run B çš„å€¼ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½ A å°†ç»§ç»­å…·æœ‰æ¯” B å°çš„å€¼ã€‚

[![Timsortâ€Šâ€”â€Šthe fastest sorting algorithm youâ€™ve never heard of](../Images/54c56654754059d9f33f30a8dcb6e308.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--LpZDAXSl--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://skerritt.blog/content/images/2019/01/image-505.png)

ä¸¤ä¸ªç¤ºä¾‹è¿è¡Œçš„å›¾åƒï¼ŒA å’Œ bã€‚è¿è¡Œå¿…é¡»ä¸¥æ ¼å¢åŠ æˆ–å‡å°‘ï¼Œå› æ­¤é€‰æ‹©è¿™äº›æ•°å­—ã€‚

Timsort éšåå°†è¿›å…¥é£å¥”æ¨¡å¼ã€‚Timsort å¯¹ a[0]ä¸­ b[0]çš„é€‚å½“ä½ç½®æ‰§è¡ŒäºŒåˆ†æœç´¢æ³•ï¼Œè€Œä¸æ˜¯å¯¹ A[0]å’Œ B[0]è¿›è¡Œæ ¸å¯¹ã€‚è¿™æ ·ï¼ŒTimsort å¯ä»¥å°† A çš„æ•´ä¸ªéƒ¨åˆ†ç§»åŠ¨åˆ°ä½ã€‚ç„¶åï¼ŒTimsort åœ¨ B ä¸­æœç´¢ A[0]çš„é€‚å½“ä½ç½®ã€‚ç„¶åï¼ŒTimsort å°†ä¸€æ¬¡ç§»åŠ¨ B ç½çš„æ•´ä¸ªéƒ¨åˆ†ï¼Œå¹¶æ”¾ç½®åˆ°ä½ã€‚

è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®é™…æƒ…å†µã€‚Timsort æ£€æŸ¥ B [0](https://dev.towhich%20is%205) å¹¶ä½¿ç”¨äºŒåˆ†æœç´¢æ³•åœ¨ a ä¸­å¯»æ‰¾æ­£ç¡®çš„ä½ç½®

å—¯ï¼ŒB[0]å±äº A åˆ—è¡¨çš„æœ«å°¾ã€‚ç°åœ¨ Timsort åœ¨ B çš„æ­£ç¡®ä½ç½®æ£€æŸ¥ A [0](https://dev.towhich%20is%201) ã€‚æ‰€ä»¥æˆ‘ä»¬è¦çœ‹çœ‹æ•°å­— 1 å»äº†å“ªé‡Œã€‚è¿™ä¸ªæ•°åœ¨ B çš„å¼€å¤´ï¼Œæˆ‘ä»¬ç°åœ¨çŸ¥é“ B å±äº A çš„ç»“å°¾ï¼ŒA å±äº B çš„å¼€å¤´ã€‚

äº‹å®è¯æ˜ï¼Œå¦‚æœ B[0]çš„åˆé€‚ä½ç½®éå¸¸é è¿‘ A çš„å¼€å¤´(åä¹‹äº¦ç„¶)ï¼Œé‚£ä¹ˆè¿™ä¸ªæ“ä½œæ˜¯ä¸å€¼å¾—çš„ã€‚å› æ­¤ï¼Œå¦‚æœæ²¡æœ‰å›æŠ¥ï¼Œç–¾é©°æ¨¡å¼å¾ˆå¿«å°±ä¼šé€€å‡ºã€‚æ­¤å¤–ï¼ŒTimsort æ³¨æ„åˆ°äº†è¿™ä¸€ç‚¹ï¼Œå¹¶é€šè¿‡å¢åŠ è¿ç»­ A-only æˆ– B-only è·èƒœçš„æ¬¡æ•°æ¥å¢åŠ ä»¥åè¿›å…¥ç–¾é©°æ¨¡å¼çš„éš¾åº¦ã€‚å¦‚æœ gallop æ¨¡å¼æœ‰å›æŠ¥ï¼ŒTimsort ä¼šè®©é‡æ–°è¿›å…¥å˜å¾—æ›´å®¹æ˜“ã€‚

ç®€è€Œè¨€ä¹‹ï¼ŒTimsort åšäº†ä¸¤ä»¶éå¸¸å¥½çš„äº‹æƒ…:

*   åœ¨å…·æœ‰é¢„å…ˆå­˜åœ¨çš„å†…éƒ¨ç»“æ„çš„é˜µåˆ—ä¸Šå®ç°å‡ºè‰²çš„æ€§èƒ½
*   èƒ½å¤Ÿä¿æŒç¨³å®šçš„æ’åº

ä»¥å‰ï¼Œä¸ºäº†å®ç°ç¨³å®šçš„æ’åºï¼Œæ‚¨å¿…é¡»ç”¨æ•´æ•°å‹ç¼©åˆ—è¡¨ä¸­çš„é¡¹ç›®ï¼Œå¹¶å°†å…¶ä½œä¸ºå…ƒç»„æ•°ç»„è¿›è¡Œæ’åºã€‚

* * *

### [](#code)**ä»£ç **

å¦‚æœæ‚¨å¯¹ä»£ç ä¸æ„Ÿå…´è¶£ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚è¿™ä¸€éƒ¨åˆ†ä¸‹é¢è¿˜æœ‰æ›´å¤šä¿¡æ¯ã€‚

ä¸‹é¢çš„æºä»£ç æ˜¯åŸºäºæˆ‘å’Œ Nanda Javarma çš„å·¥ä½œã€‚æºä»£ç å¹¶ä¸å®Œæ•´ï¼Œä¹Ÿä¸åƒ Python å®˜æ–¹çš„ sorted()æºä»£ç ã€‚è¿™åªæ˜¯ä¸€ä¸ªç®€åŒ–çš„ Timsortï¼Œæˆ‘å®ç°å®ƒæ˜¯ä¸ºäº†å¯¹ Timsort æœ‰ä¸€ä¸ªæ€»ä½“çš„æ„Ÿè§‰ã€‚å¦‚æœä½ æƒ³çœ‹åˆ° Timsort çš„åŸå§‹æºä»£ç ï¼Œè¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ã€‚Timsort æ˜¯ç”¨ C å®ç°çš„ï¼Œè€Œä¸æ˜¯ Pythonã€‚

```
# based off of this code https://gist.github.com/nandajavarma/a3a6b62f34e74ec4c31674934327bbd3
# Brandon Skerritt
# https://skerritt.tech 
def binary_search(the_array, item, start, end):
    if start == end:
        if the_array[start] > item:
            return start
        else:
            return start + 1
    if start > end:
        return start

    mid = round((start + end)/ 2)

    if the_array[mid] < item:
        return binary_search(the_array, item, mid + 1, end)

    elif the_array[mid] > item:
        return binary_search(the_array, item, start, mid - 1)

    else:
        return mid

"""
Insertion sort that timsort uses if the array size is small or if
the size of the "run" is small
"""
def insertion_sort(the_array):
    l = len(the_array)
    for index in range(1, l):
        value = the_array[index]
        pos = binary_search(the_array, value, 0, index - 1)
        the_array = the_array[:pos] + [value] + the_array[pos:index] + the_array[index+1:]
    return the_array

def merge(left, right):
    """Takes two sorted lists and returns a single sorted list by comparing the
    elements one at a time.
    [1, 2, 3, 4, 5, 6]
    """
    if not left:
        return right
    if not right:
        return left
    if left[0] < right[0]:
        return [left[0]] + merge(left[1:], right)
    return [right[0]] + merge(left, right[1:])

def timsort(the_array):
    runs, sorted_runs = [], []
    length = len(the_array)
    new_run = [the_array[0]]

    # for every i in the range of 1 to length of array
    for i in range(1, length):
        # if i is at the end of the list
        if i == length - 1:
            new_run.append(the_array[i])
            runs.append(new_run)
            break
        # if the i'th element of the array is less than the one before it
        if the_array[i] < the_array[i-1]:
            # if new_run is set to None (NULL)
            if not new_run:
                runs.append([the_array[i]])
                new_run.append(the_array[i])
            else:
                runs.append(new_run)
                new_run = []
        # else if its equal to or more than
        else:
            new_run.append(the_array[i])

    # for every item in runs, append it using insertion sort
    for item in runs:
        sorted_runs.append(insertion_sort(item))

    # for every run in sorted_runs, merge them
    sorted_array = []
    for run in sorted_runs:
        sorted_array = merge(sorted_array, run)

    print(sorted_array)

timsort([2, 3, 1, 5, 6, 7]) 
```

Timsort å®é™…ä¸Šå†…ç½®åœ¨ Python ä¸­ï¼Œæ‰€ä»¥è¿™æ®µä»£ç åªæ˜¯ä½œä¸ºä¸€ä¸ªè§£é‡Šå™¨ã€‚è¦ä½¿ç”¨ Timsortï¼Œåªéœ€ç¼–å†™:

```
list.sort() 
```

æˆ–è€…

```
sorted(list) 
```

å¦‚æœä½ æƒ³æŒæ¡ Timsort çš„å·¥ä½œåŸç†å¹¶æœ‰æ‰€ä½“ä¼šï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ å°è¯•è‡ªå·±å®ç°å®ƒï¼

æœ¬æ–‡åŸºäº Tim Peters å¯¹ Timsort çš„åŸå§‹ä»‹ç»ï¼Œåœ¨è¿™é‡Œæ‰¾åˆ°ã€‚

* * *

ğŸ‘‹ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« å—ï¼Ÿè®¢é˜…æˆ‘çš„ç”µå­é‚®ä»¶åˆ—è¡¨ï¼Œæ¯å½“æˆ‘å‘å¸ƒæ–°çš„ä¸œè¥¿æ—¶(å¤§çº¦æ¯ 3 - 6 å‘¨ä¸€æ¬¡)å°±ä¼šæ”¶åˆ°ä¸€å°ç”µå­é‚®ä»¶ã€‚âœ¨ğŸ˜[https://pages.convertkit.com/2ffbe6834c/8444e0640e](https://pages.convertkit.com/2ffbe6834c/8444e0640e)