# Whatsapp Bot API æ„å»ºä¸€ä¸ª Whatsapp Botï¼Œå¿«é€Ÿâš¡

> åŸæ–‡:[https://dev.to/jajoosam/build-a-whatsapp-bot-fast-2 hdc](https://dev.to/jajoosam/build-a-whatsapp-bot-fast--2hdc)

å‡ ä¸ªæœˆå‰ï¼Œæˆ‘å¼€å§‹åœ¨ [Telegram](https://t.me) ä¸Šåˆ¶ä½œèŠå¤©æœºå™¨äººâ€”â€”æˆ‘çœ‹åˆ°äº†ä¸€äº› WhatsApp çš„ APIï¼Œä½†å®ƒä»¬éƒ½ä¸æ˜¯å®˜æ–¹çš„ï¼Œæœ‰å¯èƒ½è®©ä½ çš„å·ç è¢«å±è”½ğŸ“± âŒ

å‰é˜µå­çœ‹åˆ° [Twilio](https://twilio.com) æœ‰å®˜æ–¹çš„ WhatsApp APIã€‚30 åˆ†é’Ÿåï¼Œæˆ‘åœ¨ WhatsApp ä¸Šåšäº†ä¸€ä¸ª[ç»´åŸºç™¾ç§‘æœºå™¨äºº](https://wikibot.4ty2.fun)ğŸ‘‡

[![](../Images/3ddcf599475364e773293164d5e54419.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--rOxVTVOx--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://wikibot.surge.sh/Untitled-b9da3f92-94c0-4f97-8afb-787110d8a9d3.png)

è¿™æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ åœ¨ WhatsApp ä¸Šåˆ¶ä½œä½ è‡ªå·±çš„èŠå¤©æœºå™¨äººçš„æ•™ç¨‹â€”â€”è¿™äº›æœºå™¨äººå¯ä»¥ç«‹å³è¢«è¶…è¿‡ 20 äº¿ç”¨æˆ·ä½¿ç”¨ï¼Œå¹¶ä¸”æœ‰å¾ˆå¤šå¯èƒ½çš„äº‹æƒ…ğŸ“

æˆ‘ç­‰ä¸åŠè¦çœ‹ä½ åšä»€ä¹ˆäº†ï¼ç°åœ¨ï¼Œæˆ‘ä»¬å¼€å§‹å§ğŸƒâ€â™‚ï¸

## [](#accounts-and-keys)ğŸ”‘å¸æˆ·å’Œå¯†é’¥

é¦–å…ˆï¼Œæ³¨å†Œå‚åŠ [Twilio](https://www.twilio.com/try-twilio)â€”â€”è¿™æ˜¯å…è´¹çš„ï¼Œä½ ä¸éœ€è¦ä¿¡ç”¨å¡ğŸ’³

[![](../Images/a0b354acd23f4cc9f452566e071bd69d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--vGgUVy53--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://wikibot.surge.sh/screely-1535885763017-fc654067-9557-4bf7-98b5-4337911ff4ba.png)

éªŒè¯å®Œç”µè¯å·ç åï¼Œé€‰æ‹© Procuts >å¯ç¼–ç¨‹ SMSï¼Œç„¶åç»§ç»­å‘½åæ‚¨çš„é¡¹ç›®ã€‚

[![](../Images/7e3f54aa9bccb642edb26a58dbe63769.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--uNYFoiUW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://wikibot.surge.sh/screely-1535885937977-c5a924ec-8cc3-4430-9345-9b5e1dc74ef3.png)

éšæ„è·³è¿‡æ·»åŠ é˜Ÿå‹çš„æ­¥éª¤â€”â€”ä½ ç°åœ¨ä¸éœ€è¦ã€‚

ç°åœ¨ï¼Œæ‚¨å¿…é¡»æ³¨æ„æ„å»º WhatsApp bot æ‰€éœ€çš„ä¸€äº›è®¤è¯å¯†é’¥ğŸ‘‡

[![](../Images/df89c550ef62189e08d21ff7a48c8232.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--v3ICO9qO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://wikibot.surge.sh/screely-1535886250966-f68b6cfb-c104-4adf-80e7-4e3f9bd15b5b.png)

æœ€åä¸€æ­¥â€”â€”è®¾ç½®ä½ çš„ WhatsApp æ²™ç›’[è¿™é‡Œ](https://www.twilio.com/console/sms/whatsapp/sandbox)â€”â€”é€‰æ‹©ä»»æ„æ•°å­—ï¼ŒæŒ‰ç…§é¡µé¢ä¸Šçš„è¯´æ˜åŠ å…¥ä½ çš„æ²™ç›’ã€‚

[![](../Images/dbba229b5d00ae1d843d46f9cc55d85b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--2vIgik1Z--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://wikibot.surge.sh/screely-1535886798623-1dac1ba9-c362-4e49-87ab-7bbb6138e8c7.png)

Aaaaaand æ‚¨å°±å®Œæˆäº†å‡­è¯è®¾ç½®ï¼åˆ«æ‹…å¿ƒï¼Œè¿™æ˜¯æœ¬æ•™ç¨‹ä¸­æœ€éš¾çš„éƒ¨åˆ†ğŸ˜›

## [](#getting-started)ğŸš€å…¥é—¨æŒ‡å—

ä¸ºäº†ä¸åœ¨è®¾ç½®ä¸ŠèŠ±è´¹å¤ªå¤šæ—¶é—´ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªç¯å¢ƒ(ç”¨ [repl.it](https://repl.it) ï¼)å¯ä»¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚æŠŠå¤´ä¼¸åˆ°[è¿™é‡Œ](https://repl.it/@jajoosam/wikibot-start)ï¼Œç­‰å‡ ç§’é’Ÿå‰å¼€ã€‚

æ¥ä¸‹æ¥ï¼Œ[åˆ›å»ºä¸€ä¸ª`.env`æ–‡ä»¶](https://repl.it/site/docs/repls/secret-keys)ï¼Œå¹¶åœ¨`1`å’Œ`2`T5 è¡Œè¾“å…¥ä½ çš„è´¦æˆ· SID å’Œ Auth Token

```
SID=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX # Account SID
KEY=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX # Auth Token 
```

æ‚¨å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç¯å¢ƒå·²ç»å®‰è£…äº†ä¾èµ–é¡¹ï¼Œå¹¶ä¸”è®¾ç½®äº†ä¸€ä¸ª`express`æœåŠ¡å™¨ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ç»™ Twilio ä¸€ä¸ª URL æ¥æ¥æ”¶ä¼ å…¥çš„æ¶ˆæ¯ğŸ”—

è®©æˆ‘ä»¬å›åˆ° [WhatsApp æ²™ç®±](https://www.twilio.com/console/sms/whatsapp/sandbox)ï¼Œå¹¶æ”¾å…¥ä¸€ä¸ª webhook URL ç”¨äºæ¥æ”¶æ¶ˆæ¯ã€‚

[![](../Images/ce901feb98f5aec7ab3a9389362d5705.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--fUZlJXWe--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://wikibot.surge.sh/Untitled-3ed5263b-c6d8-492b-ba08-b4644ab502cf.png)

è¿™ä¸ª URL å¿…é¡»æ˜¯ä½ åœ¨ [repl.it](http://repl.it) é¡¹ç›®+ `/incoming`çš„é¢„è§ˆé¢æ¿ä¸Šçœ‹åˆ°çš„

[![](../Images/a3fa4e7c816f271896f6875a6df08661.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--T5V9GXgk--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://wikibot.surge.sh/Untitled-1779b21f-9100-4942-b732-320dc48c5f76.png)

æˆ‘ä»¬ç°åœ¨ç»ˆäºå¯ä»¥è¯»å–å‘é€ç»™æœºå™¨äººçš„æ¶ˆæ¯äº†ã€‚å¯¼èˆªåˆ°`index.js`ï¼Œç„¶ååœ¨ webhook å¤„ç†ç¨‹åºä¸­æ·»åŠ ä¸€ä¸ªç®€å•çš„`console.log()`ğŸ‘‡

```
app.post('/incoming', (req, res) => {
  console.log(req.body)
}); 
```

å½“æ‚¨å‘ bot å‘é€æ¶ˆæ¯æ—¶ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿåœ¨ repl æ§åˆ¶å°ä¸­çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹ğŸ‘¨â€ğŸ’»

[![](../Images/5ef80570923f67b5cc75d874db3afde1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--w5gOY1YZ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://wikibot.surge.sh/Untitled-163eb09e-e6ab-4910-badb-d8aa0aa789f7.png)

æ„å»ºä¸€ä¸ª echo bot çœ‹èµ·æ¥ä¼šåƒè¿™æ ·ï¼Œä½¿ç”¨`twiml`æ¥ç¼–å†™æ¶ˆæ¯ğŸ‘‡

```
app.post('/incoming', (req, res) => {
    const twiml = new MessagingResponse();
    twiml.message(req.body.Body);
    res.writeHead(200, {'Content-Type': 'text/xml'});
  res.end(twiml.toString());
}); 
```

ä½†æ˜¯ï¼Œç”±äºæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨å°è¯•æ„å»ºä¸€ä¸ªæœ‰ç”¨çš„æœºå™¨äººâ€”â€”è®©æˆ‘ä»¬ä½¿ç”¨ä¿¡æ¯ä¸°å¯Œçš„ API å§ï¼

## [](#fetching-information)ğŸŒè·å–ä¿¡æ¯

DuckDuckGo æœ‰ä¸€ä¸ªæƒŠäººçš„å…è´¹å³æ—¶å›ç­” APIã€‚å®ƒæ¥å—ä¸€ä¸ªæŸ¥è¯¢ï¼Œå¹¶ä»ç»´åŸºç™¾ç§‘ç­‰è¿”å›ä¸€ä¸ªæ‘˜è¦ã€‚

å‡ ä¸ªä¾‹å­ğŸ‘‰[ç»´åŸºç™¾ç§‘](https://api.duckduckgo.com/?skip_disambig=1&format=json&pretty=1&q=WikiPedia)ï¼Œ [Macbook Air](https://api.duckduckgo.com/?skip_disambig=1&format=json&pretty=1&q=MacBook%20Air) ï¼Œ [Twilio](https://api.duckduckgo.com/?skip_disambig=1&format=json&pretty=1&q=Twilio)

æˆ‘èŠ±äº†ä¸€äº›æ—¶é—´åˆ›å»ºäº†ä¸€ä¸ªä¸é”™çš„è§£æå™¨ï¼Œå®ƒé€šå¸¸ä»è¿™ä¸ª API è¿”å›ä¿¡æ¯ã€‚è¯•ç€å°†è¿™æ®µä»£ç ç²˜è´´åˆ°ä½ çš„ [repl.it](http://repl.it) é¡¹ç›®ä¸­ï¼Œä½ çš„[æ§åˆ¶å°](https://dsh.re/f7477c)ä¸­åº”è¯¥æœ‰å…³äº Trump çš„å†…å®¹ğŸ˜›

```
var base = 'https://api.duckduckgo.com/?skip_disambig=1&format=json&pretty=1&q=';
var query = 'Donald Trump';

request(base + query, function (error, response, body) {
    body = JSON.parse(body)    
    if(body["Abstract"] == ""){
        body["Abstract"]= body["RelatedTopics"][0]["Text"]
      }   
    var msg = body["Heading"]+"\n\n"+body["Abstract"];
  console.log(msg)
  }); 
```

å¾ˆç›´æ¥ï¼Œå¯¹å§ï¼ŸğŸ˜„

## [](#putting-it-all-together)ğŸ› ï¸æŠŠè¿™ä¸€åˆ‡è”ç³»åœ¨ä¸€èµ·

è¦åˆ¶ä½œæˆ‘ä»¬å®é™…çš„æœºå™¨äººï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ä»æˆ‘ä»¬çš„è¯·æ±‚ä¸­è·å–æŸ¥è¯¢â€”â€”æˆ‘ä»¬å¯ä»¥ç”¨`req.body.Body`æ¥è·å–â€”â€”å¹¶ä½¿ç”¨`twmil`æ¥å‘é€æˆ‘ä»¬åœ¨`msg`
ä¸­æ”¶é›†çš„æ•°æ®

```
app.post('/incoming', (req, res) => {
    const twiml = new MessagingResponse();
    var base = 'https://api.duckduckgo.com/?skip_disambig=1&format=json&pretty=1&q=';
    var query = req.body.Body;

    request(base + query, function (error, response, body) {
        body = JSON.parse(body)  

        if(body["Abstract"] == ""){
            body["Abstract"]= body["RelatedTopics"][0]["Text"]
          }   

        var msg = twiml.message(body["Heading"]+"\n\n"+body["Abstract"]);
            res.writeHead(200, {'Content-Type': 'text/xml'});
          res.end(twiml.toString());
      });

}); 
```

ä½ ç°åœ¨æœ‰äº†ä¸€ä¸ªå…¨åŠŸèƒ½çš„ WhatsApp æœºå™¨äººï¼å‘é€ä»»ä½•ä½ æƒ³çŸ¥é“çš„å…³äºä½ çš„æœºå™¨äººçš„ä¿¡æ¯ğŸ¤–ä½ åº”è¯¥ä¼šçœ‹åˆ°å®ƒååº”è¶…å¿«ğŸ’¬ âš¡

æ·»åŠ æ¬¢è¿æ¶ˆæ¯å’Œä¸€ç‚¹æ ¼å¼åŒ–éå¸¸ç®€å•ï¼Œçœ‹çœ‹æœ€ç»ˆçš„ [repl](https://repl.it/@jajoosam/wikibot) å°±çŸ¥é“æˆ‘æ˜¯æ€ä¹ˆåšçš„äº†ğŸ‘¨â€ğŸ’»

[https://repl.it/@jajoosam/wikibot?lite=true](https://repl.it/@jajoosam/wikibot?lite=true)

## [](#sharing-the-bot)ğŸ”—å…±äº«æœºå™¨äºº

è¦è®©å…¶ä»–äººä½¿ç”¨è¿™ä¸ªæœºå™¨äººï¼Œä»–ä»¬éœ€è¦å…ˆåŠ å…¥ä½ çš„æ²™ç®±ï¼Œç„¶ååƒä½ ä¹‹å‰åšçš„é‚£æ ·å‘é€ä¸€æ¡æ¶ˆæ¯ğŸ‘‰`join <two-words>`

ä½ ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ–‡æœ¬åˆ›å»ºé“¾æ¥â€”â€”ä¾‹å¦‚ï¼Œè¿™ä¸ªé“¾æ¥å¯ä»¥è®©ä½ åŠ å…¥æˆ‘çš„æœºå™¨äººğŸ‘‡

```
https://wa.me/14155238886?text=join ultramarine-tapir 
```

`14155238886`æ˜¯æˆ‘çš„ bot çš„ç¼–å·ï¼Œè€Œ`ultramarine-tapir`æ˜¯æ²™ç›’çŸ­è¯­ã€‚

## [](#whats-next)âš¡ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ

ç°åœ¨ä½ å·²ç»çŸ¥é“å¦‚ä½•åœ¨ WhatsApp ä¸Šæ„å»ºä¸€ä¸ªæœºå™¨äººï¼Œè¯•ç€ç»™è‡ªå·±å‘é€é€šçŸ¥ï¼Œå¹¶æ„å»ºæ›´å¤šæœ‰ç”¨çš„å·¥å…·ï¼Twilio ä¹Ÿæœ‰å¤§é‡çš„å…¶ä»–åª’ä»‹æ¥ä¼ é€’ä¿¡æ¯ï¼

æˆ‘çš„ç»´åŸºæœºå™¨äººçš„æ‰€æœ‰ä»£ç éƒ½åœ¨ [Github](https://github.com/jajoosam/wikibot) â¬‡ï¸
ä¸Š

## ![GitHub logo](../Images/a73f630113876d78cff79f59c2125b24.png)/[wiki bot](https://github.com/jajoosam/wikibot)

### WhatsApp çš„ç»´åŸºç™¾ç§‘æœºå™¨äºº

<article class="markdown-body entry-content container-lg" itemprop="text">

# WhatsApp WikiBot

ç”± Twilio WhatsApp API å’Œ DuckDuckGo å³æ—¶æœç´¢ API æä¾›æ”¯æŒ<g-emoji class="g-emoji" alias="robot" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f916.png">ğŸ¤–</g-emoji>

ä¸

</article>

[View on GitHub](https://github.com/jajoosam/wikibot)

æˆ‘æ˜¯ä¸€ä¸ª 15 å²çš„åˆ¶é€ å•†ğŸ‘¨â€ğŸ’»æƒ³åšæ›´å¤šé…·çš„ä¸œè¥¿ï¼Œæƒ³äº†è§£æˆ‘çš„è¿›å±•ï¼Œè¯·æ³¨å†Œ[æˆ‘çš„æ—¶äº‹é€šè®¯ğŸ“§](https://buttondown.email/jajoosam)