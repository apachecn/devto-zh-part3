# ä½¿ç”¨ Reactã€Webpack 4ã€Babel 7ã€Express å’Œ Sass åˆ›å»ºèŠ‚ç‚¹åº”ç”¨ç¨‹åº

> åŸæ–‡:[https://dev . to/Kedar 9/creating-a-node-app-with-react-web pack-4-babel-7-express-and-sass-3 Mae](https://dev.to/kedar9/creating-a-node-app-with-react-webpack-4-babel-7-express-and-sass-3mae)

[![By your powers combined...](../Images/fc2fe460e1d9db973b2fa993d0a5f6c4.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--z9DieRHX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/jrcn8xq3e7h2cmx54qjq.jpg)

## [](#prologue)ğŸåºè¨€

ğŸ†•åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ã€‚è®©æˆ‘ä»¬ç§°ä¹‹ä¸ºååº”æ ·æ¿ã€‚
`mkdir react-boilerplate`

è¿˜æœ‰ *cd* æ”¾è¿›å»ã€‚
`cd react-boilerplate`

ç¡®ä¿æ‚¨å®‰è£…äº†èŠ‚ç‚¹å’Œ npmã€‚è¿è¡Œè¿™äº›å‘½ä»¤æ¥ç¡®è®¤:
`node -v`
`npm -v`
å¦‚æœä½ æ²¡æœ‰å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œç‚¹å‡»[è¿™é‡Œ](https://www.npmjs.com/get-npm)å¹¶é¦–å…ˆå®‰è£…å®ƒä»¬ã€‚

ğŸ¬ç°åœ¨ï¼Œåˆå§‹åŒ–èŠ‚ç‚¹é¡¹ç›®ã€‚
`npm init`

âœ¨ä½ ä¼šè¢«æç¤ºè¾“å…¥ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚è¾“å…¥å¹¶å®Œæˆåï¼Œæ‚¨çš„æ–‡ä»¶å¤¹ä¸­åº”è¯¥æœ‰ä¸€ä¸ª **package.json** æ–‡ä»¶ã€‚

# [](#chapter-1-tree-of%C2%A0life)ğŸŒ²ç¬¬ä¸€ç« :ç”Ÿå‘½ä¹‹æ ‘

### [](#11-express)1.1 å¿«é€’

é¦–å…ˆï¼Œæˆ‘ä»¬åšä¸€ä¸ªæœåŠ¡å™¨ã€‚æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ **Express.js** æ¡†æ¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®¾è®¡æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå¤„ç†æˆ‘ä»¬çš„è·¯çº¿å¹¶æ„å»º RESTful APIsã€‚

å¦‚æœå¤„ç†è·¯ç”±å’Œ API ä¸æ˜¯æ‚¨çš„éœ€æ±‚ï¼Œæ‚¨ä»ç„¶å¯ä»¥ä½¿ç”¨ Expressï¼Œæˆ–è€…ä¸ºäº†ä½¿äº‹æƒ…æ›´ç®€å•ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹[*web pack-dev-server*](https://github.com/webpack/webpack-dev-server)ã€‚

ğŸ“¦å®‰è£… Express.js:
`npm install --save express`

âœ¨åº”è¯¥ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåä¸º **node_modules** çš„æ–‡ä»¶å¤¹ã€‚æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å®‰è£…çš„ä»»ä½•ä¸œè¥¿éƒ½å°†é©»ç•™åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­ã€‚

ğŸ†•æ˜¯æ—¶å€™å†™æœåŠ¡å™¨äº†ã€‚åˆ›å»ºä¸€ä¸ªåä¸º **server** çš„æ–°æ–‡ä»¶å¤¹ã€‚åœ¨è¿™ä¸ªæ–°æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ **index.js** ã€‚å°†è¿™ä¸ªåŸºæœ¬çš„æœ€å°ä»£ç æ·»åŠ åˆ°æ–‡ä»¶ä¸­:

```
const express = require('express');
const app = express();
const port = process.env.PORT || 3000;
const mockResponse = {
  foo: 'bar',
  bar: 'foo'
};
app.get('/api', (req, res) => {
  res.send(mockResponse);
});
app.get('/', (req, res) => {
 res.status(200).send('Hello World!');
});
app.listen(port, function () {
 console.log('App listening on port: ' + port);
}); 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å…è®¸åº”ç”¨ç¨‹åºåœ¨æŒ‡å®šçš„ç«¯å£ä¸Šè¿è¡Œã€‚
ä»£ç è¿˜å‘Šè¯‰åº”ç”¨ç¨‹åº home route:â€œ/â€åº”è¯¥è¿”å›çŠ¶æ€ 200(æˆåŠŸ)å¹¶å‘é€æ–‡æœ¬:Hello Worldã€‚å¤ŸåŸºç¡€ï¼
å®ƒè¿˜æœ‰ä¸€ä¸ª routeâ€œ/APIâ€ï¼Œè¿”å›ä¸€ä¸ªè™šæ‹Ÿ JSON å¯¹è±¡ã€‚å®ƒå±•ç¤ºäº†è·å–æ•°æ®æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

â­ï¸:è®°ä½è·¯çº¿çš„é¡ºåºå¾ˆé‡è¦ã€‚å½“è¯·æ±‚é€šè¿‡æ—¶ï¼ŒExpress ä»é¡¶éƒ¨å¼€å§‹åŒ¹é…è·¯ç”±ã€‚å½“å®ƒåŒ¹é…æŸä¸ªè·¯ç”±æ—¶ï¼Œå°†è¿”å›å“åº”ï¼Œå¹¶ä¸”ä¸ä¼šæ£€æŸ¥è¿›ä¸€æ­¥çš„è·¯ç”±ã€‚

âœï¸ç°åœ¨æœåŠ¡å™¨å·²ç»è®¾ç½®å¥½äº†ï¼Œåœ¨ package.json æ–‡ä»¶ä¸­ï¼Œåœ¨`"scripts"`ä¸‹ï¼Œæ·»åŠ ä¸€ä¸ª`start`å‘½ä»¤å¦‚ä¸‹:

```
"scripts": {
  "start": "node server/index.js",
  "test": "echo \"Error: no test specified\" && exit 1"
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œï¼Œæˆ‘ä»¬å‘Šè¯‰ Nodeï¼Œè¦å¯åŠ¨é¡¹ç›®ï¼Œä» server/index.js å¼€å§‹ã€‚

ğŸƒğŸ»â€â™‚ï¸If:ä½ ç°åœ¨è¿è¡Œ`npm run start`å‘½ä»¤ï¼Œä½ åº”è¯¥åœ¨ç»ˆç«¯ä¸Šå¾—åˆ°ä¸€æ¡æ¶ˆæ¯:
â€œapp listening on port:3000â€ã€‚

ğŸ‰ç°åœ¨ï¼Œåœ¨ä½ çš„æµè§ˆå™¨ä¸Šè¿›å…¥ [http://localhost:3000](http://localhost:3000) ï¼Œè¿™é‡Œåº”è¯¥ä¼šæ˜¾ç¤º**â€œä½ å¥½ï¼Œä¸–ç•Œâ€**æ¶ˆæ¯ã€‚è½¬åˆ°[http://localhost:3000/API](http://localhost:3000/api)ï¼Œä¼ª JSON åº”è¯¥ä¼šå‡ºç°ã€‚

### [](#12-webpack)1.2 ç½‘ç»œåŒ…

ğŸ“¦å®‰è£…æ—¶é—´

*   ç½‘ç»œåŒ…(æ†ç»‘å™¨)
*   webpack-cli(èƒ½å¤Ÿè¿è¡Œ webpack å‘½ä»¤çš„å‘½ä»¤è¡Œç•Œé¢)

`npm install --save-dev webpack webpack-cli`

åœ¨ **package.json** æ–‡ä»¶ä¸­çš„`"scripts"`ä¸‹ï¼Œæ·»åŠ ä¸€ä¸ª`build`å‘½ä»¤:

```
"scripts": {
  "start": "node server/index.js",
  "build": "webpack --mode production",
  "test": "echo \"Error: no test specified\" && exit 1"
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ğŸ†•ç°åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º **src** çš„æ–‡ä»¶å¤¹ã€‚è¿™æ˜¯æˆ‘ä»¬é¡¹ç›®çš„å¤§éƒ¨åˆ†æºä»£ç å­˜åœ¨çš„åœ°æ–¹ã€‚åœ¨è¿™ä¸ªæ–°æ–‡ä»¶å¤¹ src ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ **index.js** ã€‚
æš‚æ—¶å°†æ–‡ä»¶ç•™ç©ºã€‚

ğŸƒğŸ»â€â™‚ï¸If ä½ è¿è¡Œ`npm run build`å‘½ä»¤ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ª **dist** æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªæ†ç»‘çš„ **main.js** æ–‡ä»¶ã€‚å…¶ä¸­çš„ä»£ç å°†è¢«ç²¾ç®€ä»¥ä¾›ç”Ÿäº§ä½¿ç”¨ã€‚

# [](#chapter-2-twilight%C2%A0ozone)ğŸ›°ï¸ç¬¬äºŒç« :æš®è‰²è‡­æ°§

### [](#21-babel)2.1 é€šå¤©å¡”

ğŸ¤—ååº”è¿‡æ¥æ‹¥æŠ± JSXã€‚(å°½ç®¡ JS ä¹Ÿèƒ½å¾ˆå¥½åœ°å·¥ä½œ)ã€‚
Babel å¸®åŠ©å°† JSX è¯­æ³•ç¼–è¯‘æˆ JSã€‚
â™»ï¸ä¸ä»…å¦‚æ­¤ï¼Œè€Œä¸”è¿˜æ˜¯å¸¸å®¢ã€‚js æ–‡ä»¶ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨ ES6 è¯­æ³•ï¼ŒBabel ä¼šæŠŠå®ƒç¼–è¯‘æˆç­‰ä»·çš„ ES5 æ ¼å¼ã€‚

ğŸ“¦å®‰è£…

*   @babel/core(å°† ES6+ä»£ç è½¬åŒ–ä¸º ES5)
*   @babel/preset-env(é¢„è®¾ä¸ºå…è®¸å¤šå¡«å……)
*   @babel/preset-react(ä¸º react å’Œ JSX é¢„è®¾)
*   babel loader(web pack helper)

`npm install --save-dev @babel/core @babel/preset-env @babel/preset-react babel-loader`

è¿™ 4 ä¸ªæ–°åŒ…ä¸­ï¼Œæœ‰ 2 ä¸ªæ˜¯*é¢„ç½®*ã€‚å·´åˆ«å¡”æ ¸å¿ƒéœ€è¦çŸ¥é“è‡ªå·±æœ‰è¿™äº›æ’ä»¶ã€‚éœ€è¦å¯¹å®ƒä»¬è¿›è¡Œè¯¦ç»†è¯´æ˜ã€‚

ğŸ†•åœ¨é¡¹ç›®çš„æ ¹çº§åˆ«ï¼Œåˆ›å»ºä¸€ä¸ª**ã€‚babelrc** æ–‡ä»¶ã€‚å¹¶å°†é¢„ç½®æŒ‡å®šä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
{
  "presets": ["@babel/preset-env", "@babel/preset-react"]
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæ‚¨çš„ä»£ç éœ€è¦å¤šå¡«å……ï¼Œæ‚¨è¿˜éœ€è¦è¿™äº›èŠ‚ç‚¹åŒ…:`core-js`å’Œ`regenerator-runtime`ã€‚æ›´å¤šå…³äº[è¿™é‡Œ](https://github.com/zloirock/core-js/blob/master/docs/2019-03-19-core-js-3-babel-and-a-look-into-the-future.md)ã€‚

### [](#22-babel-%C2%A0webpack)2.2 å·´åˆ«å¡”+ç½‘ç»œåŒ…

åŸºäº Babel çš„åŠŸèƒ½ï¼ŒWebpack éœ€è¦çŸ¥é“è¿™ä¸€ç‚¹ã€‚js å’Œã€‚jsx æ–‡ä»¶åœ¨æ†ç»‘ä¹‹å‰éœ€è¦ç»è¿‡ Babelã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºè¯¥è§„åˆ™é…ç½® Webpackã€‚

ğŸ†•åœ¨é¡¹ç›®çš„æ ¹çº§åˆ«ï¼Œåˆ›å»ºä¸€ä¸ª **webpack.config.js** æ–‡ä»¶ã€‚è¿™å°†æ˜¯æ‰€æœ‰ webpack é…ç½®çš„æ–‡ä»¶ã€‚åƒè¿™æ ·æ·»åŠ è§„åˆ™:

```
module.exports = {
  module: {
    rules: [
      {
        test: /\.(js|jsx)$/,
        exclude: /node_modules/,
        use: {
          loader: "babel-loader"
        }
      }
    ]
  }
}; 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

â­ï¸è®°ä½:ç”±äº webpack æ†ç»‘äº†æ‰€æœ‰çš„ä¸œè¥¿å¹¶åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„æµè§ˆå™¨å¯è¯»ä»£ç ï¼Œæ‰€æœ‰ä½ å®‰è£…çš„åŒ…ã€é¢„ç½®å’Œæ’ä»¶éƒ½éœ€è¦åœ¨ webpack ä¸­é…ç½®ã€‚

# [](#chapter-3%C2%A0utopia)ğŸ–ï¸ç¬¬ä¸‰ç« :ä¹Œæ‰˜é‚¦

### [](#31-react)3.1 ååº”è¿‡æ¥

æ˜¯æ—¶å€™å®‰è£… react å’Œ react-dom äº†ã€‚
`npm install --save react react-dom`

ğŸ†•åœ¨æ–‡ä»¶å¤¹ **src/** ä¸­ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶**index.html**ã€‚è¿™å°†æ˜¯æˆ‘ä»¬çš„é¡¹ç›®ä¸­çš„ä¸»è¦å’Œå”¯ä¸€çš„ HTML æ–‡ä»¶ã€‚å®ƒå°±åƒä½ åˆ¶ä½œçš„ä»»ä½•å¸¸è§„ HTML æ–‡ä»¶ä¸€æ ·ï¼Œåªæœ‰ä¸€ç‚¹ä¸åŒ:å®ƒéœ€è¦åœ¨`<body>`ä¸­æœ‰ä¸€ä¸ª`<div>`ï¼ŒReact å¯ä»¥*å¡«å……*ã€‚
ğŸ”å®ƒéœ€è¦ React å¯ä»¥æŸ¥æ‰¾çš„æŸç§å½¢å¼çš„æ ‡è¯†ç¬¦ã€‚æˆ‘ä»¬å°†`id="root"`è®¾å®šåœ¨`div`ä¸Šã€‚æ‚¨å¯ä»¥å°† id è®¾ç½®ä¸ºæ‚¨æƒ³è¦çš„ä»»ä½•å€¼ã€‚
ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ index.html å’Œ`<div id="root"></div>`çš„æ ·å­:

```
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>React Boilerplate</title>
</head>
<body>
  <div id="root"></div>
</body>
</html> 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

âœï¸è¿˜è®°å¾—æˆ‘ä»¬åœ¨ç¬¬ 1.2 èŠ‚åˆ›å»ºçš„é‚£ä¸ªç©ºçš„ **src/index.js** æ–‡ä»¶å—ï¼Ÿ
æ·»åŠ ä»£ç çš„æ—¶é—´:

```
import React from 'react';
import ReactDOM from 'react-dom';
const Index = () => {
  return <div>Welcome to React!</div>;
};
ReactDOM.render(<Index />, document.getElementById('root')); 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

âš¡ï¸Hereï¼Œ`Index`æ˜¯ä¸€ä¸ªè¿”å› React å…ƒç´ çš„å‡½æ•°ç»„ä»¶ã€‚ReactDOM åœ¨æ¥è‡ª index.html**çš„`<div id="root"></div>`å†…æ¸²æŸ“ã€‚**

### [](#32-react-%C2%A0webpack)3.2 è¯•å‰‚+ç½‘é¡µåŒ…

ç±»ä¼¼äºæˆ‘ä»¬æ‰€åšçš„ã€‚js å’Œã€‚jsx æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ Webpack å¦‚ä½•å¤„ç†æ–°çš„ã€‚html æ–‡ä»¶ã€‚Webpack éœ€è¦å°†å…¶æ†ç»‘åˆ° **dist** æ–‡ä»¶å¤¹ä¸­ã€‚

ğŸ“¦ä¸ºæ­¤ï¼Œæˆ‘ä»¬å®‰è£… html-webpack-pluginã€‚
`npm install --save-dev html-webpack-plugin`

âœï¸éœ€è¦æ›´æ–° webpack é…ç½®æ–‡ä»¶æ¥å¤„ç†è¿™ä¸ªæ’ä»¶ã€‚æˆ‘ä»¬è¿˜å‘Šè¯‰ webpackï¼Œç°åœ¨ç¼–ç çš„ **src/index.js** æ˜¯å…¥å£ç‚¹ã€‚
è¿™æ˜¯æ·»åŠ åçš„é…ç½®æ–‡ä»¶çš„æ ·å­:

```
const HtmlWebPackPlugin = require("html-webpack-plugin");
const path = require('path');
const htmlPlugin = new HtmlWebPackPlugin({
  template: "./src/index.html", 
  filename: "./index.html"
});
module.exports = {
  entry: "./src/index.js",
  output: { // NEW
    path: path.join(__dirname, 'dist'),
    filename: "[name].js"
  }, // NEW Ends
  plugins: [htmlPlugin],
  module: {
    rules: [
      {
        test: /\.(js|jsx)$/,
        exclude: /node_modules/,
        use: {
          loader: "babel-loader"
        }
      }
    ]
  }
}; 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“å®ä¾‹åŒ–`htmlPlugin`æ—¶ï¼Œ`template`é€‰é¡¹å‘Šè¯‰ webpack é€‰æ‹©ä»€ä¹ˆæ–‡ä»¶ï¼Œè€Œ`filename`é€‰é¡¹å‘Šè¯‰æ†ç»‘åŒ…çš„åç§°ã€‚dist æ–‡ä»¶å¤¹ä¸­çš„ html æ–‡ä»¶ã€‚

### [](#33-react-%C2%A0express)3.3 ååº”+è¡¨è¾¾

ğŸƒğŸ»â€â™‚ï¸:å¦‚æœä½ ç°åœ¨è¿è¡Œ`npm run start`ï¼Œæˆ‘ä»¬ä»ç„¶ä¼šåœ¨æœ¬åœ°ä¸»æœºä¸Šæ”¶åˆ°**â€œhello worldâ€**æ¶ˆæ¯ã€‚è¿™æ˜¯å› ä¸º Express æœåŠ¡å™¨ä¸çŸ¥é“è¿™äº›æ–°æ–‡ä»¶ã€‚

âœï¸åœ¨ package.json ä¸­ï¼Œ`start`è„šæœ¬åªæ˜¯å¯åŠ¨æœåŠ¡å™¨ã€‚
æˆ‘ä»¬ç°åœ¨éœ€è¦ webpack æ¥æ‰“åŒ…æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œç„¶åå¯åŠ¨æœåŠ¡å™¨ã€‚
åœ¨`"scripts"`ä¸‹ï¼Œå¢åŠ ä¸€ä¸ªæ–°çš„`dev`å‘½ä»¤ã€‚

```
"scripts": {
  "start": "node server/index.js",
  "dev": "webpack --mode development && node server/index.js",
  "build": "webpack --mode production",
  "test": "echo \"Error: no test specified\" && exit 1"
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬ç°åœ¨åº”è¯¥æ›´æ–° Express å¹¶æ›´æ”¹è·¯ç”±â€œ/â€è¿”å›çš„å†…å®¹ã€‚å®ƒåº”è¯¥è¿”å› **dist/index.html** æ–‡ä»¶ã€‚

âœï¸åœ¨ server/index.js ä¸­è¿›è¡Œæ›´æ–°(ä»£ç çš„æ–°éƒ¨åˆ†ä»¥æ³¨é‡Šç»“å°¾:`// NEW` ):

```
const express = require('express');
const path = require('path'); // NEW

const app = express();
const port = process.env.PORT || 3000;
const DIST_DIR = path.join(__dirname, '../dist'); // NEW
const HTML_FILE = path.join(DIST_DIR, 'index.html'); // NEW
const mockResponse = {
  foo: 'bar',
  bar: 'foo'
};
app.use(express.static(DIST_DIR)); // NEW
app.get('/api', (req, res) => {
  res.send(mockResponse);
});
app.get('/', (req, res) => {
 res.sendFile(HTML_FILE); // EDIT
});
app.listen(port, function () {
 console.log('App listening on port: ' + port);
}); 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ğŸ‰ç°åœ¨è¿è¡Œ`npm run dev`ï¼Œåœ¨æµè§ˆå™¨ä¸Šè¿›å…¥ [http://localhost:3000](http://localhost:3000) ã€‚**â€œæ¬¢è¿ååº”è¿‡æ¥ï¼â€**æ¥è‡ª **src/index.js** çš„æ¶ˆæ¯åº”è¯¥ä¼šæ˜¾ç¤ºåœ¨é‚£é‡Œã€‚â€œ/apiâ€è·¯å¾„ä»ç„¶åƒä»¥å‰ä¸€æ ·å·¥ä½œã€‚

# [](#chapter-4-bottom-line%C2%A0green)ğŸµç¬¬ 4 ç« :åº•çº¿ç»¿è‰²

### [](#41-sass)4.1 è¨æ–¯

æ˜¯æ—¶å€™è®©ä¸œè¥¿çœ‹èµ·æ¥æ›´å¥½äº†ã€‚å®‰è£… node-sass å’Œæ‰€éœ€åŠ è½½ç¨‹åºçš„æ—¶é—´:æ ·å¼åŠ è½½ç¨‹åºã€css åŠ è½½ç¨‹åºå’Œ sass åŠ è½½ç¨‹åºã€‚

`npm install --save-dev node-sass style-loader css-loader sass-loader`

ğŸ†•åœ¨ **src/** æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶ **styles.scss** ã€‚å‘è¯¥æ–‡ä»¶æ·»åŠ ä¸€äº›æ ·å¼ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨é¡µé¢ä¸Šä½¿ç”¨ç³»ç»Ÿå­—ä½“çš„åŸºæœ¬(ä¹Ÿæ˜¯æµè¡Œçš„)ä»£ç ã€‚æˆ‘ä»¬è¿˜è®¾ç½®äº†å®ƒçš„é¢œè‰²å±æ€§ã€‚

```
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
  Helvetica, Roboto, Arial, sans-serif;
  color: brown;
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°†æ˜¯ä¸€ä¸ªæ·»åŠ é¡¶çº§å’Œ/æˆ–å…¨å±€æ ·å¼çš„å¥½æ–‡ä»¶ã€‚

âœï¸å¯¼å…¥æ–°çš„ **styles.scss** æ–‡ä»¶ã€‚ä½ å¯ä»¥æŠŠå®ƒæ·»åŠ åˆ° index.html çš„**æˆ–è€… index.js æ–‡ä»¶ä¸­ã€‚ä¸ºäº†è®¡åˆ’ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬å°†å…¶å¯¼å…¥åˆ° **index.js** æ–‡ä»¶:** 

```
import React from 'react';
import ReactDOM from 'react-dom';
import './styles.scss';
const Index = () => {
  return <div>Welcome to React!</div>;
};
ReactDOM.render(<Index />, document.getElementById('app')); 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#42-sass-%C2%A0webpack)4.2 Sass + Webpack

åƒå…¶ä»–äº‹æƒ…ä¸€æ ·ï¼ŒWebpack éœ€è¦çŸ¥é“å¦‚ä½•å¤„ç†**ã€‚scss** æ–‡ä»¶ï¼Œå°†å®ƒä»¬æ­£ç¡®åœ°æ†ç»‘åˆ°æµè§ˆå™¨å¯ç†è§£çš„ä»£ç ä¸­ã€‚

âœï¸åœ¨ **webpack.config.js** ä¸­ï¼Œæ·»åŠ äº†æ–°è§„åˆ™ï¼Œå°±åƒæˆ‘ä»¬ä¸º babel-loader æ·»åŠ çš„è§„åˆ™ä¸€æ ·ã€‚æ‰€ä»¥ï¼Œåœ¨`module.exports`ä¸­çš„`module`å¯¹è±¡çš„`rules`æ•°ç»„ä¸­ï¼ŒåŠ ä¸Š:

```
{
  test: /\.s?css$/,
  use: ['style-loader', 'css-loader', 'sass-loader']
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ğŸ‰ç°åœ¨è¿è¡Œ`npm run dev`ï¼Œåœ¨æµè§ˆå™¨ä¸Šè¿›å…¥ [http://localhost:3000](http://localhost:3000) ã€‚â€œæ¬¢è¿ååº”è¿‡æ¥çš„**ï¼æ¶ˆæ¯"**åº”è¯¥åœ¨ç³»ç»Ÿä¸­ä»¥æ£•è‰²å­—ä½“æ˜¾ç¤ºã€‚

## [](#epilogue)âŒ›åè®°

### [](#react-components)ğŸ–‡ï¸ååº”è¿‡æ¥çš„æˆåˆ†

React é¡¹ç›®ç”±è®¸å¤šè¾ƒå°çš„ç»„ä»¶ç»„æˆã€‚ **src/index.js** ä¸­çš„`Index`å°±æ˜¯è¿™æ ·ä¸€ä¸ªç»„ä»¶ã€‚æ‚¨å°†åˆ›å»ºæ›´å¤šè¿™æ ·çš„ç»„ä»¶å¹¶å°†å®ƒä»¬å¯¼å…¥(åˆ°å¦ä¸€ä¸ªä¸­ğŸ¤¨).

ğŸ“‚æˆ‘å»ºè®®åœ¨ **src/** æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º **components/** çš„æ–‡ä»¶å¤¹ã€‚å¹¶å°†æ‰€æœ‰å…¶ä»–ç»„ä»¶å­˜å‚¨åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­ã€‚

ç†æƒ³æƒ…å†µä¸‹ï¼Œåœ¨ **components/** ä¸­ï¼Œä¸ºæ¯ä¸ªç»„ä»¶åˆ›å»ºä¸€ä¸ªå­æ–‡ä»¶å¤¹ã€‚
ä½†è¿™å–å†³äºä¸ªäººå–œå¥½ï¼

ğŸ’¡ä¸è¦å¿˜è®°:React ç»„ä»¶æ–‡ä»¶åº”è¯¥å¯¼å‡ºç»„ä»¶`Class`æˆ–`function`ã€‚
ä¸€æ—¦ä½ ç»™ **src/index.js** æ·»åŠ ä¸€äº›ç»„ä»¶ï¼Œå®ƒçœ‹èµ·æ¥ä¼šåƒè¿™æ ·:

```
import React from 'react';
import ReactDOM from 'react-dom';
import Header from './components/Header/index.jsx';
import Content from './components/Content/index.jsx';
const Index = () => {
  return (
    <div className="container">
      <Header />
      <Content />
    </div>
  );
};
ReactDOM.render(<Index />, document.getElementById('app')); 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#additional-webpack-configuration)ğŸ”§é™„åŠ  Webpack é…ç½®

åƒå…¶ä»–æ–‡ä»¶ä¸€æ ·ï¼Œå›¾åƒæˆ–ä»»ä½•å…¶ä»–é™æ€æ–‡ä»¶ä¹Ÿéœ€è¦æ†ç»‘ã€‚Webpack éœ€è¦çŸ¥é“è¿™ä¸€ç‚¹ã€‚
ğŸ“¦ä¸ºæ‰€æœ‰è¿™æ ·çš„æ–‡ä»¶å®‰è£…`file-loader`ä½œä¸º devDependency ( `--save-dev`)ã€‚
å¹¶åœ¨ **webpack.config.js** ä¸­æ·»åŠ ä»¥ä¸‹è§„åˆ™:

```
{
  test: /\.(png|svg|jpg|gif)$/,
  loader: "file-loader",
  options: { name: '/static/[name].[ext]' }
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæµ‹è¯•æ­£åˆ™è¡¨è¾¾å¼åªæŒ‡å®šäº†ä¸€èˆ¬çš„å›¾åƒæ‰©å±•ã€‚ä½†æ˜¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä¸ºå…¶ä»–æ–‡ä»¶æ·»åŠ ä»»ä½•æ‰©å±•å(åœ¨åŒä¸€ä¸ªè§„åˆ™å¯¹è±¡ä¸­)ã€‚

è¦åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å›¾åƒæˆ–ä»»ä½•å…¶ä»–èµ„äº§ï¼Œéœ€è¦å…ˆåœ¨ that.js/.jsx æ–‡ä»¶ä¸­å¯¼å…¥å®ƒã€‚å› æ­¤ï¼ŒWebpack å¯ä»¥æ­£ç¡®åœ°æ†ç»‘å®ƒï¼Œå¹¶ä½¿å®ƒåœ¨æ†ç»‘çš„æ–‡ä»¶å¤¹ä¸­å¯ç”¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ–‡ä»¶çš„å®é™…`[name]`æˆ–`[hash]`æ¥åˆ›å»ºå®ƒã€‚æœ‰æ²¡æœ‰æ–‡ä»¶`[ext]`ã€‚

```
// Import
import LOGO from '<path-to-file>/logo.png';

...

// Usage
<img src={LOGO} alt="Page Logo" /> 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#git%C2%A0ignore)ğŸ™…ğŸ¼â€â™‚ï¸é¥­æ¡¶ï¼Œåˆ«ç†ä»–ï¼

å¯¹äºéƒ¨ç½²ï¼ŒHeroku æˆ– Netlify ç­‰èŠ‚ç‚¹å…¼å®¹å¹³å°åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­è¿è¡Œ`build`å‘½ä»¤ã€‚è¿™å°†å®‰è£…æ‰€æœ‰çš„ **node_modules** ï¼Œå¹¶ç”Ÿæˆ **dist** æ–‡ä»¶å¤¹åŠå…¶å†…å®¹ã€‚
æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸éœ€è¦å°†æœ¬åœ°æ–‡ä»¶å¤¹: **node_modules** å’Œ **dist** æ¨é€åˆ° remoteã€‚

ğŸ†•ä¸ºäº†è®© Git çŸ¥é“è¿™ä¸€ç‚¹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶**ã€‚é¡¹ç›®æ ¹çº§åˆ«ä¸Šçš„ gitignore** ã€‚
ä½ æƒ³è®© Git å¿½ç•¥çš„ä»»ä½•ä¸œè¥¿éƒ½å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåŸºæœ¬ç‰ˆæœ¬:

```
# Deployment directories
node_modules
dist
# Optional npm cache directory
.npm
# Mac
.DS_Store 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ğŸºè¿™å°±ç»“æŸäº†è®¾ç½®ã€‚è¿™ä¸ªé¡¹ç›®å¯ä»¥ä½œä¸ºä»»ä½•æœªæ¥ React w/ server åº”ç”¨ç¨‹åºç”šè‡³ç‹¬ç«‹ Express é¡¹ç›®çš„æ ·æ¿ã€‚

ğŸ‘ğŸ¼æ„Ÿè°¢ä½ ä¸€è·¯çœ‹å®Œè¿™ç¯‡é•¿æ–‡ã€‚ç”¨ Webpack å’Œ Babel å’Œ Express è®¾ç½®ä¸€ä¸ªæ— é”™è¯¯çš„ Node app ç»å¯¹ä¸æ˜¯ä¸€ä»¶è½»è€Œæ˜“ä¸¾çš„äº‹æƒ…ã€‚ä½†å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚

ğŸŒåŠ æ²¹æ˜Ÿçƒï¼