# ç”¨ SQLAlchemy å®ç° ORM æ•°æ®æ¨¡å‹

> åŸæ–‡:[https://dev . to/hackersandslackers/implement-ORM-data-models-with-sqlalchemy-3lp 3](https://dev.to/hackersandslackers/implement-orm-data-models-with-sqlalchemy-3lp3)

[![Implement ORM Data Models with SQLAlchemy](../Images/913721ee46dbd51ee6ac5efcebe795f5.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--HdDGAii0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://hackersandslackers-cdn.storage.googleapis.com/2021/01/sqlalchemy-models.jpg)

åˆ©ç”¨ ORMs ä½œä¸ºæ•°æ®å±‚æ˜¯ä¸€ä¸ªå’Œé¢å‘å¯¹è±¡ç¼–ç¨‹æœ¬èº«ä¸€æ ·å¤è€çš„æ¦‚å¿µï¼›é€šè¿‡æŠ½è±¡ SQL æ¦‚å¿µï¼Œå¼€å‘äººå‘˜é€šè¿‡ä¿®æ”¹å¯¹è±¡è€Œä¸æ˜¯æŸ¥è¯¢æ¥é¿å…å¯æ€•çš„â€œä¸Šä¸‹æ–‡åˆ‡æ¢â€ã€‚ORM ä¸ä»…ä»…æ˜¯è¿‡åº¦çƒ­æƒ…çš„ OOP æ—¶ä»£æ…¢æ…¢æ¶ˆå¤±çš„äº§ç‰©ï¼›å®ƒä»¬é€šè¿‡ç¡®ä¿åº”ç”¨ç¨‹åºç«¯çš„æ•°æ®å®Œæ•´æ€§æ¥ä¿è¯ä¸€å®šç¨‹åº¦çš„æŒä¹…æ€§ï¼Œä»è€Œæœ€å°åŒ–ç¾éš¾æ€§ SQL æŸ¥è¯¢çš„å¯èƒ½æ€§ã€‚

ORM å…è®¸å¼€å‘äººå‘˜é€šè¿‡ä¿®æ”¹ä»£ç ä¸­çš„å¯¹è±¡(æ•°æ®ç±»)æ¥å¤„ç†æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹æ•°æ®åº“æ‰§è¡Œ SQL æŸ¥è¯¢ã€‚è¿™ç§å·¥ä½œæµä¸ºé¢å‘ç”¨æˆ·çš„åº”ç”¨ç¨‹åºå¸¦æ¥äº†å›æŠ¥ï¼Œè¿™äº›åº”ç”¨ç¨‹åºå®šæœŸéªŒè¯å’Œä¿®æ”¹æ•°æ®(æ¯”å¦‚éªŒè¯ç”¨æˆ·èº«ä»½ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ã€å‘å¸ƒå†…å®¹ç­‰)ã€‚).ORMs é€šè¿‡æä¾›ä¸€ä¸ªæ¥å£æ¥å¤„ç†é¢‘ç¹ä¸”å¯é¢„æµ‹çš„æ“ä½œè€Œå¤§æ”¾å¼‚å½©ï¼›è¿™å¯¹*åº”ç”¨å¼€å‘*æ¥è¯´æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä½†æ˜¯å¯¹äºä»»ä½•æ¶‰åŠ*æ•°æ®åˆ†æ*çš„äº‹æƒ…æ¥è¯´è‚¯å®šæ˜¯ä¸ªè´Ÿæ‹…ã€‚

## [](#creating-a-model)åˆ›å»ºæ¨¡å‹

æ•°æ®æ¨¡å‹æ˜¯è¡¨ç¤ºæ•°æ®åº“ä¸­ SQL è¡¨çš„ Python ç±»ï¼Œå…¶ä¸­æ¨¡å‹çš„å±æ€§è½¬åŒ–ä¸ºè¡¨ä¸­çš„åˆ—ã€‚

å½“ä½¿ç”¨ ORM æ—¶ï¼Œåˆ›å»ºæˆ‘ä»¬çš„**æ¨¡å‹**çš„**å®ä¾‹**è½¬åŒ–ä¸ºåœ¨ SQL **è¡¨**ä¸­åˆ›å»º**è¡Œ**ã€‚è‡ªç„¶ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦åœ¨ç¼–å†™ä»»ä½•æœ‰æ„ä¹‰çš„ä¸šåŠ¡é€»è¾‘ä¹‹å‰å®šä¹‰æˆ‘ä»¬çš„æ¨¡å‹ã€‚

æˆ‘ä»¬é€šè¿‡å®šä¹‰ Python ç±»æ¥åˆ›å»ºæ¨¡å‹ï¼Œè¿™äº› Python ç±»ä» SQLAlchemy æ‰©å±•äº†ä¸€ä¸ªå«åš`declarative_base()`çš„ä¸œè¥¿ã€‚æˆ‘ä»¬è¿™æ ·å®šä¹‰ä¸€ä¸ªæ¨¡å‹â€œåŸºç¡€â€å¯¹è±¡:

<figure>

```
"""SQLAlchemy Data Models."""
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

<figcaption>models.py</figcaption>

</figure>

ç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰©å±•`Base`æ¥åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¨¡å‹ã€‚æŒ‰ç…§ä¼ ç»Ÿï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¨¡å‹å°†æ˜¯ä¸€ä¸ªæ°å½“åœ°å‘½åä¸º**ç”¨æˆ·**çš„ç”¨æˆ·è´¦æˆ·æ¨¡å‹ã€‚æˆ‘ä»¬ä»ç®€å•çš„å¼€å§‹:

<figure>

```
"""SQLAlchemy Data Models."""
from sqlalchemy import Column
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.types import Integer, Text, String

Base = declarative_base()

class User(Base):
    """User account."""

    __tablename__ = "user"

    id = Column(
        Integer,
        primary_key=True,
        autoincrement="auto"
    )
    username = Column(
        String(255),
        unique=True,
        nullable=False
    )
    password = Column(
        Text,
        nullable=False
    ) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

<figcaption>models.py</figcaption>

</figure>

è™½ç„¶å®ƒå¯èƒ½æ˜¯ä¸€ä¸ªå‡†ç³»ç»Ÿï¼Œä½†ä¸Šé¢çš„ Python ç±»æ˜¯ä¸€ä¸ªå®Œå…¨æœ‰æ•ˆçš„æ•°æ®æ¨¡å‹ï¼Œå®ƒå°†äº§ç”Ÿä¸€ä¸ªåŒ…å«ä¸‰åˆ—(æ¯ä¸ªå±æ€§ä¸€åˆ—)çš„è¡¨: **id** ã€**ç”¨æˆ·å**å’Œ**å¯†ç **ã€‚æ¯ä¸ªå±æ€§éƒ½æœ‰ç±»å‹`Column()`ï¼Œè¿™æ˜¯ SQLAlchemy ç‰¹æœ‰çš„æ•°æ®ç»“æ„(å› æ­¤æˆ‘ä»¬åŒ…å«äº†`from sqlalchemy import Column`)ã€‚

æˆ‘ä»¬è¿˜å¯¼å…¥äº†ä¸‰ä¸ª SQLAlchemyâ€œç±»å‹â€ï¼Œæˆ‘ä»¬çœ‹åˆ°å®ƒä»¬è¢«ä¼ é€’ç»™äº†æ¯ä¸ª`Column`ã€‚æ¯ä¸ª**ç±»å‹**å¯¹åº”ä¸€ä¸ª SQL æ•°æ®ç±»å‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ SQL è¡¨åˆ—çš„æ•°æ®ç±»å‹å°†åˆ†åˆ«æ˜¯**æ•´æ•°**ã€ **varchar(255)** å’Œ**æ–‡æœ¬ã€**ã€‚

è¿˜å¯ä»¥æ¥å—å¯é€‰å‚æ•°ï¼Œå¦‚é”®æˆ–åˆ—çº¦æŸ:

*   **primary_key** :å°†ä¸€åˆ—æŒ‡å®šä¸ºè¡¨çš„â€œä¸»é”®â€ï¼Œè¿™æ˜¯ä¸€ç§å¼ºçƒˆæ¨èçš„åšæ³•ï¼Œæ—¢å¯ä»¥ä½œä¸ºæƒŸä¸€æ ‡è¯†ç¬¦ï¼Œä¹Ÿå¯ä»¥ä½œä¸º SQL æœç´¢çš„ç´¢å¼•ã€‚
*   **è‡ªåŠ¨å¢é‡**:ä»…ä¸æ—¢`primary_key`åˆæœ‰ç±»å‹`Integer`çš„åˆ—ç›¸å…³ã€‚æˆ‘ä»¬åˆ›å»ºçš„æ¯ä¸ªç”¨æˆ·éƒ½ä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ª idï¼Œå…¶ä¸­æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç”¨æˆ·ä¼šæœ‰ä¸€ä¸ª id**1**ï¼Œéšåçš„ç”¨æˆ·ä¼šç›¸åº”å¢åŠ ã€‚
*   **unique** :åœ¨ç»™å®šçš„åˆ—ä¸­ï¼Œæ²¡æœ‰ä»»ä½•ä¸¤ä¸ªè®°å½•/è¡Œå…±äº«ç›¸åŒçš„å€¼(æˆ‘ä»¬ä¸å¸Œæœ›ä¸¤ä¸ªç”¨æˆ·æœ‰ç›¸åŒçš„ç”¨æˆ·å)çš„æƒ…å†µä¸‹è®¾ç½®çº¦æŸã€‚
*   **å¯ç©ºçš„**:å½“è®¾ç½®ä¸º`True`æ—¶ï¼Œæ·»åŠ ä¸€ä¸ªçº¦æŸï¼Œè¯¥åˆ—æ˜¯å¼ºåˆ¶çš„ï¼Œé™¤éæä¾›ä¸€ä¸ªå€¼ï¼Œå¦åˆ™ä¸ä¼šåˆ›å»ºä»»ä½•è¡Œã€‚
*   **key** :åœ¨ç»™å®šçš„åˆ—ä¸Šæ”¾ç½®ä¸€ä¸ªè¾…é”®ï¼Œé€šå¸¸ä¸å¦ä¸€ä¸ªçº¦æŸ(å¦‚â€œindexâ€)ä¸€èµ·ä½¿ç”¨ã€‚
*   **index** :æŒ‡å®šä¸ºäº†æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œåˆ—çš„å€¼å¯ä»¥ä»¥éä»»æ„çš„æ–¹å¼æ’åº
*   **server_default** :å¦‚æœæ²¡æœ‰æ˜¾å¼ä¼ é€’å€¼ï¼Œåˆ™æŒ‡å®šé»˜è®¤å€¼ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®å¯é€‰å±æ€§`__tablename__`æ¥æ˜ç¡®æŒ‡å®šåº”è¯¥å‘½åå“ªä¸ªæ¨¡å‹çš„å¯¹åº” SQL è¡¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼ŒSQL å°†ä½¿ç”¨ç±»åæ¥åˆ›å»ºè¡¨ã€‚

æœ‰äº†è¿™äº›çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ„å»ºæˆ‘ä»¬çš„æ¨¡å‹:

<figure>

```
...
from sqlalchemy.types import Integer, Text, String, DateTime
from sqlalchemy.sql import func

class User(Base):
    """User account."""

    __tablename__ = "user"

    id = Column(
        Integer,
        primary_key=True,
        autoincrement="auto"
    )
    username = Column(
        String(255),
        unique=True,
        nullable=False
    )
    password = Column(
        Text,
        nullable=False
    )
    email = Column(
        String(255),
        unique=True,
        nullable=False
    )
    first_name = Column(String(255))
    last_name = Column(String(255))
    bio = Column(Text)
    avatar_url = Column(Text)
    created_at = Column(DateTime, server_default=func.now())
    updated_at = Column(DateTime, server_default=func.now())

    def __repr__ (self):
        return "<User %r>" % self.username 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

<figcaption>models.py</figcaption>

</figure>

ç°åœ¨é‚£æ˜¯ä¸€ä¸ªæ¨¡å‹ï¼æˆ‘ä»¬åœ¨æ¨¡å‹ä¸­æ·»åŠ äº†ä¸€äº›å±æ€§ï¼Œæ¯ä¸ªå±æ€§éƒ½æ˜¯ä¸è¨€è‡ªæ˜çš„ã€‚`created_at`å’Œ`updated_at`åˆ—æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ SQLAlchemy å‡½æ•°è‡ªåŠ¨åˆ†é…è¿™äº›å€¼ã€‚

ä¸ºäº†è®°å½•æˆ–è°ƒè¯•æˆ‘ä»¬çš„ç±»å®ä¾‹ï¼Œæœ€å¥½åœ¨æ•°æ®æ¨¡å‹(ä»¥åŠä¸€èˆ¬çš„ Python ç±»)ä¸Šè®¾ç½®`__repr__`çš„å€¼ã€‚å½“æˆ‘ä»¬`print()`ä¸€ä¸ª`User`çš„å®ä¾‹æ—¶ï¼Œ`__repr__`è¿”å›çš„å€¼å°±æ˜¯æˆ‘ä»¬å°†çœ‹åˆ°çš„ã€‚å¦‚æœä½ æ›¾ç»åœ¨ Javascript ä¸­å¤„ç†è¿‡`[object Object]`,ä½ å°±ä¼šçŸ¥é“è°ƒè¯•ä¸€ä¸ªå¯¹è±¡çš„å€¼å´å¾—ä¸åˆ°ä»»ä½•æœ‰ç”¨çš„å›æŠ¥æ˜¯å¤šä¹ˆä»¤äººè®¨åŒã€‚

æˆ‘ä»¬çš„æ¨¡å‹çœ‹èµ·æ¥ä¸é”™ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç”¨å®ƒåˆ›å»ºä¸€ä¸ª SQL è¡¨ã€‚åœ¨æˆ‘ä»¬çš„æ¨¡å‹è¢«åˆ›å»ºä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ä¸€ä¸ªåä¸º`create_tables()`çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹:

<figure>

```
Base.metadata.create_all(engine) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

<figcaption>Create SQL tables from classes which extend `Base`</figcaption>

</figure>

ä¸€æ—¦è¿è¡Œï¼ŒSQLAlchemy å°†å¤„ç†æ•°æ®åº“ç«¯çš„ä¸€åˆ‡ï¼Œåˆ›å»ºä¸€ä¸ªä¸æˆ‘ä»¬çš„æ¨¡å‹ç›¸åŒ¹é…çš„è¡¨ã€‚å¦‚æœä½ æ„Ÿåˆ°å¥½å¥‡ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„`User`æ¨¡å‹è¾“å‡ºçš„ç»“æœ:

```
CREATE TABLE "user" (
  "id" int NOT NULL AUTO_INCREMENT,
  "username" varchar(255) NOT NULL,
  "password" text NOT NULL,
  "email" varchar(255) NOT NULL,
  "first_name" varchar(255) DEFAULT NULL,
  "last_name" varchar(255) DEFAULT NULL,
  "bio" text,
  "avatar_url" text,
  "last_seen" datetime DEFAULT NULL,
  "created_at" datetime DEFAULT CURRENT_TIMESTAMP,
  "updated_at" datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY ("id"),
  UNIQUE KEY "username" ("username"),
  UNIQUE KEY "email" ("email")
); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#creating-a-session)åˆ›å»ºä¼šè¯

ä¼šè¯æ˜¯ä¸€ä¸ªæŒä¹…çš„æ•°æ®åº“è¿æ¥ï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°æ·»åŠ ã€åˆ é™¤ã€æ›´æ”¹ç”šè‡³æ’¤æ¶ˆæ›´æ”¹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨åˆšåˆšåˆ›å»ºçš„`User`æ¨¡å‹é€šè¿‡æ•°æ®åº“ä¼šè¯åˆ›å»ºæ–°ç”¨æˆ·ã€‚

ä¼šè¯æ˜¯é€šè¿‡å°†å®ƒä»¬ç»‘å®šåˆ° SQLAlchemy å¼•æ“æ¥åˆ›å»ºçš„ï¼Œæˆ‘ä»¬åœ¨æœ¬ç³»åˆ—çš„ç¬¬ 1 éƒ¨åˆ†ä¸­è®¨è®ºè¿‡ã€‚åˆ›å»ºäº†å¼•æ“ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ SQLAlchemy çš„`sessionmaker`æ¥å®šä¹‰ä¸€ä¸ªä¼šè¯ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°æˆ‘ä»¬çš„å¼•æ“:

<figure>

```
"""Database engine & session creation."""
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker

engine = create_engine(
    'mysql+pymysql://user:password@host:3600/database',
    echo=True
)
Session = sessionmaker(bind=engine)
session = Session() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

<figcaption>database.py</figcaption>

</figure>

è¿™å°±å¤Ÿäº†ï¼æˆ‘ä»¬å°†ä½¿ç”¨`session`å’Œæˆ‘ä»¬çš„`User`æ¨¡å‹æ¥åˆ›å»ºä¸€äº›ç”¨æˆ·ã€‚

## [](#creating-records-with-models-amp-sessions)ç”¨æ¨¡å‹åˆ›å»ºè®°å½•&ä¼šè¯

æœ‰äº†å®šä¹‰çš„æ¨¡å‹å’Œåˆ›å»ºçš„ä¼šè¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œå…¨ç”¨ Python æ·»åŠ å’Œä¿®æ”¹æ•°æ®äº†ã€‚SQLAlchemy ç§°ä¹‹ä¸º**åŸºäºå‡½æ•°çš„æŸ¥è¯¢æ„é€ **ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä»æˆ‘ä»¬çš„`User`ç±»:
ä¸­åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·

<figure>

```
from models import User
from database import session

user = User(
    username="admin",
    password="Please don't set passwords like this",
    email="admin@example.com",
    first_name="Todd",
    last_name="Birchard",
    bio="I write tutorials on the internet.",
    avatar_url="https://example.com/avatar.jpg"
)

session.add(user) # Add the user session.commit() # Commit the change 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

<figcaption>Adding a new user via a session</figcaption>

</figure>

åˆ›å»ºäº†ä¸€ä¸ª`User`çš„å®ä¾‹å¹¶ä¿å­˜ä¸ºå˜é‡`new_user`ï¼Œåœ¨æˆ‘ä»¬çš„æ•°æ®åº“ä¸­åˆ›å»ºè¿™ä¸ªç”¨æˆ·åªéœ€è°ƒç”¨ä¸¤æ¬¡æˆ‘ä»¬çš„ä¼šè¯:`add()`å°†é¡¹ç›®æ’é˜Ÿç­‰å¾…åˆ›å»ºï¼Œ`commit()`ä¿å­˜æ›´æ”¹ã€‚æˆ‘ä»¬ç°åœ¨åº”è¯¥åœ¨æ•°æ®åº“çš„**ç”¨æˆ·**è¡¨ä¸­çœ‹åˆ°ä¸€è¡Œï¼

ä½¿ç”¨`session`å°±åƒå››ç§ç®€å•çš„æ–¹æ³•ä¸€æ ·ç®€å•:

*   `session.add()`:æˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªæ•°æ®æ¨¡å‹çš„å®ä¾‹ä¼ é€’åˆ°`add()`ä¸­ï¼Œä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæ–°è®°å½•ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°æˆ‘ä»¬çš„æ•°æ®åº“ä¸­ã€‚
*   `session.delete()`:å’Œä¸Šé¢ä¸€æ ·ï¼Œ`delete()`æ¥å—ä¸€ä¸ªæ•°æ®æ¨¡å‹çš„å®ä¾‹ã€‚å¦‚æœè¯¥è®°å½•å­˜åœ¨äºæˆ‘ä»¬çš„æ•°æ®åº“ä¸­ï¼Œå®ƒå°†è¢«æš‚å­˜ä»¥ä¾¿åˆ é™¤ã€‚
*   `session.commit()`:åœ¨ä¼šè¯ä¸­æ‰€åšçš„æ›´æ”¹ç›´åˆ°æ˜¾å¼æäº¤åæ‰ä¼šä¿å­˜ã€‚
*   ä¸ SQLAlchemy å¼•æ“ä¸åŒï¼Œä¼šè¯æ˜¯åœ¨æ˜¾å¼å…³é—­ä¹‹å‰ä¸€ç›´ä¿æŒæ‰“å¼€çš„è¿æ¥ã€‚

åˆ é™¤è®°å½•çš„è¯­æ³•ä¸åˆ›å»ºè®°å½•çš„è¯­æ³•éå¸¸ç›¸ä¼¼ã€‚æœ‰äº†`user`å˜é‡ï¼Œåˆ é™¤æˆ‘ä»¬åˆ›å»ºçš„ç”¨æˆ·å°±åƒä¸‹é¢è¿™æ ·ç®€å•:

<figure>

```
...

session.delete(new_user)
session.commit() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

<figcaption>Delete a record</figcaption>

</figure>

åƒå˜é­”æœ¯ä¸€æ ·ï¼Œæˆ‘ä»¬é€šè¿‡ç®€å•åœ°å°†`new_user`ä¼ é€’åˆ° delete æ–¹æ³•ä¸­ï¼Œåˆ é™¤äº†ä¸æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„è®°å½•ç›¸åŒ¹é…çš„è®°å½•ã€‚ä¸è¦åªç›¸ä¿¡æˆ‘çš„è¯:è¿™ä¸ªè¿‡ç¨‹ä¸­æœ€ä»¤äººæ»¡æ„çš„éƒ¨åˆ†æ˜¯äº²çœ¼çœ‹ç€å®ƒå‘ç”Ÿï¼å°è¯•ä½¿ç”¨æ‚¨é€‰æ‹©çš„ GUI è¿æ¥åˆ°æ‚¨çš„æ•°æ®åº“ï¼Œå¹¶è§‚å¯Ÿæ‚¨è¿è¡Œçš„æ¯ä¸€è¡Œä»£ç åˆ›å»ºå’Œåˆ é™¤è®°å½•çš„æƒ…å†µã€‚æ•´æ´ï¼

## [](#wax-on-wax-off)ä¸Šèœ¡ï¼Œä¸‹èœ¡

åˆ›å»ºå’Œä¿®æ”¹è®°å½•åªæ˜¯æ‚¨ä½¿ç”¨ SQLAlchemy çš„ ORM ä¹‹æ—…çš„å¼€å§‹ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦èƒ½å¤Ÿè·å–æˆ‘ä»¬å·²ç»åˆ›å»ºçš„è®°å½•ï¼æˆ‘ä»¬å°†åœ¨ç¬¬ 3 éƒ¨åˆ†è®¨è®ºé€šè¿‡æ•°æ®æ¨¡å‹è·å–è¡Œçš„ä¹è¶£ï¼Œæ‰€ä»¥ä¸è¦ç¢°é‚£ä¸ªæ‹¨å·ç›˜ï¼

æ— è®ºå¦‚ä½•ï¼Œä½ å¯ä»¥ä»ä¸‹é¢çš„ Github ä¸­è·å–æœ¬æ•™ç¨‹çš„å·¥ä½œæºä»£ç ã€‚æœ¬ç³»åˆ—æ¯ä¸€ç« çš„æºä»£ç å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°:

## ![GitHub logo](../Images/75095a8afc1e0f207cda715962e75c8d.png)/[sqlalchemy-tutorial](https://github.com/hackersandslackers/sqlalchemy-tutorial)

### ğŸ§ªğŸ”¬ä½¿ç”¨ SQLAlchemy è¿æ¥ã€æŸ¥è¯¢å…³ç³»æ•°æ®åº“å¹¶ä¸ä¹‹äº¤äº’ã€‚

<article class="markdown-body entry-content container-lg" itemprop="text">

# SQLAlchemy æ•™ç¨‹

[![Python](../Images/91eac0264bc3c2568bdd56361da1d1ae.png)](https://camo.githubusercontent.com/0b153563dd844ea8bbae9bf9d219c0d9930aa35e7d2ed0e07638a2caa3745902/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f507974686f6e2d76253545332e382d626c75652e7376673f6c6f676f3d707974686f6e266c6f6e6743616368653d74727565266c6f676f436f6c6f723d776869746526636f6c6f72423d356538316163267374796c653d666c61742d73717561726526636f6c6f72413d346335363661)[![SQLAlchemy](../Images/1723cabc44962dff2d2950b3c1d95405.png)](https://camo.githubusercontent.com/424e1a71c7e887f61c0f663ed11eab714a5dc2f4b93862cfd20eeab74517b58f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f53514c416c6368656d792d76253545312e342e302d626c75652e7376673f6c6f6e6743616368653d74727565266c6f676f3d707974686f6e267374796c653d666c61742d737175617265266c6f676f436f6c6f723d776869746526636f6c6f72423d35653831616326636f6c6f72413d346335363661)[![PyMySQL](../Images/3feff7a175a540e1c892ce78f090ce77.png)](https://camo.githubusercontent.com/fdebcbd844cbae276b85296fea82e5730245a6f89610e81fa3b540a01ea62e19/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f50794d7953514c2d76253545312e302e302d7265642e7376673f6c6f6e6743616368653d74727565267374796c653d666c61742d737175617265266c6f676f3d7363616c61266c6f676f436f6c6f723d776869746526636f6c6f72413d34633536366126636f6c6f72423d626636313661)[![GitHub Last Commit](../Images/ce450f99c39c42faeca9f81fb73c2c1d.png)](https://camo.githubusercontent.com/556bded58c9998ff95a5c6abd94d070c459b92b20b2a0977dc3a2f94af805fbe/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6173742d636f6d6d69742f676f6f676c652f736b69612e7376673f7374796c653d666c61742d73717561726526636f6c6f72413d34633536366126636f6c6f72423d613362653863266c6f676f3d476974487562)[![GitHub Issues](../Images/b51c92f47428b4e575d45f7be4c1e2e1.png)](https://github.com/hackersandslackers/sqlalchemy-tutorial/issues)[![GitHub Stars](../Images/8df379b96bf69df566c3607586fcb4f3.png)](https://github.com/hackersandslackers/sqlalchemy-tutorial/stargazers)[![GitHub Forks](../Images/d8103d43bdbf0b4b95b37afb2ff84af6.png)](https://github.com/hackersandslackers/sqlalchemy-tutorial/network)

[![SQLAlchemy Tutorial](../Images/18eb72b96df491820eb93712bdc663e3.png)T2ã€‘](https://github.com/hackersandslackers/sqlalchemy-tutorial/blob/master/.github/sqlalchemy@2x.jpg?raw=true)

è¿™ä¸ªå­˜å‚¨åº“åŒ…å«å…³äº SQLAlchemy çš„å››éƒ¨åˆ†æ•™ç¨‹ç³»åˆ—çš„æºä»£ç :

1.  [ä½¿ç”¨ SQLAlchemy ç®€åŒ– Python ä¸­çš„æ•°æ®åº“](https://hackersandslackers.com/python-database-management-sqlalchemy)
2.  ç”¨ SQLAlchemy å®ç°ä¸€ä¸ª ORM
3.  [SQLAlchemy æ•°æ®æ¨¡å‹ä¸­çš„å…³ç³»](https://hackersandslackers.com/sqlalchemy-data-models)
4.  [ç”¨ SQLAlchemy æ„å»ºæ•°æ®åº“æŸ¥è¯¢](https://hackersandslackers.com/database-queries-sqlalchemy-orm)

# å…¥é—¨æŒ‡å—

åˆ†ä¸¤æ­¥åœ¨æœ¬åœ°è¿›è¡Œè®¾ç½®:

### ç¯å¢ƒå˜é‡

ç”¨æ‚¨çš„å€¼æ›¿æ¢ **.env.example** ä¸­çš„å€¼ï¼Œå¹¶å°†è¯¥æ–‡ä»¶é‡å‘½åä¸º**ã€‚ç¯å¢ƒ**:

*   `SQLALCHEMY_DATABASE_URI`:SQL æ•°æ®åº“çš„è¿æ¥ URIã€‚
*   `SQLALCHEMY_DATABASE_PEM` *ã€å¯é€‰ã€‘*:éœ€è¦ SSL è¿æ¥çš„æ•°æ®åº“çš„ PEM å¯†é’¥ã€‚

è®°ä½æ°¸è¿œä¸è¦æäº¤ä¿å­˜åœ¨ã€‚Github çš„ env æ–‡ä»¶ã€‚

### è£…ç½®

ä½¿ç”¨`make deploy`å¼€å§‹è¿è¡Œ:

```
$ git clone https://github.com/hackersandslackers/sqlalchemy-tutorial.git
$ cd sqlalchemy-tutorial
$ make deploy
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

* * *

**é»‘å®¢å’Œæ‡’é¬¼**æ•™ç¨‹å…è´¹ã€‚å¦‚æœä½ è§‰å¾—è¿™ä¸ªæ•™ç¨‹æœ‰å¸®åŠ©ï¼Œä¸€ä¸ª[çš„å°é¢æèµ ](https://www.buymeacoffee.com/hackersslackers)å°†ä¼šéå¸¸æ„Ÿè°¢ï¼Œè®©æˆ‘ä»¬ç»§ç»­åšç”Ÿæ„ã€‚æ‰€æœ‰çš„æ”¶ç›Šéƒ½æµå‘äº†å’–å•¡ï¼Œæ‰€æœ‰çš„å’–å•¡éƒ½æµå‘äº†æ›´å¤šçš„å†…å®¹ã€‚

</article>

[View on GitHub](https://github.com/hackersandslackers/sqlalchemy-tutorial)