# TIL: Package.json å€¼å¯ä»¥åœ¨ npm/yarn è„šæœ¬ä¸­è®¿é—®

> åŸæ–‡:[https://dev . to/stefanjudis/til-package-JSON-values-are-access-in-NPM-yarn-scripts-193 l](https://dev.to/stefanjudis/til-package-json-values-are-accessible-in-npm-yarn-scripts-193l)

æˆ‘å¶ç„¶çœ‹åˆ°[æ°æ–¯Â·ç‰¹å°”ç¦å¾·](https://twitter.com/JessTelford/status/1108531278846918657)å‘çš„è¿™æ¡æ¨æ–‡ã€‚ä»–åˆ†äº«è¯´ä½ å¯ä»¥åœ¨ä½ çš„ npm/yarn è„šæœ¬ä¸­å¼•ç”¨ä½ çš„`package.json`ä¸­å®šä¹‰çš„å€¼ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ã€‚

```
{  "name":  "my-package",  "scripts":  {  "lint":  "eslint ./src/*",  "test":  "jest ./src/*"  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ æ‰€çœ‹åˆ°çš„æ˜¯åœ¨ä¸¤ä¸ªä¸åŒçš„è„šæœ¬ä¸­å¯¹`./src/*`çš„é‡å¤å®šä¹‰ã€‚å¯¹äºè¿™ä¸¤ä¸ªè„šæœ¬æ¥è¯´ï¼Œé‡å¤å¯èƒ½æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œä½†æ˜¯åœ¨è¾ƒå¤§çš„é¡¹ç›®ä¸­ï¼Œå¯èƒ½ä¼šå›°éš¾å¾—å¤šã€‚æˆ‘ä»äº‹çš„é¡¹ç›®å®šä¹‰äº†éå¸¸å¤æ‚çš„éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤çš„è„šæœ¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¸Œæœ›é¿å…ä»»ä½•é‡å¤ã€‚

[npm](https://docs.npmjs.com/misc/scripts#packagejson-vars) å’Œ yarn æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨`package.json`çš„`scripts`éƒ¨åˆ†ä¸­ï¼Œæ‚¨å¯ä»¥å¼•ç”¨æ‰€æœ‰å·²å®šä¹‰çš„å€¼ã€‚ä¾‹å¦‚ï¼Œ`name`å±æ€§åœ¨`npm_package_name`å¯ç”¨ã€‚è¿™ç§è¡Œä¸ºå…è®¸æ‚¨é‡ç”¨å€¼ã€‚ğŸ‰

```
{  "name":  "my-package",  "config":  {  "src":  "./src/*"  },  "scripts":  {  "lint":  "eslint $npm_package_config_src",  "test":  "jest $npm_package_config_src"  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘è®¤ä¸ºè¿™æ˜¯éå¸¸å¥½çš„ npm/yarnï¼Œå€¼å¾—äº†è§£ã€‚

## [](#i-released-a-package-to-read-raw-packagejson-endraw-values-from-the-environment-too)æˆ‘ä¹Ÿå‘å¸ƒäº†ä¸€ä¸ªä»ç¯å¢ƒä¸­è¯»å–`package.json`å€¼çš„åŒ…ï¼

æˆ‘ç»§ç»­é˜…è¯»å…³äºè¿™ä¸€å‘ç°çš„ Twitter å¸–å­ï¼Œ [Jordon Harband é—®äº†å‡ ä¸ªé—®é¢˜](https://twitter.com/ljharb/status/1108590777930665984)åœ¨ Node.js æ–‡ä»¶ä¸­ä½¿ç”¨ç›¸åŒçš„è¡Œä¸ºæ˜¯å¦æœ‰æ„ä¹‰ã€‚æˆ‘ç”¨ [npm-package-to-env](https://www.npmjs.com/package/npm-package-to-env) è¿›è¡Œäº†ä¸€ä¸ªå¿«é€Ÿçš„å¤œé—´ç¼–ç ä¼šè®®ï¼Œä½¿ä¹‹æˆä¸ºå¯èƒ½ã€‚

å‡è®¾ä½ æœ‰ä¸€ä¸ª`package.json`å¦‚ä¸‹:

```
{  "name":  "my-package",  "config":  {  "foo":  "bar"  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åï¼Œæ‚¨å¯ä»¥è¯·æ±‚`npm-package-to-env`ï¼Œè¿è¡Œ`config`ï¼Œå¹¶é€šè¿‡`process.env`è®¿é—®è¿™äº›å€¼ã€‚

```
require('npm-package-to-env').config();

console.log(process.env.npm_package_name); // 'my-package'
console.log(process.env.npm_package_config_foo); // 'bar' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`config`å‘½ä»¤è¯»å‡ºæ‚¨çš„`package.json`ï¼Œå¹¶é€šè¿‡`process.env`ä½¿æ•°æ®å¯ç”¨ã€‚ä¹Ÿè®¸ä½ ä¹Ÿè§‰å¾—é‚£å¾ˆæœ‰ç”¨ã€‚:)