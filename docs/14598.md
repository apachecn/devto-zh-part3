# ä¸€ä¸ªåˆ›å»ºæ–°çš„ç›–èŒ¨æ¯”åšå®¢å¸–å­çš„æ–¹ä¾¿çš„ npm è„šæœ¬

> åŸæ–‡:[https://dev . to/jhooks/a-handy-NPM-script-for-creating-a-new-Gatsby-blog-post-5bn 8](https://dev.to/jhooks/a-handy-npm-script-for-creating-a-new-gatsby-blog-post-5bn8)

[æˆ‘çš„åšå®¢](https://joelhooks.com)æ˜¯ç”¨ Gatsby æ„å»ºçš„ï¼Œæ–‡ç« å†…å®¹ä½¿ç”¨ MDXã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„è®¾ç½®ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘éå¸¸å–œæ¬¢ä½¿ç”¨å®ƒã€‚

æˆ‘åœ¨æ—§çš„ Octopress/Jekyll é…ç½®ä¸­é”™è¿‡çš„ä¸€ä»¶äº‹æ˜¯è¿è¡Œ rake ä»»åŠ¡æ¥åˆ›å»ºä¸€ä¸ªæ–°å¸–å­çš„èƒ½åŠ›ï¼Œå…¶ä¸­å¡«å……äº†æ‰€æœ‰åŸºæœ¬çš„å¿…éœ€ frontmatter å…ƒæ•°æ®ã€‚

```
---
slug: a-handy-npm-script-for-creating-a-new-gatsby-blog-post~M3MyBb6Fd
guid: M3MyBb6Fd
date: 2019-01-30
title: 'A  handy  npm  script  for  creating  a  new  Gatsby  blog  post'
published: false
--- 
```

è¿™æ˜¯è¿™ç¯‡æ–‡ç« çš„é™ä»·å…ƒçš„ä¸€ä¸ªä¾‹å­ã€‚Gatsby åœ¨æ„å»ºç½‘ç«™æ—¶ä½¿ç”¨è¿™ä¸ª frontmatter æ¥åˆ›å»ºç›¸åº”çš„é¡µé¢ã€‚

æ¯æ¬¡éƒ½è¦æ‰‹åŠ¨è¾“å…¥ï¼Œè¿™æœ‰ç‚¹è®©äººå¤´ç–¼ï¼Œæ‰€ä»¥æˆ‘å†³å®šé€šè¿‡ä»£ç çš„åŠ›é‡æ¥è§£å†³æˆ‘çš„æŒ«è´¥æ„Ÿã€‚

```
$ npm run newPost "This is the title of my blogpost" 
```

è¿™æ˜¯æˆ‘å¸Œæœ›èƒ½å¤Ÿä»ç»ˆç«¯å‘½ä»¤è¡Œè¿è¡Œçš„å‘½ä»¤çš„åŸºæœ¬ç»“æ„ã€‚ä¸€æ—¦æ‰§è¡Œäº†è¿™ä¸ªæ“ä½œï¼Œå°±åº”è¯¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹å¹¶æ­£ç¡®å‘½åã€‚æ–‡ä»¶å¤¹é‡Œä¼šæœ‰ä¸€ä¸ª`index.mdx`æ–‡ä»¶ï¼Œé‡Œé¢æœ‰æ‰€æœ‰åŸºæœ¬/å¿…éœ€çš„ frontmatterï¼Œæˆ‘éœ€è¦åšçš„å°±æ˜¯è·³è¿›å»å†™è¿™ç¯‡æ–‡ç« ã€‚

```
/content
  - blog
    -- 2019-01-30-a-handy-npm-script-for-creating-a-new-gatsby-blog-post
      --- index.mdx 
```

è¿™æ˜¯è¿è¡Œè„šæœ¬åæˆ‘çš„è®¾ç½®çš„ç»“æœã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹éœ€è¦å‘ç”Ÿä»€ä¹ˆï¼Œæ¥çœ‹çœ‹æˆ‘æ˜¯å¦‚ä½•æ„å»ºå®ƒçš„ã€‚

1.  æ‰§è¡Œå¸¦æœ‰å‚æ•°çš„èŠ‚ç‚¹è„šæœ¬
2.  è§£æå‚æ•°
3.  æå–æ ‡é¢˜
4.  â€œslugifyâ€æ–‡ä»¶åå’Œ url ä¸­ä½¿ç”¨çš„æ ‡é¢˜
5.  æ•è·å½“å‰æ—¥æœŸ
6.  å°†æ–‡ä»¶å†™å…¥ç£ç›˜

æˆ‘åšäº†ä¸€ä¸ªåä¸º`scripts`çš„å­æ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢åˆ›å»ºäº†`newPost.js`ã€‚

ä¸ºäº†è·å¾—å‘½ä»¤è¡Œå‚æ•°ï¼Œæˆ‘ä»¬éœ€è¦è®¿é—® node ä¸­çš„`process.argv`ã€‚`newPost.js`çš„å†…å®¹æ˜¯è¿™æ ·çš„:

```
console.log(process.argv) 
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥çœ‹çœ‹`process.argv`åŒ…å«äº†ä»€ä¹ˆ:

```
node ./scripts/newPost.js "this is my test post" 
```

å‡è®¾æ²¡æœ‰é”™è¯¯ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„æ•°ç»„:

```
;[
  '/Users/joel/.nodenv/versions/10.6.0/bin/node',
  '/Users/joel/Code/joelhooks-com/test.js',
  'this is my test post',
] 
```

`process.argv`çš„å†…å®¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ­£åœ¨ä½¿ç”¨çš„å¯æ‰§è¡ŒèŠ‚ç‚¹çš„ä½ç½®ã€æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬çš„ä½ç½®ï¼Œä»¥åŠæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨æ›´å¤šçš„å‚æ•°å†è¯•ä¸€æ¬¡:

```
node ./scripts/newPost.js "this is my test post" 1 "gopher" 
```

ä½ ä¼šçœ‹åˆ°å®ƒåªæ˜¯ç®€å•åœ°æ·»åŠ åˆ°æ•°ç»„:

```
;[
  '/Users/joel/.nodenv/versions/10.6.0/bin/node',
  '/Users/joel/Code/joelhooks-com/test.js',
  'this is my test post',
  '1',
  'gopher',
] 
```

æˆ‘ä»¬å¸Œæœ›ç¡®ä¿æˆ‘ä»¬å®é™…ä¸Šæœ‰ä¸€ä¸ªåç§°å¯ä»¥ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘å°†åœ¨æˆ‘çš„è„šæœ¬ä¸­ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ if/else ä¿æŠ¤æ¥è¿›è¡Œæ£€æŸ¥å’Œç¡®è®¤ã€‚

```
const title = process.argv[2]

if (!title) {
  throw 'a title is required!'
} 
```

ç°åœ¨è¯•ç€ä¸å¸¦åç§°å‚æ•°è¿è¡Œå®ƒã€‚å®ƒåº”è¯¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯å¹¶å´©æºƒã€‚

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªåå­—ï¼Œæˆ‘ä»¬æƒ³åˆ›é€ ä¸€ä¸ªâ€œçƒ¤è‚‰ä¸²æ¡ˆä»¶â€è›è“ã€‚Slugs åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½å¯èƒ½æœ‰ç‚¹æ£˜æ‰‹ï¼Œå› æ­¤ä¸ºæ­¤æˆ‘å°†ä½¿ç”¨ä¸€ä¸ªå°å‹åº“ã€‚`npm i slug`å°†å¾—åˆ°æˆ‘æ‰€éœ€è¦çš„:

```
const slugify = require('slug')

const title = process.argv[2]

if (!title) {
  throw 'a title is required!'
}

console.log(slugify(title)) 
```

è¿™å°†è¾“å‡º`This-is-the-title-of-my-blogpost`ï¼Œå®ƒå¾ˆæ¥è¿‘ï¼Œä½†æ˜¯é€šå¸¸ä¸€ä¸ª slug å°†å…¨éƒ¨å°å†™ï¼Œæ‰€ä»¥å®ƒçœ‹èµ·æ¥æ›´åƒè¿™æ ·:

```
const slugify = require('slug')

const title = process.argv[2]

if (!title) {
  throw 'a title is required!'
}

const slug = slugify(title.toLowerCase()) 
```

å‡ºäºæ’åºçš„ç›®çš„ï¼Œæˆ‘ä¹Ÿå–œæ¬¢åœ¨æ–‡ç« çš„æ–‡ä»¶å¤¹åä¸­æ·»åŠ æ—¥æœŸã€‚æˆ‘çš„ goto æ˜¯ä¸€ä¸ªå¾ˆå°çš„`date-fns`åº“ï¼Œå®ƒåœ¨ä¸€ä¸ªå¾ˆå°çš„åŒ…ä¸­æä¾›äº†ä½ æ‰€éœ€è¦çš„å¤§éƒ¨åˆ†æ—¥æœŸ/æ—¶é—´å·¥å…·ï¼Œå¹¶ä½¿ç”¨å®ƒ:

```
const slugify = require('slug')
const dateFns = require('date-fns')

const title = process.argv[2]

if (!title) {
  throw 'a title is required!'
}

const slug = slugify(title.toLowerCase())
const date = dateFns.format(new Date(), 'YYYY-MM-DD') 
```

æ‚¨å¯ä»¥æ‰‹åŠ¨æå–å’Œæ ¼å¼åŒ–æ—¥æœŸï¼Œä½†æ˜¯...è°æœ‰æ—¶é—´åšé‚£ä¸ªï¼Ÿï¼Ÿè¿™å¾ˆå¥½ï¼Œæˆ‘æœ‰äº†ç»„è£…å’Œè¾“å‡ºæ–‡ä»¶æ‰€éœ€çš„æ‰€æœ‰éƒ¨ä»¶ã€‚

é¦–å…ˆæˆ‘è¦åˆ›å»ºè·¯å¾„:

```
const slugify = require('slug')
const dateFns = require('date-fns')

const title = process.argv[2]

if (!title) {
  throw 'a title is required!'
}

const slug = slugify(title.toLowerCase())
const date = dateFns.format(new Date(), 'YYYY-MM-DD')
const dir = `./content/blog/${date}-${slug}` 
```

ç°åœ¨æˆ‘å¯ä»¥ä½¿ç”¨èŠ‚ç‚¹`fs`æˆ–è€…æ–‡ä»¶ç³»ç»Ÿæ¨¡å—æ¥åˆ›å»ºæ–‡ä»¶å¤¹:

```
const fs = require('fs')
const slugify = require('slug')
const dateFns = require('date-fns')

const title = process.argv[2]

if (!title) {
  throw 'a title is required!'
}

const slug = slugify(title.toLowerCase())
const date = dateFns.format(new Date(), 'YYYY-MM-DD')
const dir = `./content/blog/${date}-${slug}`

if (!fs.existsSync(dir)) {
  fs.mkdirSync(dir)
} else {
  throw 'That post already exists!'
} 
```

éœ€è¦ä½¿ç”¨ requireâ€œå¯¼å…¥â€`fs`æ¨¡å—ï¼Œç„¶åæˆ‘è¿˜åœ¨å¯¹`fs.mkdirSync(dir)`çš„è°ƒç”¨å‘¨å›´æ·»åŠ äº†ä¸€ä¸ª if/elseï¼Œä»¥ç¡®ä¿æˆ‘ä¸ä¼šè¦†ç›–ç°æœ‰çš„ postã€‚å®‰å…¨æ€»æ¯”åæ‚”å¥½ã€‚è¿è¡Œä¹‹åï¼Œæ‚¨ä¼šçœ‹åˆ°åˆ›å»ºäº†ä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`fs.writeFileSync`æ¥åˆ›å»ºå®é™…çš„æ–‡ä»¶æœ¬èº«:

```
const fs = require('fs')
const slugify = require('slug')
const dateFns = require('date-fns')

const title = process.argv[2]

if (!title) {
  throw 'a title is required!'
}

const slug = slugify(title.toLowerCase())
const date = dateFns.format(new Date(), 'YYYY-MM-DD')
const dir = `./content/blog/${date}-${slug}`

if (!fs.existsSync(dir)) {
  fs.mkdirSync(dir)
} else {
  throw 'That post already exists!'
}

fs.writeFileSync(
  `${dir}/index.mdx`,
  `---
slug: ${slug} date: ${date} title: "${title}"
published: false
---`,
  function(err) {
    if (err) {
      return console.log(err)
    }

    console.log(`${title} was created!`)
  },
) 
```

`fs.writeFileSync`éœ€è¦ä¸‰ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªæ˜¯è·¯å¾„æˆ–ç›®çš„åœ°ï¼Œç¬¬äºŒä¸ªæ˜¯æ–‡ä»¶å†…å®¹ã€‚ç”±äºè¿™æ˜¯ç°ä»£èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå‹¾å·è®¿é—®å­—ç¬¦ä¸²æ¨¡æ¿æ–‡å­—ã€‚è¿™ç‰¹åˆ«å¥½ï¼Œå› ä¸ºå®ƒä»¬å…è®¸æˆ‘ä»¬åˆ›å»ºç›¸å¯¹å¹²å‡€çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå°Šé‡ç©ºç™½ï¼Œä¸éœ€è¦ç‰¹æ®Šçš„æ¢è¡Œç¬¦ã€‚

æœ€åä¸€ä¸ªå‚æ•°æ˜¯æ“ä½œå®Œæˆæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚å¦‚æœæœ‰é”™è¯¯ï¼Œå®ƒä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œå¦‚æœæˆåŠŸï¼Œæˆ‘ä»¬è¿˜ä¼šæ”¶åˆ°ä¸€æ¡å‹å¥½çš„æ¶ˆæ¯ã€‚

è¿™æ ·ï¼Œæ‚¨ç°åœ¨å°±æœ‰äº†ä¸€ä¸ªæ–¹ä¾¿çš„è„šæœ¬æ¥ä¸ºæ‚¨çš„ Gatsby åº”ç”¨ç¨‹åºåˆ›å»ºæ–°çš„ markdown blogpostsã€‚

å› ä¸ºè¿™å®Œå…¨æ˜¯æˆ‘ä¸ªäººä½¿ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰èŠ±ä»»ä½•æ—¶é—´è®©å‘½ä»¤è¡Œå‚æ•° handline å˜å¾—å¥å£®ã€‚è¿™æ˜¯ä¸€ä¸ªä¸ºå•ä¸ªç”¨æˆ·æä¾›éå¸¸å…·ä½“çš„å•ä¸ªä»»åŠ¡çš„è„šæœ¬ã€‚è¿™æ„å‘³ç€å®ƒå¯èƒ½æœ‰ç‚¹å±é™©ï¼Œä¸ä¼šæœ‰ä»»ä½•è´Ÿé¢å½±å“ã€‚å†™è¿™ç¯‡æ–‡ç« èŠ±äº†å¤§çº¦ 10 åˆ†é’Ÿçš„æ—¶é—´ï¼Œè¿™å°†ä¸ºæˆ‘å°†æ¥çœå»è®¸å¤šæ— è°“çš„æ‰“å­—æ—¶é—´ã€‚

æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæ¶ˆé™¤äº†æˆ‘å†™åšå®¢ç»å†ä¸­çš„ä¸€ç‚¹æ‘©æ“¦/ç—›è‹¦ï¼Œè¿™æ„å‘³ç€æˆ‘å¯èƒ½ä¼šåšå¾—æ›´å¤šğŸ™‚