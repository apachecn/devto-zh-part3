# Javascript Array.push æ¯” Array.concat å¿« 945 å€ğŸ¤¯ğŸ¤”

> åŸæ–‡:[https://dev . to/uilicious/JavaScript-array-push-is-945 x-fast-than-array-concat-1 oki](https://dev.to/uilicious/javascript-array-push-is-945x-faster-than-array-concat-1oki)

# [](#tdlr)TDLR

å¦‚æœä½ è¦åˆå¹¶æœ‰æ•°åƒä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨`arr1.push(...arr2)`è€Œä¸æ˜¯`arr1 = arr1.concat(arr2)`æ¥èŠ‚çœæ—¶é—´ã€‚å¦‚æœä½ çœŸçš„æƒ³èµ°å¾—æ›´å¿«ï¼Œä½ ç”šè‡³å¯èƒ½æƒ³å†™è‡ªå·±çš„å®ç°æ¥åˆå¹¶æ•°ç»„ã€‚

# [](#wait-a-minute-how-long-does-it-take-to-merge-15000-arrays-with-raw-concat-endraw-)ç­‰ä¸€ä¸‹...ç”¨`.concat`åˆå¹¶ 15ï¼Œ000 ä¸ªæ•°ç»„éœ€è¦å¤šé•¿æ—¶é—´...

æœ€è¿‘ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç”¨æˆ·æŠ±æ€¨ä»–ä»¬åœ¨ [UI-licious](https://uilicious.com) ä¸Šçš„ UI æµ‹è¯•æ‰§è¡Œé€Ÿåº¦æ˜æ˜¾å˜æ…¢ã€‚æ¯ä¸ªé€šå¸¸éœ€è¦ 1 ç§’é’Ÿå®Œæˆçš„`I.click` `I.fill` `I.see`å‘½ä»¤(åå¤„ç†ï¼Œä¾‹å¦‚æˆªå›¾)ç°åœ¨éœ€è¦ 40 å¤šç§’æ‰èƒ½å®Œæˆï¼Œå› æ­¤é€šå¸¸åœ¨ 20 åˆ†é’Ÿå†…å®Œæˆçš„æµ‹è¯•å¥—ä»¶åè€Œéœ€è¦å‡ ä¸ªå°æ—¶ï¼Œè¿™ä¸¥é‡é™åˆ¶äº†ä»–ä»¬çš„éƒ¨ç½²æµç¨‹ã€‚

æˆ‘æ²¡èŠ±å¤šé•¿æ—¶é—´å°±è®¾ç½®äº†è®¡æ—¶å™¨æ¥ç¼©å°å¯¼è‡´é€Ÿåº¦å˜æ…¢çš„ä»£ç éƒ¨åˆ†ï¼Œä½†æ˜¯å½“æˆ‘å‘ç°ç½ªé­ç¥¸é¦–æ—¶ï¼Œæˆ‘æ„Ÿåˆ°éå¸¸æƒŠè®¶:

```
arr1 = arr1.concat(arr2) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ•°ç»„çš„`.concat`æ–¹æ³•ã€‚

ä¸ºäº†å…è®¸ä½¿ç”¨ç®€å•çš„å‘½ä»¤æ¥ç¼–å†™æµ‹è¯•ï¼Œå¦‚`I.click("Login")`è€Œä¸æ˜¯ CSS æˆ– XPATH é€‰æ‹©å™¨`I.click("#login-btn")`ï¼ŒUI-licious ä½¿ç”¨åŠ¨æ€ä»£ç åˆ†ææ¥åˆ†æ DOM æ ‘ï¼Œä»¥ç¡®å®šåŸºäºè¯­ä¹‰ã€å¯è®¿é—®æ€§å±æ€§å’Œæµè¡Œä½†éæ ‡å‡†çš„æ¨¡å¼æµ‹è¯•ä»€ä¹ˆä»¥åŠå¦‚ä½•æµ‹è¯•æ‚¨çš„ç½‘ç«™ã€‚`.concat`æ“ä½œè¢«ç”¨æ¥å±•å¹³ DOM æ ‘ä»¥è¿›è¡Œåˆ†æï¼Œä½†æ˜¯å½“ DOM æ ‘éå¸¸å¤§å’Œéå¸¸æ·±æ—¶æ•ˆæœå¾ˆå·®ï¼Œè¿™å‘ç”Ÿåœ¨æˆ‘ä»¬çš„ç”¨æˆ·æœ€è¿‘å‘ä»–ä»¬çš„åº”ç”¨ç¨‹åºæ¨é€æ›´æ–°æ—¶ï¼Œè¿™å¯¼è‡´ä»–ä»¬çš„é¡µé¢æ˜¾è‘—è†¨èƒ€(è¿™æ˜¯ä»–ä»¬é‚£è¾¹çš„å¦ä¸€ä¸ªæ€§èƒ½é—®é¢˜ï¼Œä½†è¿™æ˜¯å¦ä¸€ä¸ªè¯é¢˜)ã€‚

**ç”¨`.concat`åˆå¹¶ 15ï¼Œ000 ä¸ªå¹³å‡å¤§å°ä¸º 5 ä¸ªå…ƒç´ çš„æ•°ç»„èŠ±äº† 6 ç§’ã€‚**

**ä»€ä¹ˆï¼Ÿ**

6 ç§’...

å¯¹äºå¹³å‡å¤§å°ä¸º 5 ä¸ªå…ƒç´ çš„ 15ï¼Œ000 ä¸ªæ•°ç»„ï¼Ÿ

é‚£ä¸æ˜¯å¾ˆå¤šæ•°æ®ã€‚

ä¸ºä»€ä¹ˆè¿™ä¹ˆæ…¢ï¼Ÿæœ‰æ²¡æœ‰æ›´å¿«çš„æ–¹æ³•æ¥åˆå¹¶æ•°ç»„ï¼Ÿ

* * *

# [](#benchmark-comparisons)åŸºå‡†æ¯”è¾ƒ

## [T1ã€‚æ¨ vsã€‚ä¸²è” 10000 ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„æœ‰ 10 ä¸ªå…ƒç´ ](#push-vs-concat-for-10000-arrays-with-10-elements-each)

æ‰€ä»¥æˆ‘å¼€å§‹ç ”ç©¶(æˆ‘æŒ‡çš„æ˜¯è°·æ­Œæœç´¢)ä¸ Javascript ä¸­åˆå¹¶æ•°ç»„çš„å…¶ä»–æ–¹æ³•ç›¸æ¯”çš„`.concat`åŸºå‡†ã€‚

åŸæ¥åˆå¹¶æ•°ç»„æœ€å¿«çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ¥å— n ä¸ªå‚æ•°çš„`.push`:

```
// Push contents of arr2 to arr1
arr1.push(arr2[0], arr2[1], arr2[3], ..., arr2[n])

// Since my arrays are not fixed in size, I used `apply` instead
Array.prototype.push.apply(arr1, arr2) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç›¸æ¯”ä¹‹ä¸‹ï¼Œå®ƒè¦å¿«å¾—å¤šã€‚

æœ‰å¤šå¿«ï¼Ÿ

æˆ‘è‡ªå·±è¿è¡Œäº†å‡ ä¸ªæ€§èƒ½åŸºå‡†æ¥è§‚å¯Ÿã€‚ä½ ç§ï¼Œè¿™å°±æ˜¯ Chrome çš„ä¸åŒä¹‹å¤„:

[![JsPerf - .push vs. .concat 10000 size-10 arrays (Chrome)](../Images/69b4bc7f01450ee1dfaff38173c6733f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--I6TQ4Ugm--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/txrl0qpb5oz46mqfy3zn.PNG)

ğŸ‘‰[é“¾æ¥åˆ° JsPerf ä¸Šçš„æµ‹è¯•](https://jsperf.com/javascript-array-concat-vs-push/100)

è¦åˆå¹¶å¤§å°ä¸º 10 çš„æ•°ç»„ 10ï¼Œ000 æ¬¡ï¼Œ`.concat`ä»¥ 0.40 ops/sec çš„é€Ÿåº¦æ‰§è¡Œï¼Œè€Œ`.push`ä»¥ 378 ops/sec çš„é€Ÿåº¦æ‰§è¡Œã€‚`push`æ¯”`concat`å¿« 945 å€ï¼è¿™ç§å·®å¼‚å¯èƒ½ä¸æ˜¯çº¿æ€§çš„ï¼Œä½†åœ¨è¿™ä¸ªå°èŒƒå›´å†…å·²ç»å¾ˆæ˜æ˜¾äº†ã€‚

åœ¨ Firefox ä¸Šï¼Œç»“æœå¦‚ä¸‹:

[![JsPerf - .push vs. .concat 10000 size-10 arrays (Firefox)](../Images/7700b38b7a325011d5d5c6e4ff83b473.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--1syE91oa--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/i8qyutk1h1azih06rn4z.PNG)

ä¸ Chrome çš„ V8 å¼•æ“ç›¸æ¯”ï¼ŒFirefox çš„ SpiderMonkey Javascript å¼•æ“é€šå¸¸è¾ƒæ…¢ï¼Œä½†`.push`ä»ç„¶ååˆ—å‰èŒ…ï¼Œé€Ÿåº¦å¿«äº† 2260 å€ã€‚

å¯¹æˆ‘ä»¬ä»£ç çš„è¿™ä¸€ä¸ªæ”¹å˜ä¿®å¤äº†æ•´ä¸ªå‡é€Ÿé—®é¢˜ã€‚

## [T1ã€‚æ¨ vsã€‚ä¸²è”ä¸¤ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„åŒ…å« 50ï¼Œ000 ä¸ªå…ƒç´ ](#push-vs-concat-for-2-arrays-with-50000-elements-each)

ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä¸æ˜¯åˆå¹¶ 10ï¼Œ000 ä¸ªå¤§å°ä¸º 10 çš„æ•°ç»„ï¼Œè€Œæ˜¯åˆå¹¶ 2 ä¸ªå„æœ‰ 50000 ä¸ªå…ƒç´ çš„å·¨å‹æ•°ç»„ï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ

ä»¥ä¸‹æ˜¯ Chrome ä¸Šçš„ç»“æœå’Œç»“æœ:

[![JsPerf - .push vs. .concat 2 size-50000 arrays (chrome)](../Images/febcc8b5b4aa18bf0d87b1033a9d76e0.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--pmnpnick--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/7euccbt97unwnjjdq5iw.PNG)

ğŸ‘‰[é“¾æ¥åˆ° JsPerf ä¸Šçš„æµ‹è¯•](https://jsperf.com/javascript-array-concat-vs-push/170)

`.push`ä»ç„¶æ¯”`.concat`å¿«ï¼Œä½†æ˜¯å¿«äº† 9 å€ã€‚

æ²¡æœ‰ 945 å€æ…¢ï¼Œä½†ä»ç„¶éå¸¸æ…¢ã€‚

* * *

## [](#prettier-syntax-with-rest-spread)ç”¨ rest å±•å¼€çš„æ¼‚äº®è¯­æ³•

å¦‚æœæ‚¨å‘ç°`Array.prototype.push.apply(arr1, arr2)`å†—é•¿ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å˜ä½“ï¼Œä½¿ç”¨ rest spread ES6 è¯­æ³•:

```
arr1.push(...arr2) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`Array.prototype.push.apply(arr1, arr2)`å’Œ`arr1.push(...arr2)`çš„æ€§èƒ½å·®å¼‚å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚

* * *

# [](#but-why-is-raw-arrayconcat-endraw-so-slow)ä½†æ˜¯ä¸ºä»€ä¹ˆ`Array.concat`è¿™ä¹ˆæ…¢ï¼Ÿ

è¿™å¾ˆå¤§ç¨‹åº¦ä¸Šä¸ Javascript å¼•æ“æœ‰å…³ï¼Œä½†æˆ‘ä¸çŸ¥é“ç¡®åˆ‡çš„ç­”æ¡ˆï¼Œæ‰€ä»¥æˆ‘é—®äº†æˆ‘çš„æœ‹å‹[@ pico creator](https://dev.to/picocreator),[GPU . js](http://gpu.rocks/)çš„è”åˆåˆ›å§‹äººï¼Œå› ä¸ºä»–ä¹‹å‰èŠ±äº†ç›¸å½“å¤šçš„æ—¶é—´ç ”ç©¶ V8 æºä»£ç ã€‚ [@picocreator](https://dev.to/picocreator) è¿˜æŠŠä»–å¯çˆ±çš„æ¸¸æˆ PC å€Ÿç»™äº†æˆ‘ï¼Œä»–ç”¨å®ƒæ¥æµ‹è¯• GPU.js ä»¥è¿è¡Œ JsPerf æµ‹è¯•ï¼Œå› ä¸ºæˆ‘çš„ MacBook ç”šè‡³æ²¡æœ‰å†…å­˜æ¥æ‰§è¡Œä¸¤ä¸ª 50000 å¤§å°çš„é˜µåˆ—çš„`.concat`ã€‚

æ˜¾ç„¶ï¼Œç­”æ¡ˆä¸ä»¥ä¸‹äº‹å®æœ‰å¾ˆå¤§å…³ç³»:`.concat`åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œè€Œ`.push`ä¿®æ”¹ç¬¬ä¸€ä¸ªæ•°ç»„ã€‚`.concat`å°†ç¬¬ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ æ·»åŠ åˆ°è¿”å›çš„æ•°ç»„ä¸­æ‰€åšçš„é¢å¤–å·¥ä½œæ˜¯é€Ÿåº¦å˜æ…¢çš„ä¸»è¦åŸå› ã€‚

> æˆ‘:â€œä»€ä¹ˆï¼ŸçœŸçš„å—ï¼Ÿå°±è¿™æ ·ï¼Ÿä½†æ˜¯å·®é‚£ä¹ˆå¤šï¼Ÿä¸ä¼šå§ï¼â€
> [@picocreator](https://dev.to/picocreator) :â€œæ­£ç»çš„ï¼Œå°±å†™ç‚¹å¹¼ç¨šçš„å®ç°è¯•è¯•ã€‚concat vs .push thenï¼â€

æ‰€ä»¥æˆ‘è¯•ç€å†™äº†ä¸€äº›`.concat`å’Œ`.push`çš„å¹¼ç¨šå®ç°ã€‚äº‹å®ä¸Šæœ‰å‡ ä¸ªï¼ŒåŠ ä¸Šä¸[æ´›è¾¾ä»€](https://lodash.com/)çš„`_.concat`çš„æ¯”è¾ƒ:

[![JsPerf - Various ways to merge arrays (Chrome)](../Images/412f0341faba5f716c235736a87bccb9.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--hIgqWvh5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/w00r7grlnl1x5bnprrqy.PNG)

ğŸ‘‰[é“¾æ¥åˆ° JsPerf ä¸Šçš„æµ‹è¯•](https://jsperf.com/merge-array-implementations/1)

## [](#naive-implementation-1)å¤©çœŸå®ç° 1

è®©æˆ‘ä»¬è°ˆè°ˆç¬¬ä¸€å¥—å¤©çœŸçš„å®ç°:

##### [](#naive-implementation-of-raw-concat-endraw-)å¤©çœŸçš„å®ç°`.concat`

```
// Create result array
var arr3 = []

// Add Array 1
for(var i = 0; i < arr1Length; i++){
  arr3[i] = arr1[i]
}

// Add Array 2
for(var i = 0; i < arr2Length; i++){
  arr3[arr1Length + i] = arr2[i]
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

##### [](#naive-implementation-of-raw-push-endraw-)å¤©çœŸçš„å®ç°`.push`

```
for(var i = 0; i < arr2Length; i++){
  arr1[arr1Length + i] = arr2[i]
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œä¸¤è€…ä¹‹é—´å”¯ä¸€çš„åŒºåˆ«æ˜¯`.push`å®ç°ç›´æ¥ä¿®æ”¹äº†ç¬¬ä¸€ä¸ªæ•°ç»„ã€‚

##### [](#results-of-vanilla-methods)é¦™è‰æ–¹æ³•çš„ç»“æœ:

*   æ¯ç§’ 75 æ¬¡è¿ç®—
*   `.push`:æ¯ç§’ 793 æ¬¡è¿ç®—(å¿«äº† 10 å€)

##### [](#results-of-naive-implementation-1)å¤©çœŸå®ç°çš„ç»“æœ 1

*   æ¯ç§’ 536 æ¬¡è¿ç®—
*   `.push`:æ¯ç§’ 11ï¼Œ104 æ¬¡è¿ç®—(å¿« 20 å€)

äº‹å®è¯æ˜ï¼Œæˆ‘çš„ DIY `concat`å’Œ`push`æ¯”æ™®é€šçš„å®ç°è¦å¿«...ä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç®€å•åœ°åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“æœæ•°ç»„å¹¶å¤åˆ¶ç¬¬ä¸€ä¸ªæ•°ç»„çš„å†…å®¹ä¼šå¤§å¤§å‡æ…¢è¿™ä¸ªè¿‡ç¨‹ã€‚

## [](#naive-implementation-2-preallocate-size-of-the-final-array)æœ´ç´ å®ç° 2(æœ€ç»ˆæ•°ç»„çš„é¢„åˆ†é…å¤§å°)

æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ·»åŠ å…ƒç´ ä¹‹å‰é¢„å…ˆåˆ†é…æ•°ç»„çš„å¤§å°æ¥è¿›ä¸€æ­¥æ”¹è¿›ç®€å•çš„å®ç°ï¼Œè¿™å¸¦æ¥äº†å·¨å¤§çš„ä¸åŒã€‚

##### [](#naive-implementation-of-raw-concat-endraw-with-preallocation)å¤©çœŸçš„å®ç°`.concat`ä¸é¢„åˆ†é…

```
// Create result array with preallocated size
var arr3 = Array(arr1Length + arr2Length)

// Add Array 1
for(var i = 0; i < arr1Length; i++){
  arr3[i] = arr1[i]
}

// Add Array 2
for(var i = 0; i < arr2Length; i++){
  arr3[arr1Length + i] = arr2[i]
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

##### [](#naive-implementation-of-raw-push-endraw-with-preallocation)å¤©çœŸçš„å®ç°`.push`ä¸é¢„åˆ†é…

```
// Pre allocate size
arr1.length = arr1Length + arr2Length

// Add arr2 items to arr1
for(var i = 0; i < arr2Length; i++){
  arr1[arr1Length + i] = arr2[i]
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

##### [](#results-of-naive-implementation-1)å¤©çœŸå®ç°çš„ç»“æœ 1

*   æ¯ç§’ 536 æ¬¡è¿ç®—
*   `.push`:æ¯ç§’ 11ï¼Œ104 æ¬¡è¿ç®—(å¿« 20 å€)

##### [](#results-of-naive-implementation-2)å¤©çœŸå®ç°çš„ç»“æœ 2

*   æ¯ç§’ 1ï¼Œ578 æ¬¡è¿ç®—
*   `.push`:æ¯ç§’ 18ï¼Œ996 æ¬¡è¿ç®—(å¿« 12 å€)

å¯¹äºæ¯ç§æ–¹æ³•ï¼Œé¢„å…ˆåˆ†é…æœ€ç»ˆæ•°ç»„çš„å¤§å°å¯ä»¥å°†æ€§èƒ½æé«˜ 2-3 å€ã€‚

## [](#-raw-push-endraw-array-vs-raw-push-endraw-elements-individually)`.push`æ•°ç»„ä¸`.push`å…ƒç´ å•ç‹¬å¯¹æ¯”

å¥½å§å¦‚æœæˆ‘ä»¬ã€‚å•ç‹¬æ¨é€å…ƒç´ ï¼Ÿæ¯”`Array.prototype.push.apply(arr1, arr2)`å’Œ
å¿«å—

```
for(var i = 0; i < arr2Length; i++){
  arr1.push(arr2[i])
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

##### [](#results)ç»“æœ

*   æ•´ä¸ªé˜µåˆ—:æ¯ç§’ 793 æ¬¡è¿ç®—
*   å•ç‹¬å…ƒç´ :735 ops/sec(è¾ƒæ…¢)

å› æ­¤ï¼Œå¯¹å•ä¸ªå…ƒç´ æ‰§è¡Œ`.push`æ¯”å¯¹æ•´ä¸ªæ•°ç»„æ‰§è¡Œ`.push`è¦æ…¢ã€‚æœ‰é“ç†ã€‚

# [](#conclusion-why-raw-push-endraw-is-faster-raw-concat-endraw-)ç»“è®º:ä¸ºä»€ä¹ˆ`.push`æ¯”`.concat`å¿«

æ€»ä¹‹ï¼Œ`concat`æ¯”`.push`æ…¢å¾—å¤šçš„ä¸»è¦åŸå› æ˜¯å®ƒåˆ›å»ºäº†ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå¹¶åšäº†é¢å¤–çš„å·¥ä½œæ¥å¤åˆ¶ç¬¬ä¸€ä¸ªæ•°ç»„ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œç°åœ¨å¯¹æˆ‘æ¥è¯´è¿˜æœ‰å¦ä¸€ä¸ªè°œ...

# [](#another-mystery)å¦ä¸€ä¸ªè°œ

ä¸ºä»€ä¹ˆæ™®é€šå®ç°æ¯”ç®€å•å®ç°æ…¢è¿™ä¹ˆå¤šï¼ŸğŸ¤”å†æ¬¡å‘ [@picocreator](https://dev.to/picocreator) æ±‚åŠ©ã€‚

æˆ‘ä»¬çœ‹äº†ä¸€ä¸‹ lodash çš„`_.concat`å®ç°ï¼Œä»¥è·å¾—ä¸€äº›å…³äº vanilla `.concat`åœ¨å¹•åè¿˜åšäº†ä»€ä¹ˆçš„æç¤ºï¼Œå› ä¸ºå®ƒåœ¨æ€§èƒ½ä¸Šæ˜¯å¯æ¯”çš„(lodash çš„ç¨å¿«ä¸€äº›)ã€‚

äº‹å®è¯æ˜ï¼Œå› ä¸ºæ ¹æ® vanilla çš„`.concat`è§„èŒƒï¼Œè¯¥æ–¹æ³•æ˜¯é‡è½½çš„ï¼Œå¹¶ä¸”æ”¯æŒä¸¤ä¸ªç­¾å:

1.  ä½œä¸º n ä¸ªå‚æ•°è¿½åŠ çš„å€¼ï¼Œä¾‹å¦‚`[1,2].concat(3,4,5)`
2.  è¦è¿½åŠ è‡ªèº«çš„æ•°ç»„ï¼Œä¾‹å¦‚`[1,2].concat([3,4,5])`

ä½ ç”šè‡³å¯ä»¥è¿™æ ·åš:`[1,2].concat(3,4,[5,6])`

Lodash è¿˜å¤„ç†è¿™ä¸¤ç§é‡è½½ç­¾åï¼Œä¸ºæ­¤ï¼Œlodash å°†æ‰€æœ‰å‚æ•°æ”¾å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶å°†å…¶å±•å¹³ã€‚å¦‚æœä½ æŠŠå‡ ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥æ˜¯æœ‰æ„ä¹‰çš„ã€‚ä½†æ˜¯å½“ä¼ é€’ä¸€ä¸ªæ•°ç»„ç»™ append æ—¶ï¼Œå®ƒä¸åªæ˜¯ä½¿ç”¨è¿™ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯å°†å®ƒå¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶åå°†å…¶å±•å¹³ã€‚

...å¥½çš„...

ç»å¯¹å¯ä»¥æ›´ä¼˜åŒ–ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‚¨å¯èƒ½æƒ³è‡ªå·±åŠ¨æ‰‹å®ç°åˆå¹¶æ•°ç»„ã€‚

æ­¤å¤–ï¼Œè¿™åªæ˜¯æˆ‘å’Œ [@picocreator](https://dev.to/picocreator) åŸºäº Lodash çš„æºä»£ç å’Œä»–å¯¹ V8 æºä»£ç ç•¥æ˜¾è¿‡æ—¶çš„çŸ¥è¯†å¯¹ vanilla `.concat`å¦‚ä½•åœ¨å¼•æ“ç›–ä¸‹å·¥ä½œçš„ç†è®ºã€‚

ä½ å¯ä»¥åœ¨é—²æš‡æ—¶é˜…è¯» lodash çš„æºä»£ç [è¿™é‡Œ](https://github.com/lodash/lodash/blob/4.17.11/lodash.js#L6913)ã€‚

* * *

## [](#additional-notes)é™„åŠ æ³¨é‡Š

1.  æµ‹è¯•æ˜¯ç”¨åªåŒ…å«æ•´æ•°çš„æ•°ç»„å®Œæˆçš„ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒJavascript å¼•æ“å¤„ç†ç±»å‹åŒ–æ•°ç»„çš„é€Ÿåº¦æ›´å¿«ã€‚å¦‚æœæ•°ç»„ä¸­æœ‰å¯¹è±¡ï¼Œç»“æœä¼šæ¯”è¾ƒæ…¢ã€‚

2.  ä¸‹é¢æ˜¯ç”¨äºè¿è¡ŒåŸºå‡†æµ‹è¯•çš„ PC çš„è§„æ ¼:
    [![PC specs for the performance tests](../Images/fc53baca0d0ee23bf98aca2b89a86b20.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--rsJtFcLH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/fl7utbii6ivyifs66q2t.PNG)

* * *

# ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åœ¨åˆæ³•çš„æµ‹è¯•ä¸­åšå¦‚æ­¤å¤§çš„æ•°ç»„æ“ä½œï¼Ÿ

[![Uilicious Snippet dev.to test](../Images/ddd4b0b6d1cbb7ddda303d99a1b421fa.png)T2ã€‘](https://snippet.uilicious.com/test/public/1cUHCW368zsHrByzHCkzLE)

åœ¨å¹•åï¼ŒUI-licious æµ‹è¯•å¼•æ“æ‰«æç›®æ ‡åº”ç”¨ç¨‹åºçš„ DOM æ ‘ï¼Œè¯„ä¼°è¯­ä¹‰ã€å¯è®¿é—®å±æ€§å’Œå…¶ä»–å¸¸è§æ¨¡å¼ï¼Œä»¥ç¡®å®šä»€ä¹ˆæ˜¯ç›®æ ‡å…ƒç´ ä»¥åŠå¦‚ä½•æµ‹è¯•å®ƒã€‚

è¿™æ˜¯ä¸ºäº†ç¡®ä¿æµ‹è¯•å¯ä»¥åƒè¿™æ ·ç®€å•åœ°ç¼–å†™:

```
// Lets go to dev.to
I.goTo("https://dev.to")

// Fill up search
I.fill("Search", "uilicious")
I.pressEnter()

// I should see myself or my co-founder
I.see("Shi Ling")
I.see("Eugene Cheah") 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ä½¿ç”¨ CSS æˆ– XPATH é€‰æ‹©å™¨ï¼Œè¿™æ ·æµ‹è¯•å¯è¯»æ€§æ›´å¥½ï¼Œå¯¹ UI çš„å˜åŒ–ä¸å¤ªæ•æ„Ÿï¼Œå¹¶ä¸”æ›´å®¹æ˜“ç»´æŠ¤ã€‚

### [](#attention-public-service-announcement-please-keep-your-dom-count-low)æ³¨æ„:å…¬ç›Šå…¬å‘Šâ€”â€”è¯·ä¿æŒä½ çš„ DOM ä½è®¡æ•°ï¼

ä¸å¹¸çš„æ˜¯ï¼Œè¿‘æ¥ DOM æ ‘æœ‰å˜å¾—è¿‡å¤§çš„è¶‹åŠ¿ï¼Œå› ä¸ºäººä»¬æ­£åœ¨ç”¨ç°ä»£å‰ç«¯æ¡†æ¶æ„å»ºè¶Šæ¥è¶Šå¤æ‚å’ŒåŠ¨æ€çš„åº”ç”¨ç¨‹åºã€‚è¿™æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œæ¡†æ¶å…è®¸æˆ‘ä»¬æ›´å¿«åœ°å¼€å‘ï¼Œäººä»¬ç»å¸¸å¿˜è®°æ¡†æ¶å¢åŠ äº†å¤šå°‘è‡ƒè‚¿ã€‚åœ¨æ£€æŸ¥å„ç§ç½‘ç«™çš„æºä»£ç æ—¶ï¼Œæˆ‘æœ‰æ—¶ä¼šå¯¹é‚£äº›åªæ˜¯ç”¨æ¥åŒ…è£…å…¶ä»–å…ƒç´ çš„å…ƒç´ æ•°é‡æ„Ÿåˆ°ç•ç¼©ã€‚

å¦‚æœä½ æƒ³çŸ¥é“ä½ çš„ç½‘ç«™æ˜¯å¦æœ‰å¤ªå¤šçš„ DOM èŠ‚ç‚¹ï¼Œä½ å¯ä»¥è¿è¡Œä¸€ä¸ª [Lighthouse](https://developers.google.com/web/tools/lighthouse/) å®¡è®¡ã€‚

[![Google Lighthouse](../Images/4c9eea8f4b9ccc1661893f8146002ae3.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--OZ3aIjva--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developers.google.com/web/progressive-web-apps/images/pwa-lighthouse.png)

æ ¹æ® Google çš„è¯´æ³•ï¼Œæœ€ä½³çš„ DOM æ ‘æ˜¯:

*   å°‘äº 1500 ä¸ªèŠ‚ç‚¹
*   å°äº 32 å±‚çš„æ·±åº¦å°ºå¯¸
*   çˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å°‘äº 60 ä¸ª

å¯¹ Dev.to æè¦çš„å¿«é€Ÿå®¡è®¡æ˜¾ç¤ºï¼ŒDOM æ ‘çš„å¤§å°ç›¸å½“ä¸é”™:

*   æ€»å…± 941 ä¸ªèŠ‚ç‚¹
*   æœ€å¤§å€¼ 14 çš„æ·±åº¦
*   å­å…ƒç´ çš„æœ€å¤§æ•°é‡ä¸º 49

è¿˜ä¸é”™ï¼