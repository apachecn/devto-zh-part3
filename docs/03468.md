# ä½¿ç”¨ NodeJS åˆ›å»º GraphQL æœåŠ¡å™¨

> åŸæ–‡:[https://dev . to/aman Ishi/creating-a-graphql-server-with-nodejs-17 a3](https://dev.to/amanhimself/creating-a-graphql-server-with-nodejs-17a3)

[![](../Images/3e1f2b1505f8f1d048d7cb4f2b7f4a7d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--g0xsI323--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2560/1%2AmbwU_n49CU8SEJyLPaTAUw.png)

å½“æ¶‰åŠåˆ°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åº”ç”¨ç¨‹åºä¹‹é—´çš„ç½‘ç»œè¯·æ±‚æ—¶ï¼ŒREST(ä»£è¡¨*ä»£è¡¨æ€§çŠ¶æ€è½¬ç§»*)æ˜¯è¿æ¥ä¸¤è€…çš„æœ€æµè¡Œçš„é€‰æ‹©ä¹‹ä¸€ã€‚åœ¨[REST API](https://medium.com/crowdbotics/building-a-rest-api-with-koajs-417c276929e2)çš„ä¸–ç•Œé‡Œï¼Œä¸€åˆ‡éƒ½å›´ç»•ç€å°†èµ„æºä½œä¸ºå¯è®¿é—® URL çš„æƒ³æ³•ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ CRUD æ“ä½œ(åˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤)ï¼Œè¿™äº›æ“ä½œåŸºæœ¬ä¸Šæ˜¯ HTTP æ–¹æ³•ï¼Œæ¯”å¦‚ GETã€POSTã€PUT & DELETEï¼Œæ¥ä¸æ•°æ®è¿›è¡Œäº¤äº’ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„ REST è¯·æ±‚çš„ä¾‹å­:

```
//  example  of  a  request  https://swapi.co/api/people/  //  response  of  the  above  request  in  JSON  {  "results":  [  {  "name":  "Luke Skywalker",  "gender":  "male",  "homeworld":  "https://swapi.co/api/planets/1/",  "films":  [  "https://swapi.co/api/films/2/",  "https://swapi.co/api/films/6/",  "https://swapi.co/api/films/3/",  "https://swapi.co/api/films/1/",  "https://swapi.co/api/films/7/"  ],  }  {  "name":  "C-3PO",  "gender":  "n/a",  "homeworld":  "https://swapi.co/api/planets/1/",  "films":  [  "https://swapi.co/api/films/2/",  "https://swapi.co/api/films/5/",  "https://swapi.co/api/films/4/",  "https://swapi.co/api/films/6/",  "https://swapi.co/api/films/3/",  "https://swapi.co/api/films/1/"  ],  }  ]  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

REST API çš„å“åº”æ ¼å¼ä¸ä¸€å®šæ˜¯ JSONï¼Œä½†è¿™æ˜¯ç›®å‰å¤§å¤šæ•° API çš„é¦–é€‰æ–¹æ³•ã€‚é™¤äº† RESTï¼Œå¦ä¸€ç§å¤„ç†ç½‘ç»œè¯·æ±‚çš„æ–¹æ³•å‡ºç°äº†:GraphQLã€‚2015 å¹´å¼€æºï¼ŒGraphQL æ­£åœ¨æ”¹å˜å¼€å‘è€…åœ¨æœåŠ¡å™¨ç«¯ç¼–å†™ APIï¼Œåœ¨å®¢æˆ·ç«¯å¤„ç†çš„æ–¹å¼ã€‚ GraphQL ç”±è„¸ä¹¦å¼€å‘å¹¶ç§¯æç»´æŠ¤ã€‚

## [](#shortcomings-of-rest)ä¼‘æ¯çš„ç¼ºç‚¹

GraphQL æ˜¯ä¸€ç§å¼€å‘ API çš„æŸ¥è¯¢è¯­è¨€ã€‚ä¸ REST ä¸åŒï¼ŒREST æ˜¯ä¸€ç§æ¶æ„æˆ–â€œåšäº‹çš„æ–¹å¼â€ï¼ŒgraphQL çš„å¼€å‘ç†å¿µæ˜¯å®¢æˆ·æœºåœ¨ä¸€ä¸ªè¯·æ±‚ä¸­åªå‘æœåŠ¡å™¨è¯·æ±‚æ‰€éœ€çš„ä¸€ç»„é¡¹ç›®ã€‚

åœ¨ REST æ¶æ„ä¸­ï¼Œæˆ–è€…ç±»ä¼¼äºä¸Šé¢çš„ä¾‹å­ï¼Œå½“è·å– Luke Skywalker å‡ºç°åœ¨ã€Šæ˜Ÿçƒå¤§æˆ˜ã€‹ç”µå½±ä¸­çš„ç”µå½±æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ•°ç»„`films`æˆ–è€…æ˜¯`homeworld`çš„åå­—ï¼Œå®ƒè¿›ä¸€æ­¥åŒ…å«ä¸åŒçš„ API URLsï¼Œè¿™äº› URL å¼•å¯¼æˆ‘ä»¬åˆ°ä¸åŒçš„ JSON æ•°æ®é›†çš„ç»†èŠ‚ã€‚è¿™å½“ç„¶æ˜¯ä¸€ä¸ªè¿‡åº¦æŠ“å–çš„ä¾‹å­ã€‚å®¢æˆ·ç«¯ä¸ºäº†è·å¾—å¢å…‹Â·å¤©è¡Œè€…å‡ºç°çš„ç”µå½±çš„ç»†èŠ‚ï¼Œä»¥åŠä»–çš„æ¯æ˜Ÿçš„åå­—ï¼Œå¿…é¡»å‘æœåŠ¡å™¨å‘é€å¤šä¸ªè¯·æ±‚ã€‚

ä½¿ç”¨ GraphQLï¼Œè¿™å¯ä»¥è¢«åˆ†è§£æˆä¸€ä¸ªç½‘ç»œè¯·æ±‚ã€‚è·³åˆ° API url: `https://graphql.github.io/swapi-graphql/`å¹¶æŸ¥çœ‹è¿è¡Œä¸‹é¢çš„æŸ¥è¯¢ã€‚

*æ³¨æ„*:åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä½ å¯ä»¥å¿½ç•¥ GraphQL API æ˜¯å¦‚ä½•åœ¨å¹•åå·¥ä½œçš„ã€‚åœ¨æœ¬æ•™ç¨‹çš„åé¢ï¼Œæˆ‘å°†ä¸€æ­¥ä¸€æ­¥åœ°æŒ‡å¯¼æ‚¨æ„å»ºè‡ªå·±çš„(å¯èƒ½æ˜¯ç¬¬ä¸€ä¸ª)GraphQL APIã€‚

```
{  allPeople  {  edges  {  node  {  name  gender  homeworld  {  name  }  filmConnection  {  edges  {  node  {  title  }  }  }  }  }  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å°†è·å–æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼Œæ¯”å¦‚è§’è‰²çš„åå­—ï¼Œä»–ä»¬çš„`gender`ï¼Œ`homeworld`ï¼Œä»¥åŠä»–ä»¬å‡ºç°çš„`films`çš„æ ‡é¢˜ã€‚è¿è¡Œä¸Šè¿°æŸ¥è¯¢åï¼Œæ‚¨å°†å¾—åˆ°ä»¥ä¸‹ç»“æœ:

```
{  "data":  {  "allPeople":  {  "edges":  [  {  "node":  {  "name":  "Luke Skywalker",  "gender":  "male",  "homeworld":  {  "name":  "Tatooine"  },  "filmConnection":  {  "edges":  [  {  "node":  {  "title":  "A New Hope"  }  },  {  "node":  {  "title":  "The Empire Strikes Back"  }  },  {  "node":  {  "title":  "Return of the Jedi"  }  },  {  "node":  {  "title":  "Revenge of the Sith"  }  },  {  "node":  {  "title":  "The Force Awakens"  }  }  ]  }  }  },  {  "node":  {  "name":  "C-3PO",  "gender":  "n/a",  "homeworld":  {  "name":  "Tatooine"  },  "filmConnection":  {  "edges":  [  {  "node":  {  "title":  "A New Hope"  }  },  {  "node":  {  "title":  "The Empire Strikes Back"  }  },  {  "node":  {  "title":  "Return of the Jedi"  }  },  {  "node":  {  "title":  "The Phantom Menace"  }  },  {  "node":  {  "title":  "Attack of the Clones"  }  },  {  "node":  {  "title":  "Revenge of the Sith"  }  }  ]  }  }  }  ]  }  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœåº”ç”¨ç¨‹åºçš„å®¢æˆ·ç«¯æ­£åœ¨è§¦å‘ä¸Šè¿° GraphQL URLï¼Œå®ƒå°†åªåœ¨ç½‘ç»œä¸Šå‘é€ä¸€ä¸ªè¯·æ±‚æ¥è·å¾—æ‰€éœ€çš„ç»“æœï¼Œä»è€Œæ¶ˆé™¤äº†è¿‡é‡è·å–æˆ–å‘é€å¤šä¸ªè¯·æ±‚çš„ä»»ä½•å¯èƒ½æ€§ã€‚

## [](#prerequisites)å…ˆå†³æ¡ä»¶

æŒ‰ç…§è¿™ä¸ªæ•™ç¨‹ï¼Œä½ æ‰€éœ€è¦çš„æ˜¯å®‰è£…åœ¨ä½ çš„æœ¬åœ°æœºå™¨ä¸Šçš„`Nodejs`å’Œ`npm`ã€‚

*   [Nodejs](http://nodejs.org/)T0ã€‘
*   npm `^6.x.x`

## [](#graphql-in-a-nutshell)ç®€å•åœ°è¯´ GraphQL

ç®€è€Œè¨€ä¹‹ï¼Œ **GraphQL** æ˜¯ä¸€ç§è§£é‡Šå¦‚ä½•è¯·æ±‚*æ•°æ®*çš„è¯­æ³•ï¼Œé€šå¸¸ç”¨äºä»æœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯æ£€ç´¢æ•°æ®(åˆå*æŸ¥è¯¢*)æˆ–å¯¹å…¶è¿›è¡Œæ›´æ”¹(åˆå*å˜å¼‚*)ã€‚

GraphQL å‡ ä¹æ²¡æœ‰å®šä¹‰ç‰¹å¾:

*   å®ƒè®©å®¢æˆ·ç«¯ç¡®åˆ‡åœ°æŒ‡å®šå®ƒéœ€è¦ä»€ä¹ˆæ•°æ®ã€‚è¿™ä¹Ÿç§°ä¸ºå£°æ˜æ€§æ•°æ®æå–ã€‚
*   å®ƒå¯¹ç½‘ç»œå±‚å¹¶ä¸å›ºæ‰§å·±è§
*   å°†æ¥è‡ªå¤šä¸ªæ¥æºçš„å‡ ç»„æ•°æ®ç»„åˆèµ·æ¥æ›´å®¹æ˜“
*   å½“ä»¥æ¨¡å¼å’ŒæŸ¥è¯¢çš„å½¢å¼å£°æ˜æ•°æ®ç»“æ„æ—¶ï¼Œå®ƒä½¿ç”¨å¼ºç±»å‹ç³»ç»Ÿã€‚è¿™æœ‰åŠ©äºåœ¨å‘é€ç½‘ç»œè¯·æ±‚ä¹‹å‰éªŒè¯æŸ¥è¯¢ã€‚

## graph QL API çš„æ„å»ºæ¨¡å—

GraphQL API æœ‰å››ä¸ªæ„ä»¶:

*   (è®¡åˆ’æˆ–ç†è®ºçš„)çº²è¦
*   è¯¢é—®
*   çªå˜
*   ä¸‹å†³å¿ƒè€…

**Schema** åœ¨æœåŠ¡å™¨ç«¯ä»¥å¯¹è±¡çš„å½¢å¼å®šä¹‰ã€‚æ¯ä¸ªå¯¹è±¡å¯¹åº”äºä¸åŒçš„æ•°æ®ç±»å‹ï¼Œè¿™æ ·å°±å¯ä»¥å¯¹å®ƒä»¬è¿›è¡ŒæŸ¥è¯¢ã€‚æ¯”å¦‚:

```
type  User  {  id:  ID!  name:  String  age:  Int  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šé¢çš„æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªç”¨æˆ·å¯¹è±¡çš„å½¢çŠ¶ï¼Œå¸¦æœ‰ä¸€ä¸ªç”±ç¬¦å·`!`è¡¨ç¤ºçš„å¿…å¡«å­—æ®µ`id`ã€‚è¿˜åŒ…æ‹¬å…¶ä»–å­—æ®µï¼Œå¦‚ç±»å‹ä¸º*å­—ç¬¦ä¸²*çš„`name`å’Œç±»å‹ä¸º*æ•´æ•°*çš„å¹´é¾„ã€‚è¿™è¿˜ä¼šåœ¨æŸ¥è¯¢æ•°æ®æ—¶éªŒè¯æ¨¡å¼ã€‚

**æŸ¥è¯¢**æ˜¯ç”¨æ¥å‘ GraphQL API å‘å‡ºè¯·æ±‚çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå½“æˆ‘ä»¬è·å–ä¸ã€Šæ˜Ÿçƒå¤§æˆ˜ã€‹è§’è‰²ç›¸å…³çš„æ•°æ®æ—¶ã€‚è®©æˆ‘ä»¬ç®€åŒ–ä¸€ä¸‹ã€‚åœ¨ GraphQL ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œå°±æ˜¯è¯¢é—®å¯¹è±¡ä¸Šçš„ç‰¹å®šå­—æ®µã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸ä¸Šé¢ç›¸åŒçš„ APIï¼Œæˆ‘ä»¬è·å–ã€Šæ˜Ÿçƒå¤§æˆ˜ã€‹ä¸­æ‰€æœ‰è§’è‰²çš„åå­—ã€‚ä¸‹é¢ä½ å¯ä»¥çœ‹åˆ°ä¸åŒä¹‹å¤„ã€‚å›¾åƒçš„å·¦ä¾§æ˜¯æŸ¥è¯¢ï¼Œå³ä¾§æ˜¯å›¾åƒã€‚

[![ss1](../Images/80f5b702bcc5bc54a36a44139fea7727.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--GrzZsfZ---/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1200/1%2AL-Z_EF1tNkq4jUhsopHasw.png)

GraphQL æŸ¥è¯¢çš„å¥½å¤„æ˜¯å®ƒä»¬å¯ä»¥åµŒå¥—åˆ°æ‚¨æƒ³è¦çš„æ·±åº¦ã€‚è¿™åœ¨ REST API ä¸­å¾ˆéš¾åšåˆ°ã€‚æ“ä½œå˜å¾—æ›´åŠ å¤æ‚ã€‚

ä¸‹é¢æ˜¯åµŒå¥—æŸ¥è¯¢çš„å¦ä¸€ä¸ªä¾‹å­ï¼Œæ›´å¤æ‚ã€‚

[![ss2](../Images/f0d63e3c5f8ea01bd78e50832ac71696.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--qTXrHtwE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1200/1%2Aug3h4hZmAeuNHyy93Ygy2Q.png)

**çªå˜**:åœ¨ REST æ¶æ„ä¸­ï¼Œè¦ä¿®æ”¹æ•°æ®ï¼Œæˆ‘ä»¬è¦ä¹ˆä½¿ç”¨`POST`æ·»åŠ æ•°æ®ï¼Œè¦ä¹ˆä½¿ç”¨`PUT`ç”¨æ•°æ®æ›´æ–°ç°æœ‰å­—æ®µã€‚åœ¨ GraphQL ä¸­ï¼Œæ•´ä½“æ¦‚å¿µæ˜¯ç±»ä¼¼çš„ã€‚æ‚¨å°†å‘é€ä¸€ä¸ªæŸ¥è¯¢æ¥å¯¼è‡´æœåŠ¡å™¨ç«¯çš„å†™æ“ä½œã€‚ç„¶è€Œï¼Œè¿™ç§å½¢å¼çš„æŸ¥è¯¢è¢«ç§°ä¸º
å˜å¼‚ã€‚

**è§£æå™¨**æ˜¯æ¨¡å¼å’Œæ•°æ®ä¹‹é—´çš„é“¾æ¥ã€‚å®ƒä»¬æä¾›çš„åŠŸèƒ½å¯ç”¨äºé€šè¿‡ä¸åŒçš„æ“ä½œä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬åˆšåˆšå­¦ä¹ çš„ç›¸åŒæ„å»ºå—æ¥è®¾ç½®å¸¦æœ‰ [Nodejs](https://www.crowdbotics.com/build/node-js?utm_source=medium&utm_campaign=nodeh&utm_medium=node&utm_content=koa-rest-api) çš„ GraphQL æœåŠ¡å™¨ã€‚

## [](#hello-world-with-graphql)ä½ å¥½ä¸–ç•Œï¼ä½¿ç”¨ GraphQL

ç°åœ¨è®©æˆ‘ä»¬ç¼–å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª GraphQL æœåŠ¡å™¨ã€‚å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨[é˜¿æ³¢ç½—æœåŠ¡å™¨ã€‚](https://www.apollographql.com/docs/apollo-server/)æˆ‘ä»¬æ€»å…±éœ€è¦å®‰è£…ä¸‰ä¸ªåŒ…ï¼Œä»¥ä¾¿ Apollo æœåŠ¡å™¨ä½œä¸ºä¸­é—´ä»¶ä¸æˆ‘ä»¬ç°æœ‰çš„ Express åº”ç”¨ç¨‹åºä¸€èµ·å·¥ä½œã€‚Apollo Server çš„å¥½å¤„æ˜¯å®ƒå¯ä»¥ä¸ Node.js çš„å‡ ä¸ªæµè¡Œæ¡†æ¶ä¸€èµ·ä½¿ç”¨:Expressã€ [Koa](https://medium.com/crowdbotics/building-a-rest-api-with-koajs-417c276929e2) å’Œ[å“ˆæ¯”ç¥](https://medium.com/crowdbotics/setting-up-nodejs-backend-for-a-react-app-fe2219f26ea4)ã€‚Apollo æœ¬èº«æ˜¯ä¸åº“æ— å…³çš„ï¼Œå› æ­¤åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åº”ç”¨ç¨‹åºä¸­å¯ä»¥å°†å®ƒä¸è®¸å¤šç¬¬ä¸‰æ–¹åº“è¿æ¥èµ·æ¥ã€‚

æ‰“å¼€æ‚¨çš„ç»ˆç«¯å¹¶å®‰è£…ä»¥ä¸‹ä¾èµ–é¡¹:

```
# First create a new empty directory
mkdir apollo-express-demo

# Then initialize it
npm init -y

# Install required dependencies
npm install --save graphql apollo-server-express express 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬ç®€å•äº†è§£ä¸€ä¸‹è¿™äº›ä¾èµ–é¡¹çš„ä½œç”¨ã€‚

*   `graphql`æ˜¯ä¸€ä¸ªæ”¯æŒåº“ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦çš„æ¨¡å—
*   `apollo-server-express`è¢«æ·»åŠ åˆ°ç°æœ‰çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¹¶ä¸”æ˜¯ç›¸åº”çš„ HTTP æœåŠ¡å™¨æ”¯æŒåŒ…
*   Nodejs çš„ web æ¡†æ¶

æ‚¨å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„å›¾ç‰‡ï¼Œæˆ‘å®‰è£…çš„æ‰€æœ‰ä¾èµ–é¡¹éƒ½æ²¡æœ‰ä»»ä½•é”™è¯¯ã€‚

[![ss3](../Images/c5c5fe613e1bffd795d4b85531f9c42c.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--wN2dYNoo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2AgCozaTuzY6DHaPG4Ya43zA.png)

ç”¨ä¸‹é¢çš„ä»£ç 
åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º`index.js`çš„æ–°æ–‡ä»¶ã€‚

```
const express = require('express');
const { ApolloServer, gql } = require('apollo-server-express');

const typeDefs = gql`
    type Query {
        hello: String
    }
`;

const resolvers = {
    Query: {
        hello: () => 'Hello world!'
    }
};

const server = new ApolloServer({ typeDefs, resolvers });

const app = express();
server.applyMiddleware({ app });

app.listen({ port: 4000 }, () =>
    console.log(`ğŸš€ Server ready at http://localhost:4000${server.graphqlPath}`) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ˜¯æˆ‘ä»¬çš„åˆå§‹æœåŠ¡å™¨æ–‡ä»¶ï¼Œæˆ‘ä»¬ä»ç®€å•åœ°è¦æ±‚`express`æ¨¡å—å¼€å§‹ã€‚`gql`æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–‡å­—æ ‡ç­¾ï¼Œç”¨äºå°† GraphQL æ¨¡å¼å†™æˆç±»å‹ã€‚è¯¥æ¨¡å¼ç”±ç±»å‹å®šä¹‰ç»„æˆï¼Œå¸¦æœ‰ç”¨äºè¯»å–æ•°æ®çš„å¼ºåˆ¶*æŸ¥è¯¢*ç±»å‹ã€‚å®ƒè¿˜å¯ä»¥åŒ…å«è¡¨ç¤ºå…¶ä»–æ•°æ®å­—æ®µçš„å­—æ®µå’ŒåµŒå¥—å­—æ®µã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†`typeDefs`æ¥ç¼–å†™ä¸€ä¸ª graphQL æ¨¡å¼ã€‚

ç„¶å`resolvers`è¿›å…¥ç”»é¢ã€‚è§£æå™¨ç”¨äºä»æ¨¡å¼ä¸­è¿”å›å­—æ®µæ•°æ®ã€‚æˆ‘ä»¬åœ¨ç¤ºä¾‹ä¸­å®šä¹‰äº†ä¸€ä¸ªè§£æå™¨ï¼Œå®ƒæ˜ å°„å‡½æ•°`hello()`ä»¥åœ¨æˆ‘ä»¬çš„æ¨¡å¼ä¸Šå®ç°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä½¿ç”¨`ApolloServer`ç±»å®ä¾‹åŒ–å’Œå¯åŠ¨æœåŠ¡å™¨çš„`server`ã€‚æ—¢ç„¶æˆ‘ä»¬ä½¿ç”¨ Expressï¼Œæˆ‘ä»¬éœ€è¦é›†æˆ`ApolloServer`ç±»ã€‚æˆ‘ä»¬é€šè¿‡æ–¹æ³•`applyMiddleware()`å°†å®ƒä½œä¸º`app`ä¼ é€’ï¼Œä»¥æ·»åŠ  Apollo æœåŠ¡å™¨çš„ä¸­é—´ä»¶ã€‚`app`è¿™é‡Œä»£è¡¨ç°æœ‰çš„åº”ç”¨ç¨‹åºï¼Œæ˜¯ Express çš„ä¸€ä¸ªå®ä¾‹ã€‚

æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ Express æ¨¡å—æœ¬èº«æä¾›çš„`app.listen()`æ¥å¼•å¯¼æœåŠ¡å™¨ã€‚è¦è¿è¡ŒæœåŠ¡å™¨ï¼Œæ‰“å¼€æ‚¨çš„ç»ˆç«¯å¹¶è¿è¡Œå‘½ä»¤`node index.js`ã€‚ç°åœ¨ï¼Œä»æµè§ˆå™¨çª—å£ï¼Œè®¿é—®ç½‘å€:`http://localhost:4000/graphql`æ¥æŸ¥çœ‹å®ƒçš„è¡ŒåŠ¨ã€‚

Apollo Server ä¸ºæ‚¨è®¾ç½®äº† GraphQL Playgroundï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥å¿«é€Ÿè¿è¡ŒæŸ¥è¯¢å’Œæ¢ç´¢æ¨¡å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

[![ss4](../Images/ed60b4230f17d59774eb2ee0e13e0458.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--HPNIvtoO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1200/1%2Aba4JULFAk5VbSFRsNxof8g.png)

è¦è¿è¡ŒæŸ¥è¯¢ï¼Œè¯·åœ¨å·¦ä¾§çš„å¯ç¼–è¾‘ç©ºé—´é”®å…¥ä»¥ä¸‹æŸ¥è¯¢ï¼Œç„¶åæŒ‰ä¸­é—´çš„â–½(æ’­æ”¾)æŒ‰é’®ã€‚

[![ss5](../Images/f5776f18c23f664f684bbbff7d858c86.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Z5mQPO3M--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1200/1%2ASGaIF-GZ0E0QLg2K6sJ7CA.png)

å³è¾¹çš„ schema é€‰é¡¹å¡æè¿°äº†æˆ‘ä»¬çš„æŸ¥è¯¢`hello`çš„æ•°æ®ç±»å‹ã€‚è¿™ç›´æ¥æ¥è‡ªæˆ‘ä»¬åœ¨æœåŠ¡å™¨ä¸­å®šä¹‰çš„`typeDefs`ã€‚

[![ss6](../Images/9e4f754de9f86f838b307d746dc18318.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--bj9RHUax--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2A3v_Uh_k2gjC-XueD9PhWvQ.png)

ç§å§ï¼æ‚¨åˆšåˆšåˆ›å»ºäº†æ‚¨çš„ç¬¬ä¸€ä¸ª GraphQL æœåŠ¡å™¨ã€‚ç°åœ¨è®©æˆ‘ä»¬æŠŠç°æœ‰çš„çŸ¥è¯†æ‰©å±•åˆ°ç°å®ä¸–ç•Œã€‚

## [](#building-an-api-with-graphql)ç”¨ GraphQL æ„å»º API

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æŠŠæ‰€æœ‰çš„æ¨¡å—å’Œä»»ä½•å¿…è¦çš„æœ¯è¯­æ”¾åœ¨äº†ä¸€èµ·ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é˜¿æ³¢ç½—æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªå°å‹çš„*æ˜Ÿçƒå¤§æˆ˜ API* ç”¨äºæˆ‘ä»¬è‡ªå·±çš„æ¼”ç¤ºç›®çš„ã€‚ç°åœ¨æ‚¨å¯èƒ½å·²ç»çŒœåˆ° Apollo server æ˜¯ä¸€ä¸ªåº“ï¼Œå®ƒå¸®åŠ©æ‚¨ä½¿ç”¨ Nodejs å°† GraphQL æ¨¡å¼è¿æ¥åˆ° HTTP æœåŠ¡å™¨ã€‚å®ƒå¹¶ä¸ä»…é™äºç‰¹å®šçš„èŠ‚ç‚¹æ¡†æ¶ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨å‰é¢çš„éƒ¨åˆ†ä¸­ä½¿ç”¨äº† ExpressJSã€‚å®ƒæ”¯æŒ [Koa](https://medium.com/crowdbotics/building-a-rest-api-with-koajs-417c276929e2) ï¼ŒRestifyï¼Œ[å“ˆæ¯”ç¥](https://medium.com/crowdbotics/setting-up-nodejs-backend-for-a-react-app-fe2219f26ea4)ï¼Œä¹Ÿæ”¯æŒ Lambdaã€‚å¯¹äºæˆ‘ä»¬çš„ APIï¼Œè®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ Expressã€‚

## [](#compiling-with-babel)ç”¨å·´åˆ«å¡”ç¼–è¯‘

å¦‚æœæ‚¨æƒ³ä»å¤´å¼€å§‹ï¼Œè¯·ç»§ç»­å®‰è£…ç¬¬`Hello World! With GraphQL`èŠ‚ä¸­çš„æ‰€æœ‰åº“ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­å®‰è£…çš„ä¾èµ–é¡¹:

```
"dependencies":  {  "apollo-server-express":  "^2.1.0",  "express":  "^4.16.4",  "graphql":  "^14.0.2"  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘å°†ä½¿ç”¨ç›¸åŒçš„é¡¹ç›®å’Œç›¸åŒçš„æ–‡ä»¶`index.js`æ¥å¼•å¯¼æœåŠ¡å™¨ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬å¼€å§‹æ„å»ºæˆ‘ä»¬çš„ API ä¹‹å‰ï¼Œæˆ‘æƒ³è®©ä½ å±•ç¤ºä¸€ä¸‹å¦‚ä½•åœ¨æˆ‘ä»¬çš„æ¼”ç¤ºé¡¹ç›®ä¸­ä½¿ç”¨ ES6 æ¨¡å—ã€‚ä½¿ç”¨åƒ React å’Œ Angular è¿™æ ·çš„å‰ç«¯åº“ï¼Œå®ƒä»¬å·²ç»æ”¯æŒ ES6 ç‰¹æ€§ï¼Œæ¯”å¦‚`import`å’Œ`export default`è¯­å¥ã€‚Nodejs ç‰ˆæœ¬`8.x.x`è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬æ‰€éœ€è¦çš„æ˜¯ä¸€ä¸ª transpilerï¼Œå®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨ ES6 ç‰¹æ€§ç¼–å†™ JavaScriptã€‚ä½ å®Œå…¨å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥ï¼Œä½¿ç”¨å¤è€çš„`require()`è¯­å¥ã€‚

ç„¶è€Œä»€ä¹ˆæ˜¯ *transpiler* ï¼Ÿ

> *trans piler ä¹Ÿè¢«ç§°ä¸ºâ€œæºä»£ç åˆ°æºä»£ç ç¼–è¯‘å™¨â€,å®ƒä»ç”¨ä¸€ç§ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„
> æºä»£ç ä¸­è¯»å–ä»£ç ï¼Œå¹¶ç”¨å¦ä¸€ç§
> è¯­è¨€ç”Ÿæˆç­‰ä»·çš„ä»£ç ã€‚*

åœ¨ Nodejs çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸æ˜¯åœ¨åˆ‡æ¢ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯æˆ‘ä»¬éœ€è¦ä½¿ç”¨æˆ‘æ­£åœ¨ä½¿ç”¨çš„ Node çš„ LTS ç‰ˆæœ¬ä¸æ”¯æŒçš„æ–°è¯­è¨€ç‰¹æ€§ã€‚æˆ‘å°†é€šè¿‡ä»¥ä¸‹é…ç½®è¿‡ç¨‹è®¾ç½® [Babel](https://babeljs.io/) **ç¼–è¯‘å™¨**å¹¶åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­å¯ç”¨å®ƒã€‚

é¦–å…ˆï¼Œæ‚¨å¿…é¡»å®‰è£…ä¸€äº›ä¾èµ–é¡¹ï¼Œå¹¶æ³¨æ„`-D`æ ‡è®°ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦è¿™äº›ä¾èµ–é¡¹ç”¨äºæˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒã€‚

```
npm install -D babel-cli babel-preset-env babel-watch 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸€æ—¦ä½ å®‰è£…äº†å®ƒä»¬ï¼Œæ·»åŠ ä¸€ä¸ª`.babelrc`æ–‡ä»¶åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œå¹¶æ·»åŠ ä¸‹é¢çš„é…ç½®:

```
{  "presets":  [env]  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é…ç½®è¿‡ç¨‹çš„æœ€åä¸€æ­¥æ˜¯åœ¨`package.json`ä¸­æ·»åŠ ä¸€ä¸ª`dev` `script`ã€‚ä¸€æ—¦æœ‰å˜åŒ–ï¼Œè¿™å°†è‡ªåŠ¨è¿è¡Œ babel ç¼–è¯‘å™¨ã€‚è¿™ç”±`babel-watch`å®Œæˆï¼Œå®ƒè¿˜è´Ÿè´£é‡å¯[èŠ‚ç‚¹](https://www.crowdbotics.com/build/node-js?utm_source=medium&utm_campaign=nodeh&utm_medium=node&utm_content=koa-rest-api)
ç½‘ç»œæœåŠ¡å™¨ã€‚

```
"scripts":  {  "dev":  "babel-watch index.js"  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¦æŸ¥çœ‹å®ƒçš„æ“ä½œï¼Œè¯·å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°æ‚¨çš„`index.js`ä¸­ï¼Œå¹¶æŸ¥çœ‹æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚

```
import express from "express"

const app = express()

app.get("/", (req, res) => res.send("Babel Working!"))

app.listen({ port: 4000 }, () => console.log(`ğŸš€ Server ready at http://localhost:4000`)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä»ç»ˆç«¯å†™å…¥`npm run dev`ã€‚å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œæ‚¨å°†å¾—åˆ°ä»¥ä¸‹å†…å®¹:

[![ss7](../Images/50a13e88d20bf9a66eba0ddc4a3928c2.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--WdRXagkv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2ACix-Zl8mbZf90qpuHxEB8g.png)

æ‚¨ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨çª—å£ä¸­è®¿é—®`http://localhost:4000/`æ¥æŸ¥çœ‹å®ƒçš„æ“ä½œã€‚

## [](#adding-a-schema)æ·»åŠ æ¨¡å¼

æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡å¼æ¥å¯åŠ¨æˆ‘ä»¬çš„ GraphQL APIã€‚è®©æˆ‘ä»¬åœ¨ç›®å½•`api`ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`api/schema.js`çš„æ–°æ–‡ä»¶ã€‚å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ¨¡å¼ä¸­ã€‚

æˆ‘ä»¬çš„æ¨¡å¼æ€»å…±åŒ…å«ä¸¤ä¸ªæŸ¥è¯¢ã€‚ç¬¬ä¸€ä¸ªæ˜¯`allPeople`ï¼Œé€šè¿‡å®ƒå¯ä»¥è·å–å’Œåˆ—å‡º API ä¸­çš„æ‰€æœ‰å­—ç¬¦ã€‚ç¬¬äºŒä¸ªæŸ¥è¯¢`person`æ˜¯ä½¿ç”¨ä»–ä»¬çš„ id æ£€ç´¢ä¸€ä¸ªäººã€‚è¿™ä¸¤ç§æŸ¥è¯¢ç±»å‹éƒ½ä¾èµ–äºä¸€ä¸ªåä¸º`Person`çš„è‡ªå®šä¹‰ç±»å‹ï¼Œå®ƒåŒ…å«å››ä¸ªå±æ€§ã€‚

```
import { gql } from "apollo-server-express"

const typeDefs = gql`
    type Person {
        id: Int
        name: String
        gender: String
        homeworld: String
    }
    type Query {
        allPeople: [Person]
        person(id: Int!): Person
    }
`

export default typeDefs 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#add-a-resolver)æ·»åŠ è§£æå™¨

æˆ‘ä»¬å·²ç»äº†è§£äº†åˆ†è§£å™¨çš„é‡è¦æ€§ã€‚å®ƒåŸºäºä¸€ä¸ªç®€å•çš„æœºåˆ¶ï¼Œå³å®ƒå¿…é¡»é“¾æ¥æ¨¡å¼å’Œæ•°æ®ã€‚è§£æå™¨æ˜¯åŒ…å«æŸ¥è¯¢æˆ–å˜å¼‚èƒŒåçš„é€»è¾‘çš„å‡½æ•°ã€‚ç„¶åä½¿ç”¨å®ƒä»¬æ¥æ£€ç´¢æ•°æ®ï¼Œå¹¶æ ¹æ®ç›¸å…³è¯·æ±‚è¿”å›æ•°æ®ã€‚

å¦‚æœæ‚¨åœ¨ä½¿ç”¨ Express ä¹‹å‰å·²ç»æ„å»ºäº†æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°†è§£æå™¨è§†ä¸ºä¸€ä¸ªæ§åˆ¶å™¨ï¼Œå…¶ä¸­æ¯ä¸ªæ§åˆ¶å™¨éƒ½æ˜¯ä¸ºç‰¹å®šçš„è·¯ç”±æ„å»ºçš„ã€‚å› ä¸ºæˆ‘ä»¬æ²¡æœ‰åœ¨æœåŠ¡å™¨åé¢ä½¿ç”¨ä»»ä½•æ•°æ®åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æä¾›ä¸€äº›è™šæ‹Ÿæ•°æ®æ¥æ¨¡æ‹Ÿæˆ‘ä»¬çš„ APIã€‚

åˆ›å»ºä¸€ä¸ªåä¸º`resolvers.js`çš„æ–°æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç ã€‚

```
const defaultData = [
    {
        id: 1,
        name: "Luke SkyWaler",
        gender: "male",
        homeworld: "Tattoine"
    },
    {
        id: 2,
        name: "C-3PO",
        gender: "bot",
        homeworld: "Tattoine"
    }
]

const resolvers = {
    Query: {
        allPeople: () => {
            return defaultData
        },
        person: (root, { id }) => {
            return defaultData.filter(character => {
                return (character.id = id)
            })[0]
        }
    }
}

export default resolvers 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰äº†åŒ…å«ã€Šæ˜Ÿçƒå¤§æˆ˜ã€‹ä¸­ä¸¤ä¸ªè§’è‰²ç»†èŠ‚çš„`defaultData`æ•°ç»„ã€‚æŒ‰ç…§æˆ‘ä»¬çš„æ¨¡å¼ï¼Œæ•°ç»„ä¸­çš„è¿™ä¸¤ä¸ªå¯¹è±¡éƒ½æœ‰å››ä¸ªå±æ€§ã€‚æ¥ä¸‹æ¥æ˜¯æˆ‘ä»¬çš„`resolvers`å¯¹è±¡ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªå‡½æ•°ã€‚è¿™é‡Œçš„`allPeople()`å¯ä»¥åœ¨ä»¥åç”¨æ¥æ£€ç´¢`defaultData`æ•°ç»„é‡Œé¢çš„æ‰€æœ‰æ•°æ®ã€‚`person()`ç®­å¤´å‡½æ•°ä½¿ç”¨å‚æ•°`id`æ¥æ£€ç´¢å…·æœ‰æ‰€è¯·æ±‚ ID çš„ person å¯¹è±¡ã€‚æˆ‘ä»¬å·²ç»åœ¨æŸ¥è¯¢ä¸­å®šä¹‰äº†è¿™ä¸€ç‚¹ã€‚

æ‚¨å¿…é¡»å¯¼å‡ºè§£æå™¨å’Œæ¨¡å¼å¯¹è±¡ï¼Œä»¥ä¾¿åœ¨ Apollo æœåŠ¡å™¨ä¸­é—´ä»¶ä¸­ä½¿ç”¨å®ƒä»¬ã€‚

## [](#implementing-the-server)å®ç°æœåŠ¡å™¨

æ—¢ç„¶æˆ‘ä»¬å·²ç»å®šä¹‰äº†æ¨¡å¼å’Œè§£æå™¨ï¼Œæˆ‘ä»¬å°†åœ¨æ–‡ä»¶`index.js`ä¸­å®ç°æœåŠ¡å™¨ã€‚ä»`apollo-server-express`å¯¼å…¥ Apollo æœåŠ¡å™¨å¼€å§‹ã€‚æˆ‘ä»¬è¿˜éœ€è¦ä»`api/`æ–‡ä»¶å¤¹ä¸­å¯¼å…¥æˆ‘ä»¬çš„æ¨¡å¼å’Œè§£æå™¨å¯¹è±¡ã€‚ç„¶åï¼Œä½¿ç”¨ Apollo Server Express åº“ä¸­çš„ GraphQL ä¸­é—´ä»¶å®ä¾‹åŒ– GraphQL APIã€‚

```
import express from "express"
import { ApolloServer } from "apollo-server-express"

import typeDefs from "./api/schema"
import resolvers from "./api/resolvers"

const app = express()

const PORT = 4000

const SERVER = new ApolloServer({
    typeDefs,
    resolvers
})

SERVER.applyMiddleware({ app })

app.listen(PORT, () => console.log(`ğŸš€ GraphQL playground is running at http://localhost:4000`)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`app.listen()`å¼•å¯¼æˆ‘ä»¬çš„ Express æœåŠ¡å™¨ã€‚æ‚¨ç°åœ¨å¯ä»¥è¿è¡ŒæœåŠ¡å™¨ï¼Œä»ç»ˆç«¯`npm run dev`æ‰§è¡Œå‘½ä»¤ã€‚ä¸€æ—¦èŠ‚ç‚¹æœåŠ¡å™¨å¯åŠ¨ï¼Œå®ƒå°†æç¤ºä¸€æ¡æˆåŠŸæ¶ˆæ¯ï¼Œè¡¨æ˜æœåŠ¡å™¨å·²ç»å¯åŠ¨ã€‚

ç°åœ¨ä¸ºäº†æµ‹è¯•æˆ‘ä»¬çš„ GraphQL APIï¼Œåœ¨ä¸€ä¸ª
æµè§ˆå™¨çª—å£ä¸­è·³è½¬åˆ°`http://localhost:4000/graphql` URL å¹¶è¿è¡Œä¸‹é¢çš„æŸ¥è¯¢ã€‚

```
{  allPeople  {  id  name  gender  homeworld  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç‚¹å‡»*æ’­æ”¾*æŒ‰é’®ï¼Œä½ ä¼šåœ¨å³ä¾§çœ‹åˆ°ä¸€ä¸ªç†Ÿæ‚‰çš„ç»“æœï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

[![ss8](../Images/b72b4e7de7b66ccfd82c159ba83ce3a1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--pIOHrlIL--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1200/1%2ABnyLxWTl_9yDpoIDLH-Xzg.png)

è¿™éƒ½æ˜¯å› ä¸ºæˆ‘ä»¬çš„æŸ¥è¯¢ç±»å‹`allPeople`æœ‰å®šåˆ¶çš„ä¸šåŠ¡é€»è¾‘æ¥ä½¿ç”¨è§£æå™¨æ£€ç´¢æ‰€æœ‰æ•°æ®(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ¨¡æ‹Ÿæ•°æ®æ˜¯ä½œä¸ºæ•°ç»„åœ¨`resolvers.js`ä¸­æä¾›çš„)ã€‚è¦è·å–å•ä¸ª person å¯¹è±¡ï¼Œè¯·å°è¯•è¿è¡Œå¦ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„æŸ¥è¯¢ã€‚è®°ä½ä½ å¿…é¡»æä¾›èº«ä»½è¯ã€‚

```
{  person(id:  1)  {  name  homeworld  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿è¡Œä¸Šé¢çš„æŸ¥è¯¢ï¼Œç»“æœæ˜¯ï¼Œæ‚¨å¯ä»¥æŸ¥è¯¢æ‚¨æåˆ°çš„æ¯ä¸ªå­—æ®µ/å±æ€§çš„å€¼ã€‚æ‚¨çš„ç»“æœå°†ç±»ä¼¼äºä»¥ä¸‹å†…å®¹ã€‚

[![ss9](../Images/98b1ef95111b751ed66291b02d6a4f85.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ifkrd0pW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1200/1%2ADOSW6mN894ZYg498rVxNKg.png)

å¤ªå¥½äº†ï¼æˆ‘ç›¸ä¿¡æ‚¨ä¸€å®šå·²ç»æŒæ¡äº†å¦‚ä½•åˆ›å»ºå’Œè¿è¡Œ GraphQL æŸ¥è¯¢ã€‚Apollo æœåŠ¡å™¨åº“æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åº“ã€‚å®ƒè¿˜ä½¿æˆ‘ä»¬èƒ½å¤Ÿç¼–è¾‘æ“åœºã€‚*å‡è®¾æˆ‘ä»¬è¦ç¼–è¾‘æ¸¸ä¹åœºçš„ä¸»é¢˜ï¼Ÿ*æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯åœ¨åˆ›å»º`ApolloServer`å®ä¾‹æ—¶æä¾›ä¸€ä¸ªé€‰é¡¹ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯`SERVER`ã€‚

```
const SERVER = new ApolloServer({
    typeDefs,
    resolvers,
    playground: {
        settings: {
            "editor.theme": "light"
        }
    }
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å±æ€§æœ‰å¾ˆå¤šç‰¹æ€§ï¼Œæ¯”å¦‚ä¸ºæ¸¸ä¹åœºå®šä¹‰ä¸€ä¸ªé»˜è®¤çš„ç«¯ç‚¹æ¥æ”¹å˜ä¸»é¢˜ã€‚æ‚¨ç”šè‡³å¯ä»¥åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹å¯ç”¨æ¸¸ä¹åœºã€‚æ›´å¤šå¯é…ç½®çš„é€‰é¡¹å¯ä»¥åœ¨é˜¿æ³¢ç½—æœåŠ¡å™¨çš„å®˜æ–¹æ–‡æ¡£[è¿™é‡Œ](https://www.apollographql.com/docs/apollo-server/v2/features/graphql-playground.html)T3ã€‘æ‰¾åˆ°ã€‚

æ”¹å˜ä¸»é¢˜åï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹ã€‚

[![ss10](../Images/d82854cbe66ca9f57c869c8bfe152aa0.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--K289VTEq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1200/1%2AcZ7KO6x0FVXql9c04ZshIA.png)

### [](#conclusion)ç»“è®º

å¦‚æœä½ ä¸€æ­¥ä¸€æ­¥åœ°å®Œæˆäº†æœ¬æ•™ç¨‹ï¼Œ*ç¥è´ºä½ ï¼ğŸ‰*

æ‚¨å·²ç»å­¦ä¹ äº†å¦‚ä½•ç”¨ Apollo åº“é…ç½® Express æœåŠ¡å™¨æ¥è®¾ç½®è‡ªå·±çš„ GraphQL APIã€‚Apollo Server æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ˜¯ä¸ºå…¨æ ˆåº”ç”¨ç¨‹åºåˆ›å»º GraphQL APIs çš„æœ€ç¨³å®šçš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚å®ƒè¿˜æ”¯æŒ Reactã€Vueã€Angularã€Meteor å’Œ Ember çš„å®¢æˆ·ç«¯å¼€ç®±å³ç”¨ï¼Œä»¥åŠä½¿ç”¨ Swift å’Œ Java çš„åŸç”Ÿç§»åŠ¨å¼€å‘ã€‚æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨[è¿™é‡Œ](https://www.apollographql.com/docs/react/)æ‰¾åˆ°ã€‚

Github èµ„æºåº“ä¸­æ•™ç¨‹çš„å®Œæ•´ä»£ç ğŸ‘‡

[https://github.com/amandeepmittal/apollo-express-demo](https://github.com/amandeepmittal/apollo-express-demo)

[*æœ¬å¸–åŸè´´äºæ­¤*](https://medium.com/crowdbotics/creating-a-graphql-server-with-nodejs-ef9814a7e0e6)

* * *

* * *

æˆ‘ç»å¸¸å†™å…³äºç½‘ç»œæŠ€æœ¯çš„æ–‡ç« ï¼Œå¹¶ä¸”ååº”è‡ªç„¶ã€‚ä½ å¯ä»¥åœ¨ **[Twitter](https://www.twitter.com/amanhimself)** ä¸Šå…³æ³¨æˆ‘ï¼Œæˆ–è€…ä½ å¯ä»¥ **[è®¢é˜…æˆ‘çš„æ¯å‘¨ç®€è®¯](https://tinyletter.com/amanhimself)** ç›´æ¥åœ¨ä½ çš„æ”¶ä»¶ç®±é‡Œæ¥æ”¶æˆ‘æ‰€æœ‰çš„æ•™ç¨‹ğŸ“§