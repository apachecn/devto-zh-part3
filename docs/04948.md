# å¦‚ä½•ç”¨ Docker è¿è¡Œ WordPress

> åŸæ–‡:[https://dev . to/lampewebdev/how-to-get-WordPress-running-with-docker-4m g6](https://dev.to/lampewebdev/how-to-get-wordpress-running-with-docker-4mg6)

### [](#prerequirments)ğŸš€å…ˆå†³æ¡ä»¶

ä½ éœ€è¦æœ‰ğŸ³ [Docker](https://www.docker.com/get-started) å®‰è£…å®Œæ¯•ã€‚ä½ å¦‚ä½•å®‰è£… docker å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä½ çš„æ“ä½œç³»ç»Ÿã€‚

### [](#choosing-our-image)ğŸ¤”é€‰æ‹©æˆ‘ä»¬çš„å½¢è±¡

WordPress Docker å›¾ç‰‡å¯ä»¥åœ¨[è¿™é‡Œ](https://hub.docker.com/_/wordpress)æ‰¾åˆ°ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªä½œä¸ºæˆ‘ä»¬çš„åŸºç¡€å›¾åƒï¼Œå¹¶æ‰©å±•å®ƒã€‚

### [](#building-our-image-with-dockercompose)ğŸš€ç”¨ docker-compose å»ºç«‹æˆ‘ä»¬çš„å½¢è±¡

è®©æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ã€‚å¯¹äºæœ¬æ•™ç¨‹ï¼Œ
æˆ‘å°†åœ¨`d:/dev/`ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`wordpress`çš„æ–‡ä»¶å¤¹ã€‚
åœ¨é‚£é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º`docker-compose.yml`
çš„æ–‡ä»¶ï¼Œå°†å®ƒå¤åˆ¶å¹¶ç²˜è´´åˆ°æ–‡ä»¶:

```
version: '3.1'

services:

  wordpress:
    image: wordpress
    restart: always
    ports:
      - 8080:80
    environment:
      WORDPRESS_DB_HOST: db
      WORDPRESS_DB_USER: exampleuser
      WORDPRESS_DB_PASSWORD: examplepass
      WORDPRESS_DB_NAME: exampledb

  db:
    image: mysql:5.7
    restart: always
    environment:
      MYSQL_DATABASE: exampledb
      MYSQL_USER: exampleuser
      MYSQL_PASSWORD: examplepass
      MYSQL_RANDOM_ROOT_PASSWORD: '1' 
```

ğŸ¤”è¿™ä¸ª`docker-compose.yml`æ–‡ä»¶æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿ

å®ƒå°†åˆ›å»ºä¸¤ä¸ªæœåŠ¡ã€‚æœåŠ¡æ˜¯æˆ‘ä»¬é¢„è£…äº† PHP å’Œ WordPress çš„ docker é•œåƒã€‚WordPress éœ€è¦ PHP æ‰èƒ½è¿è¡Œã€‚æˆ‘ä»¬å‘Šè¯‰ docker å®ƒåº”è¯¥åœ¨ç«¯å£ 8080 ä¸Šè¿è¡Œï¼Œåœ¨`environment`ä¸­æˆ‘ä»¬å‘Šè¯‰ WordPress å®ƒåº”è¯¥ä½¿ç”¨ä»€ä¹ˆ db å‡­è¯ã€‚

æˆ‘ä»¬çš„ç¬¬äºŒä¸ªæœåŠ¡æ˜¯ä¸€ä¸ª`mysql`æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º`db`ã€‚WordPress éœ€è¦ä¸€ä¸ªæ•°æ®åº“æ¥å­˜å‚¨æ•°æ®ã€‚åœ¨`environment`ä¸­æˆ‘ä»¬å‘Šè¯‰æ•°æ®åº“å‡­è¯åº”è¯¥æ˜¯ã€‚è¿™å¿…é¡»ä¸`wordpress`æœåŠ¡`environment`ä¸­çš„ç›¸åŒï¼Œå› ä¸º WordPress éœ€è¦è¿™äº›å‡­è¯æ¥ç™»å½•å¹¶ä¸º WordPress çš„è¿è¡Œåˆ›å»ºæ­£ç¡®çš„æ•°æ®ã€‚æœ€åä¸€ä¸ª`environment`æ˜¯ä¸ºäº†æ›´å¥½çš„è¡¡é‡ã€‚å®ƒå°†åˆ›å»ºä¸€ä¸ªéšæœºçš„æ ¹ç”¨æˆ·å¯†ç ã€‚

ç°åœ¨æˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬çš„`wordpress`æ–‡ä»¶å¤¹ä¸­è¿è¡Œ docker-compose upã€‚

```
docker-compose up 
```

Docker å°†ä¸‹è½½å›¾åƒï¼Œç„¶åå°è¯•å¯åŠ¨å®ƒä»¬ã€‚è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚æ‰€ä»¥è¦æœ‰è€å¿ƒã€‚

ç°åœ¨ä½ åªéœ€è¦æµè§ˆåˆ°`http://localhost:8080`ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ° WordPress æç¤ºæ¥è®¾ç½®ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚

### [](#mounting-the-docker-folder)ğŸš€å®‰è£… docker æ–‡ä»¶å¤¹

æˆ‘ä»¬å½“å‰çš„è®¾ç½®æœ‰é—®é¢˜ã€‚å½“ä½ æƒ³å®‰è£…ä¸€ä¸ª WordPress æ’ä»¶æ—¶ï¼ŒWordPress ä¼šè¦æ±‚ä½ è¾“å…¥ä¸€ä¸ª FTP ç™»å½•ã€‚æˆ‘ä»¬çœŸçš„ä¸æƒ³é‚£æ ·ã€‚

å¦ä¸€ä¸ªé—®é¢˜æ˜¯ä½ å¦‚ä½•ç¼–è¾‘ WordPress çš„é…ç½®æˆ–è€…ä¸»é¢˜æˆ–è€…æ’ä»¶ï¼Ÿ

æˆ‘ä»¬éœ€è¦æŒ‚è½½æ¥æ›´æ”¹`wp-config.php`æ–‡ä»¶ã€‚
é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è®¿é—®å®ƒå‘¢ï¼Ÿ

ä¸€ç§æ–¹æ³•æ˜¯ ssh è¿›å…¥å®¹å™¨ï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œè¦åšçš„ã€‚æˆ‘ä»¬å°†æŠŠ WordPress æ–‡ä»¶å¤¹å®‰è£…åˆ°æˆ‘ä»¬çš„ä¸»æœºç³»ç»Ÿä¸­ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„`wordpress`æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª`html`æ–‡ä»¶å¤¹ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°æˆ‘ä»¬çš„`docker-compse.yml`æ–‡ä»¶ã€‚
ç°åœ¨åº”è¯¥æ˜¯è¿™æ ·çš„:

```
 wordpress:
    image: wordpress
    restart: always
    ports:
      - 8080:80
    environment:
      WORDPRESS_DB_HOST: db
      WORDPRESS_DB_USER: exampleuser
      WORDPRESS_DB_PASSWORD: examplepass
      WORDPRESS_DB_NAME: exampledb
    volumes: 
      - "D:/dev/wordpress/html:/var/www/html" 
```

æˆ‘ä»¬åˆšåˆšåœ¨ wordpress æœåŠ¡ä¸­æ·»åŠ äº†ä¸¤è¡Œä»£ç ã€‚
ç¬¬ä¸€è¡Œæ˜¯`volumes`ã€‚å·æ˜¯å¤„ç† docker æ˜ åƒä¸­çš„æ–‡ä»¶çš„ä¸€ç§ç®€å•æ–¹æ³•ï¼Œå°±åƒå®ƒæ˜¯ç³»ç»Ÿä¸Šçš„æœ¬åœ°æ–‡ä»¶ä¸€æ ·ã€‚

```
 - "D:/dev/wordpress/html:/var/www/html" 
```

è¿™ä¸€è¡Œå†…å®¹å¦‚ä¸‹:docker å®¹å™¨ä¸­çš„`/var/www/html`æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ã€‚åœ¨`D:/dev/wordpress/html`ä¸­æ˜¾ç¤ºå¹¶ç¼–è¾‘å®ƒã€‚

å†æ¬¡å¼ºè°ƒ`D:/dev/wordpress/html`æ˜¯å¯¹æˆ‘æœ‰ç”¨çš„ä¸œè¥¿ã€‚ä½ å¯ä»¥æŠŠå®ƒæ”¾åœ¨ä»»ä½•ä½ æƒ³æ”¾çš„åœ°æ–¹ã€‚

ç°åœ¨ï¼Œåªéœ€åœ¨ç»ˆç«¯ä¸­æŒ‰ä¸‹`ctrl+c`å³å¯åœæ­¢ docker-compose è¿‡ç¨‹ã€‚
å¹¶å†æ¬¡è¿è¡Œã€‚

```
docker-compose up 
```

å½“ä½ ç°åœ¨å¯¼èˆªåˆ°`d:/dev/wordpress/html`æ—¶ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ° WordPress æ–‡ä»¶ã€‚åªéœ€æ‰“å¼€`wp-config.php`å¹¶åœ¨`define( 'DB_NAME', 'exampledb');`å’Œ
å‰æ·»åŠ ä¸‹é¢ä¸€è¡Œ

```
/* Make WordPress install plugins directly */
define('FS_METHOD', 'direct'); 
```

åŒæ ·ç”¨è¿™ç§æ–¹æ³•ï¼Œç°åœ¨ç¼–è¾‘ WordPress ä¸»é¢˜å’Œæ’ä»¶å¾ˆå®¹æ˜“ã€‚å®ƒä»¬ä½äº wp-content æ–‡ä»¶å¤¹ä¸­ã€‚è¿™ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ

### [](#installing-php-extensions-needed-by-some-wordpress-plugins)ğŸš€å®‰è£…ä¸€äº› WordPress æ’ä»¶éœ€è¦çš„ php æ‰©å±•

ä¸€äº› WordPress æ’ä»¶éœ€è¦ PHP æ‰©å±•ã€‚åŸºæœ¬æ˜ åƒå·²ç»å®‰è£…äº†ä¸€äº›ï¼Œä½†ä¹Ÿè®¸ä½ éœ€è¦æ›´å¤šã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºè‡ªå·±çš„ç å¤´å·¥äººå½¢è±¡ã€‚è¿™é‡Œæˆ‘ä»¬å°†å®‰è£…`memcached` PHP æ‰©å±•ã€‚

åœ¨`wordpress`æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`Dockerfile`çš„æ–°æ–‡ä»¶ã€‚æŠŠè¿™ä¸ªåŠ è¿›å»ä¿å­˜:

```
FROM wordpress
RUN apt-get update
RUN apt-get install -y libz-dev libmemcached-dev && \
    pecl install memcached && \
    docker-php-ext-enable memcached 
```

åœ¨`FROM`è¡Œä¸­ï¼Œæˆ‘ä»¬å‘Šè¯‰ docker å°†æˆ‘ä»¬çš„å›¾åƒåŸºäºæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„`wordpress`å›¾åƒã€‚ç¬¬ä¸€ä¸ª`RUN`ç®€å•çš„è¯´æˆ‘ä»¬æƒ³è¦æ›´æ–°æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„ Linux å‘è¡Œç‰ˆçš„åŒ…ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæ¯ä¸ªæ‰©å±•éƒ½åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚
ç¬¬äºŒä¸ª`RUN`å‘½ä»¤æ˜¯é’ˆå¯¹`memcached`çš„ã€‚å®ƒå®‰è£…æ‰€éœ€çš„ Linux åŒ…ï¼Œç„¶åå¯ç”¨ PHP æ‰©å±•ã€‚å¦‚æœä½ éœ€è¦å¦ä¸€ä¸ªæ‰©å±•ï¼Œä¸€ä¸ªç®€å•çš„ google æœç´¢å°±å¯ä»¥äº†ï¼Œå¯èƒ½äººä»¬å·²ç»åœ¨æŸä¸ªæ—¶å€™ç”¨ docker å®‰è£…äº†è¿™ä¸ªæ‰©å±•ï¼Œå¹¶ä¸”å·²ç»çŸ¥é“éœ€è¦ä»€ä¹ˆæ ·çš„ Linux åŒ…ã€‚

å¥½äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨:
æ„å»ºæ–°çš„åŒ…

```
docker build -t wordpress_with_extra_extension . 
```

Yeahyyyyï¼Œä½ åˆšåˆšå»ºç«‹äº†ä¸€ä¸ªæ–°çš„ç å¤´å·¥äººå½¢è±¡ï¼é…·å§ï¼Ÿ
ç°åœ¨æˆ‘ä»¬åªéœ€è¦å‘Šè¯‰æˆ‘ä»¬çš„`docker-compose.yml`æ–‡ä»¶ä½¿ç”¨æ¥è‡ª
çš„
å›¾åƒ

```
 ...
  wordpress:
    image: wordpress
  ... 
```

è‡³

```
 ...
  wordpress:
    image: wordpress_with_extra_extension
  ... 
```

å°±æ˜¯è¿™æ ·ï¼ç°åœ¨åªè¦åœä¸‹æ¥è·‘ä¸€è·‘`docker-compose up`å°±ä¸‡äº‹å¤§å‰äº†ï¼

**æ„Ÿè°¢é˜…è¯»ï¼**

è¯´ä½ å¥½ï¼[insta gram](https://www.instagram.com/lampewebdev/)|[Twitter](https://twitter.com/lampewebdev)|[LinkedIn](https://www.linkedin.com/in/michael-lazarski-25725a87)|[Medium](https://medium.com/@lampewebdevelopment)