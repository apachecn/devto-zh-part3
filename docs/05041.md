# ä¾èµ–å€’ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

> åŸæ–‡:[https://dev . to/ellehallal/what-is-the-dependency-inversion-principle-2mjb](https://dev.to/ellehallal/what-is-the-dependency-inversion-principle-2mjb)

<center>

### æœ€åˆå‘å¸ƒäº [ellehallal.dev](https://ellehallal.dev) ğŸ‘©ğŸ½â€ğŸ’»

</center>

* * *

è¿™æ˜¯ä¸€ä¸ªå…³äºæˆ‘å¯¹ä¾èµ–å€’ç½®åŸåˆ™ç†è§£çš„å¿«é€Ÿåšå®¢ã€‚è¿˜æœ‰ä¸€äº›æˆ‘ä¸ç¡®å®šçš„åœ°æ–¹ï¼Œæ‰€ä»¥è¯·éšæ—¶ç•™ä¸‹åé¦ˆã€‚

## [](#what-is-the-dependency-inversion-principle)ä¾å­˜å€’ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

> é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ã€‚ä¸¤è€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ã€‚ç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚

*â€”ç½—ä¼¯ç‰¹Â·é©¬ä¸*

å¤ªå¥½äº†ï¼Œä½†è¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼ŸğŸ¤·ğŸ½â€â™€ï¸:æˆ‘å°†ç”¨æˆ‘çš„[äº•å­—æ¸¸æˆåº”ç”¨ç¨‹åº](https://github.com/ellehallal/ruby-tic-tac-toe)ä¸­çš„ä¸€ä¸ªç±»ä½œä¸ºä¾‹å­æ¥å±•ç¤ºæˆ‘çš„ç†è§£ã€‚

## [](#dependency-inversion-in-tic-tac-toe)äº•å­—æ¸¸æˆä¸­çš„ä¾å­˜å€’ç½®

åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º`GameFactory`çš„ç±»ã€‚`GameFactory`çš„ç›®çš„æ˜¯ç”¨æŒ‡å®šçš„ç©å®¶å’Œæ£‹ç›˜åˆ›å»ºä¸€ä¸ª`Game`ç±»çš„å®ä¾‹ã€‚

ä¸‹é¢æ˜¯è¿™ä¸ªç±»çš„å‹ç¼©ç‰ˆæœ¬:

```
class GameFactory
    def initialize(player_factory)
    @player_factory = player_factory
    end

    def new_game(squares)
    board = Board.new(squares)
    player1 = @player_factory.create_player('x', 1)
    player2 = @player_factory.create_player('o', 2)
    Game.new(board, player1, player2)
    end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨`new_game`æ–¹æ³•ä¸­ï¼Œåœ¨å…¶ä¸­åˆ›å»ºäº†`Board`å’Œ`Game`ç±»çš„æ–°å®ä¾‹ã€‚ç„¶è€Œï¼Œè¿™è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ã€‚

### [](#whats-wrong-with-it)æ€ä¹ˆäº†ï¼Ÿ

é«˜çº§ç±»`GameFactory`ä¾èµ–äºä½çº§ç±»`Board`å’Œ`Game`ã€‚å› æ­¤ï¼Œå®ƒä»¬æ˜¯ç´§å¯†è€¦åˆçš„ã€‚ä½çº§åˆ«ç±»çš„æ›´æ”¹ä¼šå½±å“é«˜çº§åˆ«ç±»ã€‚

å¦‚æœæ›´æ”¹äº†`Board`æˆ–`Game`ç±»çš„åç§°ï¼Œé‚£ä¹ˆ`GameFactory`ä¸­çš„`new_game`æ–¹æ³•å°†ä¸èµ·ä½œç”¨ã€‚å› æ­¤ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œä¿®æ”¹ä»¥é€‚åº”é‡å‘½åçš„ç±»ã€‚

å¦‚æœ`Board`å’Œ`Game`çš„å­ç±»è¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°æ¸¸æˆï¼Œ(ä¾‹å¦‚ï¼Œ`BestBoard`å’Œ`FunGame`)`new_game`æ–¹æ³•å°†éœ€è¦å†æ¬¡æ”¹å˜ä»¥é€‚åº”è¿™ç§æƒ…å†µã€‚

è§£å†³ä¸Šè¿°é—®é¢˜çš„ä¸€ä¸ªæ–¹æ³•æ˜¯å°†ç±»ä¼ é€’ç»™`GameFactory`çš„æ„é€ å‡½æ•°:

```
class GameFactory
    def initialize(player_factory, board, game)
    @player_factory = player_factory
    @board = board
    @game = game
    end

    def new_game(squares)
    board = @board.new(squares)
    player1 = @player_factory.create_player('x', 1)
    player2 = @player_factory.create_player('o', 2)
    @game.new(board, player1, player2)
    end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åˆå§‹åŒ–è¿‡ç¨‹ä¸­ä½œä¸ºæ£‹ç›˜å’Œæ¸¸æˆä¼ å…¥çš„ä¸œè¥¿ï¼Œåœ¨`GameFactory.`ä¸­å˜æˆ`@board`å’Œ`@game`

å¦‚æœ`Board`å’Œ`Game`ç±»çš„åå­—è¦æ”¹å˜ï¼Œç”¨é‡å‘½åçš„ç±»åˆå§‹åŒ–`GameFactory`ä¸ä¼šå½±å“`GameFactory`ã€‚

å¦‚æœ`Board`å’Œ`Game`çš„å­ç±»(ä¾‹å¦‚`BestBoard`å’Œ`FunGame`)è¢«ç”¨äºåˆå§‹åŒ–`GameFactory`çš„å®ä¾‹ï¼Œè¿™ä¸ä¼šå½±å“`new_game`çš„åŠŸèƒ½ã€‚

æ€»ä¹‹ï¼Œæˆ‘çš„ç†è§£æ˜¯åˆå§‹åŒ–ä¸€ä¸ªç‰¹å®šçš„ç±»ï¼Œå¦åˆ™å¦ä¸€ä¸ªç±»ä¸­çš„ç±»ä¼šå¯¼è‡´ç´§è€¦åˆã€‚èƒ½å¤Ÿé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ç±»ï¼Œæœ‰åŠ©äºä½¿ç±»æ¾æ•£è€¦åˆã€‚

* * *

## [](#resources)èµ„æº

*   [Ruby ä¸­çš„ä¾èµ–å€’ç½®åŸåˆ™](http://www.getlaura.com/dependency-inversion-principle-in-ruby/) [ç¨³å›ºåŸåˆ™# 5â€”â€”ä¾èµ–å€’ç½®åŸåˆ™](https://www.netguru.com/codestories/solid-5-dip)