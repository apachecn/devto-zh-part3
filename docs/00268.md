# ä¿®å¤ iOS ç‰ˆ React Native WebView çš„ postMessage

> åŸæ–‡:[https://dev . to/charlesstover/fixing-react-native-webview-s-postmessage-for-IOs-a68](https://dev.to/charlesstover/fixing-react-native-webview-s-postmessage-for-ios-a68)

2016 å¹´ï¼ŒGitHub ç”¨æˆ· Robert Roskam (raiderrobert) [åœ¨ React åŸç”Ÿå­˜å‚¨åº“ä¸Šæ‰“å¼€äº†ä¸€ä¸ªé—®é¢˜](https://github.com/facebook/react-native/issues/10865)ï¼ŒæŠ¥å‘Šäº†é”™è¯¯â€œ*åœ¨ WebView ä¸Šè®¾ç½® onMessage è¦†ç›–äº† window.postMessage çš„ç°æœ‰å€¼ï¼Œä½†å®šä¹‰äº†ä»¥å‰çš„å€¼*â€ã€‚è‡ªé‚£ä»¥åçš„ä¸¤å¹´ä¸­ï¼Œåœ¨ WebView çš„å†…éƒ¨ React æœ¬æœºå®ç°ä¸­æ²¡æœ‰åšä»»ä½•äº‹æƒ…æ¥è§£å†³å®ƒã€‚

React åŸç”Ÿç¤¾åŒºå·²ç»[å°† WebView](https://github.com/react-native-community/react-native-webview) ä¸“é—¨ä½œä¸ºç¬¬ä¸‰æ–¹åŒ…æ¥ç»´æŠ¤ï¼Œå¹¶ä¿®å¤äº†è®¸å¤šæ­£åœ¨å‘ç”Ÿçš„é—®é¢˜ã€‚ç„¶è€Œï¼Œä¸ºäº†å®ç°è¿™äº›ç¬¬ä¸‰æ–¹åŒ…ï¼Œæ‚¨å¿…é¡»èƒ½å¤Ÿé“¾æ¥ React æœ¬åœ°åŒ…â€” `react-native link react-native-webview`ã€‚å¦‚æœä½ èƒ½å¤Ÿå¹¶ä¸”æ„¿æ„è¿™æ ·åšï¼Œä½ çš„é—®é¢˜å°±è§£å†³äº†ã€‚WebView ç¤¾åŒºç‰ˆçš„å®‰è£…è¯´æ˜éå¸¸ç®€å•:

```
yarn add https://github.com/react-native-community/react-native-webview
react-native link react-native-webview 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**æ³¨:**ä¸ºäº†`react-native link ...`ï¼Œä½ å¿…é¡»å…ˆ`yarn global add react-native`ã€‚

ä¸å¹¸çš„æ˜¯ï¼Œå¦‚æœä½ ä¸èƒ½æˆ–ä¸æ„¿æ„è¿™æ ·åšï¼Œè¿™ä¸ªé—®é¢˜å°±æ²¡æœ‰è§£å†³æ–¹æ¡ˆã€‚å¥½å‡ å¹´äº†ï¼

ä¾‹å¦‚ï¼ŒExpo çš„ç”¨æˆ·å°†ä¸å¾—ä¸æ”¾å¼ƒä»–ä»¬çš„é¡¹ç›®ï¼Œç¼–å†™ä»–ä»¬è‡ªå·±çš„æœ¬åœ°çš„ã€é JavaScript çš„ç‰¹æ€§å®ç°ã€‚ç†è®ºä¸Šï¼ŒExpo å°†åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨è¿™äº›ç¤¾åŒºç‰ˆåŒ…ï¼›ä½†æ˜¯ç¦»å‘å¸ƒæ—¶é—´åªæœ‰å‡ å‘¨äº†ï¼Œæˆ‘å’Œæˆ‘çš„å›¢é˜Ÿä¸æ„¿æ„å†ç­‰äº†ã€‚

## [](#the-solution)è§£ğŸ’¡

å¦‚æœä½ æ›´å…³å¿ƒç°åœ¨å°±è§£å†³è¿™ä¸ªé—®é¢˜*è€Œä¸æ˜¯å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¿™ä¸€èŠ‚æ˜¯ä¸ºä½ å‡†å¤‡çš„ã€‚*

 *ä½¿ç”¨`npm install rn-webview`æˆ–`yarn add rn-webview`å°† [`rn-webview`åŒ…](https://www.npmjs.com/package/rn-webview)æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­ã€‚

æ— è®ºä½ åœ¨å“ªé‡Œä½¿ç”¨`import { WebView } from 'react-native'`ï¼Œç®€å•åœ°ç”¨`import WebView from 'rn-webview'`ä»£æ›¿å®ƒã€‚ç„¶åå°±åƒä½¿ç”¨ React æœ¬åœ°å†…éƒ¨å®ç°ä¸€æ ·ä½¿ç”¨æ–°çš„ WebView ç»„ä»¶ï¼ŒåŒ…æ‹¬ä½¿ç”¨`onMessage`é“å…·ã€‚`rn-webview`åŒ…åªæ˜¯å†…éƒ¨ React æœ¬æœºå®ç°çš„åŒ…è£…å™¨ï¼Œå®ƒé€šè¿‡ä¸åŒäºå†…éƒ¨`onMessage`å±æ€§çš„é€šé“æ‹¦æˆªæ¶ˆæ¯ï¼Œä½†ç”¨è‡ªå·±çš„`onMessage`å±æ€§å¤„ç†å®ƒï¼Œç»™äººä¸€ç§ä½ å®é™…ä¸Šåœ¨ä½¿ç”¨å†…éƒ¨`onMessage`å¹¶è·å¾—é¢„æœŸç»“æœçš„é”™è§‰ã€‚

## [](#caveats)å‘Šè¯«ğŸ¤•

`rn-webview`åŒ…çš„å·¥ä½œåŸç†æ˜¯å°†`window.postMessage`çš„æµé‡å¯¼å‘`history.pushState`ã€‚React Native çš„ iOS å®ç°è™½ç„¶ä¸èƒ½æ­£ç¡®å¤„ç†`window.postMessage`ï¼Œä½†æ˜¯å¯ä»¥å¤„ç†å¯¼èˆªçŠ¶æ€å˜åŒ–ã€‚å› æ­¤ï¼Œå¯¼èˆªçŠ¶æ€æ›´æ”¹äº‹ä»¶æ˜¯æ¶ˆæ¯åœ¨ WebView å’Œæœ¬æœºåº”ç”¨ç¨‹åºä¹‹é—´ä¼ è¾“çš„é€šé“ã€‚

å¦‚æœå†å²çŠ¶æ€çš„æ“ä½œæ˜¯åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªé‡è¦æ–¹é¢ï¼Œè¿™ä¸ªè§£å†³æ–¹æ¡ˆå¯èƒ½ä¸é€‚åˆæ‚¨çš„éœ€è¦ã€‚è¯·éšæ„åœ¨ GitHub ä¸Šåˆ†å‰é¡¹ç›®ï¼Œä»¥æä¾›æ›¿ä»£è§£å†³æ–¹æ¡ˆã€‚

## [](#the-implementation)å®ç°ğŸ”¨

### [](#export)å¯¼å‡ºğŸš¢

é¦–å…ˆä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼ŒWebView çš„`ref`é“å…·æ˜¯ç‰¹åˆ«é‡è¦çš„ä¸€ä¸ªã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·å¤±å»å¯¹å®ƒçš„è®¿é—®ã€‚æˆ‘ä»¬ä»ä¸€ä¸ª`forwardRef`å®ç°å¼€å§‹è¿™ä¸ªåŒ…ï¼Œå…¶ä¸­`WebViewPostMessage`æ˜¯è¿™ä¸ªåŒ…ä½¿ç”¨çš„ç±»åã€‚

```
export default React.forwardRef((props, ref) =>
  <WebViewPostMessage
    {...props}
    forwardedRef={ref}
  /> ); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#render)æ¸²æŸ“ğŸ¨

è¯¥ç»„ä»¶çš„è¾“å‡ºå°†æ˜¯ WebView çš„ React æœ¬æœºå†…éƒ¨å®ç°ï¼Œç¨åŠ è°ƒæ•´ã€‚æˆ‘ä»¬ä¸ä¼šç»™å®ƒä¸€ä¸ª`forwardedRef`å±æ€§ï¼Œå› ä¸ºè¿™åªæ˜¯ç”¨æ¥ç»™çˆ¶èŠ‚ç‚¹è®¿é—®`ref`çš„æƒé™ï¼Œå¯¹å†…éƒ¨ WebView æ¥è¯´æ¯«æ— æ„ä¹‰ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸ä¼šç»™å®ƒ`onMessage`é“å…·ï¼Œå› ä¸ºé‚£æ˜¯æˆ‘ä»¬æ‰€æœ‰é—®é¢˜çš„æ ¹æºâ€”â€”å®ƒä¸è¢« iOS æ”¯æŒï¼

```
render() {
  const props = {...this.props};
  delete props.forwardedRef;
  delete props.onMessage;

  return (
    <WebView
      {...this.props}
      onNavigationStateChange={this.handleNavigationStateChange}
      ref={this.handleRef}
    />
  );
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„å¯¼èˆªçŠ¶æ€æ›´æ”¹ç›‘å¬å™¨ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬ç›‘å¬æ¶ˆæ¯çš„é€šé“ã€‚

æˆ‘ä»¬æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„å¼•ç”¨å¤„ç†ç¨‹åºï¼Œå› ä¸ºæˆ‘ä»¬ 1)éœ€è¦åœ¨è¿™ä¸ªç»„ä»¶ä¸­è®¿é—®å®ƒï¼Œ2)éœ€è¦é€šè¿‡`forwardedRef`å±æ€§å°†å¼•ç”¨ä¼ é€’å›çˆ¶å®¹å™¨ã€‚

### [](#ref)RefğŸ‘‹

å½“å†…éƒ¨ WebView ç»™æˆ‘ä»¬å®ƒçš„ ref æ—¶ï¼Œæˆ‘ä»¬å°†å®ƒå­˜å‚¨åœ¨å®ä¾‹(`this.ref = ref`)ä¸­ä»¥å¤‡åç”¨ã€‚å¦‚æœçˆ¶èŠ‚ç‚¹ä¹Ÿè¯·æ±‚äº† refï¼Œæˆ‘ä»¬ä¼šè½¬å‘å®ƒã€‚

```
handleRef = ref => {
  this.ref = ref;

  // If the caller also wants this ref, pass it along to them as well.
  if (this.props.forwardedRef) {
    this.props.forwardedRef(ref);
  }
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#inject-windowpostmessage)æ³¨å…¥ window.postMessageğŸ’‰

ç°åœ¨ï¼Œ`window.postMessage`çš„å®šåˆ¶å®ç°éœ€è¦å­˜åœ¨äº WebView ä¸­çš„ä»»ä½•é¡µé¢ä¸Šã€‚æ¯å½“å¯¼èˆªçŠ¶æ€æ”¹å˜æ—¶ï¼Œå¦‚æœå®ƒå·²ç»å®ŒæˆåŠ è½½ï¼Œæˆ‘ä»¬å°±å‘å®ƒæ³¨å…¥ JavaScript æ¥è¦†ç›–`window.postMessage`æ‰€åšçš„ã€‚

```
handleNavigationStateChange = e => {

  /* We'll do something here later. */

  // If this navigation state change has completed, listen for messages.
  if (
    !e.loading &&
    this.ref
  ) {
    this.ref.injectJavaScript(injectPostMessage);
  }

  /* We'll do something here later. */
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†å¯è¯»æ€§ï¼Œæˆ‘åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­å®šä¹‰äº†å’Œ`importedinjectPostMessage`ã€‚

```
export default `
(function() {
  var EMPTY_STATE = Object.create(null);
  var escape = function(str) {
    return str.replace(/'/g, '\\\\\'');
  };
  var postMessage = window.postMessage;
  window.postMessage = function() {
    if (postMessage) {
      postMessage.apply(window, arguments);
    }
    history.pushState(
      EMPTY_STATE,
      document.title,
      location.href +
      '#window.postMessage(\\\'' +
      escape(arguments[0]) +
      '\\\')'
    );
  };
})();
`; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®ƒæ˜¯ä¸€ä¸ª[ç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼](https://en.wikipedia.org/wiki/Immediately-invoked_function_expression),ä»¥ç¡®ä¿æˆ‘ä»¬çš„å˜é‡ä¸ä¼šä¸ç½‘é¡µå†²çªã€‚

`EMPTY_STATE`æ˜¯æ¨å…¥å†å²çš„å†…å®¹ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ä¼šä¸ºäº‹ä»¶ç›‘å¬å™¨ä½¿ç”¨çŠ¶æ€å¯¹è±¡ã€‚

`escape`å‡½æ•°å¯¹å­—ç¬¦ä¸²ä¸­çš„æ’‡å·è¿›è¡Œè½¬ä¹‰ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å°†è¯¥å­—ç¬¦ä¸²æ”¾åœ¨æ’‡å·ä¸­ã€‚ç”±äºæˆ‘ä»¬æ¨é€çš„å¯¼èˆªçŠ¶æ€ä¸æ˜¯çœŸæ­£çš„ JavaScriptï¼Œä¹Ÿä¸ä¼šé€šè¿‡ä»»ä½•ç±»å‹çš„ JavaScript è§£é‡Šå™¨ä¼ é€’ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥å¹¶ä¸å®Œå…¨å¿…è¦ã€‚å®ƒåªæ˜¯å…è®¸æˆ‘ä»¬æ¨é€çš„çŠ¶æ€æ›´æ¥è¿‘çœŸå®çš„ JavaScriptã€‚

`postMessage`å˜é‡æ£€æŸ¥`postMessage`å‡½æ•°æ˜¯å¦å·²ç»å­˜åœ¨ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å°†å¸Œæœ›åœ¨ä»»ä½•`window.postMessage`è°ƒç”¨ä¸­ä¹Ÿæ‰§è¡Œå®ƒã€‚

æˆ‘ä»¬å®šä¹‰äº†è‡ªå·±çš„`window.postMessage`å‡½æ•°ã€‚å®ƒåšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯æ‰§è¡Œä¹‹å‰çš„`window.postMessage`å‡½æ•°ï¼Œå¦‚æœå®ƒå­˜åœ¨çš„è¯ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¨è¿›åˆ°å†å²çŠ¶æ€ã€‚æˆ‘ä»¬æ²¡æœ‰çŠ¶æ€å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å‰é¢æåˆ°çš„ç©ºå¯¹è±¡ã€‚æ–‡æ¡£çš„æ ‡é¢˜ä¸å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬åªä½¿ç”¨å½“å‰çš„æ ‡é¢˜ã€‚æ–‡æ¡£çš„ä½ç½®æœ¬èº«ä¹Ÿæ²¡æœ‰æ”¹å˜:æˆ‘ä»¬åªæ˜¯æ·»åŠ äº†ä¸€ä¸ªæ•£åˆ—ã€‚

è¿™ä¸ªå“ˆå¸Œï¼Œæˆ‘ä»¬ç¨åä¼šå¬åˆ°ï¼Œæ˜¯`window.postMessage('the message')`ã€‚ä»è®¾è®¡ä¸Šçœ‹ï¼Œå®ƒå¾ˆåƒ JavaScriptï¼Œä½†ä¸ä¼šè¢«ä»»ä½•çœŸæ­£çš„ JavaScript è§£é‡Šå™¨è¯„ä¼°ã€‚æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå”¯ä¸€çš„æ•£åˆ—ï¼Œå®ƒä¸ä¼šä¸çœŸå®çš„æ–‡æ¡£å†…æ•£åˆ—å†²çªã€‚

### [](#postmessage-listener)é‚®ä»¶ç›‘å¬å™¨ğŸ“¬

ç°åœ¨æˆ‘ä»¬æœ‰äº†è‡ªå·±çš„`window.postMessage`äº‹ä»¶å‘å°„å™¨ï¼Œæˆ‘ä»¬éœ€è¦ç›‘å¬å®ƒã€‚è¿™æ˜¯ä½äº`handleNavigationStateChange`æ–¹æ³•é¡¶éƒ¨çš„ä»£ç ã€‚

```
const postMessage = e.url.match(/\#window\.postMessage\('(.+)'\)$/);
if (postMessage) {
  if (
    e.loading &&
    this.props.onMessage
  ) {
    this.props.onMessage({
      nativeEvent: {
        data: unescape(postMessage[1])
      }
    });
  }
  return;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬æ£€æŸ¥æ–°çš„ URL æ˜¯å¦åŒ¹é…æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„`postMessage`æ•£åˆ—ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å°†è¿›å…¥`return`,è¿™æ ·å…¶ä½™çš„å¯¼èˆªçŠ¶æ€æ”¹å˜äº‹ä»¶ç›‘å¬å™¨å°±ä¸ä¼šè§¦å‘ã€‚è¿™æ˜¯ä¸€ä¸ªæ¶ˆæ¯äº‹ä»¶ï¼Œè€Œä¸æ˜¯å¯¼èˆªçŠ¶æ€çš„æ”¹å˜(æ’‡å¼€æŠ€æœ¯ä¸è°ˆ)ã€‚

æ¯ä¸ª`postMessage`äº‹ä»¶å°†è§¦å‘ä¸¤æ¬¡å¯¼èˆªçŠ¶æ€æ”¹å˜â€”â€”ä¸€æ¬¡é’ˆå¯¹`loading: true`,å¦ä¸€æ¬¡å‡ ä¹ç´§æ¥ç€é’ˆå¯¹`loading: false`ã€‚æˆ‘ä»¬åªç›‘å¬`loading: true`äº‹ä»¶ï¼Œå› ä¸ºå®ƒé¦–å…ˆå‘ç”Ÿã€‚`loading: false`äº‹ä»¶è¢«å¿½ç•¥ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸€ä¸ªå‰¯æœ¬ã€‚

åªæœ‰å½“çˆ¶ç»„ä»¶ä¼ é€’äº†ä¸€ä¸ª`onMessage`äº‹ä»¶å¤„ç†ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬æ‰ä½¿ç”¨åŒ…å«æ¶ˆæ¯çš„æ¨¡æ‹Ÿäº‹ä»¶è°ƒç”¨è¯¥å¤„ç†ç¨‹åºã€‚æˆ‘ä»¬åœ¨ä¼ é€’æ¶ˆæ¯ä¹‹å‰å¯¹å…¶è¿›è¡Œäº†è½¬ä¹‰ï¼Œå› ä¸ºæˆ‘ä»¬ä¹‹å‰å¯¹æ’‡å·è¿›è¡Œäº†è½¬ä¹‰ã€‚

unescape å‡½æ•°è¢«å®šä¹‰åœ¨æ–‡æ¡£çš„é¡¶éƒ¨ï¼Œå› ä¸ºå®ƒæ˜¯å¸¸é‡(ä¸ä¾èµ–äºå®ä¾‹)å¹¶ä¸”ä¸éœ€è¦æˆä¸ºç»„ä»¶çš„æ–¹æ³•ã€‚å¦‚æœä½ å–œæ¬¢ä»£ç åˆ†å‰²ï¼Œä½ å¯ä»¥å¯¼å…¥å®ƒã€‚

```
const unescape = str =>
  str.replace(/\\'/g, '\''); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### onnavigationstachangeğŸ•µ

ä»¥ä¸Šæ¶µç›–äº†æˆ‘ä»¬æ‹¦æˆª`window.postMessage`å’Œç”¨è‡ªå·±çš„`onMessage`äº‹ä»¶ç›‘å¬å™¨å¤„ç†å®ƒæ‰€éœ€çš„ä¸€åˆ‡ã€‚æˆ‘ä»¬åŸæ¥çš„é—®é¢˜å·²ç»è§£å†³äº†â€”â€”`onMessage`ä½¿ç”¨è¿™ä¸ªç½‘ç»œè§†å›¾ã€‚ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬å·²ç»è¦†ç›–äº†å†…éƒ¨çš„`onNavigationStateChange`ç›‘å¬å™¨ï¼Œçˆ¶èŠ‚ç‚¹ä¸å†æ¥æ”¶å¯¼èˆªçŠ¶æ€æ”¹å˜äº‹ä»¶ã€‚

åœ¨`handleNavigationStateChange`äº‹ä»¶ç›‘å¬å™¨çš„åº•éƒ¨ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹:

```
if (this.props.onNavigationStateChange) {
  return this.props.onNavigationStateChange(e);
}
return; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœçˆ¶å…ƒç´ åŒ…å«äº†ä¸€ä¸ª`onNavigationStateChange`å±æ€§ï¼Œè°ƒç”¨å®ƒï¼Œå¹¶ç»™å®ƒè¿™ä¸ªå¯¼èˆªçŠ¶æ€æ”¹å˜äº‹ä»¶ã€‚

ç©ºè¿”å›åªæ˜¯ä¸ªäººåå¥½â€”â€”æˆ‘ä¸è®¤ä¸ºå‡½æ•°åº”è¯¥æœ‰æ¡ä»¶åœ°è¿”å›ï¼Œå³ä½¿å®ƒåœ¨åŠŸèƒ½ä¸Šç­‰åŒäºéšå¼è¿”å›ã€‚

## [](#conclusion)ç»“è®ºğŸ”š

æé†’ä¸€ä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡å®‰è£…æ¥è‡ª NPM çš„ [`rn-webview`åŒ…](https://www.npmjs.com/package/rn-webview)æ¥åŒ…å«åˆšæ‰æ¦‚è¿°çš„ç»„ä»¶ã€‚ä¹Ÿå¯ä»¥åœ¨ GitHub ä¸Šå‰å‰ã€‚

å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·éšæ„ç»™å®ƒä¸€ä¸ªå¿ƒå½¢æˆ–ç‹¬è§’å…½ã€‚åˆå¿«åˆç®€å•ï¼Œè¿˜å…è´¹ï¼å¦‚æœä½ æœ‰ä»»ä½•ç›¸å…³è¯„è®ºï¼Œè¯·åœ¨ä¸‹é¢çš„è¯„è®ºä¸­ç•™ä¸‹ã€‚

è¦é˜…è¯»æ›´å¤šæˆ‘çš„ä¸“æ ï¼Œä½ å¯ä»¥åœ¨ [LinkedIn](https://www.linkedin.com/in/charles-stover) ã€ [Medium](https://medium.com/@Charles_Stover) å’Œ [Twitter](https://twitter.com/CharlesStover) ä¸Šå…³æ³¨æˆ‘ï¼Œæˆ–è€…[åœ¨ CharlesStover.com](https://charlesstover.com/)ä¸ŠæŸ¥çœ‹æˆ‘çš„ä½œå“é›†ã€‚*