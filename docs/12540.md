# å°å­˜ä¸€ä¸ªæ³¥å·´çƒ(æˆ–è€…ï¼Œæˆ‘å¦‚ä½•ä»å®šåˆ¶è½¯ä»¶è½¬ç§»åˆ° Jekyll)

> åŸæ–‡:[https://dev . to/stegriff/mothballing-a-mudball-or-how-I-moved-from-custom-software-to-Jekyll-e3o](https://dev.to/stegriff/mothballing-a-mudball-or-how-i-moved-from-custom-software-to-jekyll-e3o)

*åŸæ¥åœ¨[https://stegriff.co.uk/upblog/mothballing-a-mudball/](https://stegriff.co.uk/upblog/mothballing-a-mudball/)T3ã€‘*

2014 å¹´ï¼Œæˆ‘æ”¾å¼ƒäº† Wordpressï¼Œåœ¨æˆ‘çš„ PHP å¼€å‘é«˜å³°æœŸï¼Œæˆ‘å†³å®šç”¨è¿™äº›è®¾è®¡ç›®æ ‡æ¥å¼€å‘ä¸€äº›å®šåˆ¶çš„åšå®¢è½¯ä»¶:

1.  è®©æˆ‘å†™åœ¨é™ä»·
2.  è®©æˆ‘ç”¨ FTP ä»ä»»ä½•åœ°æ–¹ä¸Šä¼ 
3.  è®©æˆ‘é€šè¿‡æ›´æ–°å¸–å­æ¥å°†å¸–å­â€œæå‡â€åˆ°å¸–å­åˆ—è¡¨çš„é¡¶éƒ¨

åƒ Jekyll è¿™æ ·çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨(SSG)å·²ç»å­˜åœ¨äº†ã€‚ä½†æ˜¯å½“æ—¶æˆ‘ä»ç„¶è¢« git éƒ¨ç½²æµç¨‹å“åˆ°äº†ï¼Œæˆ‘è®¤ä¸ºæˆ‘æœ€äº†è§£ PHP ä¸­çš„åŠ¨æ€è¡Œä¸ºçš„é‡è¦æ€§ã€‚

æˆ‘å»ºç«‹äº†ä¸€ä¸ªåšå®¢ï¼Œåœ¨å®ƒè¿‘äº”å¹´çš„ä»»æœŸå†…ï¼Œæˆ‘å†™äº†å¤§çº¦ 130 ç¯‡æ–‡ç« (é€šå¸¸å¹³å‡é—´éš”åå¤©)ã€‚å†™åšå®¢å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå·¥ä½œæµç¨‹ç¬¦åˆæˆ‘æƒ³è¦çš„å·¥ä½œæ–¹å¼ã€‚æ‰€ä»¥è®¾è®¡ç›®æ ‡ 1 å’Œ 2 å¯¹æˆ‘æ¥è¯´å¾ˆé‡è¦ã€‚

å¦ä¸€æ–¹é¢ï¼Œè®¾è®¡ç›®æ ‡ 3 è¢«è¯æ˜æ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚æˆ‘æ²¡æœ‰å‘ç°æˆ‘æƒ³è¦å®ƒæˆ–è€…éœ€è¦å®ƒï¼Œæ‰€ä»¥æˆ‘å’Œè½¯ä»¶éƒ½å¿˜è®°äº†å®ƒğŸ™‚

## [](#problems)é—®é¢˜

Upblog å‡ºç°äº†æ–°çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚è¯¥è½¯ä»¶çš„ç¬¬ 1 ç‰ˆå°†ä¸ºæ¯ä¸ªè®¿é—®è€…è§£ææ¯ç¯‡åšå®¢æ–‡ç« (æ¥è‡ª source markdown )!ä¸€æ—¦æœ‰äº† 10 ç¯‡å·¦å³çš„å¸–å­ï¼Œè¿™å°±æˆäº†ä¸€ä¸ªå¤§é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘å¼•å…¥äº†ä¸€ä¸ªå…ƒæ•°æ®ç¼“å­˜ï¼Œæ¯”å¦‚å¸–å­æ ‡é¢˜ã€æ‘˜å½•å’Œé“¾æ¥ã€‚å½“æˆ‘ç‚¹å‡»ä¸€ä¸ªç‰¹æ®Šçš„â€œ/load.phpâ€ç«¯ç‚¹æ—¶ï¼Œç¼“å­˜è¢«é‡æ–°æ„å»ºï¼Œä¸ºæˆ‘çš„éƒ¨ç½²è¿‡ç¨‹å¢åŠ äº†ä¸€ä¸ª(å°çš„)é¢å¤–æ­¥éª¤ã€‚

å½“æˆ‘çœ‹åˆ° 100 ä¸ªå¸–å­å·¦å³æ—¶ï¼Œåšå®¢(T2 æ‰€æœ‰å¸–å­çš„åˆ—è¡¨)çš„[ä¸»é¡µå˜å¾—å¾ˆæ…¢ã€‚æˆ‘å¯¹å®ƒè¿›è¡Œäº†é‡æ„ï¼Œä½¿ç”¨ AJAX åŠ è½½å¸–å­æ‘˜è¦(ä½œä¸º HTML éƒ¨åˆ†è§†å›¾)ï¼Œè¿™æ ·é¡µé¢å°±ä¼šç«‹å³å‡ºç°ï¼Œå‡ ç§’é’Ÿåå°±ä¼šæ˜¾ç¤ºå¸–å­ã€‚](https://stegriff.co.uk/upblog/)

[![Bart makes a muddy snowman using snow from under the car](../Images/005a6c33c8d36780be06cfcbe764a24a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Iz4zZLH3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/jteeaejzoh4h7ezcezde.jpg)

ç„¶åï¼Œæˆ‘æƒ³åœ¨æˆ‘çš„ç«™ç‚¹çš„é¦–é¡µä¸Šå±•ç¤ºä¸€äº›å¸–å­ï¼Œä½¿ç”¨ç¨å¾®ä¸åŒçš„æ•°æ®è§†å›¾ï¼Œæ‰€ä»¥é™¤äº†ç°æœ‰çš„ HTML å±€éƒ¨è§†å›¾ä¹‹å¤–ï¼Œæˆ‘è¿˜å¿…é¡»å¼•å…¥ä¸€ä¸ª JSON ç«¯ç‚¹ã€‚

...æ‰€æœ‰è¿™äº›å¼€å‘ä»»åŠ¡éƒ½æ˜¯ç”±åŸå§‹è½¯ä»¶çš„è®¾è®¡å’Œå¤æ‚æ€§é©±åŠ¨çš„ï¼Œè€Œä¸æ˜¯ç”±çœŸæ­£çš„åŠŸèƒ½éœ€æ±‚é©±åŠ¨çš„ã€‚ç°åœ¨ï¼ŒUpblog ä¸å†å¸®åŠ©æˆ‘äº†ï¼›å®ƒå¦¨ç¢äº†æˆ‘ã€‚æˆ‘çš„å­©å­å·²ç»é•¿æˆäº†ä¸€ä¸ªæ³¥çƒã€‚

è‡³äºå®‰å…¨æ€§ï¼Œç”±äºæˆ‘çš„ PHP å…±äº«ä¸»æœºçš„åŸºç¡€è®¾æ–½â€”â€”æ²¡æœ‰ shell è®¿é—®ï¼Œå¹¶ä¸”ä¸æˆ‘çš„åŸŸåä¸»æœºåˆ†ç¦»â€”â€”å¾ˆéš¾ç”¨ LetsEncrypt æ·»åŠ  HTTPSã€‚æ‰€ä»¥æˆ‘åšæŒä½¿ç”¨ HTTPï¼Œè¿™éœ€è¦æ”¹å˜ã€‚

ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ç”¨ Jekyll ä¸ºå·¥ä½œã€æ•™å ‚å’Œå°é¡¹ç›®åˆ›å»ºäº†ç½‘ç«™ï¼Œæˆ‘å¯¹ SSGs å’Œ git çš„ææƒ§å·²ç»æ¶ˆå¤±äº†ã€‚

## [](#migrating)è¿å¾™

Upblog å¸–å­æ˜¯æœªç»åŠ å·¥çš„ï¼Œæ²¡æœ‰æ­£é¢å†…å®¹ã€‚å½“ç«™ç‚¹ç¼–è¯‘å®ƒä»¬æ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª JSON å…ƒæ•°æ®æ–‡ä»¶(æ¯”å¦‚ post date)ã€‚è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸€èµ·å‘Šè¯‰ä½ å…³äºå¸–å­çš„ä¸€åˆ‡ã€‚æˆ‘ç¼–å†™äº†ä¸€ä¸ª C#è„šæœ¬ï¼Œå°†æ¯ä¸€å¯¹æ–‡ä»¶è¿ç§»åˆ°ä¸€ä¸ª Jekyll markdown æ–‡ä»¶ä¸­ï¼›å®ƒå®é™…ä¸Šåªæ˜¯åœ¨æ¯ä¸ªæ–‡ä»¶åçš„å‰é¢å¼•å…¥äº†ä¸€ä¸ªâ€œyyyy-MM-ddâ€æ—¥æœŸã€‚ä»ç„¶æ²¡æœ‰å‰æ²¿é—®é¢˜ã€‚

[![Pairs of markdown and JSON files in Filezilla](../Images/e9402f69f754b76af84bc53df37270ac.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--JH-PahRt--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/bsie3t7xi1grpnacnhe6.png)

ä»è¿™é‡Œå¼€å§‹ï¼Œå¾ˆå®¹æ˜“ä¿®æ”¹æˆ‘çš„ PHP æ¨¡æ¿çš„`require`è¯­æ³•ï¼Œä½¿ç”¨ Liquid `include`æ¥ä»£æ›¿ã€‚æˆ‘å‘ç° Jekyll æ’ä»¶ Ruby Gems çš„æ—¥æœŸç®—æ³•ä¸ Upblog ç›¸ä¼¼ï¼Œå…¶ä»–æ’ä»¶åˆ™æ¶ˆé™¤äº†å¯¹å¤§å¤šæ•°é…ç½®çš„éœ€æ±‚:

```
 plugins:
\- jekyll-optional-front-matter
\- jekyll-default-layout
\- jekyll-feed
\- jekyll-timeago
\- jekyll-titles-from-headings

~~~~

## GitHub Pages vs Netlify

I didn't realise at first that you can't run "any old plugin" on GitHub Pages (GHP). GHP is an intentionally limited platform, expected to compile fairly vanilla sites. They don't want to run arbitrary Ruby code on there, and I get it.

Netlify, in contrast, is a more fully-featured container...izer... giving you the liberty to compile whatever the heck you want. So I moved my build process there. I just used the web interface (not the CLI) to set up, and it wasn't hard.

## Legacy and Redirects

I am keen to never break a link. **[The best URLs are the ones that never change][timbl]**.

But I knew that if I pointed <https://stegriff.co.uk> to my Netlify site, it would break a lot of links to old content on my PHP server. The site goes back much further than the Upblog era, with plenty of externally-linked content dating back as far as 2008\. So I have a two step plan:

 1\. Leave the old server up at `files.stegriff.co.uk` and try to give visitors helpful 404 pages which get them back on track to the right resource, and
 2\. Gradually migrate frequently-accessed content to the Netlify site

This introduced a new risk; having two copies of my blog online. Doing that would wreck SEO and also provide a confusing visitor experience (I'd applied a new style to the new version)

![Michael Scott shouting, I Declare Bankruptcy](https://media.giphy.com/media/2PzAbPcFBdNgk/giphy.gif)

As a result, I hamstrung the Upblog software's `index.php` (the file responsible for handling all requests and redirecting you to a rendered post), replacing it with a clever redirect to the *corresponding post* on the new site. Any non-post requests just go to the stegriff index page.

There were a few other things to tweak, like the netlify `_redirects` file, and some DNS-level stuff. With config in so many places, I knew I needed documentation, so I wrote an `infrastructure.md` file in my website repo which tells future Ste anything he needs to know!

[timbl]: https://www.w3.org/Provider/Style/URI

## Outcomes 

![Green lock icon in address bar](https://thepracticaldev.s3.amazonaws.com/i/9ji0w8m1nrimbhnniwic.png)

Outcomes have been great:

 * I'm on HTTPS
 * Deployment is actually easier than ever (git is pretty much as ubiquitous as FTP, plus no more `/load.php` step)
 * It's easier to add new features
 * Site speed has increased enormously (static HTML is much faster than a ponderous PHP script!)

There were other small wins, like removing jQuery as a dependency, because I no longer load front page posts via AJAX.

## Lessons

 + **Do** try to find a blogging system that fits your mind
 + **Do** invest the time in giving existing systems the benefit of the doubt, and trying them out
 + **Don't** reinvent the wheel!
 + **Do** pause, analyse, and calibrate your choices when possible

As this post is syndicated on dev.to, I wonder what you think? If you've been through a similar journey, link your story in the comments. Have you ever declared URL bankruptcy and just broken every link on your website? What do you think of Netlify and Jekyll?

Thanks for reading my long story!

*Original at <https://stegriff.co.uk/upblog/mothballing-a-mudball/>* 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>