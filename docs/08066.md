# ååº”ä¸­çš„æ¶Ÿæ¼ªæ•ˆåº”

> åŸæ–‡:[https://dev.to/dhilipkmr/ripple-effect-in-react-3kl5](https://dev.to/dhilipkmr/ripple-effect-in-react-3kl5)

[![](../Images/ed0565b92b9e0c3d88d55bdf47630daf.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--uFvBNub1--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/n1lzgyw9q0s8u9eannth.png)

é‡è¦çš„äº‹æƒ…å…ˆæ¥ã€‚å¾ˆé«˜å…´æˆ‘ä¹‹å‰çš„å¸–å­è¢«æ¨ç‰¹ä¸Šçš„ [@thepracticaldev](https://dev.to/thepracticaldev) åˆ†äº«äº†ã€‚
éå¸¸æ„Ÿè°¢ğŸ˜‹å¯¹æˆ‘æ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„åŠ¨åŠ›ğŸ˜‹
å¦‚æœä½ é”™è¿‡äº†ï¼Œå»[è¿™é‡Œ](https://dev.to/dhilipkmr/cursor-imitator-2p0j)

è¿‘æ—¥æ¥ï¼Œè¿é”ååº”æ­£æˆä¸ºä¸€ä¸ªæœ‰è¶£çš„è¯é¢˜ã€‚è™½ç„¶æœ‰åƒ [material-ui](https://material-ui.com/) è¿™æ ·çš„åº“æ¥å¸®åŠ©å®ç°è¿™ç§è¡Œä¸ºï¼Œä½†æ˜¯ç†è§£æˆ‘ä»¬å¦‚ä½•åœ¨ä¸ä¾èµ–å¤–éƒ¨åº“çš„æƒ…å†µä¸‹è‡ªå·±å®ç°è¿™ä¸€ç‚¹æ˜¯å¾ˆé‡è¦çš„ã€‚

## [](#what-is-ripple-effect)ä»€ä¹ˆæ˜¯æ¶Ÿæ¼ªæ•ˆåº”ï¼Ÿ

[![](../Images/2f53c1d85b56581022b77b376c5d2a13.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--bYHINCWD--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/gt2m0ng7hr7kzrc8km5b.gif)

å½“æˆ‘ä»¬æŠŠä¸€å—çŸ³å¤´æ‰”è¿›æ± å­é‡Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå®ƒä»¥ä¸€ç§æºäºçŸ³å¤´ä¸æ°´æ¥è§¦ç‚¹çš„**æ¨¡å¼ã€æ³¢çº¹ã€‘åœ¨æ°´æ± ä¸­åˆ¶é€ å‡º**æ— åº**ã€‚**

[![](../Images/76178f1d563142f6733a2a75a177c259.png)T2ã€‘](https://i.giphy.com/media/L20E2bh3ntSCc/giphy.gif)

ç±»ä¼¼åœ°ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æˆ–ç‚¹å‡»æŒ‰é’®ã€å›¾æ ‡ã€å›¾åƒç­‰æ—¶ã€‚çš„æƒ…å†µä¸‹ï¼Œæ³¢çº¹ä»ç›¸äº’ä½œç”¨ç‚¹çš„**å¼€å§‹ï¼Œæµç»æ•´ä¸ªç»„ä»¶ï¼Œæœ€ç»ˆæ¶ˆå¤±ã€‚**

## [](#how-to-create-a-ripple-effect-using-react-component)å¦‚ä½•ä½¿ç”¨ React ç»„ä»¶åˆ›å»ºæ¶Ÿæ¼ªæ•ˆæœï¼Ÿ

é¦–å…ˆï¼Œæˆ‘ä»¬å°†åœ¨ React ä¸­åŒ…å«ç”¨äºå‘ˆç°æŒ‰é’®çš„ **boiler plate** ä»£ç ã€‚

```
.btn {
  margin: 50px auto;
  border-radius: 25px;
  background-color: #5300e8;
  box-shadow: 0 2px 4px 0 #888888;
  display: inline-block;
  padding: 15px 50px;
  color: #ffffff;
}
.center {
  text-align: center;
} 
```

```
class Ripple extends React.Component {
  initializeState = () => {
    return {
      spanStyles: {},
      count: 0
    }
  }
  state = this.initializeState();
  render() {
    const {children = null, classes="", onClickHandler=null} = this.props;
    return (
      <div className={classes} onClick={this.onClickHandler}>
        {children}
      </div>
    );
  }
}

const App = (
  <div className="center">
    <Ripple classes="btn">Click Me</Ripple>
  </div> );

ReactDOM.render(App, document.getElementById("app")); 
```

### [](#explanation)è§£é‡Š:

### CSS boilerplateripple . CSS

é¢œè‰²å’ŒæŒ‰é’®å¯¹é½å®Œæˆã€‚

### [](#jsrippleboilerplatejs)JsRippleBoilerPlate.js

*   `initializeState()`è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†ç¬¬ä¸€æ¬¡è®¾ç½®ä¸ºæŸä¸ªçŠ¶æ€ï¼Œå¹¶åœ¨éœ€è¦å¤ä½æ—¶è¿”å›ã€‚
*   è¿™é‡Œçš„`count`æŒ‡çš„æ˜¯åœ¨ç»„ä»¶æ¸…é™¤è·¨åº¦ä¹‹å‰ç”¨æˆ·è¿ç»­ç‚¹å‡»**çš„æ¬¡æ•°**ï¼Œä¸€æ—¦æ¸…é™¤ï¼Œè®¡æ•°å™¨é‡ç½®ä¸º 0ã€‚å¯¹äºæ¯ä¸€æ¬¡ç‚¹å‡»ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ ¹æ®ç”¨æˆ·ç‚¹å‡»çš„åæ ‡è®¾ç½®æ–°çš„ä½ç½®ï¼Œå› æ­¤æˆ‘ä»¬å°†ä¸ºæ¯ä¸€æ¬¡è®¡æ•°è®¾ç½®ä¸€ä¸ªå”¯ä¸€çš„ spanStyles å€¼ã€‚
*   JSX `App`å‘ˆç°åœ¨ id ä¸ºâ€œappâ€çš„å…ƒç´ å†…ã€‚
*   `App`æ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œå…¶å†…éƒ¨æœ‰ä¸€ä¸ª**åˆ†é‡å£°æ˜(æ³¢çº¹)**ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¼ é€’æ‚¨å¸Œæœ›æ·»åŠ åˆ° Ripple å‘ˆç°çš„**å®é™…å…ƒç´ **ä¸­çš„ç±»ã€å¤„ç†ç¨‹åºå’Œå…¶ä»–å±æ€§ã€‚
*   `Ripple`æ˜¯ä¸€ä¸ª**æœ‰çŠ¶æ€ç»„ä»¶**ï¼Œå®ƒé€šè¿‡å°†å®ƒåŒ…è£…åœ¨ä¸€ä¸ª div ä¸­è¿”å›å­ç»„ä»¶ã€‚åœ¨å®ƒçš„æœ«å°¾ï¼Œæˆ‘ä»¬æœ‰ä¸‹é¢çš„æŒ‰é’®ã€‚

[![](../Images/e354c07935e43c8f52a2e2a0c48fc7f3.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--daOm0uks--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/mchr7z8rjxcu8nu8358a.png)

## [](#ripple%E2%80%8A%E2%80%8Aoverview)æ³¢çº¹â€”æ¦‚è¿°

è®©æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹æ¶Ÿæ¼ª JSX æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚

```
<div class="ripple">
  {props.children}
  <div class="rippleContainer">
    <span><span>
  </div>
</div> 
```

*   `{props.children}`æ¸²æŸ“æˆ‘ä»¬ä»`App`ç»è¿‡çš„`<Ripple></Ripple>`é‡Œé¢çš„æ‰€æœ‰å­©å­ã€‚
*   åœ¨å‘ˆç°å­å…ƒç´ ä¹‹åï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª div ( `rippleContainer`)é™„åŠ åˆ°çˆ¶å…ƒç´ ä¸Šã€‚
*   å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼ŒSpan è¢«åˆ›å»ºä¸º`rippleContainer`çš„å­èŠ‚ç‚¹ã€‚
*   æˆ‘ä»¬åœ¨è¿™ä¸ªè·¨åº¦ä¸­æ·»åŠ äº†ä¸€äº› css ç±»å’ŒåŠ¨ç”»(ç¨åè§£é‡Š),è¿™æ ·æˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªæ¶Ÿæ¼ªæ•ˆåº”ã€‚
*   æœ€åï¼Œåœ¨åŠ¨ç”»å®Œæˆåï¼Œæˆ‘ä»¬**ç§»é™¤**`<span>`ã€‚

[![](../Images/cba6f10ca92b4163f2336dce49512785.png)T2ã€‘](https://i.giphy.com/media/107pNN5KioUJs4/giphy.gif)

## [](#lets-ripple-)å’±ä»¬æ¶Ÿæ¼ª:)

æ›´æ–°æ³¢çº¹ç»„ä»¶çš„æ¸²æŸ“æ–¹æ³•ã€‚

```
render() {
    const {children= null, classes = "", onClickHandler = null} = this.props;
    return (
        <div ref="targetElement" className={'ripple ' + classes} onClick={onClickHandler}>
            {children}
            <div className="rippleContainer" onMouseDown={this.showRipple} onMouseUp={this.callCleanUp(this.cleanUp, 2000)}>
                {this.renderRippleSpan()}
            </div>
        </div>
    );
} 
```

```
.ripple {
  position: relative;
  overflow: hidden;
}
.ripple .rippleContainer {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
} 
```

*   æˆ‘ä»¬å°†`ripple`ç±»æ·»åŠ åˆ°çˆ¶ div ä¸­ï¼Œå¹¶åˆ†é…æ ·å¼ï¼Œä½¿å…¶æˆä¸º**ç›¸å¯¹çš„å’Œéšè—çš„æº¢å‡º**ã€‚
*   `rippleContainer` child è¢«è¿½åŠ åˆ° ripple divï¼Œæœ‰ä¸¤ä¸ªäº‹ä»¶`mousedown`(å¼€å§‹æ¶Ÿæ¼ªæ•ˆæœ)å’Œ`mouseup`(è§¦å‘è¶…æ—¶ç§»é™¤`span`)ã€‚
*   `this.renderRippleSpan()` -æ˜¯å¯¹**æ¸²æŸ“è·¨åº¦(æˆ‘ä»¬ç§°ä¹‹ä¸º Ripple :P)** çš„å‡½æ•°è°ƒç”¨

> ***æ³¨æ„:*** *å¯¹äºå…ƒç´ çš„æ¯ä¸ªæ–°ç‚¹å‡»ï¼Œä¸€ä¸ªæ–°çš„ span å­å…ƒç´ å°†è¢«è¿½åŠ åˆ°`rippleContainer`ä¸­ï¼Œå› æ­¤æœ‰å¿…è¦æ¸…ç† span ä»¥å‡å° DOM çš„å¤§å°ã€‚*

*   åœ¨ç»™`rippleContainer`åˆ†é… css æ ·å¼æ—¶ï¼Œå®ƒ**å®Œå…¨è¦†ç›–äº†å®ƒçš„çˆ¶å…ƒç´ **ã€‚æ‰€ä»¥ä»»ä½•ç‚¹å‡»éƒ½å°†é¦–å…ˆåˆ°è¾¾ div çš„å¤„ç†ç¨‹åºï¼Œç„¶åæ˜¯å®ƒçš„çˆ¶ç±»ã€‚

ç‚¹å‡»æŒ‰é’®â€¦

```
.ripple .rippleContainer span {
  transform: scale(0);
  border-radius: 100%;
  position: absolute;
  opacity: 0.75;
  background-color: #ffffff;
  animation: ripple 850ms;
}

@keyframes ripple {
  to {
    opacity: 0;
    transform: scale(2);
  }
} 
```

```
showRipple = (e) => {
    const rippleContainer = e.currentTarget;
    const size = rippleContainer.offsetWidth;
    const pos = rippleContainer.getBoundingClientRect();
    const x = e.pageX - pos.x - (size / 2);
    const y = e.pageY - pos.y - (size / 2);
    const spanStyles = { top: y + 'px', left: x + 'px', height: size + 'px', width: size + 'px' };
    const count = this.state.count + 1;
    this.setState({
      spanStyles: {...this.state.spanStyles, [count] : spanStyles},
      count: count
    });
  }

 renderRippleSpan = () => {
    const {showRipple = false, spanStyles = {}} = this.state;
    const spanArray = Object.keys(spanStyles);
    if (spanArray && spanArray.length > 0) {
      return (
        spanArray.map((key, index) => {
          return <span key={'spanCount_' + index} className="" style={{ ...spanStyles[key]}}></span>
        })
      )
    } else {
      return null;
    }
  } 
```

### [](#showripple-explained)showRipple è§£é‡Šé“â€¦

*   å½“æŒ‰é’®**è¢«ç‚¹å‡»æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨`showRipple(e)`å‡½æ•°ã€‚**
*   `currentTarget`ç»™å‡ºäº†å¤„ç†ç¨‹åºæ”¾ç½®åœ¨**ä¸Šçš„å…ƒç´ ï¼Œåœ¨æœ¬ä¾‹ä¸­æ˜¯å…·æœ‰`rippleContainer`ç±»çš„ divã€‚**
*   ç„¶åï¼Œæˆ‘ä»¬æ‰¾åˆ°`rippleContainer`çš„**å®½åº¦**ã€‚
*   `getBoundingClientRect()`æ˜¯ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç»™å‡ºå…ƒç´ åœ¨é¡µé¢ä¸­çš„ä½ç½®(å³ã€ä¸Šã€ä¸‹ã€å·¦ã€å®½ã€é«˜ã€x å’Œ y)
*   `x`å’Œ`y`æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªæ•°å­¦å…¬å¼æ¥è®¡ç®—é¼ æ ‡åœ¨æŒ‰é’®å†…éƒ¨çš„äº¤ç‚¹ã€‚`e.pageX`å’Œ`e.pageY`ç»™å‡ºæ¥è§¦ç‚¹ç›¸å¯¹äºæ•´ä¸ªé¡µé¢çš„ X å’Œ Y åæ ‡ã€‚
*   ç„¶åæˆ‘ä»¬å°†ä¸Šé¢è·å¾—çš„ä¿¡æ¯æ·»åŠ åˆ°`spanStyles`å¯¹è±¡ä¸­ã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¯¥æ ·å¼ä½œä¸º span å…ƒç´ çš„å†…è”æ ·å¼ã€‚
*   ç”±äºçŠ¶æ€æ›´æ–°åœ¨ React ä¸­æ˜¯**å¼‚æ­¥çš„ï¼Œæˆ‘ä»¬å¢åŠ äº†è®¡æ•°å™¨**ï¼Œå¹¶åˆ©ç”¨å®ƒå°†æ¯æ¬¡ç‚¹å‡»çš„ç‹¬ç‰¹é£æ ¼å­˜å‚¨åˆ°`spanStyle`å±æ€§ä¸­ã€‚æœ€åï¼Œæˆ‘ä»¬æ­£åœ¨**è®¾ç½®**å’Œ`state`ã€‚
*   `renderRippleSpan()` -ä¸€ä¸ªç›¸å½“ç®€å•çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°†ä¸ºæ¯ç§é£æ ¼æ¸²æŸ“è·¨åº¦ï¼Œè¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºç”¨æˆ·å¯ä»¥åŒæ—¶ç‚¹å‡»æŒ‰é’®**ã€‚**

### [](#css-explained)css è§£é‡Šâ€¦

*   æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å†…éƒ¨è·¨åº¦ï¼Œ`transform: scale(0)`æ”¾å¤§å…ƒç´ åˆ° 0%,æˆ‘ä»¬æ·»åŠ è‡ªå®šä¹‰åŠ¨ç”»æ•ˆæœï¼Œå¹¶ç»™å®ƒä¸€ä¸ªåå­—`ripple`

åœ¨å…³é”®å¸§ä¸­å®šä¹‰`ripple`åŠ¨ç”»ã€‚åŠ¨ç”»æŒç»­ 850 æ¯«ç§’ï¼Œåœ¨ 850 æ¯«ç§’çš„è¿‡ç¨‹ä¸­ï¼Œè·¨åº¦çš„ä¸é€æ˜åº¦åº”è¯¥ä» 0.75 å‡å°‘åˆ° 0(æœ‰åŠ©äºåœ¨æ³¢çº¹æ•ˆæœç»“æŸæ—¶éšè—æ³¢çº¹)ï¼Œå¹¶ä¸”**ç¼©æ”¾**åº”è¯¥ä» 0%å¢åŠ åˆ° 200%(ä½¿è·¨åº¦çš„èƒŒæ™¯é¢œè‰²å¯è§)ã€‚

## [](#tadaaaaaa)Tadaaaaaaâ€¦..ï¼

[![](../Images/128a5cee8aba6276e7a02a98bdfccfa1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--rb1WD0uN--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/qibsu852xtpdhyu2u399.gif)

ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†è¿é”ååº”ï¼Œæˆ‘ä»¬å¿…é¡»**ç§»é™¤å·²ç»äº§ç”Ÿçš„`span`** ã€‚ç§»é™¤è·¨åº¦åŒ…æ‹¬å°†**å»æŠ–åŠŸèƒ½**æ·»åŠ åˆ°ä»£ç ä¸­ï¼Œå› ä¸ºå¦‚æœç”¨æˆ·åœ¨å®Œæˆå‰ä¸€æ¬¡ç‚¹å‡»çš„è¿‡æ¸¡ä¹‹å‰**è¿ç»­ç‚¹å‡»**ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åˆ é™¤æ‰€æœ‰è·¨åº¦ï¼Œå› ä¸ºè¿™å°†å½±å“**è¿›ç¨‹ä¸­æœ€åä¸€æ¬¡ç‚¹å‡»çš„è·¨åº¦ã€‚**

æ‰€ä»¥æˆ‘ä»¬ç­‰å¾…ä¸€æ®µç‰¹å®šçš„æ—¶é—´(æ¯”å¦‚ 2000 æ¯«ç§’)ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰å¾—åˆ°ä»»ä½•ç‚¹å‡»ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä» DOM ä¸­åˆ é™¤ spanã€‚ç­‰å¾…æ—¶é—´åº”è¯¥å¤§äº**åŠ¨ç”»è¿‡æ¸¡æ—¶é—´ã€‚**

```
cleanUp = () => {
  const initialState = this.initializeState();
  this.setState({ ...initialState });
}

callCleanUp = (cleanup, delay) => {
  return function() {
    clearTimeout(this.bounce);
    this.bounce = setTimeout(() => {
      cleanup();
    }, delay);
  }
} 
```

*   æˆ‘ä»¬åœ¨`mouseup`å¯åŠ¨`callCleanup`ã€‚
*   æ³¨æ„: **`callCleanup()`** è¿”å›ä¸€ä¸ªå‡½æ•°ã€‚è¿”å›çš„å‡½æ•°åœ¨`mouseup`æ—¶è¢«è°ƒç”¨
*   è¶…æ—¶åŠŸèƒ½ï¼Œæœ‰åŠ©äºåœ¨æŒ‡å®šçš„å»¶è¿Ÿåç§»é™¤é‡ç¨‹ã€‚
*   **å»æŠ–ã€‚**æ¯å½“ç”¨æˆ·æŒç»­ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬æ¸…é™¤ä¹‹å‰è®¾ç½®çš„è¶…æ—¶ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šå½±å“æ­£åœ¨è¿›è¡Œçš„è½¬æ¢ï¼Œä¸€æ—¦æˆ‘ä»¬æ²¡æœ‰ç‚¹å‡»è€Œç»è¿‡â€œå»¶è¿Ÿâ€æ¯«ç§’ï¼Œæˆ‘ä»¬å°±å¼€å§‹åˆ é™¤ spanã€‚
*   `cleanup()` **å°†**çŠ¶æ€é‡ç½®å›åŸå§‹çŠ¶æ€(å³æ— è·¨åº¦)ã€‚

å…³æ³¨æˆ‘æœ‰è¶£çš„å†…å®¹:P

æˆ‘çš„[æ¨ç‰¹](https://twitter.com/dhilipkmr_)

åœ¨è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„ CodePen ç¤ºä¾‹

[![](../Images/07588370cbcfebd1cec288c32888a816.png)T2ã€‘](https://i.giphy.com/media/a0Lgc1JvbfS4o/giphy.gif)

## [](#thats-all-folks)é‚£éƒ½æ˜¯ä¹¡äº²ä»¬ï¼