# PHP ä¸­çš„å¯æ¢å¤æ–‡ä»¶ä¸Šä¼ :ä»¥ä¼˜é›…çš„æ–¹å¼å¤„ç†å¤§æ–‡ä»¶ä¸Šä¼ 

> åŸæ–‡:[https://dev . to/konsole/resumable-file-upload-in-PHP-handle-large-file-uploads-in-a-elegant-way-4a 84](https://dev.to/konsole/resumable-file-upload-in-php-handle-large-file-uploads-in-an-elegant-way-4a84)

> æ›¾ç»åœ¨ PHP ä¸­ä¸ºå¤§æ–‡ä»¶ä¸Šä¼ è€ŒæŒ£æ‰è¿‡å—ï¼Ÿæƒ³çŸ¥é“ä½ æ˜¯å¦å¯ä»¥ç»§ç»­ä¸Šä¼ ä½ ç¦»å¼€çš„åœ°æ–¹ï¼Œè€Œä¸éœ€è¦åœ¨ä»»ä½•ä¸­æ–­çš„æƒ…å†µä¸‹é‡æ–°ä¸Šä¼ å…¨éƒ¨æ•°æ®ï¼Ÿå¦‚æœè¿™å¬èµ·æ¥å¯¹ä½ æ¥è¯´å¾ˆç†Ÿæ‚‰ï¼Œé‚£ä¹ˆç»§ç»­è¯»ä¸‹å»ã€‚

æ–‡ä»¶ä¸Šä¼ æ˜¯æˆ‘ä»¬åœ¨å‡ ä¹æ‰€æœ‰ç°ä»£ web é¡¹ç›®ä¸­çš„ä¸€é¡¹å¸¸è§ä»»åŠ¡ã€‚æœ‰äº†æ‰€æœ‰ä¸åŒçš„å·¥å…·ï¼Œç”¨ä»»ä½•è¯­è¨€å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½éƒ½ä¸æ˜¯å¾ˆéš¾ã€‚ä½†æ˜¯ï¼Œå½“æ¶‰åŠåˆ°å¤§æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œäº‹æƒ…å˜å¾—æœ‰ç‚¹å¤æ‚ã€‚

æ¯”æ–¹è¯´ï¼Œä½ æ­£è¯•å›¾ä¸Šä¼ ä¸€ä¸ªç›¸å½“å¤§çš„æ–‡ä»¶ã€‚ä½ å·²ç»ç­‰äº†ä¸€ä¸ªå¤šå°æ—¶äº†ï¼Œä¸Šä¼ äº† 90%ã€‚ç„¶åçªç„¶ï¼Œä½ çš„è¿æ¥ä¸­æ–­æˆ–æµè§ˆå™¨å´©æºƒã€‚ä¸Šä¼ è¢«ä¸­æ­¢ï¼Œæ‚¨éœ€è¦ä»å¤´å¼€å§‹ã€‚ä»¤äººæ²®ä¸§ï¼Œä¸æ˜¯å—ï¼Ÿæ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœä½ çš„è¿æ¥é€Ÿåº¦å¾ˆæ…¢ï¼Œå°±åƒä¸–ç•Œä¸Šå¾ˆå¤šåœ°æ–¹ä¸€æ ·ï¼Œæ— è®ºä½ å°è¯•å¤šé•¿æ—¶é—´ï¼Œæ¯æ¬¡éƒ½åªèƒ½ä¸Šä¼ ç¬¬ä¸€éƒ¨åˆ†ã€‚

[![Basic TUS architecture](../Images/8cde9d353ff1576f7352c4858287a0ac.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Y1Az-0sG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1600/1%2Avf60tLKejXf1XZgBJcxhMw.png)

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€ä¸ªå°è¯•ï¼Œé€šè¿‡ä½¿ç”¨ tus åè®®ä¸Šä¼ å¯æ¢å¤å—ä¸­çš„æ–‡ä»¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

[https://www.youtube.com/embed/sHep0dLbMd4](https://www.youtube.com/embed/sHep0dLbMd4)

## [](#what-is%C2%A0tus)ä»€ä¹ˆæ˜¯ tusï¼Ÿ

Tus æ˜¯ä¸€ä¸ªåŸºäº HTTP çš„[å¼€æ”¾åè®®ï¼Œç”¨äºå¯æ¢å¤æ–‡ä»¶ä¸Šä¼ ](https://tus.io/)ã€‚å¯æ¢å¤æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç»§ç»­æˆ‘ä»¬ç¦»å¼€çš„åœ°æ–¹ï¼Œè€Œä¸éœ€è¦åœ¨ä»»ä½•ä¸­æ–­çš„æƒ…å†µä¸‹é‡æ–°ä¸Šä¼ å…¨éƒ¨æ•°æ®ã€‚å¦‚æœç”¨æˆ·æƒ³è¦æš‚åœï¼Œä¸­æ–­å¯èƒ½æ˜¯è‡ªæ„¿å‘ç”Ÿçš„ï¼Œæˆ–è€…åœ¨ç½‘ç»œé—®é¢˜æˆ–æœåŠ¡å™¨ä¸­æ–­çš„æƒ…å†µä¸‹å¶ç„¶å‘ç”Ÿçš„ã€‚

> Tus åè®®[äº 2017 å¹´ 5 æœˆè¢« Vimeo](https://medium.com/vimeo-engineering-blog/vimeo-is-adopting-tus-d5e999acd517) é‡‡ç”¨ã€‚

## [](#why-tus)ä¸ºä»€ä¹ˆæ˜¯ tusï¼Ÿ

å¼•ç”¨è‡ª [Vimeo çš„åšå®¢](https://medium.com/vimeo-engineering-blog/vimeo-is-adopting-tus-d5e999acd517):

> æˆ‘ä»¬å†³å®šåœ¨æˆ‘ä»¬çš„ä¸Šä¼ æ ˆä¸­ä½¿ç”¨ tusï¼Œå› ä¸º tus åè®®ä»¥ç®€æ´å’Œå¼€æ”¾çš„æ–¹å¼æ ‡å‡†åŒ–äº†ä¸Šä¼ æ–‡ä»¶çš„è¿‡ç¨‹ã€‚è¿™ç§æ ‡å‡†åŒ–å°†å…è®¸ API å¼€å‘äººå‘˜æ›´å¤šåœ°å…³æ³¨ä»–ä»¬çš„åº”ç”¨ç¨‹åºç‰¹å®šçš„ä»£ç ï¼Œè€Œä¸æ˜¯ä¸Šä¼ è¿‡ç¨‹æœ¬èº«ã€‚

ä»¥è¿™ç§æ–¹å¼ä¸Šä¼ æ–‡ä»¶çš„å¦ä¸€ä¸ªä¸»è¦å¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥ä»ç¬”è®°æœ¬ç”µè„‘å¼€å§‹ä¸Šä¼ ï¼Œç”šè‡³å¯ä»¥ç»§ç»­ä»æ‰‹æœºæˆ–ä»»ä½•å…¶ä»–è®¾å¤‡ä¸Šä¼ ç›¸åŒçš„æ–‡ä»¶ã€‚è¿™æ˜¯å¢å¼ºç”¨æˆ·ä½“éªŒçš„å¥½æ–¹æ³•ã€‚

<figure>

[![Basic Tus Architecture](../Images/054e91c513a02fafd421a20447c4a7d6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--6akJzIuM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ybitnimp708fds5csq1y.png)

<figcaption>Basic Tus Architecture</figcaption>

</figure>

## [](#getting-started)å…¥é—¨

è®©æˆ‘ä»¬ä»æ·»åŠ ä¾èµ–é¡¹å¼€å§‹ã€‚

```
$ composer require ankitpokhrel/tus-php 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[tus-php](https://github.com/ankitpokhrel/tus-php) æ˜¯ä¸€ä¸ªæ¡†æ¶ä¸å¯çŸ¥çš„çº¯ PHP [æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å®ç°](https://tus.io/implementations.html)ç”¨äº tus å¯æ¢å¤ä¸Šä¼ åè®® v1.0.0

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png)[ankitpokhrel](https://github.com/ankitpokhrel)/[tus-PHP](https://github.com/ankitpokhrel/tus-php)

### ğŸš€ç”¨äº tus å¯æ¢å¤ä¸Šä¼ åè®® v1.0.0 çš„çº¯ PHP æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯

<article class="markdown-body entry-content container-lg" itemprop="text">

# TusPHP

[![PHP Version](../Images/6de1fa1cd4681cf5dc567c38ee34d76e.png)](https://packagist.org/packages/ankitpokhrel/tus-php)[![Build Status](../Images/e4e1976f5246b9701ff341ddaaaf7c3b.png)](https://github.com/ankitpokhrel/tus-php/actions/workflows/ci.yml?query=branch%3Amain+is%3Acompleted)[![Code Coverage](../Images/f7c27de51d0e544aae9fe2d354b34b7c.png)](https://scrutinizer-ci.com/g/ankitpokhrel/tus-php)[![Scrutinizer Code Quality](../Images/8ed1d66263ef312a31cb65e1be5507e0.png)](https://scrutinizer-ci.com/g/ankitpokhrel/tus-php)[![Downloads](../Images/e4d72197de8c13d3bd198459f92ef238.png)](https://packagist.org/packages/ankitpokhrel/tus-php)[![Software License](../Images/bef0dd78b2319f6aa43444906a81e982.png)](https://github.com/ankitpokhrel/tus-php/blob/main/LICENSE)

*ä½¿ç”¨ [tus å¯æ¢å¤ä¸Šä¼ åè®® v 1 . 0 . 0](https://tus.io)T3ã€‘åœ¨ PHP ä¸­ä¸Šä¼ å¯æ¢å¤æ–‡ä»¶*

[![TusPHP Demo](../Images/31eb4f99c2663d50d055ffc47f218ed3.png)](https://github.com/ankitpokhrel/tus-php/blob/main/example/demo.gif) 

[ä¸­æ¡](https://medium.com/@ankitpokhrel/resumable-file-upload-in-php-handle-large-file-uploads-in-an-elegant-way-e6c6dfdeaedb) <g-emoji class="g-emoji" alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">âš¡</g-emoji> [æ‹‰å‹’ç»´å°”&æµæ˜æ•´åˆ](https://github.com/ankitpokhrel/tus-php/wiki/Laravel-&-Lumen-Integration) <g-emoji class="g-emoji" alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">âš¡</g-emoji> [Symfony æ•´åˆ](https://github.com/ankitpokhrel/tus-php/wiki/Symfony-Integration) <g-emoji class="g-emoji" alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">âš¡</g-emoji> [CakePHP æ•´åˆ](https://github.com/ankitpokhrel/tus-php/wiki/CakePHP-Integration) <g-emoji class="g-emoji" alias="zap" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/26a1.png">âš¡</g-emoji> [WordPress æ•´åˆ](https://github.com/ankitpokhrel/tus-php/wiki/WordPress-Integration)

[![](../Images/52ad1a1a2a4620e3ea80480739cc1877.png)T2ã€‘](https://opencollective.com/tus-php#backers)

tus æ˜¯ä¸€ä¸ªåŸºäº HTTP çš„åè®®ï¼Œç”¨äºå¯æ¢å¤çš„æ–‡ä»¶ä¸Šä¼ ã€‚å¯æ¢å¤æ„å‘³ç€æ‚¨å¯ä»¥ä»ä¸­æ–­çš„åœ°æ–¹ç»§ç»­ï¼Œè€Œæ— éœ€åœ¨ä»»ä½•ä¸­æ–­çš„æƒ…å†µä¸‹é‡æ–°ä¸Šä¼ å…¨éƒ¨æ•°æ®ã€‚å¦‚æœç”¨æˆ·æƒ³è¦æš‚åœï¼Œä¸­æ–­å¯èƒ½æ˜¯è‡ªæ„¿å‘ç”Ÿçš„ï¼Œæˆ–è€…åœ¨ç½‘ç»œé—®é¢˜æˆ–æœåŠ¡å™¨ä¸­æ–­çš„æƒ…å†µä¸‹å¶ç„¶å‘ç”Ÿçš„ã€‚

### ç›®å½•

*   [å®‰è£…](https://github.com/ankitpokhrel/tus-php#installation)
*   [ç”¨é€”](https://github.com/ankitpokhrel/tus-php#usage)
    *   [æœåŠ¡å™¨](https://github.com/ankitpokhrel/tus-php#server)
        *   [Nginx](https://github.com/ankitpokhrel/tus-php#nginx)
        *   [é˜¿å¸•å¥‡](https://github.com/ankitpokhrel/tus-php#apache)
    *   [å®¢æˆ·ç«¯](https://github.com/ankitpokhrel/tus-php#client)
    *   [ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯åº“](https://github.com/ankitpokhrel/tus-php#third-party-client-libraries)
    *   [äº‘æä¾›å•†](https://github.com/ankitpokhrel/tus-php#cloud-providers)
*   [æ‰©å±•æ”¯æŒ](https://github.com/ankitpokhrel/tus-php#extension-support)
    *   [åˆ°æœŸ](https://github.com/ankitpokhrel/tus-php#expiration)
    *   [ä¸²è”](https://github.com/ankitpokhrel/tus-php#concatenation)
*   [äº‹ä»¶](https://github.com/ankitpokhrel/tus-php#events)
    *   [å“åº”äº‹ä»¶](https://github.com/ankitpokhrel/tus-php#responding-to-an-event)
*   [ä¸­é—´ä»¶](https://github.com/ankitpokhrel/tus-php#middleware)
    *   [åˆ›å»ºä¸­é—´ä»¶](https://github.com/ankitpokhrel/tus-php#creating-a-middleware)
    *   [æ·»åŠ ä¸­é—´ä»¶](https://github.com/ankitpokhrel/tus-php#adding-a-middleware)
    *   [è·³è¿‡ä¸€ä¸ªä¸­é—´ä»¶](https://github.com/ankitpokhrel/tus-php#skipping-a-middleware)
*   [è®¾ç½®å¼€å‘ç¯å¢ƒå’Œ/æˆ–åœ¨æœ¬åœ°è¿è¡Œç¤ºä¾‹](https://github.com/ankitpokhrel/tus-php#setting-up-a-dev-environment-andor-running-examples-locally)
    *   [ç å¤´å·¥äºº](https://github.com/ankitpokhrel/tus-php#docker)
*   [æŠ•ç¨¿](https://github.com/ankitpokhrel/tus-php#contributing)
*   [å…³äºè¿™ä¸ªé¡¹ç›®çš„é—®é¢˜ï¼Ÿ](https://github.com/ankitpokhrel/tus-php#questions-about-this-project)
*   [æ”¯æŒè€…](https://github.com/ankitpokhrel/tus-php#supporters)

### è£…ç½®

é€šè¿‡ composer æå–åŒ…ã€‚

```
$ composer require ankitpokhrel/tus-php
// Use v1 for php7.1, Symfony 3 or 4.
```

â€¦<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg></article>

[View on GitHub](https://github.com/ankitpokhrel/tus-php)

> **æ›´æ–°** : Vimeo ç°åœ¨æ­£åœ¨ä¸º Vimeo API ä½¿ç”¨ä»–ä»¬[å®˜æ–¹ PHP åº“](https://github.com/vimeo/vimeo.php/pull/186) [v3](https://github.com/vimeo/vimeo.php/releases/tag/3.0.0) ä¸­çš„ [TusPHP](https://github.com/ankitpokhrel/tus-php) ã€‚

## [](#creating-a-server-to-handle-our%C2%A0requests)åˆ›å»ºæœåŠ¡å™¨æ¥å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚

è¿™æ˜¯ä¸€ä¸ªç®€å•æœåŠ¡å™¨çš„æ ·å­ã€‚

```
// server.php
$server   = new \TusPhp\Tus\Server('redis');

$response = $server->serve();

$response->send();

exit(0); // Exit from current PHP process. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨éœ€è¦é…ç½®æ‚¨çš„æœåŠ¡å™¨æ¥å“åº”ç‰¹å®šçš„ç«¯ç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨ Nginx ä¸­ï¼Œæ‚¨å¯ä»¥è¿™æ ·åš:

```
# nginx.conf

location /files {
    try_files $uri $uri/ /path/to/server.php?$query_string;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœåŠ¡å™¨çš„ URL æ˜¯ [http://server.tus.local](http://server.tus.local) ã€‚å› æ­¤ï¼ŒåŸºäºä¸Šé¢çš„ nginx é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ http://server.tus.local/files çš„ T2 æ¥è®¿é—®æˆ‘ä»¬çš„ tus ç«¯ç‚¹ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ RESTful ç«¯ç‚¹ã€‚

```
# Gather information about server's current configuration
OPTIONS /files

# Check if the given upload is valid
HEAD /files/{upload-key}

# Create a new upload
POST /files

# Resume upload created with POST
PATCH /files/{upload-key}

# Delete the previous upload
DELETE /files/{upload-key} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æŸ¥çœ‹[åè®®è¯¦æƒ…](https://tus.io/protocols/resumable-upload.html)äº†è§£æ›´å¤šå…³äºç«¯ç‚¹çš„ä¿¡æ¯ã€‚

> å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Laravel è¿™æ ·çš„æ¡†æ¶ï¼Œæ‚¨å¯ä»¥åœ¨æ¡†æ¶è·¯ç”±æ–‡ä»¶ä¸­å®šä¹‰åˆ°æ‰€æœ‰åŸºäº tu çš„ç«¯ç‚¹çš„è·¯ç”±ï¼Œè€Œä¸æ˜¯ä¿®æ”¹æ‚¨çš„æœåŠ¡å™¨é…ç½®ã€‚æˆ‘ä»¬å°†åœ¨å¦ä¸€ä¸ªæ•™ç¨‹ä¸­è¯¦ç»†ä»‹ç»è¿™ä¸€ç‚¹ã€‚

## [](#handling-upload-using-tusphp%C2%A0client)ä½¿ç”¨ tus-php å®¢æˆ·ç«¯å¤„ç†ä¸Šä¼ 

ä¸€æ—¦æœåŠ¡å™¨å°±ä½ï¼Œå°±å¯ä»¥ä½¿ç”¨å®¢æˆ·æœºæ¥ä¸Šä¼ æ–‡ä»¶ã€‚è®©æˆ‘ä»¬ä»åˆ›å»ºä¸€ä¸ªç®€å•çš„ HTML è¡¨å•æ¥è·å–ç”¨æˆ·è¾“å…¥å¼€å§‹ã€‚

```
<form action="upload.php" method="post" enctype="multipart/form-data">
    <input type="file" name="tus_file" id="tus-file" />
    <input type="submit" value="Upload" />
</form> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æäº¤è¡¨å•åï¼Œæˆ‘ä»¬éœ€è¦éµå¾ªå‡ ä¸ªæ­¥éª¤æ¥å¤„ç†ä¸Šä¼ ã€‚

#### [](#1-create-a-tusphp-client-object)1ã€‚åˆ›å»ºä¸€ä¸ª tus-php å®¢æˆ·ç«¯å¯¹è±¡

```
// Tus client
$client = new \TusPhp\Tus\Client('http://server.tus.local'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šé¢ä»£ç ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‚¨çš„ tus æœåŠ¡å™¨ç«¯ç‚¹ã€‚

#### [](#2-initialize-client-with-file-metadata)2ã€‚ç”¨æ–‡ä»¶å…ƒæ•°æ®åˆå§‹åŒ–å®¢æˆ·ç«¯

ä¸ºäº†ä¿æŒä¸Šä¼ çš„å”¯ä¸€æ€§ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€äº›æ ‡è¯†ç¬¦æ¥è¯†åˆ«å³å°†åˆ°æ¥çš„è¯·æ±‚ä¸­çš„ä¸Šä¼ ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ä¸Šä¼ å¯†é’¥ï¼Œç”¨äºä»¥åç»§ç»­ä¸Šä¼ ã€‚æ‚¨å¯ä»¥æ˜ç¡®æä¾›ä¸Šä¼ å¯†é’¥ï¼Œä¹Ÿå¯ä»¥è®©ç³»ç»Ÿè‡ªå·±ç”Ÿæˆå¯†é’¥ã€‚

```
// Set upload key and file meta
$client->setKey($uploadKey)
    ->file($_FILES['tus_file']['tmp_name'], 'your file name'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæ²¡æœ‰æ˜ç¡®æä¾›ä¸Šä¼ å¯†é’¥ï¼Œä¸Šè¿°æ­¥éª¤å°†ç±»ä¼¼äº:

```
$client->file($_FILES['tus_file']['tmp_name'], 'your file name');

$uploadKey = $client->getKey(); // Unique upload key 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

#### [](#3-upload-a-chunk)3ã€‚ä¸Šä¼ ä¸€å¤§å—

```
// $chunkSize is size in bytes, i.e. 5000000 for 5 MB
$bytesUploaded = $client->upload($chunkSize); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸‹ä¸€æ¬¡ï¼Œå½“ä½ æƒ³ä¸Šä¼ å¦ä¸€ä¸ªå—ï¼Œä½ å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ä¸Šä¼ é”®ç»§ç»­ã€‚

```
// To resume upload in next request
$bytesUploaded = $client->setKey($uploadKey)->upload($chunkSize); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šä¼ å®Œæˆåï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®æ ¡éªŒå’ŒéªŒè¯ä¸Šä¼ ï¼Œä»¥ç¡®ä¿ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰æŸåã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å°†ä½¿ç”¨`sha256`ç®—æ³•æ¥éªŒè¯ä¸Šä¼ ã€‚

> ä¸Šé¢æ¼”ç¤ºè§†é¢‘çš„å®Œæ•´å®ç°å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/ankitpokhrel/tus-php/tree/master/example/basic)æ‰¾åˆ°ã€‚

## [](#handling-upload-using-tusjsclient)ä½¿ç”¨ tus-js-client å¤„ç†ä¸Šä¼ 

Uppy æ˜¯ä¸€ä¸ªæ—¶é«¦çš„æ¨¡å—åŒ–æ–‡ä»¶ä¸Šä¼ æ’ä»¶ï¼Œç”±æ”¯æŒ tus åè®®çš„äººå¼€å‘ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ uppy å°†å®˜æ–¹çš„ [tus-js-client](https://github.com/tus/tus-js-client) ä¸ tus-php æœåŠ¡å™¨æ— ç¼é›†æˆã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä½¿ç”¨æœåŠ¡å™¨çš„ php å®ç°å’Œå®¢æˆ·æœºçš„ js å®ç°ã€‚

```
uppy.use(Tus, {
  endpoint: 'https://server.tus.local/files/', // your tus endpoint
  resume: true,
  autoRetry: true,
  retryDelays: [0, 1000, 3000, 5000]
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

> åœ¨ [uppy æ–‡æ¡£](https://uppy.io/docs/tus/)å’Œç¤ºä¾‹å®ç°[è¿™é‡Œ](https://github.com/ankitpokhrel/tus-php/tree/master/example/uppy)æŸ¥çœ‹æ›´å¤šç»†èŠ‚ã€‚

## [](#partial-uploads)éƒ¨åˆ†ä¸Šä¼ 

tus-php æœåŠ¡å™¨æ”¯æŒ[è¿æ¥æ‰©å±•](https://tus.io/protocols/resumable-upload.html#concatenation)ï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†å¤šä¸ªä¸Šä¼ è¿æ¥æˆå•ä¸ªä¸Šä¼ ï¼Œä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿæ‰§è¡Œå¹¶è¡Œä¸Šä¼ å’Œä¸Šä¼ ä¸è¿ç»­çš„å—ã€‚