# åˆ›å»º Vue.js ç»„ä»¶åº“:ç¬¬ä¸‰éƒ¨åˆ†â€”â€”æ•´åˆåˆ°æ’ä»¶ä¸­

> åŸæ–‡:[https://dev . to/sie gerts/consolidation-components-into-a-vue-js-plugin-NDC](https://dev.to/siegerts/consolidating-components-into-a-vue-js-plugin-ndc)

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª[ç»“æ„åŒ–çš„æ–¹æ³•](https://dev.to/siegerts/creating-a-vue-js-component-library-part-ii-structure-iph)æ¥åˆ›å»ºæ–°çš„ Vue.js ç»„ä»¶å¹¶å°†å®ƒä»¬åˆå¹¶åˆ°ä¸€ä¸ªæ¨¡å—å¯¼å‡ºä¸­ã€‚å‰å®³ï¼æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠç»„ä»¶æ†ç»‘åˆ°ä¸€ä¸ªæ’ä»¶ä¸­ï¼Œåœ¨ Vue å®ä¾‹ä¸Šæ³¨å†Œã€‚

è¯·è®°ä½ï¼Œåœ¨é¡¹ç›®åˆå§‹åŒ–æœŸé—´ï¼ŒVue CLI ä¼šåœ¨`/src`ç›®å½•çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª`main.js`å…¥å£ç‚¹æ–‡ä»¶ã€‚é€šå¸¸ï¼Œè¿™è¢«ç”¨ä½œæ–° Vue åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹ã€‚æˆ‘ä»¬å°†ä¿®æ”¹å®ƒæ¥åˆ›å»ºæ’ä»¶ã€‚

å¦‚æœä½ æ²¡æœ‰é˜…è¯»[ç³»åˆ—ä»‹ç»](https://dev.to/siegerts/creating-a-vue-js-component-library-part-i-introduction-2o9f)å°±ç™»é™†äº†è¿™ç¯‡æ–‡ç« ï¼Œå…ˆè·³åˆ°é‚£é‡Œã€‚

## [](#-raw-mainjs-endraw-entry-point)`main.js`å…¥å£ç‚¹

é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ é™¤ç”Ÿæˆçš„ä»£ç ã€‚æˆ‘ä»¬å°†æ›¿æ¢ä¸ºä¸‹é¢çš„å·®å¼‚ã€‚

```
// main.js

- import Vue from 'vue'
- import App from './App.vue' 
- Vue.config.productionTip = false

- new Vue({
-  render: h => h(App),
- }).$mount('#app') 
+ import * as components from './components'
+
+ const ComponentLibrary = {
+  install(Vue, options = {}) {
+    // components
+    for (const componentName in components) {
+      const component = components[componentName]
+
+      Vue.component(component.name, component)
+    }
+  }
+ }
+
+ export default ComponentLibrary
+
+ if (typeof window !== 'undefined' && window.Vue) {
+  window.Vue.use(ComponentLibrary)
+ } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯¥æ–‡ä»¶åº”è¯¥ç±»ä¼¼äº:

```
// main.js

import * as components from './components'

const ComponentLibrary = {
  install(Vue, options = {}) {
    // components
    for (const componentName in components) {
      const component = components[componentName]

      Vue.component(component.name, component)
    }
  }
}

export default ComponentLibrary

if (typeof window !== 'undefined' && window.Vue) {
  window.Vue.use(ComponentLibrary)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ğŸ‘€ã€‚

*   ä»`src/components`å¯¼å…¥ç»„ä»¶ã€‚è¿™å°†ä»`index.js`ä¸­çš„*å‡ºå£*æŠ“å–ç»„ä»¶ã€‚è¿™æ˜¯å¯¼å…¥(æ”¶é›†)æˆ‘ä»¬æƒ³è¦åŒ…å«åœ¨åº“ä¸­çš„ç»„ä»¶çš„æ–‡ä»¶ã€‚

*   ç°åœ¨ï¼Œæˆ‘ä»¬å°†åˆ›å»º Vue æ’ä»¶å¹¶å…¬å¼€ä¸€ä¸ª`install`æ–¹æ³•ã€‚æ ¹æ® Vue [æ’ä»¶æ–‡æ¡£](https://vuejs.org/v2/guide/plugins.html#Writing-a-Plugin):

> Vue.js æ’ä»¶åº”è¯¥å…¬å¼€ä¸€ä¸ªå®‰è£…æ–¹æ³•...è¯¥æ–¹æ³•å°†ä½¿ç”¨ Vue æ„é€ å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä»¥åŠå¯èƒ½çš„é€‰é¡¹æ¥è°ƒç”¨

*   åœ¨`install`æ–¹æ³•ä¸­ï¼Œéå†å¯¼å…¥çš„ç»„ä»¶ï¼Œå¹¶å°†æ¯ä¸ªç»„ä»¶åˆ†é…ç»™`const component`ã€‚`componentName`è¢«ç”¨ä½œä»`components`å¯¹è±¡ä¸­å–å‡ºç»„ä»¶çš„é”®ã€‚

*   ç”¨`Vue.component()`æ³¨å†Œæ¯ä¸ªç»„ä»¶ã€‚`component.name`æ˜¯æ¥è‡ªç»„ä»¶çš„åç§°*å±æ€§*å’Œä½œä¸ºç»„ä»¶çš„`component`ã€‚å½“æ’ä»¶åœ¨ Vue é¡¹ç›®ä¸­æ³¨å†Œæ—¶ï¼Œæˆ‘ä»¬çš„ç»„ä»¶å°†[å…¨çƒå¯ç”¨](https://vuejs.org/v2/guide/components-registration.html#Global-Registration)ã€‚

åœ¨ä¸Šé¢ï¼Œ`componentName`æ˜¯*è€Œä¸æ˜¯*ä¸`component.name`ç›¸åŒã€‚

*   å°†ç»„ä»¶åº“æ’ä»¶å¯¼å‡ºä¸ºé»˜è®¤æ’ä»¶ã€‚è¿™å…è®¸ä½œä¸º`import ComponentLibrary from ...`è¯­æ³•å¯¼å…¥åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­:

```
import Vue from 'vue'
import ComponentLibrary from './main.js'

Vue.use(ComponentLibrary)

... 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*   æœ€åï¼Œåœ¨çª—å£ä¸­å­˜åœ¨ Vue å®ä¾‹è€Œæ²¡æœ‰ä½¿ç”¨æ¨¡å—ç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨æ³¨å†Œæ’ä»¶ã€‚å½“æˆ‘ä»¬å°†åº“å‘å¸ƒåˆ°å†…å®¹äº¤ä»˜ç½‘ç»œ(CDN)å¹¶å°†å…¶åŒ…å«åœ¨åŒ…å«çš„ Vue æ ‡ç­¾ä¹‹åçš„é¡µé¢ä¸Šæ—¶ï¼Œæˆ‘ä»¬å°†å¯¹æ­¤è¿›è¡Œæµ‹è¯•ã€‚è¿™åœ¨ Vue [å…¥é—¨æŒ‡å—](https://vuejs.org/v2/guide/index.html#Getting-Started)ä¸­æœ‰æ‰€ä»‹ç»ï¼Œå¹¶ä¸”æ˜¯åœ¨å¯èƒ½ä¸ä½¿ç”¨æ„å»ºç³»ç»Ÿçš„ç°æœ‰åº”ç”¨ä¸­é‡‡ç”¨ Vue æ—¶çš„ä¸€ä¸ªé€‰é¡¹ã€‚

ç›®å‰ï¼Œä¸Šé¢çš„è®¾ç½®åªåšä¸€ä»¶äº‹â€”â€”æ³¨å†Œç»„ä»¶ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ç°åœ¨éœ€è¦å®ƒåšçš„ï¼Œä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ’ä»¶åˆ›å»ºå’Œåº“å…¥å£ç‚¹`main.js`æœ‰ä¸åŒçš„æ¨¡å¼ã€‚

ä¸€äº›ä¾‹å­åŒ…æ‹¬:

*   æ·»åŠ æŒ‡ä»¤ã€è¿‡æ»¤å™¨å’Œæ··åˆ
*   ä½¿ç”¨`Vue.prototype`æ·»åŠ å®ä¾‹å±æ€§
*   å¯¼å…¥æ ·å¼ä¾èµ–é¡¹
*   ç”¨`options = {}`å°†ç”¨æˆ·è‡ªå®šä¹‰é€‰é¡¹åˆå¹¶åˆ°æ’ä»¶æ³¨å†Œä¸­

Vue æ–‡æ¡£ä¸­è§„å®šçš„ç¼–å†™æ’ä»¶çš„å¤§çº²æ˜¯:

```
// 1\. add global method or property
Vue.myGlobalMethod = function () {
  // some logic ...
}

// 2\. add a global asset
Vue.directive('my-directive', {
  bind (el, binding, vnode, oldVnode) {
    // some logic ...
  }
  ...
})

// 3\. inject some component options
Vue.mixin({
  created: function () {
    // some logic ...
  }
  ...
})

// 4\. add an instance method
Vue.prototype.$myMethod = function (methodOptions) {
  // some logic ...
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¥æº:https://vuejs.org/v2/guide/plugins.html#Writing-a-Plugin

## [](#one-last-tip)æœ€åä¸€ä¸ªæç¤º

å¦å¤–ï¼Œå¦‚æœä½¿ç”¨ä¸Šé¢çš„`Vue.component`å’Œ`component.name`æ–¹æ³•ï¼Œä¸€å®šè¦è®°ä½åœ¨ç»„ä»¶ä¸­å¡«å……ä¸€ä¸ª`name`å±æ€§ã€‚å¦‚æœ`component.name`ä¸å­˜åœ¨ï¼Œæ³¨å†Œä¼šæŠ›å‡ºé”™è¯¯ã€‚

```
<template>
  <div>
    <slot></slot>
  </div>
</template>

<script>
  export default {
    name: 'name-of-your-component' // :point_left:
  }
</script>

<style></style> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç»™ä½ çš„ç»„ä»¶å‘½åä¸ºâ˜ï¸

æ¥ä¸‹æ¥ï¼Œç”¨ VuePress æ”¶ç´§åé¦ˆå›è·¯ï¼Œå¹¶æš—ç¤º[æƒŠäººçš„æ–‡æ¡£](https://dev.to/siegerts/creating-a-vue-js-component-library-part-iv-documentation-with-vuepress-56h5)ğŸŒ‹ã€‚