# ä½¿ç”¨ Pytest çš„ Python TDD å…¥é—¨

> åŸæ–‡:[https://dev.to/wangonya/python-tdd-with-pytest-å…¥é—¨-4l07](https://dev.to/wangonya/python-tdd-with-pytest-----getting-started-4l07)

æµ‹è¯•é©±åŠ¨çš„å¼€å‘å¾ˆæ£’ã€‚å¦‚æœæ‚¨æ˜¯ Pythonistaï¼Œpytest ä¼šæ›´å¥½â€”â€”ä¸€ä¸ªä½¿æ„å»ºç®€å•å’Œå¯ä¼¸ç¼©çš„æµ‹è¯•å˜å¾—å®¹æ˜“çš„æ¡†æ¶ã€‚

åœ¨æœ¬ç³»åˆ—ä¸­ï¼Œæˆ‘å°†æ¢ç´¢ pytest æä¾›çš„ä¸€äº›å¾ˆé…·çš„ç‰¹æ€§ï¼Œè¿™äº›ç‰¹æ€§æœ‰åŠ©äºè½»æ¾æµ‹è¯• Python ä»£ç ã€‚

## [](#preparing-your-python-environment)å‡†å¤‡æ‚¨çš„ python ç¯å¢ƒ

è®©æˆ‘ä»¬ç”¨`virtualenv`è®¾ç½®æˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Python 3ã€‚`cd`è¿›å…¥ä½ çš„å·¥ä½œç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒ:

```
python3 -m venv env 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ:

```
source env/bin/activate 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#installing-raw-pytest-endraw-)å®‰è£…`pytest`

```
pip install pytest 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°±æ˜¯å‡†å¤‡ pytest æ‰€éœ€è¦åšçš„å…¨éƒ¨å·¥ä½œã€‚æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ
æ¥æ£€æŸ¥å®‰è£…çš„ç‰ˆæœ¬

```
pytest --version 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#creating-your-first-test)åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªæµ‹è¯•

å‡è®¾æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå½“å®ƒè¿è¡Œæ—¶ï¼Œå®ƒä¼šå‘ä½ ç»™å®ƒèµ·çš„åå­—é—®å¥½(æˆ‘çŸ¥é“ï¼Œéå¸¸æœ‰åˆ›æ„ğŸ˜…).

```
# simple hello world test 
def hello_world(name):
    pass

def test_hello():
    assert hello_world("World!") == "Hello World!" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨ä¼šæ³¨æ„åˆ°æˆ‘ä»¬çš„æµ‹è¯•å‡½æ•°åç§°ä»¥å•è¯ *test* å¼€å§‹ã€‚pytest å°±æ˜¯è¿™æ ·å‘ç°æµ‹è¯•æ–¹æ³•çš„ã€‚è¿˜æœ‰ï¼Œ:

*   æµ‹è¯•æ–‡ä»¶åº”è¯¥å‘½åä¸º`test_<something>.py`æˆ–`<something>_test.py`
*   æµ‹è¯•ç±»åº”è¯¥è¢«å‘½åä¸º`Test<Something>`

è¿è¡Œ`pytest hello.py`åº”è¿”å›:

```
collected 1 item
hello.py F                         [100%]

===================== FAILURES ======================
    def test_hello():
>       assert hello_world("World!") == "Hello World!"
E       AssertionError: assert None == 'Hello World!'
E        +  where None = hello_world('World!')

hello.py:6: AssertionError 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

Pytest æ˜¾ç¤ºæµ‹è¯•å¤±è´¥çš„åŸå› :`AssertionError: assert None == 'Hello World!â€™`ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬çš„ hello å‡½æ•°ä¸­æ²¡æœ‰ä»£ç ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

```
def hello_world(name):
    return "Hello {}".format(name)

def test_hello():
    assert hello_world("World!") == "Hello World!" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ­£åœ¨è¿è¡Œçš„`pytest hello.py`ç°åœ¨åº”è¯¥è¿”å›:

```
collected 1 item     
hello.py .                       [100%]

==================== 1 passed in 0.04 seconds ====================== 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æ‚¨æ‰€è§ï¼Œä½¿ç”¨ pytest å¼€å§‹åœ¨ python ä¸­è¿›è¡Œæµ‹è¯•éå¸¸å®¹æ˜“ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»è®¾ç½®å¥½äº†ä¸€åˆ‡ï¼Œéšç€æœ¬ç³»åˆ—çš„ç»§ç»­ï¼Œæˆ‘ä»¬å°†è¿›å…¥æ›´é«˜çº§çš„ç‰¹æ€§ã€‚