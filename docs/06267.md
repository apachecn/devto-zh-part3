# Async-Await vs. Then ä»¥é¿å…å›è°ƒåœ°ç‹±ğŸ“ğŸ˜ˆ

> åŸæ–‡:[https://dev . to/pan/when-to-use-async-await-vs-then-with-promises-1gb 7](https://dev.to/pan/when-to-use-async-await-vs-then-with-promises-1gb7)

[![Dante's Inferno Callback Hell](../Images/64522f560bd2d2d62e403bba53c43cb1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--94hdKSCm--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/5ofrscwnfljka6uhoe7j.jpg)

## [](#callback-hell)å›è°ƒåœ°ç‹±ğŸ”¥

å½“ä½¿ç”¨ JavaScript æ—¶ï¼Œæœ‰ä¸€ä¸ªè¢«ç§°ä¸ºå›è°ƒåœ°ç‹±çš„æ¦‚å¿µã€‚å®ƒæè¿°äº†ä¸€ç»„æ·±åº¦åµŒå¥—çš„å›è°ƒå‡½æ•°ï¼Œå¾ˆéš¾é˜…è¯»å’Œç»´æŠ¤ã€‚å›è°ƒåœ°ç‹±çš„å‘ç”Ÿæ˜¯ç”±äº JavaScript çš„å¼‚æ­¥éé˜»å¡ç‰¹æ€§ã€‚ä¸‹é¢æ˜¯åŸºäºä½†ä¸çš„æ’å›¾ğŸ˜ˆä¹å±‚åœ°ç‹±ã€‚

```
hell() {
    firstCircle() {
        secondCircle() {
            thirdCircle() {
                fourthCircle() {
                    fifthCircle() {
                        sixthCircle() {
                            seventhCircle() {
                                eighthCircle() {
                                    ninthCircle() {
                                        alert("Hell has Frozen Over!")
                                    }
                                }
                            }
                        }    
                    }
                }
            }
        }
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#promises)æ‰¿è¯º

åœ¨å‘å‡º AJAX HTTP è¯·æ±‚æ—¶ï¼Œæ‚¨é€šå¸¸ä¼šé‡åˆ°å›è°ƒé—®é¢˜ã€‚ä¸ºäº†ç®€åŒ–åµŒå¥—çš„å›è°ƒä»¥æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œ[æ‰¿è¯ºå¯ä»¥ä½¿ç”¨](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)ã€‚æœ‰äº†æ‰¿è¯ºï¼Œå°±æœ‰äº†ä¸¤ç§æ‹‰å¹³æˆ‘ä»¬å›è°ƒçš„æŠ€å·§â€”â€”(1)[`then`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/then)(2)[`async-await`](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Async_await)ã€‚

### [](#-raw-then-endraw-)`then`

è¿™ç§æ¨¡å¼æœ‰åŠ©äºå°†åµŒå¥—çš„å›è°ƒåˆ†è§£æˆè¿ç»­çš„`thens`ã€‚è¿™ä¸ª`fetch`è¯·æ±‚çš„æ•´ä¸ªæ‰§è¡Œæ˜¯å®Œå…¨å¼‚æ­¥å’Œéé˜»å¡çš„ã€‚

```
someFunc() {
    fetch('https://someurl.com')
        .then((response) => response.json())
        .then((data) => console.log(data)

    console.log("I will not be blocked")
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#-raw-asyncawait-endraw-)`async-await`

è¿™ç§æ¨¡å¼åšåŒæ ·çš„äº‹æƒ…ï¼Œä½†æ˜¯æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºæ¯ä¸€è¡Œçš„`await`å¯¼è‡´ä»£ç æ‰§è¡Œé˜»å¡ï¼ŒåŒæ—¶ç­‰å¾…æ‰¿è¯º[è§£å†³](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/resolve)ã€‚

```
async someFunc() {
    let response = await fetch('https://someurl.com'),
           data = await response.json()
    console.log("I will be blocked until I get a response", data)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#-raw-asyncawait-endraw-vs-raw-then-endraw-)`async-await` vs `then`

### [](#-raw-asyncawait-endraw-)`async-await`

å¦‚æœæ‚¨çš„ä»£ç ä¸`Promises`ä¸€èµ·å·¥ä½œï¼Œå¹¶ä¸”éœ€è¦é¡ºåºæ‰§è¡Œï¼Œé‚£ä¹ˆè¿™å°†éå¸¸æœ‰ç”¨ã€‚ç”±äºé˜»å¡ï¼Œæ‚¨å¯èƒ½ä¼šå¤±å»ä¸€äº›å¹¶è¡Œå¤„ç†ä»£ç çš„èƒ½åŠ›ã€‚æˆ‘ä¸»è¦åœ¨ä» Node.js æœåŠ¡å™¨å‘å‡º API è¯·æ±‚æ—¶ä½¿ç”¨`async-await`ã€‚

### [](#-raw-then-endraw-)`then`

è¿™å¯¹äºæˆ‘åœ¨å®¢æˆ·ç«¯å·¥ä½œæ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºè¯·æ±‚æ˜¯å¹¶è¡Œå¤„ç†çš„ï¼Œæ‰€ä»¥ UI çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡ã€‚å¦‚æœä½ ç”¨ React.js å¼€å‘ä½ çš„å‰ç«¯ï¼Œä¸€ä¸ªå…¸å‹çš„ç”¨ä¾‹å¯èƒ½æ˜¯æ˜¾ç¤ºä¸€ä¸ªåŠ è½½å±å¹•ï¼Œç›´åˆ°ä¸€ä¸ª`fetch`è¯·æ±‚è¿”å›ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ª`setState`æ›´æ–° UIã€‚

## [](#conclusion)ç»“è®º

ä¸¤ç§`Promise`æœºåˆ¶éƒ½å¯ä»¥ç”¨æ¥è§£å†³å›è°ƒåœ°ç‹±é—®é¢˜ï¼Œæ¯ç§æœºåˆ¶éƒ½æœ‰è‡ªå·±çš„æœ€ä½³ç”¨ä¾‹ã€‚ä¸è¦æŠŠè‡ªå·±å±€é™äºä»»ä½•æ•™æ¡ã€‚åšå¯¹ä½ çš„ç”¨ä¾‹æœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚

> å¦‚æœä½ è§‰å¾—è¿™äº›å†…å®¹æœ‰ç”¨ï¼Œå¹¶æƒ³è·å¾—æ–°å†…å®¹çš„æ›´æ–°ï¼Œè¯·åœ¨ Twitter ä¸Šå…³æ³¨æˆ‘ã€‚