# JavaScript æ•°ç»„:ã€‚forEach -å¾ªç¯çš„å‡½æ•° for

> åŸæ–‡:[https://dev . to/cedpolily/foreach-the-functional-for-loop-1d 14](https://dev.to/cedpoilly/foreach-the-functional-for-of-loop-1d14)

é‡è§`Arrayâ€‹.prototypeâ€‹.forâ€‹Each()`ã€‚

å®ƒçš„ç›®çš„æ˜¯åœ¨æ•°ç»„çš„æ¯ä¸€é¡¹ä¸Šæ‰§è¡Œä½ æä¾›çš„ä»£ç :æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª**å¾ªç¯**ã€‚

ä¸‹é¢æ˜¯å®ƒçš„å®šä¹‰:

```
array.forEach(function callback(currentValue [, index [, array]]) {  
// code for this iteration 
}[, thisArg]); 
```

ä¸‹é¢æ¥è§£é‡Šä¸€ä¸‹ã€‚ğŸ˜‰

# [](#its-parameters)å®ƒçš„å‚æ•°

`forEach`æœ€å¤šæ¥å—ä¸¤ä¸ªå‚æ•°:

*   `callback`å‡½æ•°ï¼Œå¯¹æ•°ç»„çš„æ¯ä¸€é¡¹æ‰§è¡Œ
*   `thisArg`(å¯é€‰)ï¼Œæ”¹å˜å›è°ƒå‡½æ•°ä¸­`this`çš„å€¼

ç°åœ¨ï¼Œæ›´æ·±å…¥åœ°çœ‹çœ‹æ¯ä¸€ä¸ªã€‚ğŸ‘‡

## 1)`callback`åŠŸèƒ½

å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨çš„æ–¹æ³•ã€‚å®ƒæœ€å¤šéœ€è¦ä¸‰ä¸ªå‚æ•°:

*   currentValue:æ•°ç»„çš„å½“å‰é¡¹ï¼Œ`ğŸ`åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶
*   index(å¯é€‰):å½“å‰é¡¹çš„ç´¢å¼•ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶
*   array(å¯é€‰):æ•´ä¸ªæ•°ç»„ï¼Œæ‰€æœ‰è¿­ä»£çš„`same`

```
const array = ["ğŸ", "ğŸŒ", "ğŸ"];

array.forEach(function(current, index, array) {  
console.log(current);  
console.log(index);  
console.log(array);  
console.log("\n");  
});

// LOGS 
// { current: 'ğŸ' } 
// { index: 0 } 
// { array: [ 'ğŸ', 'ğŸŒ', 'ğŸ' ] } 
// 
// { current: 'ğŸŒ' } 
// { index: 1 } 
// { array: [ 'ğŸ', 'ğŸŒ', 'ğŸ' ] } 
// 
// { current: 'ğŸ' } 
// { index: 2 } 
// { array: [ 'ğŸ', 'ğŸŒ', 'ğŸ' ] } 
```

### `index`å‚æ•°

`index`å‚æ•°æ˜¯å¯é€‰çš„ã€‚å½“é€»è¾‘ä¾èµ–äºé¡¹ç›®åœ¨æ•°ç»„ä¸­çš„ä½ç½®æ—¶ï¼Œè¿™å¾ˆæ–¹ä¾¿ã€‚

```
const fruitEmojis = ["ğŸ", "ğŸŒ", "ğŸ"];  
const fruitNames = ["apple", "banana", "pineapple"];

fruitEmojis.forEach(function logFruitName(currentFruitEmoji, index) {  
const fruitName = fruitNames[index];

console.log({ emoji: currentFruitEmoji, name: fruitName });  
});

// LOGS 
// { emoji: 'ğŸ', name: 'apple' } 
// { emoji: 'ğŸŒ', name: 'banana' } 
// { emoji: 'ğŸ', name: 'pineapple' } 
```

### `array`å‚æ•°

æœ€åä¸€ä¸ªå‚æ•°æ˜¯`array`ã€‚å®ƒæ˜¯å›è°ƒæ–¹æ³•æ‰§è¡Œå¼€å§‹æ—¶æ•´ä¸ªæ•°ç»„çš„å€¼ã€‚
**:å½“ä½ æœ‰ä¸€ä¸ªæ³›å‹æ–¹æ³•ä¼ é€’ç»™éœ€è¦è®¿é—®æ•°ç»„çš„`forEach`æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚

æ–¹æ³•æ˜¯æ³›å‹çš„ï¼Œä½ æ— æ³•é¢„å…ˆçŸ¥é“å®ƒå°†è¢«è°ƒç”¨çš„æ•°ç»„ã€‚è¿™ä¹Ÿæ„å‘³ç€ä½ ä¸èƒ½ä¾èµ–é—­åŒ…ï¼Œå› ä¸ºå®ƒæ˜¯æœªçŸ¥çš„ã€‚

å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`array`å‚æ•°æ˜¯æ‚¨è®¿é—®å½“å‰æ•°ç»„çš„å”¯ä¸€**é€‰é¡¹ã€‚****

 **æ›´å¤šä¿¡æ¯è¯·å‚è§æ¥è‡ª [redneb](https://stackoverflow.com/users/6776093/redneb) çš„ Stackoverflow å“åº”[å›å¤](https://stackoverflow.com/a/39528692)ã€‚

## 2)`thisArg`å‚æ•°

è¦†ç›–`callback`å‡½æ•°ä¸­çš„`this`å…³é”®å­—å€¼ã€‚

é»˜è®¤æƒ…å†µä¸‹`this`ä¼šå¼•ç”¨çª—å£å¯¹è±¡ï¼Œå®ƒä¼šè¢«ä½ ä¼ é€’ç»™å®ƒçš„å€¼è¦†ç›–ã€‚

```
const array = [1];

array.forEach(function basicCall(current) {  
console.log(this);  
});

// LOGS 
// ... the whole Window object actually (in the browser)

const thisArg = { context: "custom" };

array.forEach(function explicitThisArg(current) {  
console.log(this);  
}, thisArg);

// LOGS 
//`{context: "custom"}`, which is the custom `this` value passed 
```

# [](#my-usage-of-raw-foreach-endraw-)æˆ‘çš„ç”¨æ³•`forEach`

å½“æˆ‘æƒ³å¯¹æŸä¸ªå¯¹è±¡æˆ–å¦ä¸€ä¸ªæ•°ç»„åº”ç”¨å‰¯ä½œç”¨æ—¶ï¼Œæˆ‘é€šå¸¸ä¼šä½¿ç”¨å®ƒã€‚(æˆ‘å°½å¯èƒ½é¿å…å‰¯ä½œç”¨ã€‚)

## [](#example)ä¸¾ä¾‹

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè¡¨æƒ…åˆ—è¡¨å’Œç›¸åº”çš„åç§°åˆ—è¡¨ã€‚æˆ‘ä»¬å¸Œæœ›åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­çš„å…³é”®å­—æ˜¯åç§°ï¼Œå€¼å°†åŒ…å«è¡¨æƒ…ç¬¦å·ã€‚

è¿™ä¸¤ä¸ªæ•°ç»„ä»¥ç›¸åŒçš„æ–¹å¼æ’åº:åœ¨ä»»ä½•ç»™å®šçš„ç´¢å¼•å¤„ï¼Œä¸¤ä¸ªæ•°ç»„ä¸­çš„é¡¹éƒ½å¯¹åº”ã€‚

```
const fruitEmojis = ["ğŸ", "ğŸŒ", "ğŸ"];  
const fruitNames = ["apple", "banana", "pineapple"];

let fruitMap = {};

fruitEmojis.forEach(function addKeyPairToFruitMap(currentFruitEmoji, index) {  
const key = fruitNames[index];

fruitMap[key] = currentFruitEmoji;  
});

console.log(fruitMap);

// LOGS 
// { apple: "ğŸ", banana: "ğŸŒ", pineapple: "ğŸ" } 
```

æ³¨æ„ï¼Œ`fruitMap`æ˜¯åœ¨`fruitEmojis`ä¸Šè°ƒç”¨ forEach ä¹‹å‰åˆ›å»ºçš„ã€‚æˆ‘ä»¬åœ¨æ‰§è¡Œ`addKeyPairToFruitMap`çš„è¿‡ç¨‹ä¸­æ›´æ–°å¯¹è±¡ã€‚

# [](#information-to-consider)ä¿¡æ¯è€ƒè™‘

åœ¨å¯¹æ•°ç»„ä½¿ç”¨`forEach`æ–¹æ³•ä¹‹å‰ï¼Œè¿™é‡Œæœ‰ä¸€äº›å€¼å¾—äº†è§£çš„ä¿¡æ¯ã€‚

## [](#1-returns-raw-undefined-endraw-thus-not-chainable)1)è¿”å›`undefined`ï¼Œå› æ­¤ä¸å¯é“¾æ¥

`forEach`æ•°ç»„æ–¹æ³•æ€»æ˜¯è¿”å›`undefined`ï¼Œå› æ­¤**ä¸**å¯é“¾æ¥ã€‚è¿™æ„å‘³ç€åœ¨ä¸€ä¸ª*è°ƒç”¨é“¾*ä¸­ï¼Œå®ƒåªèƒ½æ”¾åœ¨**ç«¯**ã€‚

```
const fruitEmojis = ["ğŸ", "ğŸŒ", "ğŸ"];

let fruitMap = {};

fruitEmojis  
.forEach(function addKeyPairToFruitMap(currentFruitEmoji) {  
return currentFruitEmoji;  
})  
.map(function logEmoji(emoji) {  
console.log("Calling `.map` will throw an error!");  
}  
);

// LOGS (console.error) 
// ... (omitted details) 
// .map(function logEmoji(emoji) { 
// ^ 
// TypeError: Cannot read property 'map' of undefined 
// ... (omitted details) 
```

## [](#2-callback-function-can-modify-original-array)2)å›è°ƒå‡½æ•°å¯ä»¥ä¿®æ”¹åŸæ•°ç»„

æˆ‘ä»¬å¯ä»¥åœ¨å›è°ƒå‡½æ•°ä¸­æ·»åŠ /åˆ é™¤/æ›´æ–°æ•°ç»„ä¸­çš„é¡¹ã€‚

### [](#addition)åŠ æ³•

æ·»åŠ **ä¸å½±å“**è°ƒç”¨çš„é¡¹ç›®:åªå¤„ç†æœ€åˆå‡ºç°çš„é¡¹ç›®ã€‚

ä½†æ˜¯æ‰§è¡Œä¹‹åæˆ‘ä»¬çœ‹åˆ°å®ƒå—åˆ°äº†å½±å“ã€‚

```
const fruitEmojis = ["ğŸ", "ğŸŒ", "ğŸ"];

let fruitMap = {};

fruitEmojis.forEach(function addKeyPairToFruitMap(currentFruitEmoji, index) {  
fruitEmojis.push(`test ${index}`);

console.log({index});  
});

console.log({fruitEmojis});

// LOGS

// `forEach`: 
// { index: 0 } 
// { index: 1 } 
// { index: 2 }

// logging the array: 
// { fruitEmojis: [ 'ğŸ', 'ğŸŒ', 'ğŸ', 'test 0', 'test 1', 'test 2' ] } 
```

### [](#deletion)åˆ é™¤

åˆ é™¤**ä¼šå½±å“é€šè¯çš„é¡¹ç›®æ•°é‡å—ï¼Ÿå¦‚æœåˆ é™¤äº†ä¸‹ä¸€ä¸ªè®¡åˆ’ç‰©æ–™ï¼Œåˆ™ä¸ä¼šå¯¹å…¶è¿›è¡Œå¤„ç†ã€‚** 

 **```
let fruitEmojis = ["ğŸ", "ğŸŒ", "ğŸ"];

let fruitMap = {};

fruitEmojis.forEach(function addKeyPairToFruitMap(currentFruitEmoji, index) {  
fruitEmojis.shift();  
fruitEmojis.pop();  
fruitEmojis.splice(0, 1);

console.log({index});  
});

console.log({fruitEmojis});

// LOGS

// `forEach`: 
// { index: 0 }

// logging the array: 
// { fruitEmojis: [] } 
```

### [](#modification)ä¿®æ”¹

ä¿®æ”¹**æ˜¯å¦å½±å“ç‰©å“**æœ¬èº«**ä¸ºè°ƒç”¨ï¼Œä½†ä¸å½±å“è®¡æ•°ã€‚å¦‚æœæˆ‘ä»¬ä¿®æ”¹ä¸‹ä¸€ä¸ªè®¡åˆ’ç‰©æ–™ï¼Œåˆ™åœ¨å¤„ç†è¯¥ç‰©æ–™æ—¶ï¼Œå¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚

æ³¨æ„ï¼Œç¬¬å››é¡¹æ˜¯ç”±äºè¿™æ¡è¯­å¥ï¼Œä¸‹é¢è¿™æ¡è¯­å¥åœ¨æœ€åä¸€æ¬¡æ‰§è¡Œæ—¶å‘æ•°ç»„ä¸­æ·»åŠ äº†ä¸€é¡¹:`fruitEmojis[index + 1] = "AAAAAARH!";`ã€‚** 

 **```
let fruitEmojis = ["ğŸ", "ğŸŒ", "ğŸ"];

let fruitMap = {};

fruitEmojis.forEach(function addKeyPairToFruitMap(currentFruitEmoji, index) {  
fruitEmojis[index + 1] = "AAAAAARH!";  

console.log({currentFruitEmoji, index});  
});

console.log({fruitEmojis});

// LOGS

// `forEach`: 
// { currentFruitEmoji: 'ğŸ', index: 0 } 
// { currentFruitEmoji: 'AAAAAARH!', index: 1 } 
// { currentFruitEmoji: 'AAAAAARH!', index: 2 }

// the array 
// { fruitEmojis: [ 'ğŸ', 'AAAAAARH!', 'AAAAAARH!', 'AAAAAARH!' ] } 
```

## [](#3-cannot-be-stopped)3)ä¸èƒ½åœæ­¢

è°ƒç”¨ forEach æ–¹æ³•æ—¶ï¼Œä¸èƒ½åœæ­¢æ‰§è¡Œæˆ–â€œä¸­æ–­å¾ªç¯â€ã€‚

å¦‚æœä½ è¯•å›¾åœæ­¢æ‰§è¡Œï¼Œä½ å¯èƒ½åº”è¯¥ä½¿ç”¨ä¸åŒçš„æ•°ç»„æ–¹æ³•(å¦‚ findã€filterã€reduceã€someã€includes)æˆ–ä½¿ç”¨ä¸€ä¸ª **for-loop** æ¥ä»£æ›¿ã€‚

# [](#conclusion)ç»“è®º

å¸Œæœ›è¿™ç¯‡å…³äº`forEach`æ³•çš„æ–‡ç« ç»™ä½ å¸¦æ¥äº†ä»·å€¼ã€‚ğŸ™‚

è¿™å°†æ˜¯ JavaScript æ•°ç»„ç³»åˆ—çš„ä¸€éƒ¨åˆ†ï¼Œæ•¬è¯·å…³æ³¨ä¸‹ä¸€æœŸï¼ğŸ‰

ç›´åˆ°é‚£æ—¶ï¼Œå¿«ä¹ç¼–ç ï¼ğŸ˜******