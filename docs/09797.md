# ä½¿ç”¨ Azure Pipelines å’Œ Particle æ„å»ºç‰©è”ç½‘å›ºä»¶

> åŸæ–‡:[https://dev . to/bsatrom/building-IOT-firmware-with-azure-pipelines-and-particle-2m 30](https://dev.to/bsatrom/building-iot-firmware-with-azure-pipelines-and-particle-2m30)

*TLï¼›DR ä½¿ç”¨ Azure Pipelines å’Œ Particle CLIï¼Œå¯ä»¥è½»æ¾åˆ›å»ºç®¡é“æ¥è‡ªåŠ¨æ„å»ºç‰©è”ç½‘è®¾å¤‡å›ºä»¶ã€å‘å¸ƒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”šè‡³è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼*

æ›¾ç»æœ‰è¿‡ä¸€ä¸ªä¸€æ¬¡åˆä¸€æ¬¡å‡ºç°çš„çˆ±å¥½é¡¹ç›®å—ï¼Ÿä½ å¾—åˆ°çµæ„Ÿå¼€å§‹ï¼Œç–¯ç‹‚åœ°å·¥ä½œä¸€æ®µæ—¶é—´ï¼Œç„¶åæŠŠå®ƒæ”¾åœ¨ä¸€è¾¹ï¼Œå› ä¸ºç”Ÿæ´»å’Œå·¥ä½œå‘ç”Ÿäº†ã€‚

æˆ–è€…ä½ è¢«è¿™ä¸ªä¸œè¥¿å“åˆ°äº†ï¼Œç„¶åæ…¢æ…¢åœ°(æˆ–å¾ˆå¿«åœ°)åé€€ï¼Ÿ

[![](../Images/1543ae0868e7bdabe7c6bf4affdb2abf.png)T2ã€‘](https://i.giphy.com/media/rVHcovSkVKUuY/giphy.gif)

çŒ«ä¸ºä»€ä¹ˆå®³æ€•é¦™è•‰ï¼Ÿä¹Ÿè®¸ä»–åªæ˜¯å»é…®ã€‚

æˆ‘çŸ¥é“é‚£ç§ææƒ§çš„æ„Ÿè§‰ï¼Œå°¤å…¶æ˜¯å½“å®ƒæ¶‰åŠåˆ°çˆ±å¥½é¡¹ç›®çš„æ—¶å€™ã€‚

ç„¶è€Œï¼Œæœ‰ä¸€äº›æ°¸è¿œä¸ä¼šçœŸæ­£æ¶ˆå¤±ã€‚ä½ åå¤æ€è€ƒå®ƒä»¬ã€‚ä½ å¶å°”ä¼šå¯¹å®ƒä»¬ç¨åŠ ä¿®æ”¹ã€‚ä½ ä¸æ–­åœ¨ä½ çš„æ„¿æœ›æ¸…å•ä¸Šæ·»åŠ åŠŸèƒ½ã€‚çµæ„Ÿ(æˆ–ææƒ§)æ°¸è¿œä¸ä¼šçœŸæ­£æ¶ˆå¤±ï¼Œä½ çš„æŸä¸€éƒ¨åˆ†åªçŸ¥é“ä½ æœ‰ä¸€å¤©ä¼šå®Œæˆé‚£ä»¶äº‹ã€‚

æˆ‘çš„ä¸€ä¸ªè¿™æ ·çš„é¡¹ç›®æ˜¯ [Brew Buddy](https://github.com/bsatrom/brew-buddy) ã€‚ä¸€ä¸ª[ç²’å­åŠ¨åŠ›](https://particle.io)å®¶é…¿ç›‘æµ‹è£…ç½®ï¼Œæˆ‘åœ¨ä¸‰å¹´å‰å¼€å§‹ä½¿ç”¨ã€‚æˆ‘ç”¨æ¥è‡ª Sparkfun çš„[ç²’å­å…‰å­](https://docs.particle.io/photon/)ã€ä¸€ä¸ª [Adafruit](https://adafruit.com) TFT å’Œä¸€ä¸ª [K å‹çƒ­ç”µå¶çªç ´å¼€å§‹äº†è¿™ä¸ªé¡¹ç›®ã€‚åœ¨ä»å¥¥ä»€å…¬å›­](https://www.sparkfun.com/products/13266)[å¾—åˆ°çœŸæ­£çš„å¤šæ°¯è”è‹¯ä¹‹å‰ï¼Œæˆ‘åœ¨æˆ‘çš„å¦ä¸€å®¶å·¥å‚åˆ›é€ äº†æˆ‘è‡ªå·±çš„å¤šæ°¯è”è‹¯ã€‚](https://oshpark.com/)

æˆ‘ç”šè‡³åˆ¶ä½œäº†å‡ ä¸ªå…³äºè¿™ä¸ªè¿‡ç¨‹çš„ YouTube è§†é¢‘ã€‚

[![](../Images/4b7d4ac6188edae8510e1342cb9c1219.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--QaqEhLGx--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/rcwnyj0uthbmmw91hz56.png)

æˆ‘ä¸æ‰“ç®—é“¾æ¥åˆ°é‚£äº› YouTube è§†é¢‘ã€‚ä¸å®¢æ°”å¦‚æœä½ è¶³å¤ŸåŠªåŠ›åœ°å¯»æ‰¾ä½ èƒ½æ‰¾åˆ°ä»–ä»¬ï¼Œä½†æ˜¯ä¸è¦è¯´æˆ‘æ²¡æœ‰è­¦å‘Šä½ ã€‚

ç¢°å·§çš„æ˜¯ï¼Œåœ¨ä¸€é˜µå¿™ä¹±ä¹‹åï¼Œæˆ‘æŠŠè¿™ä¸ªé¡¹ç›®æŸä¹‹é«˜é˜ï¼Œè½¬è€Œåšå…¶ä»–äº‹æƒ…ã€‚æµ‹è¯• Brew Buddy çš„æ¯ä¸€æ¬¡è¿­ä»£éƒ½éœ€è¦â€œçœŸå®ä¸–ç•Œâ€çš„æµ‹è¯•ï¼Œä¿¡ä¸ä¿¡ç”±ä½ ï¼Œäººç±»å¯ä»¥å–çš„å•¤é…’é‡å®é™…ä¸Šæ˜¯æœ‰é™åˆ¶çš„ã€‚

å»å¹´å¹´åº•ï¼ŒBrew Buddy åˆå›åˆ°äº†æˆ‘çš„è„‘æµ·é‡Œã€‚åœ¨ç²’å­å…¬å¸å‘å¸ƒäº†ä»–ä»¬çš„æ–°çš„ç¬¬ä¸‰ä»£è®¾å¤‡(T1)ï¼Œæ°©ã€ç¡¼å’Œæ°™åä¸ä¹…ï¼Œä¸€ä¸ªå¾®å¼±çš„å£°éŸ³éå¸¸æ¸©æŸ”åœ°è¯´:â€œT2ï¼Œä½ çŸ¥é“ï¼Œæ°©(T3)å’Œ T4 å¯¹é…¿é…’ä¼™ä¼´æ¥è¯´å¾ˆæ£’ã€‚æ‚¨è¿˜å¯ä»¥æ·»åŠ é‚£äº›æ‚¨ä¸€ç›´åœ¨è€ƒè™‘çš„æ–°åŠŸèƒ½ã€‚â€

æ— åŠ›æŠ—æ‹’æ–°ç¡¬ä»¶çš„è¯±æƒ‘ï¼Œæˆ‘åœ¨ä¸€æœˆä»½é‡æ–°å¼€å§‹äº†è¿™ä¸ªé¡¹ç›®ã€‚æˆ‘åœ¨æˆ‘çš„ Twitch é¢‘é“ä¸Šç›´æ’­äº†å¾ˆå¤šæˆ‘æœ€åˆçš„å·¥ä½œï¼Œå¹¶åœ¨ç²’å­åšå®¢ä¸Šå‘è¡¨äº†ä¸€ç¯‡å…³äºå…‰å­åˆ°æ°©ç«¯å£çš„ T2 å¸–å­ã€‚

æˆ‘è¢«å¸äº†å›å»ã€‚

## [](#enter-azure-devops)è¿›å…¥ Azure DevOps

æˆ‘å–œæ¬¢ç¡¬ä»¶é¡¹ç›®çš„ä¸€ä¸ªåŸå› æ˜¯ï¼Œå®ƒä»¬ç»™æˆ‘ä¸€ä¸ªå€Ÿå£å»æ¢ç´¢æˆ‘ä¸€ç›´æ¸´æœ›å°è¯•çš„ç›¸å…³ä¸»é¢˜æˆ–æ¦‚å¿µã€‚ä¾‹å¦‚ï¼Œæœ€åˆçš„ Brew Buddy æ˜¯è¿›å…¥ PCB è®¾è®¡çš„é—¨æˆ·ï¼Œè¿™åœ¨è¿‡å»å‡ å¹´é‡Œå·²ç»æˆä¸ºæˆ‘çš„ä¸€ä¸ªå›°æ‰°ã€‚

> ![unknown tweet media content](../Images/9d7e3f5c3b3e781b3fac400b1c45e1ed.png)![Brandon Satrom ğŸ¥•ğŸ‘– profile image](../Images/f93119ff1b908c7f955c2e7574a35fcf.png)å¸ƒå…°ç™»Â·è¨ç‰¹ç½—å§†ğŸ¥•ğŸ‘–@ brandonsatrom![twitter logo](../Images/65e26e35707d96169ec8af6b3cbf2003.png)é™¤äº†æˆ‘ä»¬çš„å¾½ç« è®¾è®¡ï¼Œæœ€è¿‘è¿˜åšäº†ä¸€ç‚¹ PCB è‰ºæœ¯ã€‚@mrtwinkletwink æœ‰ä¸€äº›å¾ˆæ£’çš„ä¸œè¥¿ï¼Œæˆ‘å—åˆ°å¯å‘åˆ›ä½œäº†è¿™ä¸ªã€‚æˆ‘ç»™ä½ ä¸€ä¸ªåƒåœ¾ç†ŠçŒ«å¾½ç« ...[# badge life](https://twitter.com/hashtag/badgelife)2018 å¹´ 7 æœˆ 02 æ—¥æ™š 21 ç‚¹[![Twitter reply action](../Images/269095962147c28351274afdd5486a48.png)](https://twitter.com/intent/tweet?in_reply_to=1013890175355752448)20[![Twitter like action](../Images/c077611ab2a5e0b4cd0c826ee7ae1e48.png)](https://twitter.com/intent/like?tweet_id=1013890175355752448)113

åœ¨è¿™æ¬¡æ›´æ–°ä¸­ï¼Œæˆ‘çœŸçš„æƒ³æ¢ç´¢å›ºä»¶/ç‰©è”ç½‘å¼€å‘çš„ DevOps æ–¹é¢ã€‚æˆ‘å¬è¯´äº†å¾ˆå¤šå…³äº Azure DevOps å’Œ[æ–°ç®¡é“](https://azure.microsoft.com/en-us/services/devops/pipelines/)åŠŸèƒ½çš„å¥½æ¶ˆæ¯ï¼Œæ‰€ä»¥æˆ‘å†³å®šå°è¯•ä¸€ä¸‹ã€‚

ä½¿ç”¨ Azure Pipelines å’Œ Particle CLIï¼Œæˆ‘èƒ½å¤Ÿå¿«é€Ÿè‡ªåŠ¨åŒ–æ„å»º BrewBuddy å›ºä»¶çš„è¿‡ç¨‹ï¼Œå¹¶åœ¨éœ€è¦æ—¶å‘å¸ƒäºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå¿«é€Ÿçš„æ­¥éª¤æ¦‚è¿°ï¼Œæˆ‘é‡‡å–äº†è¿™ä¸ªå·¥ä½œã€‚

## [](#1-set-up-azure-devops)1ã€‚è®¾ç½® Azure DevOps

è¦ä½¿ç”¨ Azure Pipelinesï¼Œæ‚¨éœ€è¦ä¸€ä¸ª Azure DevOps å¸æˆ·ã€‚å¾®è½¯æœ‰[å¤§é‡å…³äºè¿™ä¸ªè¿‡ç¨‹çš„æ–‡æ¡£](https://docs.microsoft.com/en-us/azure/devops/pipelines/get-started/index?view=azure-devops)ï¼Œæˆ‘ä¸ä¼šåœ¨è¿™é‡Œé‡å¤ã€‚å‰å¾€ dev.azure.com[çš„](https://dev.azure.com)ï¼Œåšå¥½ä¸€åˆ‡å‡†å¤‡ã€‚åœ¨åˆ›å»ºé¡¹ç›®ä¹‹å‰ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ª Azure DevOps ç»„ç»‡ï¼Œä»¥åŠä¸€ä¸ª GitHub å¸æˆ·ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥å°†æ‚¨çš„ç®¡é“è¿æ¥åˆ°ç›¸å…³çš„å­˜å‚¨åº“ã€‚

[![My sparse DevOps dashboard](../Images/694604ce2a47f6e1dc35fa00b2ef02b2.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--CVmvhG7A--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/kfcbges8prrpqoksfjza.png)

## [](#2-create-your-first-pipeline)2ã€‚åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªç®¡é“

åˆ›å»ºäº† Azure DevOps ç»„ç»‡åï¼Œæ‚¨å°±å¯ä»¥åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªç®¡é“äº†ã€‚å¦‚æœä½ åªæ˜¯åœ¨æ¢ç´¢ç®¡é“ï¼Œ[å¾®è½¯æœ‰ä¸€äº›å¿«é€Ÿå¯åŠ¨å·¥å…·ï¼Œä½ å¯ä»¥å…‹éš†å‡ºæ¥å°è¯•æ‰€æœ‰çš„ä¸œè¥¿](https://docs.microsoft.com/en-us/azure/devops/pipelines/get-started-yaml?view=azure-devops)ã€‚

å½“æ‚¨åˆ›å»ºä¸€ä¸ªç®¡é“æ—¶ï¼Œæ‚¨å°†æœ‰ä¸¤ç§é€‰æ‹©:åœ¨ YAML ä¸­åˆ›å»ºç®¡é“å®šä¹‰ï¼Œæˆ–è€…é€šè¿‡å¯è§†åŒ–ç¼–è¾‘å™¨ã€‚æ¯ä¸ªéƒ½æœ‰[çš„åˆ©å¼Šã€‚æˆ‘é€‰æ‹©äº† YAML çš„æ–¹æ³•ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥åœ¨æˆ‘çš„](https://docs.microsoft.com/en-us/azure/devops/pipelines/get-started/pipelines-get-started?toc=/azure/devops/pipelines/toc.json&bc=/azure/devops/boards/pipelines/breadcrumb/toc.json&view=azure-devops) [Brew Buddy repo](https://github.com/bsatrom/brew-buddy) ä¸­ç‰ˆæœ¬åŒ–æ„å»ºè¿‡ç¨‹ã€‚

å¦‚æœä½ å‡†å¤‡å¼€å§‹ä¸€ä¸ªçœŸæ­£çš„é¡¹ç›®ï¼Œç¬¬ä¸€æ­¥æ˜¯ä¸ºä½ çš„ç®¡é“é€‰æ‹©ä¸€ä¸ªæºå›è´­ï¼Œå¯ä»¥æ˜¯ GitHub æˆ– Azure repos ä¸­çš„å›è´­ã€‚

[![](../Images/d7d7736480b09755f01f8f4eba2af01e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--_jr_zEzU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/rieqh4jqgn78no88by0a.png)

ä¸‹ä¸€æ­¥æ˜¯é€‰æ‹©ä¸€ä¸ªå­˜å‚¨åº“ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªå¯åŠ¨é…ç½®ã€‚è¿™é‡Œæœ‰å¤§é‡çš„é€‰é¡¹ï¼Œæ‰€ä»¥ä½ åº”è¯¥æ‰¾åˆ°é€‚åˆä½ æ­£åœ¨æ„å»ºçš„ä¸œè¥¿ã€‚

[![](../Images/f527aed1e73b40b80adb537b73db959a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--WxPRgUV4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/3ypn6bt9ga8ctmi9qn2s.png)

ç”±äºæˆ‘æ­£åœ¨æ„å»ºä¸€ä¸ªå›ºä»¶é¡¹ç›®ï¼Œæ‚¨å¯èƒ½ä¼šè®¤ä¸ºæˆ‘é€‰æ‹©äº†å¸¦æœ‰ GCC é€‰é¡¹çš„ C/C++ã€‚ä¸æ˜¯è¿™æ ·çš„ï¼è™½ç„¶æˆ‘å¯ä»¥è¿™æ ·åšï¼Œä½†æˆ‘æƒ³ç”¨åŸºäº npm çš„ [Particle CLI](https://docs.particle.io/tutorials/developer-tools/cli/) è¿›è¡Œäº‘æ„å»ºï¼Œè¿™æ„å‘³ç€æˆ‘ä¸éœ€è¦å®‰è£…æœ¬åœ° GCC å·¥å…·é“¾ï¼Œå³ä½¿åœ¨æˆ‘çš„æ„å»ºç¯å¢ƒä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ç›¸åï¼Œæˆ‘é€‰æ‹©äº† Node.js é€‰é¡¹ï¼Œè¿™ç»™äº†æˆ‘ä¸€ä¸ªå¾ˆå¥½çš„é¢„é…ç½® YAML æ–‡ä»¶ï¼Œå¯ä»¥éšæ—¶è¿›è¡Œå®šåˆ¶ã€‚

[![](../Images/a254229789f334da1a05d678e6a32fd3.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ger5afi0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/i217zj18gxqp6fpsg6w6.png)

## [](#3-setup-triggers-and-define-a-vm-pool)3ã€‚è®¾ç½®è§¦å‘å™¨å¹¶å®šä¹‰è™šæ‹Ÿæœºæ± 

é»˜è®¤ç®¡é“å°†ä¸ºæ‚¨é¢„å®šä¹‰ä¸€äº›ä¸œè¥¿ï¼ŒåŒ…æ‹¬å•ä¸ªè§¦å‘å™¨å’Œæ± ã€‚è§¦å‘å™¨å®šä¹‰ä½•æ—¶è¿è¡Œæ„å»ºç®¡é“ï¼Œæ± æŒ‡å®šå¸Œæœ›ç®¡é“åœ¨å“ªäº›ç±»å‹çš„è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œã€‚ä»¥ä¸‹æ˜¯æˆ‘ä¸ºæˆ‘çš„æ„å»ºæ‰€åšçš„è°ƒæ•´ã€‚

```
trigger:
- master
- feature/*

pool:
  vmImage: 'macOS-10.13' 
```

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ„å»ºå°†åœ¨æ‰€æœ‰åˆ†æ”¯ä¸Šè§¦å‘ã€‚æˆ‘ç¨å¾®ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œä»¥å»ºç«‹åœ¨æˆ‘åˆ›å»ºçš„`master`å’Œä»»ä½•`feature/`åˆ†æ”¯ä¹‹ä¸Šã€‚

å¯¹äº VM æ± ï¼Œæˆ‘ä½¿ç”¨`macOS`è¿›è¡Œæ„å»ºï¼Œå› ä¸ºè¿™ä¸æˆ‘çš„å¼€å‘ç¯å¢ƒéå¸¸ç›¸ä¼¼ã€‚Windowsï¼ŒMac å’Œ Linux éƒ½æ”¯æŒç²’å­ CLIï¼Œæ‰€ä»¥æˆ‘çœŸçš„ä¸éœ€è¦æ”¹å˜è¿™ä¸€ç‚¹ï¼Œä½†æˆ‘æ— æ³•æŠ—æ‹’ã€‚æˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸€ä¸ªå¾®è½¯åœ¨ Azure çš„ macOS ä¸Šæä¾›è‡ªåŠ¨åŒ–æ„å»ºæœåŠ¡çš„ä¸–ç•Œã€‚æ´»ç€æ˜¯å¤šä¹ˆç¾å¥½çš„æ—¶å…‰ã€‚

## [](#4-use-steps-to-facilitate-dependency-installation-builds-and-more)4ã€‚ä½¿ç”¨æ­¥éª¤æ¥ç®€åŒ–ä¾èµ–é¡¹çš„å®‰è£…ã€æ„å»ºç­‰

åœ¨ Azure ç®¡é“ä¸­ï¼Œæ­¥éª¤æ„æˆäº†å·¥ä½œçš„ä¸»è¦éƒ¨åˆ†ã€‚æ¯ä¸ªç®¡é“éƒ½å¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªæ­¥éª¤æ¥å®‰è£…ä¾èµ–é¡¹ã€è¿è¡Œè„šæœ¬ã€æ„å»ºå·¥ä»¶ã€è¿è¡Œæµ‹è¯•ç­‰ç­‰ã€‚å‡ºäºè¿™ä¸ªé¡¹ç›®çš„ç›®çš„ï¼Œä»æºä»£ç åˆ°å›ºä»¶äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘éœ€è¦é‡‡å–äº”ä¸ªæ­¥éª¤ã€‚

### [](#install-nodejs)å®‰è£… Node.js

é¦–å…ˆï¼Œæˆ‘éœ€è¦å®‰è£… Node.jsã€‚æ¨¡æ¿åŒ…å«äº†è¿™ä¸ªä»»åŠ¡ï¼Œä½†æˆ‘å¯¹å®ƒè¿›è¡Œäº†è°ƒæ•´ï¼Œä½¿å…¶åŒ…å« Node.js 9.x.

```
- task: NodeTool@0
  inputs:
    versionSpec: '9.x'
  displayName: 'Install  Node.js' 
```

### [](#install-the-particle-cli)å®‰è£…ç²’å­ CLI

å®‰è£… Node.js(å’Œ npm)åï¼Œä¸‹ä¸€æ­¥æ˜¯å…¨å±€å®‰è£… Particle CLIã€‚

```
- script: |
    npm install -g particle-cli
  displayName: 'Install  the  Particle  CLI' 
```

### [](#login-to-the-particle-cli)ç™»å½•åˆ°ç²’å­ CLI

ç²’å­ CLI å¯ä»¥æ‰§è¡ŒåŸºäºäº‘çš„å›ºä»¶æ„å»ºï¼Œä½†å¿…é¡»ç™»å½•åˆ°è‡ªå·±çš„[ç²’å­è´¦æˆ·](https://login.particle.io)æ‰èƒ½ä½¿ç”¨è¯¥åŠŸèƒ½ã€‚æˆ‘æœ‰ä¸€ä¸ªå¸æˆ·å’Œå‡­è¯å¯ä»¥è¢«ç®¡é“ç”¨äºè¿™é¡¹å·¥ä½œï¼Œä½†æ˜¯æˆ‘æƒ³ä»¥ä¸€ç§å®‰å…¨çš„æ–¹å¼æŒ‡å®šè¿™äº›å‡­è¯(è€Œä¸æ˜¯å°†æˆ‘çš„ç”¨æˆ·åå’Œå¯†ç æäº¤ç»™ source)ã€‚å¹¸è¿çš„æ˜¯ï¼ŒAzure Pipelines é€šè¿‡æ¯ä¸ªç®¡é“çš„åº“æä¾›äº†å¯¹å˜é‡çš„æ”¯æŒã€‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ªåä¸º`particle-secrets`çš„ç»„ï¼Œå¹¶ç”¨é€‚å½“çš„å‡­è¯æ·»åŠ äº†`PARTICLE_USERNAME`å’Œ`PARTICLE_PASSWORD`å˜é‡ã€‚

[![](../Images/f0f10730b3c6a1c0eb2dc3455e1d2aaa.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--MzNrMCqb--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/4yawv9isidxpmqeh2f2r.png)

è¦ä½¿ç”¨å¯å˜ç»„ï¼Œæˆ‘å¯ä»¥åœ¨æˆ‘çš„ YAML é¡¶éƒ¨å¼•ç”¨ç»„ã€‚

```
variables:
- group: particle-secrets 
```

è¿™å…è®¸æˆ‘åœ¨`particle login`å‘½ä»¤ä¸­å¼•ç”¨è¿™äº›å˜é‡ã€‚

```
- script: |
    particle login --username $(PARTICLE_USERNAME) --password $(PARTICLE_PASSWORD)
  displayName: 'Login  to  Particle  CLI' 
```

### [](#build-a-firmware-binary-using-the-particle-cli)ä½¿ç”¨ç²’å­ CLI æ„å»ºå›ºä»¶äºŒè¿›åˆ¶æ–‡ä»¶

ç™»å½•åï¼Œæˆ‘å¯ä»¥ä½¿ç”¨`particle compile`å‘½ä»¤æ„å»ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç›®æ ‡æ˜¯ç²’å­æ°©å’Œ 0.9.0 ç‰ˆæœ¬çš„è®¾å¤‡æ“ä½œç³»ç»Ÿå›ºä»¶ã€‚

```
- script: |
    particle compile argon --target 0.9.0 brew-buddy-firmware --saveTo brewBuddy.argon.bin
  displayName: 'Build  Firmware' 
```

### [](#copy-the-firmware-binary-to-a-staging-directory)å°†å›ºä»¶äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ°æš‚å­˜ç›®å½•

æœ‰äº†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘å°†æŠŠ`.bin`æ–‡ä»¶ç›´æ¥å¤åˆ¶åˆ° staging ä¸­ã€‚è¿™å…è®¸æˆ‘ä¸ºæœ€åä¸€ä¸ªä»»åŠ¡é€‰æ‹©äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

```
- task: CopyFiles@2
  inputs:
    sourceFolder: '$(Build.SourcesDirectory)'
    contents: 'brewBuddy.argon.bin'
    targetFolder: '$(Build.ArtifactStagingDirectory)' 
```

## [](#5-create-a-github-release-when-merging-to-master)5ã€‚åˆå¹¶åˆ° master æ—¶åˆ›å»ºä¸€ä¸ª GitHub ç‰ˆæœ¬

ä¸Šè¿°æ­¥éª¤åœ¨æ¯æ¬¡ç­¾å…¥æ—¶è¿è¡Œï¼Œå¹¶é’ˆå¯¹æˆ‘çš„æ‰€æœ‰åˆ†æ”¯ï¼Œä»¥ç¡®ä¿æˆ‘æ€»æ˜¯å¯ä»¥æ„å»ºå›ºä»¶ï¼Œå¹¶ä¸”ä¸ä¼šå°†é‡å¤§æ›´æ”¹æäº¤åˆ°æˆ‘çš„é¡¹ç›®ä¸­ã€‚

æˆ‘åœ¨`feature/`åˆ†æ”¯ä¸­è¿›è¡Œæ‰€æœ‰çš„å¼€å‘ï¼Œè™½ç„¶æˆ‘æƒ³æŒç»­è¿è¡Œæ„å»ºï¼Œä½†æˆ‘åªæƒ³åœ¨ä¸€ä¸ªç‰¹æ€§åˆ†æ”¯è¢«åˆå¹¶åˆ°ä¸»åˆ†æ”¯æ—¶å‘å¸ƒæ–°çš„å›ºä»¶ã€‚ä½¿ç”¨`condition`è¯­å¥ï¼Œæˆ‘å¯ä»¥æŒ‡å®šï¼Œå¦‚æœå‰é¢çš„æ‰€æœ‰æ­¥éª¤éƒ½æˆåŠŸå¹¶ä¸”æºåˆ†æ”¯æ˜¯ masterï¼Œé‚£ä¹ˆæˆ‘åªæƒ³è¿è¡Œå‘å¸ƒä»»åŠ¡ã€‚

```
# GitHub Release
- task: GithubRelease@0 
  condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/master'))
  displayName: 'Create  GitHub  Release'      
  inputs:
    gitHubConnection: bsatromBB
    repositoryName: bsatrom/brew-buddy
    tagSource: manual
    tag: $(Build.BuildNumber) 
    assets: $(Build.ArtifactStagingDirectory)/*.bin 
```

ä½œä¸ºè¿™ä¸ªæœ€ç»ˆä»»åŠ¡çš„ä¸€éƒ¨åˆ†ï¼Œ`assets`è¾“å…¥å°†è·å–æˆ‘çš„å›ºä»¶äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶å°†å…¶ä½œä¸ºå‘å¸ƒçš„ä¸€éƒ¨åˆ†ã€‚

## [](#6-run-the-pipeline)6ã€‚è¿è¡Œç®¡é“ï¼

ç®¡é“å°±ç»ªåï¼Œä¸‹ä¸€æ­¥æ˜¯è¿è¡Œå®ƒï¼Œè¿™å¯ä»¥é€šè¿‡ç­¾å…¥æˆ–åœ¨ DevOps é—¨æˆ·ä¸­æ‰‹åŠ¨è§¦å‘æ¥å®Œæˆã€‚åœ¨å‡ ä¸ª(åå‡ ä¸ª)è°ƒæ•´ä¹‹åï¼Œæˆ‘å¾ˆé«˜å…´åœ¨æˆ‘çš„æ„å»ºä¸­çœ‹åˆ°ä¸€æ’æ’ç»¿è‰²ã€‚

[![](../Images/850a297d1038a5a258cd3598a7444e07.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--eHALHy7R--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/424q9ef1cc6r57gtva6v.png)

è€Œä¸”ï¼Œæ¯ä¸€ä¸ªåˆå¹¶åˆ° master çš„ PR éƒ½ä¼šå¯¼è‡´ä¸€ä¸ªæ–°çš„å‘å¸ƒï¼Œå¸¦æœ‰ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆçš„å˜æ›´åˆ—è¡¨å’Œä¸€ä¸ªé—ªäº®çš„æ–°äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

[![](../Images/b0c983a9a1b3dcad5159686174add5c6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--dW7q-lYZ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/93b3p6k9xficaaig4kwt.png)

*æˆ‘çš„å…¨ç®¡é“ YAML åœ¨ [Brew Buddy GitHub å›è´­](https://github.com/bsatrom/brew-buddy/blob/master/azure-pipelines.yml)T3ã€‘ä¸­å¯ç”¨*

## [](#whats-next)æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼Ÿ

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å¯¹ Azure Pipelines çš„ä½“éªŒè¿˜ç®—é¡ºåˆ©ã€‚åœ¨åˆ›å»ºå¯å˜ç»„å’Œæ­£ç¡®å®Œæˆ GitHub å‘å¸ƒä»»åŠ¡æ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›æŒ«æŠ˜ï¼Œä½†åœ¨ä½¿ç”¨ä¸€ä¸ªæ–°çš„ã€ä¸ç†Ÿæ‚‰çš„æœåŠ¡æ—¶ï¼Œè¿™å¹¶æ²¡æœ‰è¶…å‡ºäººä»¬çš„é¢„æœŸã€‚æˆ‘å·²ç»è¿è¡Œä¸Šè¿°ç®¡é“å‡ ä¸ªæ˜ŸæœŸäº†ï¼Œå®ƒå¯¹æˆ‘çš„å·¥ä½œæµç¨‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¡¥å……ã€‚

å½“ç„¶ï¼Œä½œä¸ºä¸€ä¸ªä¸æ–­ä¿®è¡¥çš„äººï¼Œæˆ‘è¿˜æƒ³åšæ›´å¤šçš„äº‹æƒ…ã€‚æ—¢ç„¶æˆ‘å·²ç»è‡ªåŠ¨æ„å»ºäº†å›ºä»¶ï¼Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨ Particle CLI å¯¹ä¸“ç”¨è®¾å¤‡è¿›è¡Œç©ºä¸­ä¸‹è½½(OTA)å›ºä»¶æ›´æ–°å‘¢ï¼Ÿä¹‹åï¼Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨[ç²’å­å˜é‡ã€å‡½æ•°å’Œå‘å¸ƒ/è®¢é˜…åŸè¯­](https://docs.particle.io/reference/device-os/firmware/argon/#cloud-functions)è¿è¡Œè‡ªåŠ¨åŒ–é›†æˆæµ‹è¯•å‘¢ï¼Ÿ

å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæˆ‘å°†åœ¨å‡ å‘¨åæŸ¥çœ‹å…³äºè¯¥é¡¹ç›®çš„å¦ä¸€ç¯‡æ–‡ç« ã€‚

æˆ–è€…æˆ‘ä¼šè¢«åˆ«çš„äº‹æƒ…åˆ†å¿ƒã€‚

* * *

è¦å…³æ³¨æˆ‘åœ¨ BrewBuddy å’Œå…¶ä»–ç²’å­é©±åŠ¨ç‰©è”ç½‘é¡¹ç›®ä¸Šçš„è¿›å±•ï¼Œè¯·åŠ¡å¿…åœ¨ Twitch ä¸Šå…³æ³¨æˆ‘ï¼Œå¹¶åœ¨å‘¨ä¸€å’Œå‘¨å››ä¸æˆ‘ä¸€èµ·äº«å—ç›´æ’­ä¹è¶£ï¼

## ![GitHub logo](../Images/a73f630113876d78cff79f59c2125b24.png)[b satrom](https://github.com/bsatrom)/[brew-buddy](https://github.com/bsatrom/brew-buddy)

### Brew Buddy é¡¹ç›®çš„ç¡¬ä»¶ã€å›ºä»¶å’Œè½¯ä»¶é¡¹ç›®

<article class="markdown-body entry-content container-lg" itemprop="text">

# é…¿é…’ä¼™ä¼´

[![Build Status](../Images/8007e9adcc6153f4dd64de4d1f715187.png)T2ã€‘](https://dev.azure.com/brandon0360/BrewBuddy/_build/latest?definitionId=1&branchName=master)

BrewBuddy é¡¹ç›®çš„æ¥æºã€‚åŒ…å«ä¸»æ¿ç¡¬ä»¶/å¸ƒå±€ã€å›ºä»¶å’Œ 3d æ‰“å°å¤–å£³çš„æ¥æºã€‚

</article>

[View on GitHub](https://github.com/bsatrom/brew-buddy)