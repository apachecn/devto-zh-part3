# AlaSQL:ä¸€ä¸ªçœŸæ­£çš„ Web æµè§ˆå™¨æ•°æ®åº“(å’Œ Node.js)

> åŸæ–‡:[https://dev . to/Jorge _ rockr/alasql-a-real-database-for-web-browsers-and-nodejs-24gj](https://dev.to/jorge_rockr/alasql-a-real-database-for-web-browsers-and-nodejs-24gj)

â€œç­‰ç­‰ï¼Œä»€ä¹ˆï¼Ÿ!"

[![](../Images/60b3e3da96e06618bc0f6887835191dd.png)T2ã€‘](https://i.giphy.com/media/3o7abBP0nMjrdIvaCY/giphy.gif)

æ˜¯çš„ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘åœ¨æ¨ç‰¹ä¸Šçœ‹åˆ°çš„ååº”ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘ä½ è§£é‡Šä»€ä¹ˆæ˜¯ **AlaSQL** ï¼Œå¹¶æµ‹è¯•å®ƒæ˜¯å¦å¦‚é¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚

## [](#what-is-alaqsl)ä»€ä¹ˆæ˜¯ AlaQSLï¼Ÿ

**AlaSQL** æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å®¢æˆ·ç«¯å†…å­˜ SQL æ•°æ®åº“ã€‚å®ƒæ˜¯ç”¨çº¯ Javascript ç¼–å†™çš„ï¼Œæ”¯æŒ JOinã€GROUPã€UNIONã€INã€ALL å’Œæ›´å¤šæ“ä½œã€‚

é€Ÿåº¦å¿«å—ï¼Ÿå½“ç„¶æ˜¯å•¦ï¼å®ƒåˆ©ç”¨äº† Javascript çš„åŠ¨æ€ç‰¹æ€§ï¼Œè€Œ
ä½¿ç”¨äº†ä¼˜åŒ–æ–¹æ³•ã€‚æ®æäº¤äººç§°:

*   æŸ¥è¯¢è¢«ç¼“å­˜ä¸ºç¼–è¯‘åçš„å‡½æ•°ã€‚

*   è¿æ¥çš„è¡¨æ˜¯é¢„å…ˆç´¢å¼•çš„ã€‚

*   `WHERE`ä¸ºè¿æ¥é¢„å…ˆè¿‡æ»¤è¡¨è¾¾å¼

å®ƒèƒ½åœ¨å¤§å¤šæ•°ç½‘ç»œæµè§ˆå™¨ä¸­å·¥ä½œå—ï¼Ÿå½“ç„¶ï¼å®ƒå¯ä»¥åœ¨æ‰€æœ‰ç°ä»£ç‰ˆæœ¬çš„ Chromeã€Mozillaã€Safari ç”šè‡³ IE ä¸Šè¿è¡Œã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ Node.js ä¸Šä½¿ç”¨å®ƒã€‚

å®ƒæ”¯æŒ NoSQL æ•°æ®åº“å—ï¼Ÿæ˜¯çš„ï¼ï¼æ‚¨å¯ä»¥åˆ›å»º JSON è¡¨å¹¶ä½¿ç”¨ JSON å¯¹è±¡ã€‚

æ‚¨å¯ä»¥åœ¨ **AlaSQL** github èµ„æºåº“ä¸­è·å¾—æ›´å¤šä¿¡æ¯:

## ![GitHub logo](../Images/a73f630113876d78cff79f59c2125b24.png) [é˜¿æ ¼é¡º](https://github.com/agershun) / [é˜¿æ‹‰ sql](https://github.com/agershun/alasql)

### ç”¨äº browser å’Œ Node.js çš„ JavaScript SQL æ•°æ®åº“ã€‚å¤„ç†ä¼ ç»Ÿçš„å…³ç³»è¡¨å’ŒåµŒå¥—çš„ JSON æ•°æ®(NoSQL)ã€‚ä» localStorageã€IndexedDB æˆ– Excel å¯¼å‡ºã€å­˜å‚¨å’Œå¯¼å…¥æ•°æ®ã€‚

<article class="markdown-body entry-content container-lg" itemprop="text">

AlaSQL æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ¯æœˆæœ‰è¶…è¿‡ 200 ä¸‡çš„é¡µé¢æµè§ˆé‡â€”â€”æˆ‘ä»¬éå¸¸æ„Ÿè°¢æ‰€æœ‰çš„è´¡çŒ®ã€‚[è¯·å¸®å¸®å¿™](https://github.com/agershun/alasql/labels/Please%20help%20out%21)ã€‚

*æœ‰é—®é¢˜å—ï¼Ÿä½¿ç”¨â€œalasqlâ€æ ‡ç­¾è¯¢é—®å †æ ˆæº¢å‡ºã€‚*

[![CI-test](../Images/3979f27069046d72a6f782a15fcacf40.png)](https://github.com/agershun/alasql/actions)[![NPM downloads](../Images/42efad8d1ad9e03b238ee555b8f0fb2b.png)](https://npm-stat.com/charts.html?package=alasql)[![OPEN open source software](../Images/1f9c629fa4e3ae46d6f402e5e57c0bdd.png)](http://open-oss.com)[![Release](../Images/417c9f94f9b2d8e3a1908161741e28b8.png)](https://www.npmjs.com/package/alasql)[![Stars](../Images/9c697aac654e119d201a0656a0e52abe.png)](https://github.com/agershun/alasql)[![Average time to resolve an issue](../Images/3ec9afd46996a84a3e583b2fe9ccdb50.png)](http://isitmaintained.com/project/agershun/alasql "Average time to resolve an issue")[![Coverage](../Images/262f8f7a198c61fc8262df89c27304c9.png)](https://rawgit.com/agershun/alasql/develop/test/coverage/lcov-report/dist/alasql.fs.js.html)[![CII Best Practices](../Images/8973fbf4f6e0f059149622a3ab863750.png)](https://bestpractices.coreinfrastructure.org/projects/328)[![](../Images/223ac58b6005c1b69be3648e0f246903.png)](https://www.jsdelivr.com/package/npm/alasql)[![code style: prettier](../Images/4c12fc5e8626e4a5a43247378361e460.png)](https://github.com/prettier/prettier)[![FOSSA Status](../Images/2030df16192460116435936dfa86aa3c.png)](https://app.fossa.io/projects/git%2Bgithub.com%2Fagershun%2Falasql?ref=badge_small)

# é˜¿æ‹‰ SQL

## [![AlaSQL logo](../Images/d2fcad997ea58f4e01d4ee03f0bff9ea.png)T2ã€‘](http://alasql.org)

alasql-*([Ã la](http://en.wiktionary.org/wiki/%C3%A0_la)[SQL](http://en.wikipedia.org/wiki/SQL))ã€É›skju:É›lã€‘*-æ˜¯ä¸€ä¸ªç”¨äº JavaScript çš„å¼€æº SQL æ•°æ®åº“ï¼Œéå¸¸æ³¨é‡å…³ç³»æ•°æ®å’Œæ— æ¨¡å¼æ•°æ®çš„æŸ¥è¯¢é€Ÿåº¦å’Œæ•°æ®æºçµæ´»æ€§ã€‚å®ƒé€‚ç”¨äºç½‘ç»œæµè§ˆå™¨ã€Node.js å’Œç§»åŠ¨åº”ç”¨ç¨‹åºã€‚

è¯¥åº“è®¾è®¡ç”¨äº:

*   èƒ–å®¢æˆ·æœºä¸Š BI å’Œ ERP åº”ç”¨ç¨‹åºçš„å¿«é€Ÿå†…å­˜ SQL æ•°æ®å¤„ç†
*   é€šè¿‡å¤šç§æ ¼å¼çš„æ•°æ®å¯¼å…¥/æ“ä½œ/å¯¼å‡ºå®ç°ç®€å•çš„ ETL å’ŒæŒä¹…æ€§é€‰é¡¹
*   æ‰€æœ‰ä¸»æµæµè§ˆå™¨ã€Node.js å’Œç§»åŠ¨åº”ç”¨

åœ¨æ„å»ºæŸ¥è¯¢æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡åˆ©ç”¨ JavaScript çš„åŠ¨æ€ç‰¹æ€§æ¥å…³æ³¨é€Ÿåº¦ã€‚ç°å®ä¸–ç•Œçš„è§£å†³æ–¹æ¡ˆéœ€è¦â€¦

</article>

[View on GitHub](https://github.com/agershun/alasql)

## [](#installation)å®‰è£…

ä½¿ç”¨ NPM:
`npm install --save alasql`

ä½¿ç”¨ CDN:

```
<script src="https://cdn.jsdelivr.net/npm/alasql@0.4"></script> 
```

ä»…æ­¤è€Œå·²ã€‚å¾ˆç®€å•ï¼Œæ˜¯å§ï¼Ÿ

## [](#usage)ç”¨æ³•

é¦–å…ˆï¼Œå°†`alasql`å¯¼å…¥åˆ°æ‚¨çš„ä»£ç :

```
// CommonJS style
var alasql = require('alasql');

// ES6 style
import * as alasql from 'alasql';

// Global variable style
window.alasql 
```

ç„¶åï¼Œå¼€å§‹ç¼–å†™ SQL:

```
alasql("CREATE TABLE test (language INT, hello STRING)");
alasql("INSERT INTO test VALUES (1, 'Hello!')");
alasql("INSERT INTO test VALUES (2, 'Aloha!')");
alasql("INSERT INTO test VALUES (3, 'Bonjour!')");

const results = alasql("SELECT * FROM test WHERE language > 1");
console.log(results);

// Output:
// [{ "language":2, "hello":"Aloha!" },{ "language":3,"hello":"Bonjour!" }] 
```

æ‚¨ç”šè‡³å¯ä»¥å¯¹ä¸€ç»„å¯¹è±¡è¿è¡ŒæŸ¥è¯¢:

```
const data = [{ id: 1, amount: 10 }, { id: 2, amount: 20 }, { id: 1, amount: 30 }];
const results = alasql('SELECT id, SUM(amount) AS total FROM ? GROUP BY id', [data]);
console.log(results);

// Output:
// [{"id":1,"total":40},{"id":2,"total":20}] 
```

å¤ªæ£’äº†ï¼Œå¯¹å§ï¼Ÿ

[![](../Images/0a1c6ddf0e0db84cf31e55f38f5baca0.png)T2ã€‘](https://i.giphy.com/media/HT4IFvKvQwhCE/giphy.gif)

## [](#example)ä¸¾ä¾‹

è®©æˆ‘ä»¬ä½¿ç”¨`npx create-react-app`å·¥å…·åˆ›å»ºä¸€ä¸ªæ–°çš„ React åº”ç”¨ç¨‹åºï¼Œå¹¶å®ç°ä¸€ä¸ªåŸºæœ¬çš„å¾…åŠäº‹é¡¹åˆ—è¡¨åº”ç”¨ç¨‹åº:

```
import React from 'react';

class App extends React.Component {

  constructor(props) {
    super(props);

    this.state = { todo: [] };
  }

  addTodo() {
    const { todo } = this.state;
    const { inputTodo } = this.refs;

    todo.push(inputTodo.value);
    inputTodo.value = "";
    this.setState({ todo });
  }

  removeTodo(index) {
    const { todo } = this.state;

    todo.splice(index, 1);
    this.setState({ todo });
  }

  render() {
    const { todo } = this.state;

    return (
      <main className="container">
        <h1 className="mt-4">TODO List</h1>
        <div className="row mt-4">
          <form className="form-inline">
            <div className="form-group mx-sm-3 mb-2">
              <label for="inputTodo" className="sr-only">Todo</label>
              <input type="text" ref="inputTodo" className="form-control" id="inputTodo" placeholder="Todo"/>
            </div>
            <button type="button" className="btn btn-primary mb-2" onClick={ e => this.addTodo() }>Add</button>
          </form>
        </div>

        <div className="row">
          <table className="table table-bordered">
            <thead>
              <tr>
                <th>TODO</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {
              !todo.length &&
              <tr>
                <td colspan="2" className="text-center">
                  No data available
                </td>
              </tr>
              }
              {
              todo.length > 0 && todo.map((x,i) => (
              <tr>
                <td>{ x }</td>
                <td>
                  <button className="btn btn-danger" onClick={ e => this.removeTodo(i) }>
                    x
                  </button>
                </td>
              </tr>
              ))
              }
            </tbody>
          </table>
        </div>
      </main>
      );
  }
}

export default App; 
```

ç»“æœæ˜¯:

[![](../Images/e5d18dafd33c89e0e83588bad55edc94.png)T2ã€‘](https://i.giphy.com/media/3gNpPsV0uinCadzIqd/giphy.gif)

å®ƒå·¥ä½œèµ·æ¥å¾ˆç¥å¥‡ï¼Œä½†æ˜¯å¦‚æœæˆ‘é‡æ–°åŠ è½½é¡µé¢ï¼Œæˆ‘ä¼šä¸¢å¤±æ‰€æœ‰çš„å¾…åŠäº‹é¡¹åˆ—è¡¨ã€‚è®©æˆ‘ä»¬ç”¨ **AlaSQL** æ¥æŒä¹…åŒ–é‚£äº› TODOsã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥ **AlaSQL** å¹¶ä½¿ç”¨`componentWillMount` hook åˆ›å»ºè¡¨:

```
import React from 'react';
import * as alasql from 'alasql';

class App extends React.Component {

  // Constructor ...

  componentWillMount() {
    alasql('CREATE TABLE todo (id INT AUTOINCREMENT PRIMARY KEY, text STRING)');
  }

  // Lines of code ...
}

export default App; 
```

æ¯æ¬¡åŠ è½½ç»„ä»¶æ—¶ï¼Œ **AlaSQL** éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè¡¨ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªä»æ•°æ®åº“ä¸­è·å–æ‰€æœ‰å¾…åŠäº‹é¡¹çš„æ–¹æ³•ï¼Œä¸€ä¸ªæ’å…¥æ–°å¾…åŠäº‹é¡¹çš„æ–¹æ³•å’Œä¸€ä¸ªåˆ é™¤å®ƒä»¬çš„æ–¹æ³•ã€‚

```
import React from 'react';
import * as alasql from 'alasql';

class App extends React.Component {

  // Lines of code ...

  fetchTodos() {
    const result = alasql('SELECT * FROM todo');
    this.setState({ todo: result });
  }

  insertTodo(text) {
    alasql('INSERT INTO todo VALUES ?',
      [{ id: alasql.autoval('todo', 'id', true), text }]);
  }

  deleteTodo(id) {
    alasql('DELETE FROM todo WHERE id = ?', id);
  }

  // Lines of code ...
}

export default App; 
```

å¦‚æ‚¨æ‰€è§ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„ SQL SELECTã€INSERT å’Œ DELETE æ¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚`alasql.autoval`è·å–è¦æ’å…¥çš„ä¸‹ä¸€ä¸ª IDï¼Œå› ä¸ºæˆ‘ä»¬çš„è¡¨ ID æ˜¯å¯è‡ªåŠ¨é€’å¢çš„ã€‚

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬é‡æ„`addTodo`å’Œ`removeTodo`æ–¹æ³•ï¼Œå¹¶æ·»åŠ `componentDidMount`é’©å­ä»æ•°æ®åº“:
ä¸­è·å– TODOs

```
import React from 'react';
import * as alasql from 'alasql';

class App extends React.Component {

  // Lines of code...

  componentDidMount() {
    this.fetchTodos();
  }

  addTodo() {
    const { inputTodo } = this.refs;

    if (!inputTodo.value) return;

    this.insertTodo(inputTodo.value);
    this.fetchTodos();
    inputTodo.value = "";
  }

  removeTodo(id) {
    this.deleteTodo(id);
    this.fetchTodos();
  }

  // Lines of code ...
}

export default App; 
```

æœ€åï¼Œè®©æˆ‘ä»¬æ›´æ–° render æ–¹æ³•ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„ ID åˆ—ï¼Œå¹¶ä½¿ç”¨ TODO å¯¹è±¡ä»£æ›¿çº¯æ–‡æœ¬:

```
import React from 'react';
import * as alasql from 'alasql';

class App extends React.Component {

  // Lines of code ...

  render() {
    const { todo } = this.state;

    return (
      <main className="container">
        <h1 className="mt-4">TODO List</h1>
        <div className="row mt-4">
          <form className="form-inline">
            <div className="form-group mx-sm-3 mb-2">
              <label for="inputTodo" className="sr-only">Todo</label>
              <input type="text" ref="inputTodo" className="form-control" id="inputTodo" placeholder="Todo"/>
            </div>
            <button type="button" className="btn btn-primary mb-2" onClick={ e => this.addTodo() }>Add</button>
          </form>
        </div>

        <div className="row">
          <table className="table table-bordered">
            <thead>
              <tr>
                <th>ID</th>
                <th>TODO</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {
              !todo.length &&
              <tr>
                <td colspan="3" className="text-center">
                  No data available
                </td>
              </tr>
              }
              {
              todo.length > 0 && todo.map(x => (
              <tr>
                <td>{ x.id }</td>
                <td>{ x.text }</td>
                <td>
                  <button className="btn btn-danger" onClick={ e => this.removeTodo(x.id) }>
                    x
                  </button>
                </td>
              </tr>
              ))
              }
            </tbody>
          </table>
        </div>
      </main>
      );
  }
}

export default App; 
```

ä½¿ç”¨ **AlaSQL** çš„ç»“æœæ˜¯:

[![](../Images/48d8553820c192ec3a37283777bdda40.png)T2ã€‘](https://i.giphy.com/media/RkHKubMsAu6e7hLxAD/giphy.gif)

è¯¥æ­»ï¼Œå¦‚æœæˆ‘é‡æ–°åŠ è½½é¡µé¢ï¼Œæˆ‘åˆä¼šä¸¢å¤±æ‰€æœ‰å¾…åŠäº‹é¡¹...ä¸ºä»€ä¹ˆï¼Ÿï¼

[![](../Images/1776e9ff416f49cbcaef1bf85de2ae31.png)T2ã€‘](https://i.giphy.com/media/l2JhtKtDWYNKdRpoA/giphy.gif)

å—¯ï¼Œäº‹å®ä¸Šæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ **AlaSQL** å¹¶ä¸”äº‹å®ä¸Šæˆ‘ä»¬æ­£åœ¨å°†æ•°æ®æ’å…¥åˆ°ä¸€ä¸ªè¡¨ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰åˆ›å»ºä¸€ä¸ªæ•°æ®åº“æ¥ä¿å­˜æ•°æ®ã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹`componentWillMount`é’©å­ï¼Œå¦‚æœå®ƒä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºä¸€ä¸ªåä¸º`todo_db`çš„æ–°æ•°æ®åº“ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒlocalStorage å°†ç”¨ä½œæ•°æ®åº“å¼•æ“ã€‚

```
componentWillMount() {
    alasql(`
      CREATE LOCALSTORAGE DATABASE IF NOT EXISTS todo_db;
      ATTACH LOCALSTORAGE DATABASE todo_db;
      USE todo_db;
    `);
    alasql('CREATE TABLE IF NOT EXISTS todo (id INT AUTOINCREMENT PRIMARY KEY, text STRING)');
} 
```

æ¯æ¬¡åŠ è½½ç»„ä»¶æ—¶ï¼Œ **AlaSQL** ä¼šåˆ›å»ºä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®åº“ã€‚

ä»¥ä¸‹æ˜¯æœ€ç»ˆç»“æœ:

[![](../Images/97dc09228a1174b3e6fa8ba223bf8b00.png)T2ã€‘](https://i.giphy.com/media/d2Ng0iJqNKePt8cUin/giphy.gif)

å®ƒåƒé¢„æœŸçš„é‚£æ ·å·¥ä½œğŸ‘Œã€‚

æ„Ÿè°¢é˜…è¯»ï¼æ‚¨å¯ä»¥åœ¨ä¸‹ä¸€ä¸ªèµ„æºåº“ä¸­æ‰¾åˆ°è¿™ç¯‡æ–‡ç« çš„æºä»£ç :

## ![GitHub logo](../Images/a73f630113876d78cff79f59c2125b24.png)[jorgeramon](https://github.com/jorgeramon)/[alasql-react-example](https://github.com/jorgeramon/alasql-react-example)

### å¦‚ä½•å°† AlaSQL ä¸ React ä¸€èµ·ä½¿ç”¨çš„ç¤ºä¾‹

<article class="markdown-body entry-content container-lg" itemprop="text">

è¿™ä¸ªé¡¹ç›®æ˜¯ç”¨ [Create React App](https://github.com/facebook/create-react-app) å¼•å¯¼çš„ã€‚

## å¯ç”¨è„šæœ¬

åœ¨é¡¹ç›®ç›®å½•ä¸­ï¼Œæ‚¨å¯ä»¥è¿è¡Œ:

### `npm start`

åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œåº”ç”¨ç¨‹åºã€‚
æ‰“å¼€ [http://localhost:3000](http://localhost:3000) åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€‚

å¦‚æœæ‚¨è¿›è¡Œç¼–è¾‘ï¼Œé¡µé¢å°†é‡æ–°åŠ è½½ã€‚æ‚¨è¿˜ä¼šåœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°ä»»ä½• lint é”™è¯¯ã€‚

### `npm test`

åœ¨äº¤äº’å¼è§‚å¯Ÿæ¨¡å¼ä¸‹å¯åŠ¨æµ‹è¯•è¿è¡Œç¨‹åºã€‚
è¯¦è§[è¿è¡Œæµ‹è¯•](https://facebook.github.io/create-react-app/docs/running-tests)ç« èŠ‚ã€‚

### `npm run build`

å°†ç”Ÿäº§åº”ç”¨ç¨‹åºæ„å»ºåˆ°`build`æ–‡ä»¶å¤¹ä¸­ã€‚
å®ƒåœ¨ç”Ÿäº§æ¨¡å¼ä¸­æ­£ç¡®æ†ç»‘ Reactï¼Œå¹¶ä¼˜åŒ–æ„å»ºä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚

æ„å»ºè¢«ç¼©å°ï¼Œå¹¶ä¸”æ–‡ä»¶ååŒ…æ‹¬æ•£åˆ—ã€‚
æ‚¨çš„åº”ç”¨å·²ç»å‡†å¤‡å¥½éƒ¨ç½²äº†ï¼

æ›´å¤šä¿¡æ¯å‚è§[éƒ¨ç½²](https://facebook.github.io/create-react-app/docs/deployment)éƒ¨åˆ†ã€‚

### `npm run eject`

**æ³¨æ„:è¿™æ˜¯å•å‘æ“ä½œã€‚ä¸€æ—¦ä½ `eject`ï¼Œä½ å°±ä¸èƒ½å›å»äº†ï¼**

å¦‚æœæ‚¨å¯¹æ„å»ºå·¥å…·ä¸æ»¡æ„â€¦

</article>

[View on GitHub](https://github.com/jorgeramon/alasql-react-example)