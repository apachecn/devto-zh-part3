# æ‚¨åº”è¯¥ä½¿ç”¨ Python @dataclass

> åŸæ–‡:[https://dev.to/dbanty/you-should-use-python-dataclass-lkc](https://dev.to/dbanty/you-should-use-python-dataclass-lkc)

# TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Python 3.7+ï¼Œé‚£ä¹ˆ [dataclasses](https://docs.python.org/3/library/dataclasses.html) å°†ä¼šä¸ºä½ èŠ‚çœå¤§é‡æ—¶é—´ï¼Œè®©ä½ çš„ä»£ç æ›´åŠ æ•´æ´ï¼Œç”šè‡³å¯èƒ½è®©ä½ çš„ä»£ç æ›´åŠ æ­£ç¡®ã€‚

# [](#why-you-should-not-use-a-dataclass)ä¸ºä»€ä¹ˆä¸åº”è¯¥ä½¿ç”¨æ•°æ®ç±»

1.  ğŸ•¸ä½ è¢«å›°åœ¨ python ä»¥ä¸‹çš„ç‰ˆæœ¬ä¸Šäº†ã€‚å¾ˆæŠ±æ­‰ï¼Œ3.7 å¢åŠ äº†å‡ ä¸ªéå¸¸æ£’çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å°½å¯èƒ½å‡çº§ã€‚
2.  ğŸš«æ²¡æœ‰ 2ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Python 3.7+æ•°æ®ç±»ï¼Œé‚£ä¹ˆåœ¨æŸäº›æ—¶å€™å‡ ä¹è‚¯å®šä¼šå¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚

# [](#whats-a-dataclass)ä»€ä¹ˆæ˜¯[æ•°æ®ç±»](https://docs.python.org/3/library/dataclasses.html)ï¼Ÿ

æˆ‘å¾ˆé«˜å…´ä½ é—®äº†ğŸ¤“ï¼Python 3.7 å¢åŠ äº†ä¸€ä¸ªå«åš`@dataclass`çš„æ•´æ´çš„å°è£…é¥°å™¨ã€‚ä¸å…¶ç”¨è‹±è¯­è§£é‡Šä¸ºä»€ä¹ˆå®ƒå¾ˆæ£’ï¼Œæˆ‘ä¸å¦‚ç›´æ¥å±•ç¤ºç»™ä½ çœ‹ã€‚

### [](#what-you-write)ä½ å†™ä»€ä¹ˆ

```
from dataclasses import dataclass, field
from typing import List

@dataclass
class Pizza:
    # Each of these is called a field
    crust: str
    has_cheese: bool = True
    toppings: List[str] = field(default_factory=list) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#what-you-can-now-do)ä½ ç°åœ¨èƒ½åšä»€ä¹ˆ

```
from dataclasses import asdict, astuple, replace

# An __init__ is created which takes all fields as args or kwargs! thick_cheesy = Pizza(crust='thick')

# __repr__ is generated, exclude any fields you donâ€™t want print(thick_cheesy)
# Prints "Pizza(crust='thick', has_cheese=True, toppings=[])" 
# Handy method to create a dict, only includes fields d = asdict(thick_cheesy)
assert d == {
    'crust': 'thick',
    'has_cheese': True,
    'toppings': [],
}

# Create a new object based on another object with_olives = replace(thick_cheesy, toppings=['olives'])

# Make a tuple from the fields t = astuple(with_olives)
assert t == ('thick', True, ['olives'])

# __eq__ is generated assert with_olives != thick_cheesy # Effectively compares as tuples 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#but-wait-theres-more)ä½†æ˜¯ç­‰ç­‰ï¼Œè¿˜æœ‰ï¼ğŸ’¸

é€šè¿‡å°†ä¸€äº›é€‰é¡¹ä¼ é€’ç»™`@dataclass`è£…é¥°å™¨ï¼Œæ‚¨è¿˜å¯ä»¥:

1.  è®©ä½ æ–°å½¢æˆçš„ç‰©ä½“ä¸å¯å˜(åˆåå†»ç»“çš„ğŸ¥¶)
2.  åŠ è½½ä¸æ˜¾ç¤ºä¸ºå­—æ®µçš„é™„åŠ å±æ€§(ä¹Ÿä¸åœ¨ asdict ä¸­ï¼)
3.  å¿«é€Ÿæ·»åŠ æ¯”è¾ƒå™¨(ç­‰)ã€‚)

# [](#not-sold)æ²¡å–å‡ºå»ï¼Ÿ

å¦‚æœæ•°æ®ç±»ä¸èƒ½ç«‹å³è®©ä½ å…´å¥‹ï¼Œä¸ºä»€ä¹ˆä¸å‘¢ï¼Ÿæˆ‘å¾ˆæƒ³çœ‹çœ‹ä½ çš„è¯„è®ºã€‚