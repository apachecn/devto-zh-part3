# Apache OpenWhisk ä¸Š Slack bot çš„å¿«é€Ÿ Python åç«¯

> åŸæ–‡:[https://dev . to/IBM developer/quick-python-back end-for-your-slack-bot-on-Apache-open whisk-3k8f](https://dev.to/ibmdeveloper/quick-python-backend-for-your-slack-bot-on-apache-openwhisk-3k8f)

[![](../Images/f93f1a0c77ddf2bcd81134b76e9db6d0.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--pc_3p8Eh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2A5IaZdfxGvkqfUhNz4YXwxg.png) 

<figcaption>OpenWhisk ä»å¤´å¼€å§‹å¯ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„ï¼</figcaption>

> ä¸€ä½åŒäº‹æœ€è¿‘åœ¨æˆ‘ä»¬çš„å†…éƒ¨ slack workspace ä¸Šè¯¢é—®å¦‚ä½•ä¸º slack bot æ„å»º Python åç«¯ã€‚è¿™æ˜¯ ***æ— æœåŠ¡å™¨*** çš„ä¸€ä¸ªå¾ˆå¥½çš„ç”¨ä¾‹ï¼Œå…¶ä¸­ä½ çš„ä»£ç æ­£åœ¨åšä¸€ä¸ªéå¸¸ä¸“æ³¨çš„ä»»åŠ¡ï¼Œä½¿ç”¨å¯èƒ½**ä¸é¢‘ç¹**å’Œ**ä¸å¯é¢„æµ‹**ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ IBM Cloud Functionsï¼Œå®ƒæ˜¯ Apache OpenWhisk çš„æ‰˜ç®¡ç‰ˆæœ¬ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹ä»¶é©±åŠ¨çš„æ— æœåŠ¡å™¨å¹³å°ã€‚

#### [](#prerequisites)å…ˆå†³æ¡ä»¶

1.æ‚¨çš„æœºå™¨äººå°†è¢«éƒ¨ç½²çš„å®½æ¾çš„å·¥ä½œç©ºé—´ã€‚æˆ‘çš„åå­—å« **upkar-watson-team** ã€‚
2ã€‚IBM Cloud account æ¥æ„å»º API ç½‘å…³èƒŒåçš„æ“ä½œå’Œå…¬å¼€ã€‚[ä½ å¯ä»¥åœ¨è¿™é‡ŒæŠ¥å](https://cloud.ibm.com/login)ã€‚
3ã€‚[å¯é€‰â€” WSK CLI](https://openwhisk.apache.org/documentation.html#wsk-cli) å°†å‡½æ•°ä¸Šä¼ åˆ° OpenWhiskã€‚æˆ‘ä»¬è¿˜å°†å±•ç¤ºå¦‚ä½•åœ¨ IBM Cloud UI ä¸Šåšåˆ°è¿™ä¸€ç‚¹ã€‚

### [](#steps)æ­¥éª¤

è¿™äº›æ­¥éª¤éå¸¸ç®€å•ï¼ŒåŒ…æ‹¬åœ¨ Slack ä¸Šåˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºå’Œä¸€ä¸ªæœºå™¨äººï¼Œå¹¶åœ¨ OpenWhisk ä¸Šéƒ¨ç½²ä¸€ä¸ªå¯ä»¥ç”¨ä½œå›è°ƒçš„å‡½æ•°ã€‚

> è¿™ä¸ªæƒ³æ³•æ˜¯ Slack å°†å‘æˆ‘ä»¬çš„ Python åŠ¨ä½œå‘é€ä¸€ä¸ª POST è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬çš„ bot è®¢é˜…çš„æ‰€æœ‰äº‹ä»¶çš„äº‹ä»¶ä¿¡æ¯ã€‚

#### [](#write-an-action-on-apache-openwhisk-ibm-cloud-functions)åœ¨ Apache OpenWhisk ä¸Šå†™ä¸€ä¸ªåŠ¨ä½œ(IBM äº‘å‡½æ•°)

1.ç™»å½• [IBM äº‘](https://cloud.ibm.com/login)ã€‚ç™»å½•åï¼Œæ‚¨å°†è¢«å¸¦åˆ°æ‚¨çš„ ***ä»ªè¡¨ç›˜*** ã€‚

2.ç‚¹å‡»å·¦è¾¹èœå•ä¸Šçš„åŠŸèƒ½æ¥å¯åŠ¨ OpenWhisk ä¸»é¡µ

[![](../Images/4d4905ac3dcb6c344db7e32b520b9b66.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ykecmPly--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/785/1%2A6d4UOrBPwNkeAGTCm2iAlQ.png)

3.ç‚¹å‡» ***åˆ›å»ºæ–°åŠ¨ä½œï¼Œå¼€å§‹åˆ›å»º*** ã€‚

[![](../Images/b9a0e7886e0bc06aba18b6004733c492.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--0ZPWPGq6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1007/1%2A1d5ulxV9EtYh5Fda5NOKYQ.png)

4.ç»™åŠ¨ä½œèµ·ä¸€ä¸ªåå­—ï¼Œé€‰æ‹© ***Python 3*** ä½œä¸ºè¿è¡Œæ—¶ã€‚

[![](../Images/14c95d0fe8524450f0f418f875321ee9.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--n4IAch7d--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/968/1%2AWaQr84YLAEMzHAYooYBDmw.png)

5.å°†ä»¥ä¸‹ python ä»£ç æ·»åŠ åˆ°åŠ¨ä½œ

```
#
#
# main() will be run when you invoke this action
#
# [@param](http://twitter.com/param) Cloud Functions actions accept a single                     parameter, which must be a JSON object.
#
# [@return](http://twitter.com/return) The output of this action, which must be     a JSON object.
#
#
import sys

def main(event):
  # check if the event contains a challenge
  if "challenge" in event:
      print('Event with verification challenge detected.')
      challenge = event['challenge']
      return {'challenge': challenge}

  return { 'message': 'No challenge found. Nothing to do' } 
```

[![](../Images/d78676f1e362cab98b2817377aa25b35.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--S307HhaT--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/963/1%2AkF397V8W2KuYUBIR9EE0cw.png)

æ‚¨å¯ä»¥ä» UI æœ¬èº«è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å› ä¸ºäº‹ä»¶å­—å…¸ä¸­æ²¡æœ‰äº‹ä»¶ï¼Œæ‰€ä»¥åŠ¨ä½œè¿”å›

```
â€˜messageâ€™: â€˜No challenge found. Nothing to doâ€™ } 
```

[![](../Images/6baf4cbb40d1f2712f394cf74aa25050.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--A5bzGgBS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AUzxi8VCZAE-OzvSgy1Cr_Q.png) 

<figcaption>åŠ¨ä½œè°ƒç”¨æ—¶æ²¡æœ‰äº‹ä»¶é€šè¿‡</figcaption>

6.ç‚¹å‡» ***æ·»åŠ ä»¥ä¸‹å‚æ•°ï¼Œæ›´æ”¹è¾“å…¥*** å¦‚ä¸‹:
[![](../Images/2a33097822c4ae026779091e75534707.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--B3oUDHxC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AN3sC7xpppOemNtcyENufRg.png) 

<figcaption>è®¾ç½®äº‹ä»¶ä¸ºåŠ¨ä½œ</figcaption>

çš„è¾“å…¥

å½“æ‚¨ç°åœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°æŒ‘æˆ˜ä½œä¸ºè¾“å‡ºè¿”å›ã€‚è¿™å°±æ˜¯ Slack æ‰€æœŸå¾…çš„ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»[æ›´å¤šç»†èŠ‚ã€‚](https://api.slack.com/events/url_verification)

[![](../Images/2a443acc5572988e814ef19f5ba7eb50.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--45xk97tl--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2A2AAtuoWC-wnrqFubTiUX6A.png)

7.ç‚¹å‡» ***ç«¯ç‚¹*** ï¼Œå°†åŠ¨ä½œå¯ç”¨ä¸º web åŠ¨ä½œ

[![](../Images/5489145461a386caea6c4f417df13221.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--qN7niRJN--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2Aj_uDOkWq0yY6CMJ-2jJ0vg.png)

8.è¿”å›åˆ° ***åŠ¨ä½œ*** ä¸»é¡µï¼Œåœ¨æ‚¨çš„åŠ¨ä½œå‰é¢æ·»åŠ ä¸€ä¸ª APIã€‚

[![](../Images/9918f5b4c2b42f91151472985e152888.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--k55723eM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2And6KcWNbNSlG10e6fHqYXQ.png)

9.ä¸ºæ‚¨çš„æ“ä½œåˆ›å»ºä¸€ä¸ª API ç«¯ç‚¹

[![](../Images/f56bed3967964bfe667d5e763cb8c766.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--reJiHRSN--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AcXold5SVtP8HvRzGtoNfYQ.png)

10.ç»™ä¸€ä¸ª ***å‘½å*** ï¼Œä¸€ä¸ª ***åŸºç¡€ api è·¯å¾„*** å’Œ ***åˆ›å»ºä¸€ä¸ªæ–°æ“ä½œ*** ã€‚

[![](../Images/fa1252e720aeee1e2b40d9b86dea95c4.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ltr8L7Ts--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AL9AHCPvoZVWViLDT8f5BxA.png)

11.åˆ›å»ºä¸€ä¸ªç›‘å¬ POST è¯·æ±‚å¹¶è°ƒç”¨æˆ‘ä»¬çš„ python æ“ä½œçš„æ“ä½œ

[![](../Images/8fabf8e07ccb185f50e33a2c39fb73c3.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--mEbUCjrT--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AndPuMPZVzf5-akoj31nhWw.png)

12.ä¿å­˜ API

[![](../Images/6caaccab810a76d51d43ead8c9591595.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--l9JXd2gB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2A1NB8o66siDHN9JQot4_54g.png)

13.ä» API Explorer è·å–æ–‡ç«  URL

[![](../Images/1939155d5c024e4fc3abc83dfdd4d5ce.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--6CiUanqj--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2AEakxf5_dXddqwAZun8xVDw.png)

`Keep this URL handy. We will provide it to slack in the next section as a verification URL.`

#### [](#create-a-bot-on-slack)åœ¨ç©ºé—²æ—¶é—´åˆ›å»ºä¸€ä¸ªæœºå™¨äºº

1.  è½¬åˆ° api.slack.com å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åº

[![](../Images/e091fa91d112d73634b33acf5c46f8d3.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--nXbY6OQu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/723/1%2AWkcmGQa3zMUOoYTSYQ2i_Q.png)

[![](../Images/7a6353f2a6f0be2bfdc99229ef8cef9a.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--sBlVjeK1--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/784/1%2AI3u3gfHmFc1zxBuJB6nNfQ.png) 

<figcaption>åˆ›å»ºæ–°åº”ç”¨</figcaption>

1.  æ·»åŠ æœºå™¨äººç”¨æˆ·

[![](../Images/0aa481f9e009dc421435c2ae928ac94f.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--UeEVUvYm--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/988/1%2AEJOfE8Totg-H5jR7UX7B0g.png) 

<figcaption>æ·»åŠ æ–°çš„ bot ç”¨æˆ·</figcaption>

[![](../Images/00db1fea9c68e31cbeef47da18c198a0.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--4y_bgBiW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1015/1%2Ay0h_FZdlkVD5FArK_8wvzA.png) 

<figcaption>æ·»åŠ æ–°çš„ bot ç”¨æˆ·</figcaption>

1.  è®¢é˜…å·¥ä½œç©ºé—´å’Œæœºå™¨äººäº‹ä»¶

[![](../Images/78b350856c719cd4587cecf7071d3dcc.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--cZNg97yt--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/779/1%2AuoISxzVjjKs2CHXeHY1fHw.png)

1.  å¯ç”¨äº‹ä»¶å¹¶æ·»åŠ  API ç½‘å…³ç«¯ç‚¹å‘å¸ƒ URLã€‚

[![](../Images/0853f34a17b7da1abc2504137c893533.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--ThEqXfK5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1009/1%2ApRhj4rsJnoC0hdofv19ecQ.png)

<figcaption>bot è®¢é˜…ä¸åŒçš„æ¶ˆæ¯äº‹ä»¶</figcaption>

å°†æ‚¨åœ¨ä¸Šä¸€èŠ‚ä¸­å¤åˆ¶çš„ IBM API URL æ·»åŠ ä¸ºè¯¥å±å¹•ä¸­çš„ ***è¯·æ±‚ URL*** ã€‚è·³å‡ºè¯¥å­—æ®µï¼Œå¹¶ç¡®ä¿ Slack å¯ä»¥éªŒè¯è¯¥ URLã€‚

[![](../Images/3837f67cdf63b598f9f1f391ecdb4e0b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--yK2BteX4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/961/1%2A1XgNdKXy1c80CtNYuZauOQ.png) 

<figcaption>æ·»åŠ è¯·æ±‚ URL å¹¶åœ¨ç©ºé—²æ—¶éªŒè¯</figcaption>

1.  æˆ‘ä»¬å·²ç»å®Œæˆäº†å¯¹ Slack ä¸Šçš„åº”ç”¨ç¨‹åºå’Œ bot çš„é…ç½®ã€‚ä¸‹ä¸€æ­¥æ˜¯å°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå®‰è£…åˆ°æˆ‘ä»¬çš„å·¥ä½œåŒºã€‚

[![](../Images/25ea57f34468f7f782cb0a4b60a0fa08.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--LxeoE3E4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/920/1%2AV5DUZSUlqDTfQzMQPEInjA.png)

[![](../Images/26471b0acd133190b934204748d57908.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--rFU9qNQq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/581/1%2AsEy3NvrcgkkvO8BYZmehPA.png)

1.  è½¬åˆ° slack å·¥ä½œåŒºï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ–°çš„ bot å¯ç”¨ã€‚

[![](../Images/726a208b0044855c6f6f01679d44bc8e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Tfr5EdwX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/652/1%2A_-DUBREVFfO__Rca-IytJw.png)

è¿™ä¹ˆğŸ†ğŸˆï¼ï¼æˆ‘ä»¬åœ¨ OpenWhisk ä¸­éå¸¸å¿«é€Ÿåœ°æ„å»ºäº†ä¸€ä¸ª Python åç«¯ï¼Œè¿™å°†å…è®¸æˆ‘ä»¬ä¸æˆ‘ä»¬çš„æœºå™¨äººè¿›è¡Œäº¤äº’ã€‚

#### [](#testing-our-bot-in-slack)åœ¨ç©ºé—²æ—¶æµ‹è¯•æˆ‘ä»¬çš„æœºå™¨äºº

æˆ‘ä¿®æ”¹äº† OpenWhisk åŠ¨ä½œä»£ç ï¼Œæ‰“å°å‡ºæ¥è‡ª Slack çš„æ¶ˆæ¯ã€‚

[![](../Images/4cc253eb4cec5f35190d21b14d32a693.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--MX_2cOY_--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/989/1%2AxQo2xZR4kBtdaSldPAsFwQ.png)

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨***wsk activation poll***å‘½ä»¤æ¥è½®è¯¢ OpenWhisk æ—¥å¿—ï¼Œæ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼ŒSlack å®¢æˆ·ç«¯å’Œæ—¥å¿—ä¸­éƒ½å‘å¸ƒäº†ç›¸åŒçš„æ¶ˆæ¯ã€‚è¿™å°±éœ€è¦ä½ å®‰è£… ***IBM Cloud CLI*** å’Œ ***WSK CLI*** ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ IBM å†…ç½®æ—¥å¿—æ¥æŸ¥çœ‹æ“ä½œè¾“å‡ºçš„å€¼ã€‚

[![](../Images/de9b5f725a0502e270c87f44c7f74916.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--xP2GAehX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/956/1%2ASzoDYziioRLTbtu8DjjvNw.png)

æ—¢ç„¶æˆ‘ä»¬å·²ç»æˆåŠŸåœ°ä¸ºæˆ‘ä»¬çš„ bot éƒ¨ç½²äº† Python åç«¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¤„ç†æ¥è‡ª Slack çš„äº‹ä»¶äº†ã€‚ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹æ˜¯ä½¿ç”¨å¼€æº python åº“æ¥åˆ†æç”¨æˆ·æ‰€è¯´çš„å†…å®¹ã€‚æˆ‘æ­£åœ¨å†™ä¸€ç¯‡ä½¿ç”¨ NLTK çš„å¸–å­ï¼ŒNLTK æ˜¯ç”¨ Python ç¼–å†™çš„ä¸€ä¸ªæµè¡Œçš„ NLP åº“ï¼Œç”¨æ¥æ£€æµ‹ç”¨æˆ·è¾“å…¥å†…å®¹çš„æƒ…æ„Ÿã€‚

æ•¬è¯·æœŸå¾…ï¼

[ã€max Katzã€‘ã€](https://medium.com/u/bf01a11701fe)[ã€Carlos Santanaã€‘ã€](https://medium.com/u/1f2fe78a0cf3)[ã€tomami immuraã€‘ã€](https://medium.com/u/a0b0677819e4)