# é‡æ„å‘å¯¹è±¡æ·»åŠ å±æ€§çš„æ¡ä»¶

> åŸæ–‡:[https://dev . to/Samantha Ming/refactoring-conditional-adding-property-to-object-45n 3](https://dev.to/samanthaming/refactoring-conditional-adding-property-to-object-45n3)

# [](#refactoring-conditional-adding-property-to-object)é‡æ„æ¡ä»¶å‘å¯¹è±¡æ·»åŠ å±æ€§

[![Code Tidbit by SamanthaMing.com](../Images/2dd64608936ff7db40211beb5f287cff.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--pl3SEnn7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/d9b4roza5s0nxepcqbnn.png)

è€Œä¸æ˜¯ä½¿ç”¨ä¸‰å…ƒç»„æœ‰æ¡ä»¶åœ°æ·»åŠ å±æ€§ã€‚ä½¿ç”¨â€œ||â€è¿ç®—ç¬¦ğŸ‘å› æ­¤ï¼Œå¦‚æœç¬¬ä¸€ä¸ªè¡¨è¾¾å¼å¯ä»¥è½¬æ¢ä¸ºçœŸï¼Œä½¿ç”¨å®ƒã€‚å¦åˆ™ï¼Œä½¿ç”¨ç¬¬äºŒä¸ªè¡¨è¾¾å¼ğŸŒŸ

```
const refill = {};

// Ternary
refill['ğŸ¥¤'] = refill['ğŸ¥¤'] ? refill['ğŸ¥¤'] + 1 : 1;

// âœ… Refactor using ||
refill['ğŸ¥¤'] = refill['ğŸ¥¤'] + 1 || 1; 
```

## [](#what-is-this-code-doing)è¿™æ®µä»£ç åœ¨åšä»€ä¹ˆï¼Ÿ

è®©æˆ‘ç”¨æ–‡å­—æ¥è§£é‡Šè¿™æ®µä»£ç åœ¨åšä»€ä¹ˆ:

1.  å¦‚æœå±æ€§`'ğŸ¥¤'`å­˜åœ¨äºå¯¹è±¡ä¸­ï¼Œåˆ™åŠ  1
2.  å¦‚æœè¯¥å±æ€§ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥å±æ€§å¹¶å°†å€¼è®¾ç½®ä¸º 1

å¥½äº†ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å•ä¸ªåœºæ™¯çš„è¾“å‡º:

**1ã€‚**æˆ¿äº§ä¸å­˜åœ¨

```
const refill = {};

refill['ğŸ¥¤'] = refill['ğŸ¥¤'] + 1 || 1;

console.log(refill); 
// OUTPUT â¡ï¸ { 'ğŸ¥¤': 1 } 
```

**2ã€‚**è´¢äº§ç¡®å®å­˜åœ¨

```
const refill = { 'ğŸ¥¤': 1 };

refill['ğŸ¥¤'] = refill['ğŸ¥¤'] + 1 || 1;

console.log(refill); 
// OUTPUT â¡ï¸ { 'ğŸ¥¤': 2 } 
```

## [](#rewriting-this-ternary-with-raw-if-endraw-)ç”¨`if`æ”¹å†™è¿™ä¸ªä¸‰å…ƒ

å¦‚æœä½ ä¸ç†Ÿæ‚‰ä¸‰å…ƒè¿ç®—ï¼Œè®©æˆ‘ç”¨ä¸€ä¸ª`if`è¯­å¥é‡å†™è¿™æ®µä»£ç ã€‚å¸Œæœ›è¿™å°†ä½¿è¿™æ®µä»£ç æ›´å®¹æ˜“ç†è§£ğŸ

```
const refill = {};

if (refill['ğŸ¥¤']) {
  refill['ğŸ¥¤'] = refill['ğŸ¥¤'] + 1
} else {
  refill['ğŸ¥¤'] = 1
} 
```

## [](#explaining-the-raw-endraw-operator)è§£é‡Š`||`è¿ç®—ç¬¦

æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä»¥ä¸º`||`è¿ç®—ç¬¦åªåœ¨æ¡ä»¶ä¸­ä½¿ç”¨ã€‚ç›´åˆ°æˆ‘è¯»äº†å‡¯å°”Â·è¾›æ™®æ£®çš„ã€Šä½ ä¸çŸ¥é“çš„ JSã€‹è¿™æœ¬ä¹¦â€”â€”æˆ‘å¼ºçƒˆæ¨èè¯»ä»–çš„ä¹¦ï¼æˆ‘è¯´è¿‡å®ƒæ˜¯å…è´¹çš„å—ğŸ‘

å‡¯å°”å°†`||`è§£é‡Šä¸º**é€‰æ‹©å™¨è¿ç®—ç¬¦**ï¼Œè€Œä¸æ˜¯é€»è¾‘è¿ç®—ç¬¦:

> ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå®ƒä»¬å®é™…ä¸Šä¸ä¼šäº§ç”Ÿé€»è¾‘å€¼(åˆå`Boolean`)ã€‚é‚£ä¹ˆå®ƒä»¬ä¼šäº§ç”Ÿä»€ä¹ˆç»“æœå‘¢ï¼Ÿå®ƒä»¬äº§ç”Ÿä¸¤ä¸ªæ“ä½œæ•°ä¸­çš„ä¸€ä¸ª(ä¸”åªæœ‰ä¸€ä¸ª)çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬é€‰æ‹©ä¸¤ä¸ªæ“ä½œæ•°å€¼ä¸­çš„ä¸€ä¸ªã€‚

è¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨å®ƒæ¥èµ‹å€¼ã€‚å“‡ï¼Œé‚£ä¸æ˜¯å¾ˆé…·å—ğŸ¤©è¿™æ­£æ˜¯æˆ‘åœ¨è¿™æ®µä»£ç ä¸­æ‰€åšçš„ğŸ‘

è¿™ç§æ¨¡å¼ç»å¸¸ç”¨äºè®¾ç½®é»˜è®¤å€¼ã€‚å¦‚æœè¿™æ˜¯æ‚¨ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ç§æ¨¡å¼ï¼Œé‚£ä¹ˆç”¨ä¸‰è¿›åˆ¶æ¥æ€è€ƒå®ƒä¼šæœ‰æ‰€å¸®åŠ©ã€‚è‡³å°‘ï¼Œåœ¨å¼€å§‹ç†è§£å®ƒçš„æ—¶å€™ï¼Œè¿™å¯¹æˆ‘æ˜¯æœ‰å¸®åŠ©çš„ğŸ˜

```
'Option A' || 'default option';

// This is roughly the same as
'Option A' ? 'Option A' : 'default option'; 
```

âš ï¸ä½†æ˜¯ï¼åœ¨ä½ å‘ç–¯ç”¨`||`æ“ä½œç¬¦é‡æ„æ‰€æœ‰ä¸‰å…ƒè¯­å¥ä¹‹å‰ã€‚çœ‹ä¸‹ä¸€èŠ‚ï¼

## [](#-raw-endraw-does-not-replace-ternary-operator)`||`ä¸æ›¿ä»£ä¸‰å…ƒè¿ç®—ç¬¦ï¼

è™½ç„¶`||`æ“ä½œç¬¦æ˜¯è®¾ç½®é»˜è®¤å€¼çš„ä¸€ç§éå¸¸æœ‰ç”¨çš„æ¨¡å¼ã€‚å®ƒä¸èƒ½ä»£æ›¿ä¸‰è¿›åˆ¶ã€‚æ‚¨åº”è¯¥åªåœ¨å¸Œæœ›è·³è¿‡æ‰€æœ‰ falsy å€¼çš„æƒ…å†µä¸‹ä½¿ç”¨å®ƒã€‚å¦åˆ™ï¼Œæœ€å¥½ä½¿ç”¨ä¸‰å…ƒç»„ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ æ˜ç¡®ã€‚

### [](#an-example-where-ternary-is-better-than-raw-endraw-)ä¸€ä¸ªä¸‰å…ƒä¼˜äº`||`çš„ä¾‹å­

è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¨å¾®ä¸åŒç‰ˆæœ¬çš„å¡«å……ç¤ºä¾‹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåˆ›å»ºå¡«å……å¯¹è±¡çš„å‡½æ•°ã€‚ä½†æ˜¯ç°åœ¨ï¼Œæˆ‘ä»¬å…è®¸æˆ‘ä»¬çš„ç”¨æˆ·è·³è¿‡å¡«å……ã€‚æ„æ€æ˜¯ä»–ä»¬æƒ³è¦ç»­æ¯ã€‚

```
function refillDrink(num) {
  const refill = {};

  refill['ğŸº'] = num || 1;

  return refill;
}

refillDrink(0);
// ğŸ˜± This is NOT what we want >> { 'ğŸº': 1 } 
```

â˜ï¸å“¦ï¼Œä¸ï¼æˆ‘ä»¬è¿‡ä¸å»`0`ã€‚é‚£æ˜¯å› ä¸º`0`æ˜¯ä¸€ä¸ªå‡å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸‰å…ƒä¼šå¥½å¾—å¤šã€‚

```
function refillDrink(num) {
  const refill = {};

  refill['ğŸº'] = num !== undefined ? num : 1;

  return refill;
}

refillDrink(0);
// âœ… { 'ğŸº': 0 } 
```

â˜ï¸:è€¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ`0`è®¾ä¸ºæˆ‘ä»¬çš„å€¼ğŸ‘

## [](#resources)èµ„æº

*   [ä½ ä¸çŸ¥é“ JS:è¿ç®—ç¬¦||](https://github.com/getify/You-Dont-Know-JS/blob/master/types%20%26%20grammar/ch4.md#operators--and-)
*   [æˆ‘å…³äºè™šä¼ªä»·å€¼è§‚çš„æ–‡ç« ](https://www.samanthaming.com/tidbits/25-js-essentials-falsy-values)

### [](#thanks-for-reading-%E2%9D%A4)æ„Ÿè°¢é˜…è¯»â¤

æ‰“ä¸ªæ‹›å‘¼ï¼ [Instagram](https://www.instagram.com/samanthaming/) | [æ¨ç‰¹](https://twitter.com/samantha_ming) | [è„¸ä¹¦](https://www.facebook.com/hisamanthaming) | [åª’ä½“](https://medium.com/@samanthaming) | [åšå®¢](https://www.samanthaming.com/blog)