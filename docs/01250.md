# ä¼Ÿå¤§çš„è¿­ä»£è¾©è®º:è¿‡æ»¤/æ˜ å°„ï¼Œå‡å°‘ï¼Œè¿˜æ˜¯ä¸ºäº†ï¼Ÿ

> åŸæ–‡:[https://dev . to/cmborchert/the-great-iterate-debate-filter-map-reduce-or-for-1bjk](https://dev.to/cmborchert/the-great-iterate-debate-filter-map-reduce-or-for-1bjk)

> æœ€åˆå‘å¸ƒäº[æˆ‘çš„åšå®¢](https://cborchert.blog/the-great-iterate-debate-filter-map-reduce-or-for)

## [T1ã€‘ç®€ä»‹](#intro)

æƒ³è±¡ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªç›¸å¯¹å¸¸è§çš„åœºæ™¯:æˆ‘æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘éœ€è¦ä»ä¸­æŒ‘é€‰å‡ºç‰¹å®šçš„é¡¹å¹¶å°†å…¶è½¬æ¢æˆæ–°çš„æ ¼å¼ã€‚

æˆ‘æ³¨æ„åˆ°ï¼Œå½“éœ€è¦ä»ä¸€ç³»åˆ—å¯¹è±¡ä¸­ç”Ÿæˆä¸€ç³»åˆ—ç»„ä»¶æ—¶ï¼Œè¿™ä¸ªé—®é¢˜åœ¨ React land ä¸­å°¤å…¶é¢‘ç¹å‡ºç°ã€‚

### [](#an-example)ä¸¾ä¸ªä¾‹å­

ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œç»™å®šä¸€ç»„ç”¨æˆ·å¯¹è±¡ï¼Œæˆ‘ä»¬åªéœ€è¦è·å–å·²ç»éªŒè¯äº†å…¶å¸æˆ·çš„ç”¨æˆ·ï¼Œå¹¶åˆ›å»ºä»–ä»¬çš„ç”µå­é‚®ä»¶åˆ—è¡¨:

ç”¨æˆ·åˆ—è¡¨:

```
const users = [
  { name: 'alex', isVerified: true, email: 'alex@mail.net' },
  { name: 'bobby', isVerified: false, email: 'bobby@mail.net' },
  { name: 'charlie', isVerified: true, email: 'charlie@mail.net' },
  { name: 'dannie', isVerified: false, email: 'dannie@mail.net' },
  { name: 'elliot', isVerified: false, email: 'elliot@mail.net' },
  { name: 'finn', isVerified: true, email: 'finn@mail.net' },
] 
```

æˆ‘ä»¬æƒ³è¦ä¸‹é¢çš„æ•°ç»„ä½œä¸ºç»“æœ:

```
['alex@mail.net', 'charlie@mail.net', 'finn@mail.net'] 
```

### [](#a-visual-example)ä¸€ä¸ªç›´è§‚çš„ä¾‹å­

å¯¹äºé‚£äº›å–œæ¬¢è§†è§‰æ•ˆæœçš„äººæ¥è¯´ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå¸¦æœ‰å½¢çŠ¶å’Œæ•°å€¼çš„å¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªåŒ…å«æ‰€æœ‰æ–¹å—ä¸­çš„æ•°å­—çš„æ•°ç»„:

[![creating an array of numbers from a collection of shapes](../Images/a461039f788da4b75b33a6ecd0c75b07.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--5-PS_Zwg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/w81pbfqfnnarp6piabut.jpg)

## [](#three-common-paths)ä¸‰ç§å¸¸è§çš„è·¯å¾„

ä½ å¦‚ä½•ä»ä¸Šé¢çš„ä¾‹å­ä¸­è¾¾åˆ°ç›®æ ‡ï¼Ÿ

æˆ‘é‡åˆ°äº†ä¸‰ç§å¤„ç†è¿™ç§æƒ…å†µçš„ä¸»è¦æ¨¡å¼:ä½¿ç”¨`for`å¾ªç¯ã€`filter`ä½¿ç”¨æ•°ç»„ï¼Œç„¶å`map` ping ç»“æœï¼Œæˆ–è€…ä½¿ç”¨`reduce` rã€‚è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹è¿™äº›æ–¹æ³•ä¸­çš„æ¯ä¸€ç§ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­çš„`users`å¯¹è±¡ï¼Œç›®æ ‡æ˜¯å¾—åˆ°ä¸€ä¸ªç”µå­é‚®ä»¶åœ°å€æ•°ç»„ä½œä¸ºç»“æœã€‚è¯·æ³¨æ„ï¼Œåœ¨ä»£ç ä¸­ï¼Œæˆ‘å°†å°½åŠ›ä½¿ä»£ç *æ˜“äºç†è§£*ï¼Œå› æ­¤æˆ‘å°†è·³è¿‡ææ„å‚æ•°å’ŒæŒ‘å‰”æ¯ä¸ªå­—ç¬¦ã€‚æ¯•ç«Ÿï¼Œè¿™ä¸æ˜¯ä»£ç é«˜å°”å¤«ğŸ˜‰ï¼

### [](#for-loop)ä¸ºå¾ªç¯

#### [](#code)ä»£ç 

```
const users = [
  { name: 'alex', isVerified: true, email: 'alex@mail.net' },
  { name: 'bobby', isVerified: false, email: 'bobby@mail.net' },
  { name: 'charlie', isVerified: true, email: 'charlie@mail.net' },
  { name: 'dannie', isVerified: false, email: 'dannie@mail.net' },
  { name: 'elliot', isVerified: false, email: 'elliot@mail.net' },
  { name: 'finn', isVerified: true, email: 'finn@mail.net' },
]

// initialize array
const userEmails = []
// loop through each item, pushing their email to the list if the user isVerified
for (let i = 0; i < users.length; i++) {
  if (users[i].isVerified) {
    userEmails.push(users[i].email)
  }
}

console.log(userEmails)
// [ 'alex@mail.net', 'charlie@mail.net', 'finn@mail.net' ] 
```

å•Šï¼Œ`for`å¾ªç¯:å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€çš„åŸºçŸ³ä¹‹ä¸€ã€‚ç®€å•ç™¾æ­ï¼è¿™é‡Œæ²¡æœ‰å¤ªå¤šè¦è§£é‡Šçš„ï¼Œå¦‚æœä½ å·²ç»ç”¨ä»»ä½•è¯­è¨€åšè¿‡ä¸€äº›ç¼–ç¨‹ï¼Œä½ åº”è¯¥èƒ½æ˜ç™½è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆã€‚æˆ‘ä»¬æ­£åœ¨åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå¹¶å°†å…ƒç´ æ”¾å…¥å…¶ä¸­ã€‚

#### [](#pros)ä¼˜ç‚¹

*   åˆ°ç›®å‰ä¸ºæ­¢æœ€å¿«çš„è®¡ç®—é€‰é¡¹(å‚è§ä¸‹é¢å…³äºæ€§èƒ½çš„éƒ¨åˆ†)ã€‚
*   ç›¸å¯¹å¯è¯»æ€§(æˆ‘ç»™å®ƒæ‰“ 3/5 çš„åˆ†:å¦‚æœä½ è¯»äº†ä»£ç ï¼Œä½ ä¼šçœ‹åˆ°å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰åšä»»ä½•èŠ±å“¨çš„äº‹æƒ…)ã€‚

#### [](#cons)å¼Š

*   è¯¦ç»†(96 ä¸ªå­—ç¬¦çš„ç²¾ç®€é•¿åº¦)
*   å®¹æ˜“å‡ºé”™:å°½ç®¡ä»£ç æœ¬èº«å¾ˆç®€å•ï¼Œä½†è¿™é‡Œæœ‰æ›´å¤šçš„æ´»åŠ¨éƒ¨åˆ†ã€‚ä½ å¾ˆå®¹æ˜“çŠ¯ä¸€ä¸ªé”™è¯¯ï¼Œæ¯”å¦‚å†™`for (let i = 0; i <= users.length; i++)`ï¼Œä½†ä¸ä¸€å®šæ„è¯†åˆ°è¿™ä¸€ç‚¹ã€‚
*   è¿™ä¸æ—¶é«¦ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº† ES6 æ•°ç»„æ–¹æ³•ï¼Œå°±åƒï¼Œæ°¸è¿œï¼æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ”¹å˜ä»»ä½•å˜é‡çš„å€¼å‘¢ï¼Ÿ(è™½ç„¶è¿™æ˜¯çœŸçš„ï¼Œä½†è¿™æ„å‘³ç€è®½åˆºã€‚)

### [](#filter-map)æ»¤é•œ+è´´å›¾

```
const users = [
  { name: 'alex', isVerified: true, email: 'alex@mail.net' },
  { name: 'bobby', isVerified: false, email: 'bobby@mail.net' },
  { name: 'charlie', isVerified: true, email: 'charlie@mail.net' },
  { name: 'dannie', isVerified: false, email: 'dannie@mail.net' },
  { name: 'elliot', isVerified: false, email: 'elliot@mail.net' },
  { name: 'finn', isVerified: true, email: 'finn@mail.net' },
]

const userEmails = users
  .filter(user => user.isVerified) // keep if user.isVerified is truthy
  .map(user => user.email) // for each filtered user, return the email

console.log(userEmails)
// [ 'alex@mail.net', 'charlie@mail.net', 'finn@mail.net' ] 
```

æˆ‘ä¸æ‰“ç®—åœ¨è¿™é‡Œéšè—ä»€ä¹ˆã€‚è¿™æ˜¯æˆ‘å¿ƒç›®ä¸­çš„èµ¢å®¶(é™¤éä½ çœŸçš„æƒ³é€šè¿‡å‡å°‘å¾®ç§’æ¥æé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚

#### [](#pros)ä¼˜ç‚¹

*   è®¡ç®—é€Ÿåº¦ç¬¬äºŒå¿«çš„é€‰é¡¹(å‚è§ä¸‹é¢å…³äºæ€§èƒ½çš„éƒ¨åˆ†)ã€‚
*   *å¯è¯»æ€§å¾ˆå¼º(æˆ‘ç»™å®ƒæ‰“ 5/5 çš„åˆ†:ä¸€çœ¼çœ‹å»ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æ­£åœ¨ä»ä¸€ä¸ªæ•°ç»„ä¸­`filter`ç§»é™¤ä¸€äº›é¡¹ï¼Œç„¶å`map` ping(è½¬æ¢)å‰©ä½™çš„é¡¹ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨æ“ä½œæ‰§è¡Œä¹‹åï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªæ•°ç»„ã€‚).*
*   æœ€ä¸å†—é•¿(63 ä¸ªå­—ç¬¦çš„ç²¾ç®€é•¿åº¦)
*   å¾ˆéš¾æç ¸ã€‚å‡ºäºåŒæ ·çš„åŸå› ï¼Œä½¿è¿™äº›ä»£ç æ˜“äºé˜…è¯»ï¼Œè¿™äº›ä»£ç å¾ˆéš¾æç ¸ã€‚ä¸ºèƒœåˆ©è¿›è¡Œå°è§„æ¨¡è¿é”æ“ä½œï¼

#### [](#cons)å¼Š

*   æˆ‘ä¼šç­‰å¾…æœ‰äººæ¥çº æ­£æˆ‘ï¼Œä½†æˆ‘ä¼šè¯´â€œæ²¡æœ‰â€ï¼Œé™¤éä½ æ”¯æŒ IE10 æˆ–å…¶ä»–ä¸œè¥¿ã€‚

### [](#reduce)å‡å°‘

```
const users = [
  { name: 'alex', isVerified: true, email: 'alex@mail.net' },
  { name: 'bobby', isVerified: false, email: 'bobby@mail.net' },
  { name: 'charlie', isVerified: true, email: 'charlie@mail.net' },
  { name: 'dannie', isVerified: false, email: 'dannie@mail.net' },
  { name: 'elliot', isVerified: false, email: 'elliot@mail.net' },
  { name: 'finn', isVerified: true, email: 'finn@mail.net' },
]

const userEmails = users.reduce((accumulator, user) => {
  if (user.isVerified) {
    return [...accumulator, user.email] // return the previous array plus the new user email
  }
  return accumulator // otherwise return the array without changes
}, []) // initialize accumulator as an empty array

console.log(userEmails)
// [ 'alex@mail.net', 'charlie@mail.net', 'finn@mail.net' ] 
```

å¦‚æœä½ çš„ç›´è§‰æ˜¯å»æ‹¿å‡å‹å™¨ï¼Œä½ å¯¹æˆ‘æ¥è¯´å¤ªé…·äº†ã€‚è™½ç„¶`reduce`åŠŸèƒ½å¤šæ ·ï¼Œä½†æˆ‘å‘ç°å®ƒä¸ç›´è§‚ï¼Œå¯¹åˆçº§å¼€å‘äººå‘˜å’Œä»£ç å®¡æŸ¥äººå‘˜ä¸å‹å¥½ï¼Œè€Œä¸”é€šå¸¸ä¸æ˜¯è¿™ç§æ“ä½œçš„æœ€ä½³å·¥å…·ã€‚

#### [](#pros)ä¼˜ç‚¹

*   ç¬¬äºŒä¸è¯¦ç»†(71 ä¸ªå­—ç¬¦çš„æœ€å°é•¿åº¦)
*   è¶…çº§æ½®ã€‚æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯å½“ä½ ä½¿ç”¨ä¸€ä¸ª`reducer`çš„æ—¶å€™ï¼Œä½ çªç„¶è¾¾åˆ°äº†ä¸€ä¸ªæ–°çš„æ°´å¹³ã€‚

#### [](#cons)å¼Š

*   ä¸‰ä¸ªé€‰é¡¹ä¸­è®¡ç®—é€Ÿåº¦æœ€æ…¢çš„ä¸€ä¸ª(å‚è§ä¸‹é¢å…³äºæ€§èƒ½çš„éƒ¨åˆ†)ã€‚
*   å¯è¯»æ€§ä¸å¼º(æˆ‘ç»™å®ƒæ‰“ 2/5 çš„åˆ†:æ¯æ¬¡æˆ‘é‡åˆ° reduceï¼Œå°±åƒ for å¾ªç¯ä¸€æ ·:æˆ‘éœ€è¦é˜…è¯»æ¯ä¸€è¡Œæ¥ç†è§£æ“ä½œï¼›è¿”å›å€¼ä¸ä¸€å®šæ˜¯æ•°ç»„(æ‚¨å¯ä»¥ä½¿ç”¨ reducer æ¥è·å¾—å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼æˆ–ä»»ä½•æ‚¨æƒ³è¦çš„ä¸œè¥¿:å®ƒçš„çµæ´»æ€§ä½¿å®ƒçœ‹èµ·æ¥æ›´éš¾ç†è§£)ã€‚æ­¤å¤–ï¼Œæˆ‘åªæ˜¯ä¸å–œæ¬¢ reduce çš„åˆå§‹å€¼å‡ºç°åœ¨ reducer å‡½æ•°ä¹‹åã€‚æˆ‘è§‰å¾—è¿™å¾ˆä¸ç›´è§‚ã€‚).

## [](#performance)è¡¨ç°

è¿™ç¯‡æ–‡ç« å®é™…ä¸Šæ¥è‡ªäºæˆ‘åœ¨å·¥ä½œä¸­å‚ä¸çš„ä¸€æ¬¡ä»£ç å®¡æŸ¥å’Œéšåçš„è¾©è®ºï¼Œå½“æ—¶æœ‰äººå†™äº†ä¸€äº›æŠ€æœ¯ä¸Šä¸æ­£ç¡®çš„ä»£ç (ä»–ä»¬åªä½¿ç”¨äº†ä¸€ä¸ª`map`ï¼Œå¹¶ä¸”æ²¡æœ‰`filter`åˆ é™¤ä¸éœ€è¦çš„é¡¹ç›®)ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å€¾å‘äºä½¿ç”¨ reduce æ¥å¤„ç†ä»»ä½•äº‹æƒ…ï¼Œæˆ‘ä¸»å¼ ä½¿ç”¨`.filter().map()`ã€‚æˆ‘æœ€ç»ˆç¼–å†™äº†ä¸€ä¸ª JSPerf æµ‹è¯•[,æ¦‚è¿°äº†è¿™é‡Œè®¨è®ºçš„æ“ä½œå’Œå…¶ä»–ä¸€äº›æ“ä½œä¹‹é—´çš„é€Ÿåº¦å·®å¼‚ã€‚ç»“æœè®©æˆ‘å¤§åƒä¸€æƒŠ:`.filter().map()`çš„è¡¨ç°æ˜¯`.reduce`çš„ä¸¤å€ï¼Œ`for`æ˜¯`.filter().map()`çš„ä¸‰å€ï¼](https://jsperf.com/filtermap-vs-reduce-vs-for-vs-function-vs-method)

[![Performance comparison as a bargraph](../Images/36e51abda04f9ebdebc219b286fb379e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ipGmLSGc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/2o5ge17mv6w2yzs3hpwd.png)

æˆ‘å¯¹ç»“æœæ„Ÿåˆ°æƒŠè®¶ï¼Œç‰¹åˆ«æ˜¯ï¼Œæ­£å¦‚æˆ‘çš„ä¸€ä¸ªåŒäº‹æŒ‡å‡ºçš„ï¼Œâ€œæˆ‘ä»¬ç”¨è¿‡æ»¤å›¾å¯¹æ•°æ®å¾ªç¯äº†ä¸¤æ¬¡ï¼Œè€Œç”¨ reducer åªå¾ªç¯äº†ä¸€æ¬¡ã€‚â€ç»“æœå¯èƒ½ä¼šå› ä½ ç¼–å†™å‡½æ•°çš„æ–¹å¼è€Œå¼‚ï¼Œreduce æœ€ç»ˆä¼šæ¯” filter-map æ›´å¿«ï¼Œä½†ä¸ä¼šæ›´å¿«ã€‚è‡³äº`for`å¾ªç¯ï¼Œæˆ‘å¹¶ä¸æ„å¤–å®ƒæ˜¯èµ¢å®¶ï¼Œåªæ˜¯æ²¡æƒ³åˆ°å®ƒèµ¢äº†è¿™ä¹ˆå¤šã€‚äº‹å®è¯æ˜ï¼Œåå¤è°ƒç”¨ reduce å‡½æ•°æ˜¯ç›¸å½“è€—æ—¶çš„ï¼Œæ­£å¦‚æœ¬æ–‡ä¸­çš„[æ‰€ç®€è¦æè¿°çš„é‚£æ ·ï¼Œä½†æ˜¯æœ‰äº›ç»†èŠ‚æˆ‘å·²ç»æä¸æ‡‚äº†ã€‚å¦‚æœæœ‰äººèƒ½è§£é‡Šä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œæˆ‘å¾ˆæƒ³å¬å¬ã€‚](https://hackernoon.com/3-javascript-performance-mistakes-you-should-stop-doing-ebf84b9de951?gi=fc581d91f3a0)

## [](#verdict)è£å†³

è™½ç„¶æ€§èƒ½ç»“æœå¾ˆæœ‰è¶£ï¼Œä½†æˆ‘ä»¬è®¨è®ºçš„æ˜¯æœ€ç»ˆèŠ‚çœçš„å¾®ç§’æ•°ï¼Œè€Œä¸”ï¼Œå°½ç®¡åœ¨æŸäº›æƒ…å†µä¸‹åšæŒè¿™äº›èŠ‚çœå¯èƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†æˆ‘ä¸è®¤ä¸ºèŠ‚çœçš„æ—¶é—´å€¼å¾—ç¼–å†™æ›´å¤šè¿Ÿé’çš„ä»£ç ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘å»ºè®®ä½¿ç”¨å‹å¥½çš„ã€è‡ªæˆ‘è®°å½•çš„ã€éš¾ä»¥å‡ºé”™çš„`.filter().map()`æ¥å®Œæˆè¿™ä¸ªç‰¹å®šçš„æ“ä½œã€‚

éƒ‘é‡å£°æ˜ï¼Œæˆ‘è®¤ä¸º reduce å¯èƒ½ä»ç„¶æœ‰å®ƒçš„ä½ç½®ï¼Œä½†å®ƒä¸ä¼šå–ä»£`.filter().map()`ã€‚å®é™…ä¸Šï¼Œæˆ‘å¾ˆéš¾è¯´å®ƒåº”è¯¥å–ä»£ä»»ä½•ç»™å®šçš„`for`å¾ªç¯ï¼Œå› ä¸ºå®ƒå’Œ for å¾ªç¯ä¸€æ ·å…·æœ‰æè¿°æ€§ï¼Œè€Œä¸”æ›´æ…¢ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œ`reduce`åœ¨ä½ å¯ä»¥åˆ›å»ºåº”ç”¨ç¨‹åºä¸­éœ€è¦çš„å¯é‡ç”¨çš„ reducer å‡½æ•°æ—¶å¤§æ”¾å¼‚å½©ï¼Œä½ åªéœ€è¦åŠ å…¥`myArray.reduce(myReducer, [])`ã€‚å¦‚æœæœ‰äººèƒ½æŒ‡å‡ºä¸ºä»€ä¹ˆæˆ‘ä»¬åº”è¯¥æ›´å¤šåœ°ä½¿ç”¨ reduceï¼Œæˆ‘ä¼šå¾ˆé«˜å…´ï¼

*å°é¢å›¾ç‰‡è‡´è°¢:*
ç…§ç‰‡ç”±[å“ˆç»´å°”Â·é˜¿è±æ ¼Â·å·´ç½—æ–¯](https://unsplash.com/photos/C7B-ExXpOIE?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](https://unsplash.com/search/photos/choice?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) æ‹æ‘„