# å®Œå…¨åˆå­¦è€…çš„éšæœºæ£®æ—

> åŸæ–‡:[https://dev . to/vzhou 842/random-forests-for-complete-åˆå­¦è€…-4 æ·»åŠ ](https://dev.to/vzhou842/random-forests-for-complete-beginners-4odd)

åœ¨æˆ‘çœ‹æ¥ï¼Œå¤§å¤šæ•°æœºå™¨å­¦ä¹ æ•™ç¨‹å¯¹åˆå­¦è€…ä¸å¤Ÿå‹å¥½ã€‚

ä¸Šä¸ªæœˆï¼Œæˆ‘ä¸ºå®Œå…¨åˆå­¦è€… å†™äº†ä¸€ç¯‡[ç¥ç»ç½‘ç»œç®€ä»‹**ã€‚è¿™ç¯‡æ–‡ç« å°†é‡‡ç”¨åŒæ ·çš„ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´**å‡è®¾æ²¡æœ‰æœºå™¨å­¦ä¹ çš„å…ˆéªŒçŸ¥è¯†**ã€‚æˆ‘ä»¬å°†å­¦ä¹ ä»€ä¹ˆæ˜¯éšæœºæ£®æ—ï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•ä»å¤´å¼€å§‹å·¥ä½œçš„ã€‚**](https://victorzhou.com/blog/intro-to-neural-networks/)

å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹å§ã€‚

## [](#1-decision-trees)1ã€‚å†³ç­–æ ‘ğŸŒ²

éšæœºæ£®æ—ğŸŒ²ğŸŒ²ğŸŒ²å®é™…ä¸Šåªæ˜¯ä¸€å †å†³ç­–æ ‘ğŸŒ²æ†ç»‘åœ¨ä¸€èµ·(å“¦ğŸ’¡è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒè¢«ç§°ä¸º*æ£®æ—*ã€‚åœ¨è¿›å…¥æ£®æ—ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è°ˆè®ºæ ‘æœ¨ã€‚

è¯·çœ‹ä¸‹é¢çš„æ•°æ®é›†:

[![](../Images/9e231b40b0d76214d2ab7c352cd22123.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--k3ZlJ9Rm--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/dataset.svg) 

<figcaption>æ•°æ®é›†</figcaption>

å¦‚æœæˆ‘å‘Šè¯‰ä½ æœ‰ä¸€ä¸ª x åæ ‡ä¸º 1 çš„æ–°ç‚¹ï¼Œä½ è®¤ä¸ºå®ƒä¼šæ˜¯ä»€ä¹ˆé¢œè‰²ï¼Ÿ

è“è‰²ï¼Œå¯¹å—ï¼Ÿ

ä½ åˆšåˆšåœ¨è„‘å­é‡Œè¯„ä¼°äº†ä¸€ä¸ªå†³ç­–æ ‘:

[![](../Images/fa889b91fc1ca959453948cfb435f739.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--sk0wx5oN--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/decision-tree.svg)

è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å†³ç­–æ ‘ï¼Œæœ‰ä¸€ä¸ª**å†³ç­–èŠ‚ç‚¹**ï¼Œç”±**æµ‹è¯•** x < 2ã€‚å¦‚æœæµ‹è¯•é€šè¿‡(x < 2)ï¼Œæˆ‘ä»¬é€‰æ‹©å·¦è¾¹çš„**åˆ†æ”¯**å¹¶é€‰æ‹©è“è‰²ã€‚å¦‚æœæµ‹è¯•å¤±è´¥(x â‰¥ 2)ï¼Œæˆ‘ä»¬é€‰æ‹©å³è¾¹çš„**åˆ†æ”¯**å¹¶é€‰æ‹©ç»¿è‰²ã€‚

[![](../Images/a127fd6407a975fe2c76a205a578410b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--TEzddabv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/dataset-split.svg) 

<figcaption>æ•°æ®é›†ï¼Œåœ¨ x=2 å¤„æ‹†åˆ†</figcaption>

å†³ç­–æ ‘ç»å¸¸è¢«ç”¨æ¥å›ç­”è¿™ç±»é—®é¢˜:ç»™å®šä¸€ä¸ªæ ‡æœ‰çš„**æ•°æ®é›†ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•**å¯¹**æ–°æ ·æœ¬è¿›è¡Œåˆ†ç±»ï¼Ÿ**

> **æ ‡è®°**:æˆ‘ä»¬çš„æ•°æ®é›†è¢«*æ ‡è®°ä¸º*ï¼Œå› ä¸ºæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ª**ç±»**(é¢œè‰²):è“è‰²æˆ–ç»¿è‰²ã€‚
> 
> **åˆ†ç±»**:å¯¹*åˆ†ç±»*ä¸€ä¸ªæ–°çš„æ•°æ®ç‚¹å°±æ˜¯ç»™å®ƒåˆ†é…ä¸€ä¸ªç±»(é¢œè‰²)ã€‚

è¿™é‡Œçš„æ•°æ®é›†ç°åœ¨æœ‰ 3 ä¸ªç±»ï¼Œè€Œä¸æ˜¯ 2 ä¸ª:

[![](../Images/f6a1d8bcc1054c3aa709a1385d488cbc.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--pSXKVOPd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/dataset2.svg) 

<figcaption>æ•°æ®é›† v2</figcaption>

æˆ‘ä»¬çš„æ—§å†³ç­–æ ‘ä¸å†é‚£ä¹ˆç®¡ç”¨äº†ã€‚ç»™å®šä¸€ä¸ªæ–°ç‚¹(xï¼Œy)ï¼Œ

*   å¦‚æœ xâ‰¥2ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ç†ç›´æ°”å£®åœ°å°†å…¶å½’ç±»ä¸ºç»¿è‰²ã€‚
*   å¦‚æœ x<2ï¼Œæˆ‘ä»¬ä¸èƒ½é©¬ä¸ŠæŠŠå®ƒå½’ç±»ä¸ºè“è‰²â€”â€”å®ƒä¹Ÿå¯èƒ½æ˜¯çº¢è‰²ã€‚

æˆ‘ä»¬éœ€è¦å‘æˆ‘ä»¬çš„å†³ç­–æ ‘æ·»åŠ å¦ä¸€ä¸ª**å†³ç­–èŠ‚ç‚¹**:

[![](../Images/a39ea0e0a864540e0200ed9434fdcd6a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--huxR6756--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/decision-tree2.svg)

[![](../Images/e5be1608e18a4ae5b3312425dded8037.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--eLSbXvH0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/dataset2-split.svg)

å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿè¿™æ˜¯å†³ç­–æ ‘èƒŒåçš„åŸºæœ¬æ€æƒ³ã€‚

## [](#2-training-a-decision-tree)2ã€‚è®­ç»ƒå†³ç­–æ ‘

è®©æˆ‘ä»¬å¼€å§‹è®­ç»ƒå†³ç­–æ ‘å§ï¼æˆ‘ä»¬å°†å†æ¬¡ä½¿ç”¨ 3 ç±»æ•°æ®é›†:

[![](../Images/f6a1d8bcc1054c3aa709a1385d488cbc.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--pSXKVOPd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/dataset2.svg) 

<figcaption>æ•°æ®é›† v2</figcaption>

### [](#21-training-a-decision-tree-the-root-node)2.1 è®­ç»ƒä¸€æ£µå†³ç­–æ ‘:æ ¹èŠ‚ç‚¹

æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä»»åŠ¡æ˜¯ç¡®å®šæˆ‘ä»¬çš„æ ‘ä¸­çš„æ ¹å†³ç­–èŠ‚ç‚¹ã€‚å®ƒå°†æµ‹è¯•å“ªä¸ªç‰¹æ€§(x æˆ– y ),æµ‹è¯•é˜ˆå€¼æ˜¯å¤šå°‘ï¼Ÿä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¹‹å‰çš„æ ‘ä¸­çš„æ ¹èŠ‚ç‚¹ä½¿ç”¨äº† x ç‰¹æ€§ï¼Œæµ‹è¯•é˜ˆå€¼ä¸º 2:

[![](../Images/bc330da3c217b422301d601de061e94d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--99ECw0um--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/decision-tree2-root.svg)

ç›´è§‰ä¸Šï¼Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªåšå‡ºâ€œå¥½â€åˆ†å‰²çš„å†³ç­–èŠ‚ç‚¹ï¼Œå…¶ä¸­â€œå¥½â€å¯ä»¥ç²—ç•¥åœ°å®šä¹‰ä¸ºå°½å¯èƒ½å¤šåœ°åˆ†ç¦»ä¸åŒç±»çš„**ã€‚ä¸Šé¢çš„æ ¹èŠ‚ç‚¹åšäº†ä¸€ä¸ªâ€œå¥½â€çš„åˆ†å‰²:*æ‰€æœ‰çš„*æœå²­åœ¨å³è¾¹ï¼Œ*æ²¡æœ‰*æœå²­åœ¨å·¦è¾¹ã€‚**

å› æ­¤ï¼Œæˆ‘ä»¬ç°åœ¨çš„ç›®æ ‡æ˜¯é€‰æ‹©ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œç»™æˆ‘ä»¬ä¸€ä¸ªå¯èƒ½çš„â€œæœ€ä½³â€åˆ†å‰²ã€‚ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•é‡åŒ–æ‹†åˆ†æœ‰å¤šå¥½å‘¢ï¼Ÿå¾ˆå¤æ‚ã€‚æˆ‘[å†™äº†ä¸€æ•´ç¯‡åšæ–‡ï¼Œè®²è¿°äº†ä¸€ç§ä½¿ç”¨åŸºå°¼ç³»æ•°çš„æ–¹æ³•ã€‚ **â†æˆ‘å»ºè®®åœ¨ä½ ç»§ç»­ä¹‹å‰ç°åœ¨å°±é˜…è¯»å®ƒ**â€”â€”æˆ‘ä»¬å°†åœ¨è¿™ç¯‡æ–‡ç« çš„åé¢ç”¨åˆ°è¿™äº›æ¦‚å¿µã€‚](https://victorzhou.com/blog/gini-impurity/)

* * *

æ¬¢è¿å›æ¥ï¼

> å¸Œæœ›ä½ åªæ˜¯è¯»äº†[æˆ‘çš„åŸºå°¼ä¸æ´è´´](https://victorzhou.com/blog/gini-impurity/)ã€‚å¦‚æœä½ æ²¡æœ‰ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆçŸ­çš„ TLï¼›åšå£«:æˆ‘ä»¬å¯ä»¥ç”¨åŸºå°¼ç³»æ•°æ¥è®¡ç®—ä»»ä½•åˆ†å‰²çš„åŸºå°¼ç³»æ•°**å’Œ**ã€‚**æ›´å¥½çš„åˆ†å‰²æœ‰æ›´é«˜çš„åŸºå°¼ç³»æ•°**ã€‚

å›åˆ°ç¡®å®šæˆ‘ä»¬æ ¹å†³ç­–èŠ‚ç‚¹çš„é—®é¢˜ã€‚æ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰äº†è¯„ä¼°æ‹†åˆ†çš„æ–¹æ³•ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æ‰¾åˆ°å¯èƒ½çš„æœ€ä½³æ‹†åˆ†ï¼ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†**å°è¯•æ¯ä¸€ä¸ªå¯èƒ½çš„åˆ†å‰²**ï¼Œå¹¶ä½¿ç”¨æœ€å¥½çš„åˆ†å‰²(åŸºå°¼ç³»æ•°æœ€é«˜çš„åˆ†å‰²)ã€‚**è¿™ä¸æ˜¯æ‰¾åˆ°æœ€ä½³åˆ†å‰²**çš„æœ€å¿«æ–¹æ³•ï¼Œä½†å´æ˜¯æœ€å®¹æ˜“ç†è§£çš„ã€‚

å°è¯•æ¯ä¸€æ¬¡åˆ†è£‚æ„å‘³ç€å°è¯•

*   æ¯ä¸ªç‰¹å¾(x æˆ– y)ã€‚
*   æ‰€æœ‰â€œå”¯ä¸€â€é˜ˆå€¼ã€‚æˆ‘ä»¬åªéœ€è¦å°è¯•äº§ç”Ÿä¸åŒåˆ†è£‚çš„é˜ˆå€¼ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨ x åæ ‡ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»¥ä¸‹é˜ˆå€¼:

[![](../Images/c9af7fd7b418178bbba851b9fdb536e7.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--9jz3AEEv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/dataset2-thresholds-x.svg) 

<figcaption>x é˜ˆå€¼</figcaption>

è®©æˆ‘ä»¬å¯¹ x=0.4 çš„åˆ†å‰²åšä¸€ä¸ªåŸºå°¼ç³»æ•°è®¡ç®—çš„ä¾‹å­ã€‚

[![](../Images/335cc6a7202c76e6e264713c38219ab1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--B0e9t5cK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/j6dl96l2tlmpn7ragihr.png)

é¦–å…ˆï¼Œæˆ‘ä»¬è®¡ç®—æ•´ä¸ªæ•°æ®é›†çš„åŸºå°¼ç³»æ•°:

[![](../Images/39c67a04a878481f0ae30b4e99fafe13.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--uL4Q-SSs--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/yavkzt1pfq6xrd3c3etf.png)

ç„¶åï¼Œæˆ‘ä»¬è®¡ç®—ä¸¤ä¸ªåˆ†æ”¯çš„åŸºå°¼ç³»æ•°:

[![](../Images/de2275224d566040da73f778ca3dd574.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--LD-ADTYZ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/pibzd5vzmvuzcjcbkuno.png)

æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ä»åŸå§‹æ‚è´¨ä¸­å‡å»åŠ æƒåˆ†æ”¯æ‚è´¨æ¥è®¡ç®—åŸºå°¼ç³»æ•°:

[![](../Images/70559caf10f4349b056b2dfadd7b8321.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--byCvHbSX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/arwvak8l6qeo57svtrs6.png)

> å¯¹åˆšåˆšå‘ç”Ÿçš„äº‹æ„Ÿåˆ°å›°æƒ‘ï¼Ÿæˆ‘å‘Šè¯‰è¿‡ä½ ä½ åº”è¯¥è¯»ä¸€ä¸‹[æˆ‘çš„åŸºå°¼ä¸æ´è´´](https://victorzhou.com/blog/gini-impurity/)ã€‚å®ƒå¯ä»¥è§£é‡Šæ‰€æœ‰è¿™äº›åŸºå°¼ç³»æ•°ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•è®¡ç®—æ¯ä¸€ç§å¯èƒ½åˆ†å‰²çš„åŸºå°¼ç³»æ•°:

[![](../Images/c3a4dfb1c9d717fd155a10a191c7abbe.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--1_1dH6Kh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/jnq4bevt5jflhihuzjdo.png)

[![](../Images/41d1e34eb772d7567ff58f3495ccff7b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--RZZRI7fn--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/dataset2-thresholds.svg) 

<figcaption>æ‰€æœ‰é—¨æ§›</figcaption>

åœ¨å°è¯•äº† x å’Œ y çš„æ‰€æœ‰é˜ˆå€¼åï¼Œæˆ‘ä»¬å‘ç° x=2 çš„åˆ†å‰²å…·æœ‰æœ€é«˜çš„ Gini å¢ç›Šï¼Œå› æ­¤æˆ‘ä»¬å°†ä½¿æˆ‘ä»¬çš„æ ¹å†³ç­–èŠ‚ç‚¹ä½¿ç”¨é˜ˆå€¼ä¸º 2 çš„ x ç‰¹å¾ã€‚è¿™æ˜¯æˆ‘ä»¬ç›®å‰æŒæ¡çš„æƒ…å†µ:

[![](../Images/e2bab5215c5e865bce1162a2155505e5.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--5RLQu8kU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/decision-tree2-build1.svg)

ä¸æ–­è¿›æ­¥ï¼

### [](#22-training-a-decision-tree-the-second-node)2.2:è®­ç»ƒå†³ç­–æ ‘:ç¬¬äºŒä¸ªèŠ‚ç‚¹

æ˜¯æ—¶å€™åšå‡ºæˆ‘ä»¬çš„ç¬¬äºŒä¸ªå†³å®šäº†ã€‚æˆ‘ä»¬(ä»»æ„)å»å·¦æ”¯å§ã€‚**æˆ‘ä»¬ç°åœ¨åªä½¿ç”¨å°†é‡‡å–å·¦åˆ†æ”¯**çš„æ•°æ®ç‚¹(å³æ»¡è¶³ x < 2 çš„æ•°æ®ç‚¹)ï¼Œç‰¹åˆ«æ˜¯ 3 ä¸ªè“è‰²å’Œ 3 ä¸ªçº¢è‰²ã€‚

ä¸ºäº†æ„å»ºæˆ‘ä»¬çš„ç¬¬äºŒä¸ªå†³ç­–èŠ‚ç‚¹ï¼Œ**æˆ‘ä»¬åªæ˜¯åšåŒæ ·çš„äº‹æƒ…ï¼**æˆ‘ä»¬å¯¹ç°æœ‰çš„ 6 ä¸ªæ•°æ®ç‚¹å°è¯•äº†æ¯ä¸€ç§å¯èƒ½çš„åˆ†å‰²ï¼Œå¹¶æ„è¯†åˆ° y=2 æ˜¯æœ€ä½³åˆ†å‰²ã€‚æˆ‘ä»¬æŠŠå®ƒå˜æˆä¸€ä¸ªå†³ç­–èŠ‚ç‚¹ï¼Œç°åœ¨æœ‰äº†è¿™ä¸ª:

[![](../Images/aae9fede94f517f9e08d94e0dc569c01.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--CwLpq9Wv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/decision-tree2-build2.svg)

æˆ‘ä»¬çš„å†³ç­–æ ‘å·®ä¸å¤šå®Œæˆäº†â€¦

### [](#23-training-a-decision-tree-when-to-stop)2.3 è®­ç»ƒä¸€ä¸ªå†³ç­–æ ‘:ä½•æ—¶åœæ­¢ï¼Ÿ

è®©æˆ‘ä»¬ç»§ç»­ä¸‹å»ï¼Œè¯•ç€åšç¬¬ä¸‰ä¸ªå†³ç­–èŠ‚ç‚¹ã€‚è¿™æ¬¡æˆ‘ä»¬å°†ä½¿ç”¨æ ¹èŠ‚ç‚¹çš„å³åˆ†æ”¯ã€‚è¯¥åˆ†æ”¯ä¸­å”¯ä¸€çš„æ•°æ®ç‚¹æ˜¯ 3 ä¸ªæœå²­ã€‚

åŒæ ·ï¼Œæˆ‘ä»¬å°è¯•äº†æ‰€æœ‰å¯èƒ½çš„åˆ†è£‚ï¼Œä½†ä»–ä»¬éƒ½

*   éƒ½ä¸€æ ·å¥½ã€‚
*   åŸºå°¼ç³»æ•°ä¸º 0(åŸºå°¼ç³»æ•°å·²ç»æ˜¯ 0ï¼Œä¸èƒ½å†ä½äº†)ã€‚

åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ªå†³ç­–èŠ‚ç‚¹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºè¿™æ ·åšä¸ä¼šæ”¹è¿›æˆ‘ä»¬çš„å†³ç­–æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿è¿™ä¸ªèŠ‚ç‚¹æˆä¸ºä¸€ä¸ª**å¶èŠ‚ç‚¹**ï¼Œå¹¶ç»™å®ƒè´´ä¸Šç»¿è‰²æ ‡ç­¾ã€‚è¿™æ„å‘³ç€**æˆ‘ä»¬å°†åˆ°è¾¾è¿™ä¸ªèŠ‚ç‚¹çš„ä»»ä½•æ•°æ®ç‚¹å½’ç±»ä¸ºç»¿è‰²**ã€‚

å¦‚æœæˆ‘ä»¬ç»§ç»­å‰©ä¸‹çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼ŒåŒæ ·çš„äº‹æƒ…ä¼šå‘ç”Ÿ:æˆ‘ä»¬å°†å·¦ä¸‹æ–¹çš„èŠ‚ç‚¹ä½œä¸ºè“å¶èŠ‚ç‚¹ï¼Œå°†å³ä¸‹æ–¹çš„èŠ‚ç‚¹ä½œä¸ºçº¢å¶èŠ‚ç‚¹ã€‚è¿™ç»™æˆ‘ä»¬å¸¦æ¥äº†æœ€åçš„ç»“æœ:

[![](../Images/a39ea0e0a864540e0200ed9434fdcd6a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--huxR6756--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/decision-tree2.svg)

ä¸€æ—¦æˆ‘ä»¬çš„å†³ç­–æ ‘ä¸­æ‰€æœ‰å¯èƒ½çš„åˆ†æ”¯éƒ½ä»¥å¶èŠ‚ç‚¹ç»“æŸï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ã€‚æˆ‘ä»¬å·²ç»è®­ç»ƒäº†ä¸€ä¸ªå†³ç­–æ ‘ï¼

## [](#3-random-forests)3ã€‚éšæœºæ£®æ—ğŸŒ²ğŸŒ³ğŸŒ²ğŸŒ³ğŸŒ²

æˆ‘ä»¬ç»ˆäºå‡†å¤‡å¥½è®¨è®ºéšæœºæ£®æ—äº†ã€‚è®°å¾—æˆ‘ä¹‹å‰è¯´çš„å—ï¼Ÿ

> éšæœºæ£®æ—å®é™…ä¸Šåªæ˜¯æ†ç»‘åœ¨ä¸€èµ·çš„ä¸€å †å†³ç­–æ ‘ã€‚

è¿™æ˜¯çœŸçš„ï¼Œä½†æœ‰ç‚¹ç®€å•åŒ–äº†ã€‚

### [](#31-bagging)3.1 è£…è¢‹

è€ƒè™‘ä»¥ä¸‹ç®—æ³•ï¼Œåœ¨ç»™å®š n ä¸ªç‚¹çš„æ•°æ®é›†çš„æƒ…å†µä¸‹è®­ç»ƒä¸€æŸå†³ç­–æ ‘:

1.  æ ·æœ¬ï¼Œ**æ›¿æ¢**ï¼Œæ•°æ®é›†çš„ n ä¸ªè®­ç»ƒæ ·æœ¬ã€‚
2.  åœ¨ n ä¸ªæ ·æœ¬ä¸Šè®­ç»ƒå†³ç­–æ ‘ã€‚
3.  å¯¹äºæŸäº›æµ‹è¯•ï¼Œé‡å¤æµ‹è¯•æ¬¡æ•°

ä¸ºäº†ä½¿ç”¨ t æ ‘çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œæˆ‘ä»¬èšé›†æ¥è‡ªå„ä¸ªå†³ç­–æ ‘çš„é¢„æµ‹ï¼Œå¹¶ä¸”

*   å¦‚æœæˆ‘ä»¬çš„æ ‘äº§ç”Ÿäº†ç±»åˆ«æ ‡ç­¾(æ¯”å¦‚é¢œè‰²)ï¼Œå°±é‡‡å–**å¤šæ•°æŠ•ç¥¨**ã€‚
*   å¦‚æœæˆ‘ä»¬çš„æ ‘äº§ç”Ÿæ•°å€¼(ä¾‹å¦‚é¢„æµ‹æ¸©åº¦ã€ä»·æ ¼ç­‰)ï¼Œåˆ™å–å¹³å‡å€¼ã€‚

è¿™ç§æŠ€æœ¯å«åš**è£…è¢‹**ï¼Œæˆ–[T3ã€‘b è£…è¢‹**èšé›†**å†èšé›†](https://en.wikipedia.org/wiki/Bootstrap_aggregating)ã€‚æˆ‘ä»¬è¿›è¡Œçš„æ›¿æ¢æŠ½æ ·è¢«ç§°ä¸º [bootstrap](https://en.wikipedia.org/wiki/Bootstrapping_(statistics)) æ ·æœ¬ã€‚

[![](../Images/2fadea208ebed0491c9e0fed1f2417de.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--_s24-vEK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://victorzhou.com/media/random-forest-post/random-forest.svg)T3ã€‘è¢‹è£…å†³ç­–æ ‘é¢„æµ‹é¢œè‰²

è¢‹è£…å†³ç­–æ ‘éå¸¸æ¥è¿‘éšæœºæ£®æ—â€”â€”å®ƒä»¬åªæ˜¯ç¼ºå°‘äº†ä¸€æ ·ä¸œè¥¿â€¦

### [](#32-bagging-%E2%86%92-random-forest)3.2 è£…è¢‹â†’éšæœºæ£®æ—

è¢‹è£…å†³ç­–æ ‘åªæœ‰ä¸€ä¸ªå‚æ•°:tï¼Œæ ‘çš„æ•°é‡ã€‚

éšæœºæ£®æ—è¿˜æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ§åˆ¶åœ¨å¯»æ‰¾æœ€ä½³åˆ†å‰²ç‚¹æ—¶è¦å°è¯•å¤šå°‘ç‰¹æ€§ã€‚æœ¬æ•™ç¨‹ä¸­çš„ç®€å•æ•°æ®é›†åªæœ‰ä¸¤ä¸ªç‰¹å¾(x å’Œ y)ï¼Œä½†å¤§å¤šæ•°æ•°æ®é›†éƒ½æœ‰æ›´å¤šçš„ç‰¹å¾(æ•°ç™¾æˆ–æ•°åƒ)ã€‚

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å« p ä¸ªè¦ç´ çš„æ•°æ®é›†ã€‚ä¸æ˜¯æ¯æ¬¡æˆ‘ä»¬åšä¸€ä¸ªæ–°çš„å†³ç­–èŠ‚ç‚¹éƒ½å°è¯•æ‰€æœ‰çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬**åªæ˜¯å°è¯•ç‰¹æ€§**çš„ä¸€ä¸ªå­é›†ã€‚æˆ‘ä»¬è¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†æ³¨å…¥éšæœºæ€§ï¼Œè®©æ¯æ£µæ ‘éƒ½æ›´åŠ ç‹¬ç‰¹ï¼Œ**å‡å°‘äº†æ ‘ä¸æ ‘ä¹‹é—´çš„ç›¸å…³æ€§**ï¼Œä»è€Œæé«˜äº†æ£®æ—çš„æ•´ä½“æ€§èƒ½ã€‚è¿™ç§æŠ€æœ¯æœ‰æ—¶è¢«ç§°ä¸º**ç‰¹å¾è£…è¢‹**ã€‚

## [](#4-now-what)4ã€‚ç°åœ¨æ€ä¹ˆåŠï¼Ÿ

è¿™æ˜¯ä¸€ä¸ªåˆå­¦è€…å¯¹éšæœºæ£®æ—çš„ä»‹ç»ï¼å¿«é€Ÿå›é¡¾ä¸€ä¸‹æˆ‘ä»¬çš„å·¥ä½œ:

*   ä»‹ç»äº†**å†³ç­–æ ‘**ï¼Œéšæœºæ£®æ—çš„æ„å»ºæ¨¡å—ã€‚
*   å­¦ä¹ äº†å¦‚ä½•é€šè¿‡è¿­ä»£è¿›è¡Œå¯èƒ½çš„æœ€ä½³åˆ†å‰²æ¥è®­ç»ƒå†³ç­–æ ‘ã€‚
*   å®šä¹‰[åŸºå°¼ç³»æ•°](https://victorzhou.com/blog/gini-impurity/)ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥é‡åŒ–æ”¶å…¥å·®è·æœ‰å¤šâ€œå¥½â€çš„æŒ‡æ ‡ã€‚
*   æˆ‘çœ‹åˆ°äº†ä¸€ä¸ªéšæœºæ£®æ—=ä¸€å †å†³ç­–æ ‘ã€‚
*   äº†è§£ **bagging** å¦‚ä½•ç»“åˆå¤šæ£µæ ‘çš„é¢„æµ‹ã€‚
*   äº†è§£åˆ°**ç‰¹å¾è£…è¢‹**æ˜¯è£…è¢‹å†³ç­–æ ‘å’Œéšæœºæ£®æ—çš„åŒºåˆ«ã€‚

ä½ å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›äº‹æƒ…:

*   åœ¨çœŸå®æ•°æ®é›†ä¸Šè¯•éªŒ scikit-learn çš„[å†³ç­–æ ‘åˆ†ç±»å™¨](https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html)å’Œ [RandomForestClassifier](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html) ç±»ã€‚
*   å°è¯•ä»å¤´å¼€å§‹ç¼–å†™ä¸€ä¸ªç®€å•çš„å†³ç­–æ ‘æˆ–éšæœºæ£®æ—å®ç°ã€‚æˆ‘å¾ˆä¹æ„ç»™äºˆæŒ‡å¯¼æˆ–ä»£ç å®¡æŸ¥ï¼åªéœ€[å‘å¾®åšç»™æˆ‘](https://twitter.com/victorczhou)æˆ–è€…[å‘é‚®ä»¶ç»™æˆ‘](mailto:vzhou842@gmail.com)ã€‚
*   é˜…è¯»å…³äº[æ¢¯åº¦å¢å¼ºå†³ç­–æ ‘](https://en.wikipedia.org/wiki/Gradient_boosting#Gradient_tree_boosting)çš„æ–‡ç« ï¼Œå¹¶ä½¿ç”¨ [XGBoost](https://xgboost.readthedocs.io/en/latest/) è¿™ä¸ªå¼ºå¤§çš„æ¢¯åº¦å¢å¼ºåº“ã€‚
*   é˜…è¯»å…³äºéšæœºæ£®æ—çš„æ‰©å±•[ext tree](https://en.wikipedia.org/wiki/Random_forest#ExtraTrees)ï¼Œæˆ–è€…ç© scikit-learn çš„[ext tree classifier](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.ExtraTreesClassifier.html)ç±»ã€‚

æœ¬æ•™ç¨‹åˆ°æ­¤ç»“æŸã€‚æˆ‘å–œæ¬¢[å†™å…³äºæœºå™¨å­¦ä¹ çš„](/tag/machine-learning)(ä½†ä¹Ÿæœ‰å…¶ä»–è¯é¢˜)ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³å¾—åˆ°æ–°å¸–å­çš„é€šçŸ¥ï¼Œè¯· **[è®¢é˜…](http://eepurl.com/gf8JCX)ã€‚**

æ„Ÿè°¢é˜…è¯»ï¼