# å¯è®¿é—®çš„ React æ‰‹é£ç´ç»„ä»¶

> åŸæ–‡:[https://dev . to/stereo booster/accessible-react-accordion-component-4p 99](https://dev.to/stereobooster/accessible-react-accordion-component-4p99)

å…³äºç¼–å†™ React accessible accordion ç»„ä»¶æœ‰å¤šç®€å•çš„å°å®éªŒ(è½¬åˆ°æ•™ç¨‹ä¸­)ã€‚æˆ‘ä»¥å‰æ²¡æœ‰å¯è®¿é—®æ€§æ–¹é¢çš„ç»éªŒ(å—¯ï¼Œä¹Ÿè®¸æ˜¯ä¸€äº›åŸºæœ¬çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ä½¿ç”¨ alt param ä¸è¦ä½¿ç”¨é“¾æ¥ä½œä¸ºæŒ‰é’®)ã€‚

æˆ‘éµå¾ª WAI-ARIA åˆ›ä½œå®è·µ 1.1 ä¸­çš„[æ‰‹é£ç´å¼è®¾è®¡æ¨¡å¼ï¼Œåˆ«æ— å…¶ä»–ã€‚](https://www.w3.org/TR/wai-aria-practices/examples/accordion/accordion.html)

æœ¬æ•™ç¨‹çš„é‡ç‚¹æ˜¯ a11y å’Œ Reactï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä¼šå…³å¿ƒå¦‚ä½•æ‰“åŒ…åˆ° npm æˆ– CSS-in-JS æˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ create-react-appã€‚

### [](#bootstrap)è‡ªä¸¾

è®©æˆ‘ä»¬å¯åŠ¨æˆ‘ä»¬çš„é¡¹ç›®

```
npx create-react-app my-app
cd my-app
npm start 
```

[å»æ‰ä¸€åˆ‡æ— å…³çš„ä¸œè¥¿](https://github.com/stereobooster/react-accessible-accordion/commit/6664bb290e5d68f415bd236202c61a091a5cc80e)ã€‚

### [](#design-api)è®¾è®¡ API

æ˜¯æ—¶å€™è€ƒè™‘ä¸€ä¸‹ç»„ä»¶çš„ API äº†ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹å…¸å‹çš„æ‰‹é£ç´:

[![](../Images/2d020c3ba3c6fb0153abf62364ed2977.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--3HeGWSiw--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/i8ca76wwevbvyewidy8v.png)

æœ‰ä¸€ä¸ªæ ¹ç»„ä»¶å’Œå‡ ä¸ªéƒ¨åˆ†ã€‚æ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰ä¸€ä¸ªæ ‡é¢˜å’Œå†…å®¹ã€‚å¯¹å—ï¼ŸåŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡æˆ‘ä»¬çš„ API ä¼šæ˜¯ä»€ä¹ˆæ ·å­:

```
const App = () => (
  <Accordion>
    <AccordionSection title="section 1">content 1</AccordionSection>
    <AccordionSection title="section 2" expanded>
      content 2
    </AccordionSection>
  </Accordion> ); 
```

è®©æˆ‘ä»¬ä¸ºç»™å®šçš„ API
ç¼–å†™ç»„ä»¶çš„åˆç¨¿

```
import React from "react";

export const Accordion = ({ children }) => <div>{children}</div>; 
export const AccordionSection = ({ children, title, expanded }) => (
  <>
    <div>{title}</div>
    <div>{expanded && children}</div>
  </> ); 
```

### [](#add-a11y)æ·»åŠ  a11y

å¾ˆå¥½ã€‚è®©æˆ‘ä»¬åœ¨ WAI-ARIA åˆ›ä½œå®è·µ 1.1 ä¸­æ‰“å¼€[æ‰‹é£ç´å¼è®¾è®¡æ¨¡å¼ï¼Œå¹¶å¤åˆ¶ç²˜è´´æ‰€æœ‰éœ€è¦çš„æ ‡è®°:](https://www.w3.org/TR/wai-aria-practices/examples/accordion/accordion.html) 

```
export const AccordionSection = ({ children, title, expanded, id }) => {
  const sectionId = `section-${id}`;
  const labelId = `label-${id}`;

  return (
    <>
      <div
        role="button"
        aria-expanded={expanded}
        aria-controls={sectionId}
        id={labelId}
        tabIndex={0}
      >
        {title}
      </div>
      <div
        role="region"
        aria-labelledby={labelId}
        id={sectionId}
        hidden={!expanded}
      >
        {expanded && children}
      </div>
    </>
  );
}; 
```

`Accordion`ä¸éœ€è¦æ”¹å˜ã€‚æœ‰ä¸¤ä¸ªå…ƒç´ :æ ‡é¢˜å’Œé¢æ¿ã€‚è¡¨å¤´(`role="button"`)æœ‰`id`å’Œ`aria-controls`(å¯¹åº”é¢æ¿çš„`id`)ã€‚é¢æ¿(`role="region"`)æœ‰`id`å’Œ`aria-labelledby`(å¯¹åº”è¡¨å¤´çš„`id`)ã€‚`aria-expanded`èŠ‚æ˜¯å¦å±•å¼€ã€‚`hidden`ä¸æˆªé¢æ˜¯å¦å±•å¼€ç›¸åã€‚åœ¨æˆ‘çœ‹æ¥å¾ˆç®€å•ã€‚

[å†æ¥åŠ ç‚¹é£æ ¼](https://github.com/stereobooster/react-accessible-accordion/commit/2eb6ad679485339213d08e8c9c887faab5ecae10)ã€‚

[![](../Images/46e565e1db8a7a40f072be6fedbc6763.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--vffIVe2T--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/fn7hcxim89iqbr7ptbxy.png)

[ç°åœ¨æ˜¯æ·»åŠ çŠ¶æ€å’Œäº‹ä»¶å¤„ç†](https://github.com/stereobooster/react-accessible-accordion/commit/8f014094701860a879efa7179223af282590e980)çš„æ—¶å€™äº†ã€‚

çŠ¶æ€å’Œå›è°ƒ(æˆ‘ä»¬æ­£åœ¨åˆ›å»º[å—æ§ç»„ä»¶](https://reactjs.org/docs/forms.html#controlled-components) ):

```
function App() {
  const [expanded1, setExpanded1] = useState(false);
  return (
      <Accordion>
        <AccordionSection
      ...
          expanded={expanded1}
          onToggle={() => setExpanded1(!expanded1)}
        > 
```

äº‹ä»¶å¤„ç†

```
export const AccordionSection = ({
  ...
  expanded,
  onToggle
}) => {
  ...
  return (
    <>
      <div
        role="button"
        ...
        onClick={onToggle}
        onKeyDown={e => {
          switch (e.key) {
            case "  ":
            case "Enter":
              onToggle();
              break;
            default:
          }
        }}
      > 
```

### [](#lets-pause)è®©æˆ‘ä»¬æš‚åœä¸€ä¸‹

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå·²ç»æ˜¯ç›¸å½“ä¸é”™çš„æˆç»©äº†ã€‚æˆ‘ä»¬å®Œæˆäº† a11y çš„ä¸€åŠè¦æ±‚ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šçš„å·¥ä½œã€‚

*   `Space`æˆ–`Enter`
    *   å½“ç„¦ç‚¹åœ¨æŠ˜å éƒ¨åˆ†çš„æŠ˜å æ ‡é¢˜ä¸Šæ—¶ï¼Œå±•å¼€è¯¥éƒ¨åˆ†ã€‚
*   `Tab`
    *   å°†ç„¦ç‚¹ç§»åˆ°ä¸‹ä¸€ä¸ªå¯èšç„¦çš„å…ƒç´ ã€‚
    *   æŠ˜å é¢æ¿ä¸­æ‰€æœ‰å¯èšç„¦çš„å…ƒç´ éƒ½åŒ…å«åœ¨é¡µé¢é€‰é¡¹å¡åºåˆ—ä¸­ã€‚
*   `Shift` + `Tab`
    *   å°†ç„¦ç‚¹ç§»åˆ°ä¸Šä¸€ä¸ªå¯èšç„¦çš„å…ƒç´ ã€‚
    *   æŠ˜å é¢æ¿ä¸­æ‰€æœ‰å¯èšç„¦çš„å…ƒç´ éƒ½åŒ…å«åœ¨é¡µé¢é€‰é¡¹å¡åºåˆ—ä¸­ã€‚

å¦‚æœä½ è‡³å°‘åšåˆ°äº†è¿™ä¸€ç‚¹ï¼Œé‚£å·²ç»æ¯”ä»€ä¹ˆéƒ½æ²¡æœ‰å¼ºäº†ã€‚

### [](#more-a11y)æ›´ a11y

[ä¸‹ä¸€èŠ‚](https://github.com/stereobooster/react-accessible-accordion/commit/3d894bf54170b0ad0b643058118b615876250ea2)æœ‰ç‚¹å¤æ‚(æ›´å¥½ç©)ã€‚

*   `Down Arrow`
    *   å½“ç„¦ç‚¹åœ¨æŠ˜å æ ‡é¢˜ä¸Šæ—¶ï¼Œå°†ç„¦ç‚¹ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæŠ˜å æ ‡é¢˜ã€‚
    *   å½“ç„¦ç‚¹åœ¨æœ€åä¸€ä¸ªæŠ˜å é¡¹æ ‡é¢˜ä¸Šæ—¶ï¼Œå°†ç„¦ç‚¹ç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªæŠ˜å é¡¹æ ‡é¢˜ã€‚
*   `Up Arrow`
    *   å½“ç„¦ç‚¹åœ¨æŠ˜å æ ‡é¢˜ä¸Šæ—¶ï¼Œå°†ç„¦ç‚¹ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªæŠ˜å æ ‡é¢˜ã€‚
    *   å½“ç„¦ç‚¹åœ¨ç¬¬ä¸€ä¸ªæŠ˜å é¡¹æ ‡é¢˜ä¸Šæ—¶ï¼Œå°†ç„¦ç‚¹ç§»åŠ¨åˆ°æœ€åä¸€ä¸ªæŠ˜å é¡¹æ ‡é¢˜ã€‚

è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦è·Ÿè¸ªå“ªé‡Œæ˜¯ç„¦ç‚¹ï¼Œèƒ½å¤Ÿé€‰æ‹©ä¸‹ä¸€ä¸ªæˆ–ä¸Šä¸€ä¸ªéƒ¨åˆ†ã€‚æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªæ‰‹é£ç´å­˜å‚¨ä¸€æ¬¡å˜é‡ã€‚æ‰€ä»¥ä¹Ÿè®¸`useState`ï¼Ÿå—¯ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³åœ¨ç„¦ç‚¹æ”¹å˜æ—¶è§¦å‘ç»„ä»¶çš„é‡æ–°å‘ˆç°ã€‚ç„¶å`useRef`æˆ‘çŒœã€‚

```
export const Accordion = ({ children }) => {
  const focusRef = useRef(null); 
```

`focusRef`å°†åŒ…å«å½“å‰èšç„¦éƒ¨åˆ†çš„`id`æˆ–è€…åœ¨æ²¡æœ‰é€‰æ‹©çš„æƒ…å†µä¸‹åŒ…å«`null`ã€‚æˆ‘ä»¬éœ€è¦è·Ÿè¸ªæ ‡é¢˜ä¸Šçš„`focus`å’Œ`blur`äº‹ä»¶ã€‚

```
<div
  role="button"
  ...
  onFocus={() => {
    focusRef.current = id;
  }}
  onBlur={() => {
    focusRef.current = null;
  }} 
```

é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å°†`focusRef`ä»`Accordion`ä¼ é€’åˆ°`AccordionSection`ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡é“å…·(ç”¨`React.Childre.map`å’Œ`React.CloneElement`)æˆ–è€…ä¸Šä¸‹æ–‡æ¥å®Œæˆã€‚æˆ‘æ›´å–œæ¬¢ä¸Šä¸‹æ–‡æ€æƒ³ï¼Œå› ä¸ºå®ƒåˆ›å»ºäº†æ›´å¹²å‡€çš„ APIã€‚

åˆ›å»ºä¸Šä¸‹æ–‡:

```
const AccordionContext = createContext({
  focusRef: {}
});
export const useAccordionContext = () => useContext(AccordionContext); 
```

å°†`focusRef`ä¼ é€’ç»™`Context`(æˆ‘ä½¿ç”¨`useMemo`æ¥ç¡®ä¿æˆ‘ä»¬ä¸ä¼šå› ä¸º`Context`ä¸­çš„æ›´æ–°è€Œè§¦å‘ä¸éœ€è¦çš„é‡æ–°å‘ˆç°å™¨)

```
const context = useMemo(
  () => ({
    focusRef
  }),
  []
);

return (
  <AccordionContext.Provider value={context}>
    {children}
  </AccordionContext.Provider>
); 
```

è€Œåœ¨`AccordionSection`å’Œ

```
const { focusRef } = useAccordionContext(); 
```

å¥½äº†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ•æ‰å½“å‰é€‰ä¸­çš„éƒ¨åˆ†ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦å“åº”é”®ç›˜äº‹ä»¶ï¼Œè®©æˆ‘ä»¬åœ¨æ ¹ç»„ä»¶ä¸­æ·»åŠ ä¸€ä¸ªå¤„ç†ç¨‹åº:

```
export const AccordionSection = ({}) => {
  ...
  return (
    <div
      onKeyDown={e => {
        switch (e.key) {
          case "ArrowDown":
            break;
          case "ArrowUp":
            break;
          case "Home":
            break;
          case "End":
            break;
        }
      }}
    >
      <AccordionContext.Provider value={context}> 
```

åœ¨`ArrowDown`çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°`children`ä¸­çš„`focus`å…ƒç´ ï¼Œå¹¶é€‰æ‹©ä¸‹ä¸€ä¸ªã€‚æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªåŒ…å«`children`å…ƒç´ 
çš„æ‰€æœ‰`id`çš„æ•°ç»„

```
const ids = React.Children.map(children, child => child.props.id); 
```

ç„¶åæ‰¾åˆ°èšç„¦å…ƒç´ çš„ç´¢å¼•

```
const index = ids.findIndex(x => x === focusRef.current); 
```

ç„¶åæ‰¾åˆ°ä¸‹ä¸€ä¸ªå€¼

```
if (index >= ids.length - 1) {
  return ids[0];
} else {
  return ids[index + 1];
} 
```

å¾ˆå¥½ã€‚ä½†æ˜¯æˆ‘ä»¬å°†å¦‚ä½•å¼•å‘ç„¦ç‚¹çš„æ”¹å˜å‘¢ï¼ŸğŸ¤”
å¯¹æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ [`focus()`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus) çš„æ–¹æ³•ã€‚ä¸ºäº†å¾—åˆ°ä¸€ä¸ª DOM å…ƒç´ ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ referenceã€‚

```
export const AccordionSection = ({}) => {
  const labelRef = useRef();
  ...
  return (
    <>
      <div
        role="button"
        ...
        ref={labelRef}
      > 
```

æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨`useEffect`æ¥å®é™…è°ƒç”¨ DOM å…ƒç´ ä¸Šçš„æ–¹æ³•ã€‚é—®é¢˜æ˜¯ä»€ä¹ˆæ—¶å€™è§¦å‘è¿™ä¸ªæ•ˆæœï¼Ÿæˆ‘ä»¬éœ€è¦åœ¨æ¯æ¬¡æ ‡ç­¾é¡µçš„é€‰æ‹©æ”¹å˜æ—¶ï¼Œæ¯æ¬¡ç”¨æˆ·è§¦å‘`ArrowDown`æˆ–`ArrowUp`ç­‰æ—¶è§¦å‘å®ƒã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å®ƒå­˜å‚¨åœ¨æŸä¸ªå˜é‡ä¸­ï¼Œå¹¶åœ¨å®ƒæ¯æ¬¡æ”¹å˜æ—¶è§¦å‘æ•ˆæœ

```
export const AccordionSection = ({}) => {
  ...
  useEffect(() => {
    if (id === selected && labelRef.current) {
      labelRef.current.focus();
    }
  }, [id, selected]); 
```

æ¯æ¬¡é€‰æ‹©å‘ç”Ÿå˜åŒ–ï¼Œå¹¶ä¸”æ‰€é€‰é¡¹ç›®ä¸å½“å‰é¡¹ç›®ç›¸åŒæ—¶ï¼Œå°†ç„¦ç‚¹æ”¾åœ¨å®ƒä¸Šé¢ã€‚

æˆ‘ä»¬åœ¨å“ªé‡Œå­˜å‚¨`selected`å€¼ï¼Ÿåœ¨æ ¹ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬æ¯ä¸ª`Accordion`éœ€è¦ä¸€ä¸ªå˜é‡ã€‚æˆ‘ä»¬å¦‚ä½•é€šè¿‡å®ƒï¼Ÿé€šè¿‡ä¸Šä¸‹æ–‡ï¼Œå°±åƒæˆ‘ä»¬é€šè¿‡`focusRef`ä¸€æ ·ã€‚åœ¨`Accordion` :

```
const focusRef = useRef(null);
const [selected, setSelected] = useState(null);
const context = useMemo(
  () => ({
    focusRef,
    selected
  }),
  [selected]
);
...
case "ArrowDown":
  {
    const ids = React.Children.map(children, child => child.props.id);
    const index = ids.findIndex(x => x === focusRef.current);
    if (index >= ids.length - 1) {
      setSelected(ids[0]);
    } else {
      setSelected(ids[index + 1]);
    }
  } 
```

å¹¶ä¸”åœ¨`AccordionSection` :

```
const { focusRef, selected } = useAccordionContext(); 
```

å”·ï¼æˆ‘ä»¬æˆåŠŸäº†ã€‚å®Œå…¨å¯è®¿é—®çš„ç»„ä»¶ã€‚ä¸è¦å¿˜è®°æ·»åŠ é€»è¾‘

*   ä¸»é¡µ
    *   å½“ç„¦ç‚¹åœ¨æŠ˜å æ ‡é¢˜ä¸Šæ—¶ï¼Œå°†ç„¦ç‚¹ç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªæŠ˜å æ ‡é¢˜ã€‚
*   ç»“æŸ
    *   å½“ç„¦ç‚¹åœ¨æŠ˜å æ ‡é¢˜ä¸Šæ—¶ï¼Œå°†ç„¦ç‚¹ç§»åŠ¨åˆ°æœ€åä¸€ä¸ªæŠ˜å æ ‡é¢˜ã€‚

### [](#developer-experience)å¼€å‘è€…ä½“éªŒ

æˆ‘ä»¬ç…§é¡¾äº†ç”¨æˆ·ï¼Œè®©æˆ‘ä»¬ç…§é¡¾å¼€å‘è€…ã€‚æˆ‘ä»¬éå¸¸ä¾èµ–`id` sï¼Œä»¥é˜²å¼€å‘è€…å¿˜è®°æä¾›å®ƒï¼Œä»–ä»¬å°†ä¼šå¾—åˆ°éå¸¸ç»†å¾®çš„é”™è¯¯ã€‚[è®©æˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦å­˜åœ¨ï¼Œå¦åˆ™å‘å‡ºè­¦å‘Š](https://github.com/stereobooster/react-accessible-accordion/commit/45237580410f3e671e34347be43a306d75560dbf) :

```
AccordionSection.propTypes = {
  id: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,
  title: PropTypes.string.isRequired,
  expanded: PropTypes.bool,
  onToggle: PropTypes.func
}; 
```

åŒæ ·æˆ‘ä»¬å‡è®¾`id` s æ˜¯å”¯ä¸€çš„ï¼Œ[è®©æˆ‘ä»¬ä¹Ÿæ£€æŸ¥ä¸€ä¸‹](https://github.com/stereobooster/react-accessible-accordion/commit/8edb4dfcaaf38fa59e8f50534ec0711ca991cdb1) :

```
if (process.env.NODE_ENV === "development") {
  const uniqueIds = new Set();
  React.Children.forEach(children, child => {
    if (uniqueIds.has(child.props.id)) {
      console.warn(
        `AccordionSection id param should be unique, found the duplicate key: ${
          child.props.id
        }`
      );
    } else {
      uniqueIds.add(child.props.id);
    }
  });
} 
```

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ç»„ä»¶çš„ API éœ€è¦ä¸€ä¸ª onToggle å›è°ƒå‡½æ•°ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°è¢«ç»‘å®šåˆ°å®ƒçš„ id æˆ–è€…å¯¹æ¯ä¸ªéƒ¨åˆ†éƒ½æ˜¯å”¯ä¸€çš„ã€‚è¿™ä¸ª API å¾ˆéš¾ç”¨ã€‚[è®©æˆ‘ä»¬æ”¹ä¸ºé€šè¿‡`id`æ¥å›è°ƒ](https://github.com/stereobooster/react-accessible-accordion/commit/37131d743e145f6cad25f12779782f4377061f1b)ã€‚è¿™æ ·ï¼Œå¼€å‘è€…å¯ä»¥å¯¹æ‰€æœ‰éƒ¨åˆ†ä½¿ç”¨ä¸€ä¸ªå­˜å‚¨å’Œä¸€ä¸ªå›è°ƒ:

```
const [expanded, setExpanded] = useState({ "2": true });
const toggle = id => {
  setExpanded({
    ...expanded,
    [id]: !expanded[id]
  });
};
...
<AccordionSection
  title="section 1"
  id="1"
  expanded={expanded["1"]}
  onToggle={toggle}
>
...
<AccordionSection
  title="section 2"
  id="2"
  expanded={expanded["2"]}
  onToggle={toggle} 
```

æˆ‘ä¸å–œæ¬¢æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªéƒ¨åˆ†é‡å¤`expanded`å’Œ`onToggle`ï¼Œç›¸åï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä¼ é€’ç»™`Accordion` :

```
<Accordion expanded={expanded} onToggle={onToggle}>
  <AccordionSection title="section 1" id="id1">
  ...
  </AccordionSection>
  <AccordionSection title="section 2" id="id2">
  ...
  </AccordionSection>
</Accordion> 
```

è¿™æ ·çœ‹èµ·æ¥æ›´å¹²å‡€ã€‚è¿˜æœ‰ä¸€äº›ç¼ºç‚¹ï¼Œæ¯”å¦‚ä½ éœ€è¦ç¡®ä¿ state ä¸­çš„ id å’Œ`AccordionSection`ä¸­çš„ id æ˜¯ç›¸åŒçš„(å¦åˆ™æŸäº›éƒ¨åˆ†å¯èƒ½æ— æ³•å·¥ä½œ)ã€‚

æˆ‘ä»¬å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œ[ä¸ºé»˜è®¤è¡Œä¸º](https://github.com/stereobooster/react-accessible-accordion/commit/04d9070aa797f7b1f180dce3f9ce558850c9fd72)æä¾›ä¸€ä¸ªå®šåˆ¶çš„é’©å­ã€‚

```
import { useState } from "react";

export const useAccordionState = intialState => {
  const [expanded, setExpanded] = useState(intialState);
  const onToggle = id => {
    setExpanded({
      ...expanded,
      [id]: !expanded[id]
    });
  };
  return { expanded, onToggle };
}; 
```

æ‰€ä»¥æœ€ç»ˆçš„ä»£ç ä¼šæ˜¯è¿™æ ·çš„:

```
function App() {
  const accordionProps = useAccordionState({ });
  return (
      <Accordion {...accordionProps}>
        <AccordionSection title="section 1" id="id1"> 
```

### [](#conclusion)ç»“è®º

æ²¡æˆ‘æƒ³çš„é‚£ä¹ˆå¯æ€•ã€‚WAI-ARIA åˆ›ä½œå®è·µå†™å¾—å¾ˆå¥½ğŸ‘ã€‚æˆ‘é¼“åŠ±ä½ ä½¿ç”¨é€‚å½“çš„æ ‡è®°å’Œé”®ç›˜äº‹ä»¶(æ¯æ¬¡ä½¿ç”¨`onClick`)ã€‚å®ç°å®Œå…¨å¯è®¿é—®çš„ç»„ä»¶å¯èƒ½æ˜¯ä¸€ä¸ªæœ‰è¶£çš„å­¦ä¹ ç»ƒä¹ ã€‚

åœ¨çº¿æ¼”ç¤ºæ˜¯[è¿™é‡Œ](https://stereobooster.github.io/react-accessible-accordion/)ã€‚å®Œæ•´çš„æºä»£ç æ˜¯[è¿™é‡Œ](https://github.com/stereobooster/react-accessible-accordion)ã€‚

## [](#ps)PS

å¦‚æœæˆ‘ä¸ä¼šå·æ‡’ï¼Œå¦‚æœè¿™ç¯‡æ–‡ç« ä¼šå¼•èµ·æˆ‘çš„å…´è¶£ï¼Œæˆ‘ä¼šå†™å¦‚ä½•ç”¨ Cypress æµ‹è¯•è¿™ä¸ªç»„ä»¶ï¼Œä»¥åŠå¦‚ä½•ä¿®å¤æˆ‘å†™å®Œè¿™ç¯‡æ–‡ç« åæ³¨æ„åˆ°çš„ä¸€ä¸ªå·å·æ‘¸æ‘¸çš„é”™è¯¯ã€‚