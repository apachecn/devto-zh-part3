# Reddit æœºå™¨äººåˆ¶ä½œ Reddit å›å¤æœºå™¨äºº

> åŸæ–‡:[https://dev.to/seiyria/making-a-reddit-reply-bot-f55](https://dev.to/seiyria/making-a-reddit-reply-bot-f55)

æœ‰å¾ˆå¤šå…³äºç”¨ Python ç¼–å†™ reddit æœºå™¨äººçš„æ–‡æ¡£ï¼Œä½†æˆ‘ç”šè‡³å¾ˆéš¾æ‰¾åˆ° Node çš„åŸºæœ¬æ–‡æ¡£â€”â€”ç”šè‡³ reddits å®˜æ–¹ wiki ä¸Šåˆ—å‡ºçš„ä¸€äº›åº“å·²ç»è¿‡æ—¶æˆ–å·²æœ‰ 5 å¹´å†å²(é˜…è¯»:ä¸å¤ªæ”¯æŒæ–°çš„ reddit)ã€‚æ‰€ä»¥ï¼Œæˆ‘æƒ³å†™ä¸€ä¸ªç®€å•è€Œå¸¸è§çš„ç”¨ä¾‹:*å›å¤ç»™ä½ è´´æ ‡ç­¾çš„ç”¨æˆ·*ã€‚

### [](#creating-a-reddit-application)åˆ›å»º Reddit åº”ç”¨ç¨‹åº

é¦–å…ˆï¼Œå‰å¾€[https://www.reddit.com/prefs/apps](https://www.reddit.com/prefs/apps)ï¼Œç‚¹å‡»â€œåˆ›å»ºåº”ç”¨â€â€”â€”ä½ éœ€è¦è¿™æ ·åšï¼Œè¿™æ · reddit å°±ä¸ä¼šä½¿ç”¨ä½ çš„ä¸ªäººç”¨æˆ·è´¦æˆ·ã€‚ä½ ä¹Ÿåº”è¯¥ä¸ºä½ çš„æœºå™¨äººæ³¨å†Œä¸€ä¸ªæ–°çš„ reddit è´¦å·(ç‰¹åˆ«æ˜¯å½“å®ƒå¯ä»¥è¢«å¬å”¤çš„æ—¶å€™)ã€‚ç¡®ä¿æ‚¨å°†æ‚¨çš„ä¸»å¸æˆ·å’Œ bot å¸æˆ·æ·»åŠ ä¸ºè¯¥åº”ç”¨ç¨‹åºçš„å¼€å‘äººå‘˜ã€‚

åˆ›å»ºåº”ç”¨ç¨‹åºæ—¶ï¼Œæ‚¨éœ€è¦å¡«å†™å¦‚ä¸‹å­—æ®µ:

[![](../Images/1b5a18f72fbc7f95a06f18ecced86365.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--yORT8DHs--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://imgur.com/vclhFhT.png)

æ‚¨ä¸éœ€è¦æ‹…å¿ƒ`about uri`æˆ–`redirect uri`å­—æ®µï¼Œå› ä¸ºæ‚¨ä¸ä¼šä½¿ç”¨å®ƒä»¬ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥è¾“å…¥æ‚¨æƒ³è¦çš„ä»»ä½•å†…å®¹ã€‚

ä¸€æ—¦è¿›å…¥ï¼Œæ‚¨å°†çœ‹åˆ°è¿™æ ·çš„å±å¹•:

[![](../Images/c5e396fe085a79d860fd9a889ddde815.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--0Iks7Fxi--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://imgur.com/IKpfGVt.png)

è¯·æ³¨æ„è¿™ä¸€ç‚¹ï¼Œå› ä¸ºæ‚¨å¾ˆå¿«å°±ä¼šéœ€è¦è¿™äº›ä¿¡æ¯ã€‚

### [](#starting-the-node-project)å¯åŠ¨èŠ‚ç‚¹å·¥ç¨‹

å¯¹äºç±»ä¼¼è¿™æ ·çš„ä¸œè¥¿ï¼Œæˆ‘å‘ç°ä½¿ç”¨ [`snoostorm`](https://www.npmjs.com/package/snoostorm) (ä¸€ä¸ªåŒ…è£¹ [`snoowrap`](https://www.npmjs.com/package/snoowrap) )éå¸¸å®¹æ˜“ã€‚è¿™ä¸ªåº“ä½¿å¾—æ”¶åˆ°è¯„è®ºå˜å¾—å¼‚å¸¸ç®€å•ã€‚

æ‚¨é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª`snoowrap`å¯¹è±¡ï¼Œç„¶åä½¿ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ª`CommentStream`å¯¹è±¡ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦æ‚¨çš„ reddit bot ç”¨æˆ·åã€å¯†ç ã€åº”ç”¨ç¨‹åºå¯†ç å’Œåº”ç”¨ç¨‹åº idã€‚æ‚¨å¿…é¡»æŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„ç”¨æˆ·ä»£ç†ï¼Œæ‰€ä»¥ç§°å®ƒä¸ºç±»ä¼¼äº`my-node-js-bot`çš„ä¸œè¥¿ã€‚æ‰€ä»¥ï¼Œè¿™æ ·é…ç½®å§(æˆ‘çš„æ˜¯æ ¹æ®ä¸Šå›¾é…ç½®çš„):

```
const Snoowrap = require('snoowrap');
const { CommentStream } = require('snoostorm');

const client = new Snoowrap({
    userAgent: 'my-node-js-bot',
    clientId: 'qR6rJnQ7sEJZDw',
    clientSecret: 'OCoo9pYnlC2K6fxQQxbcIPQ5MA4',
    username: 'myusernamebutactuallybot',
    password: 'mypasswordbutactuallybot'
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ‰äº†è¿™ä¸ªå®¢æˆ·æœºå¯¹è±¡ï¼Œæ‚¨ç»ˆäºå¯ä»¥å¼€å§‹ç›‘å¬æ–°çš„è¯„è®ºäº†ï¼å‰å¾€ [/r/testingground4bots](https://www.reddit.com/r/testingground4bots) ï¼ŒåŠ å…¥ä¸€ä¸ªçº¿ç¨‹æˆ–åˆ›å»ºè‡ªå·±çš„çº¿ç¨‹ã€‚ç„¶åï¼Œæ·»åŠ ä¸€äº›ä»£ç å¼€å§‹è§‚çœ‹è¯„è®º:

```
// pollTime is 10000 because reddit is very strict on posting too frequently
// at first, you'll only be able to post once every 10 minutes, so make sure you get it right!
const comments = new CommentStream(client, { 
    subreddit: 'testingground4bots', 
    limit: 10, 
    pollTime: 10000 
});

comments.on('item', (item) => {
    console.log(item);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¯åŠ¨è¿™ä¸ªæœºå™¨äººï¼Œä½ ä¼šåœ¨ä½ çš„ç»ˆç«¯ä¸Šçœ‹åˆ°å¤§é‡çš„è¯„è®ºã€‚ä½ å¯èƒ½æƒ³çŸ¥é“è¿™æ˜¯ä¸ºä»€ä¹ˆ-ä½ ç”šè‡³è¿˜æ²¡æœ‰çœ‹åˆ°ä»»ä½•æ–°çš„è¿›æ¥ï¼å—¯ï¼Œå½“ä½ å¯åŠ¨ä½ çš„æœºå™¨äººæ—¶,`client`å°†æ€»æ˜¯ç»™ä½ å‰ X ä¸ªæ¡ç›®(åœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ 10 ä¸ª),ç„¶åå®ƒå°†ä»é‚£é‡Œå¼€å§‹è·Ÿè¸ªã€‚

æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è§£å†³è¿™ä¸ªé—®é¢˜:

```
// reddits api doesn't use millis
const BOT_START = Date.now() / 1000;

const comments = new CommentStream(client, { 
    subreddit: 'testingground4bots', 
    limit: 10, 
    pollTime: 10000 
});

comments.on('item', (item) => {
    if(item.created_utc < BOT_START) return;

    console.log(item);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¤ªå¥½äº†ï¼Œç°åœ¨ä½ åªèƒ½çœ‹åˆ°æœ€æ–°çš„è¯„è®ºäº†ã€‚å¸Œæœ›ä½ å·²ç»æœ‰äº†è¶³å¤Ÿçš„ reddit è´¦å·ï¼Œå¯ä»¥åœ¨è¿™ä¸ª subreddit ä¸Šå‘è¡¨ä¸€äº›å¸–å­ã€‚å¦‚æœä½ è¿™æ ·åšäº†ï¼Œä½ ä¼šçœ‹åˆ°ä½ çš„ç»ˆç«¯åœ¨å‘å¸ƒåå¾ˆå¿«å°±å¡«æ»¡äº†å®ƒä»¬ã€‚

### [](#making-it-interact)ä½¿å…¶ç›¸äº’ä½œç”¨

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»æœ‰äº†ä¸€ä¸ªæœºå™¨äººï¼Œå®ƒå¯ä»¥é˜…è¯»è¯„è®ºâ€”â€”è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ï¼ä½†æ˜¯ä½ æƒ³è®©å®ƒå’Œä½ çš„è§‚ä¼—äº’åŠ¨ï¼Œå¯¹å—ï¼Ÿé‚£ä¹ˆï¼Œä¸€ä¸ªç¾å¥½çš„â€œä½ å¥½ä¸–ç•Œâ€æ€ä¹ˆæ ·ï¼Ÿæ¥çœ‹çœ‹:

```
const BOT_START = Date.now() / 1000;

const comments = new CommentStream(client, { 
    subreddit: 'testingground4bots', 
    limit: 10, 
    pollTime: 10000 
});

comments.on('item', (item) => {
    if(item.created_utc < BOT_START) return;

    item.reply('hello world!');
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨é‚£é‡Œï¼Œä»»ä½•æ—¶å€™æœ‰è¯„è®ºè¿›æ¥ï¼Œæœºå™¨äººéƒ½ä¼šå›å¤â€œä½ å¥½ï¼Œä¸–ç•Œï¼â€ç­‰å¾…...é‚£å¯èƒ½ä¼šç»å¸¸è¯´è¯ï¼Œä¸æ˜¯å—ï¼Ÿè¿™å¯èƒ½ä¼šæœ‰ç‚¹çƒ¦äººã€‚ Reddit å»ºè®®åœ¨æåˆ°ä½ çš„æœºå™¨äººæ—¶ç‰¹åˆ«å›å¤ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªç›¸å½“ç®€å•çš„æ–¹æ³•:

```
const BOT_START = Date.now() / 1000;

const canSummon = (msg) => {
    return msg && msg.toLowerCase().includes('/u/myusernamebutactuallybot');
};

const comments = new CommentStream(client, { 
    subreddit: 'testingground4bots', 
    limit: 10, 
    pollTime: 10000 
});

comments.on('item', (item) => {
    if(item.created_utc < BOT_START) return;
    if(!canSummon(item.body)) return;

    item.reply('hello world!');
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é‚£é‡Œï¼æ‰€ä»¥ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†ç¡®ä¿ä½ çš„æœºå™¨äººæ‰¾åˆ°çš„è¯„è®º*å®é™…ä¸Šæ˜¯æŒ‡æœºå™¨äººæœ¬èº«ã€‚è¿™ä¸ª`canSummon`å‡½æ•°å°†åšåŸºæœ¬çš„æ£€æŸ¥ï¼Œä»¥ç¡®ä¿ä½ çš„æœºå™¨äººä¸ä¼šé”™è¯¯åœ°å‘é€ä¸€å †äººçš„è¯„è®ºã€‚ç°åœ¨åšä¸€ä¸ªè¯„è®ºè¯´`/u/myusernamebutactuallybot`(æ›´ç¡®åˆ‡åœ°è¯´ï¼Œä½ åº”è¯¥æ£€æŸ¥ä¸€ä¸‹*ä½ è‡ªå·±çš„æœºå™¨äººåå­—*)ï¼Œä½ åº”è¯¥å¾ˆå¿«å°±ä¼šçœ‹åˆ°ä¸€ä¸ªå›å¤è¯´â€œä½ å¥½ï¼Œä¸–ç•Œï¼â€ä½œä¸ºå›ç­”ã€‚*

è¿™å°±æ˜¯ä½ è¦åšçš„ï¼ğŸ‰