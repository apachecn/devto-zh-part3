# ç”¨ JavaScript å»ºæ¨¡(å’ŒæŸ¥è¯¢)å…³ç³»æ•°æ®

> åŸæ–‡:[https://dev.to/mikewheaton/filtering-related-arrays-4kn5](https://dev.to/mikewheaton/filtering-related-arrays-4kn5)

è¿™ç¯‡æ–‡ç« æè¿°äº†ä¸€ç§ç”¨ JavaScript å»ºæ¨¡å…³ç³»æ•°æ®çš„æ–¹æ³•ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨`filter()`å’Œ`some()`æ•°ç»„æ–¹æ³•æ¥æŸ¥è¯¢è¿™äº›æ•°æ®ã€‚å®ƒå¹¶ä¸æ‰“ç®—å–ä»£ä¸€ä¸ªçœŸæ­£çš„æ•°æ®åº“ï¼Œè€Œæ˜¯å±•ç¤ºå¦‚ä½•æ ¹æ®ä¸€ä¸ªå¯¹è±¡æ•°ç»„çš„å†…å®¹æ¥è¿‡æ»¤å¦ä¸€ä¸ªå¯¹è±¡æ•°ç»„ã€‚

## [](#structuring-the-data)ç»“æ„åŒ–æ•°æ®

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬è€ƒè™‘è€å¸ˆå’Œå­¦ç”Ÿã€‚æ¯ä¸ªäººéƒ½å¯ä»¥ç”¨ç®€å•çš„å¯¹è±¡æ¥è¡¨ç¤ºï¼ŒåŒ…æ‹¬ä»–ä»¬çš„åå­—å’Œå”¯ä¸€çš„ IDã€‚ID å…è®¸æˆ‘ä»¬å¼•ç”¨ä¸€ä¸ªç‰¹å®šçš„è€å¸ˆæˆ–å­¦ç”Ÿï¼Œå³ä½¿ä»–ä»¬çš„åå­—å°†æ¥ä¼šæ”¹å˜ã€‚å› ä¸ºæˆ‘ä»¬å°†æœ‰å¤šä¸ªè€å¸ˆå’Œå­¦ç”Ÿï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å°†ä»–ä»¬ç»„ç»‡æˆæ•°ç»„:

```
const teachers = [
  {
    id: 1,
    name: 'John Kreuger',
  },
  {
    id: 2,
    name: 'Amy David',
  },
];

const students = [
  {
    id: 1,
    name: 'Alice Thompson',
  },
  {
    id: 2,
    name: 'Bill Lemond',
  },
  {
    id: 3,
    name: 'Ashley Jefferson',
  },
]; 
```

è€å¸ˆæœ‰å¤šä¸ªå­¦ç”Ÿï¼Œå­¦ç”Ÿæœ‰å¤šä¸ªè€å¸ˆã€‚è¿™æ˜¯ä¸€ç§å¤šå¯¹å¤šçš„å…³ç³»ï¼Œæœ‰å‡ ç§æ–¹æ³•å¯ä»¥å¯¹è¿™äº›æ•°æ®è¿›è¡Œå»ºæ¨¡ã€‚ä¸€ç§æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ•™å¸ˆå’Œå­¦ç”Ÿä¹‹é—´è”ç³»çš„åˆ—è¡¨ã€‚å¦‚æœä½ æƒ³æ˜¾å¾—èªæ˜ï¼Œä½†æŠŠçœ¼é•œå¿˜åœ¨å®¶é‡Œäº†ï¼Œè¿™å¯ä»¥è¢«ç§°ä¸º[è”æƒ³å®ä½“](https://en.wikipedia.org/wiki/Associative_entity)ã€‚

è®©æˆ‘ä»¬åˆ›å»ºç¬¬ä¸‰ä¸ªæ•°ç»„æ¥æè¿°è¿™äº›è¿æ¥ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¯ä¸ªæ•™å¸ˆå’Œå­¦ç”Ÿçš„å”¯ä¸€ idï¼Œä»¥é˜²å°†æ¥å§“åæ›´æ”¹ï¼Œå¹¶å…è®¸äººä»¬å…±äº«åŒä¸€ä¸ªå§“åã€‚

```
const teachersToStudents = [
  {
    teacherId: 1,
    studentId: 1,
  },
  {
    teacherId: 1,
    studentId: 2,
  },
  {
    teacherId: 1,
    studentId: 3,
  },
  {
    teacherId: 2,
    studentId: 2,
  },
  {
    teacherId: 2,
    studentId: 3,
  },
]; 
```

## [](#filtering-the-data)è¿‡æ»¤æ•°æ®

å¥½äº†ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸‰ä¸ªæ•°ç»„æ¥æè¿°è€å¸ˆï¼Œå­¦ç”Ÿï¼Œä»¥åŠä»–ä»¬ä¹‹é—´çš„è”ç³»ã€‚ğŸ‰

è®©æˆ‘ä»¬æŠŠè¿™ä¸ªæ´¾ä¸Šç”¨åœºã€‚æˆ‘ä»¬è™šæ„çš„åº”ç”¨ç¨‹åºå¯ä»¥ä¸ºæ¯ä¸ªæ•™å¸ˆæä¾›ä¸€ä¸ªåŒ…å«å­¦ç”Ÿåˆ—è¡¨çš„ä¸ªäººèµ„æ–™é¡µé¢ã€‚æˆ‘ä»¬å°†éœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ¥å—ä¸€ä¸ªæ•™å¸ˆ(é€šè¿‡ä»–ä»¬çš„ ID å¼•ç”¨)å¹¶è¿”å›æ‹¥æœ‰è¯¥æ•™å¸ˆçš„å­¦ç”Ÿçš„æ•°ç»„ã€‚

```
// Returns an array of students for a given teacher.
function getStudentsForTeacher(teacherId) {
  // @todo: Return array.
} 
```

è¿™é‡Œæˆ‘ä»¬è¦è¿”å›çš„æ˜¯`students`æ•°ç»„çš„å­é›†ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™æ­£æ˜¯[è¿‡æ»¤å™¨()æ–¹æ³•](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter)æ‰€åšçš„ã€‚å®ƒé€ä¸ªéå†æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œå°†æ¯ä¸ªå…ƒç´ ä¼ é€’ç»™æˆ‘ä»¬æä¾›çš„å‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬çš„å‡½æ•°è¿”å›`true`ï¼Œè¿™ä¸ªå…ƒç´ å°†è¢«æ·»åŠ åˆ°ä¸€ä¸ªæ–°çš„æ•°ç»„ä¸­ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çš„å‡½æ•°æ€»æ˜¯è¿”å›`true`ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªåŒ…å«æ¯ä¸ªå­¦ç”Ÿçš„æ•°ç»„ã€‚

```
// Returns an array of students for a given teacher.
function getStudentsForTeacher(teacherId) {
  students.filter(student => true);
} 
```

æ‰€ä»¥æˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœå­¦ç”Ÿè¿æ¥åˆ°è€å¸ˆï¼Œå®ƒå°†è¿”å›`true`ï¼Œå¦åˆ™è¿”å›`false`ã€‚ä¸ºäº†æ¸…æ¥šèµ·è§ï¼Œè®©æˆ‘ä»¬ä¸ºæ­¤åˆ›å»ºç¬¬äºŒä¸ªå‡½æ•°:

```
// Returns true or false, indicating whether a given teacher has a given student.
function teacherHasStudent(teacherId, studentId) {
  // @todo: Return true or false.
} 
```

æˆ‘ä»¬å¦‚ä½•å›ç­”è¿™ä¸ªé—®é¢˜ï¼Ÿæ²¡é”™ï¼Œé€šè¿‡å¼•ç”¨æˆ‘ä»¬æè¿°äº†æ•™å¸ˆå’Œå­¦ç”Ÿä¹‹é—´æ‰€æœ‰è”ç³»çš„`teachersToStudents`æ•°ç»„ã€‚

æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå¾ªç¯æ¥éå†æ•°ç»„ï¼Œå¦‚æœæ‰¾åˆ°åŒ¹é…ï¼Œè¿”å›`true`,å¦‚æœåˆ°è¾¾æœ«å°¾ï¼Œè¿”å›`false`ã€‚ä¸å¯æ€•ï¼Œä½†æ˜¯æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚ç±»ä¼¼äºè¿‡æ»¤ï¼Œ [some()æ–¹æ³•](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some)å°†è¿­ä»£æ•°ç»„ä¸­çš„å…ƒç´ ã€‚ä½†æ˜¯å®ƒä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œè€Œæ˜¯æ ¹æ®æˆ‘ä»¬æä¾›çš„æµ‹è¯•å‡½æ•°è¿è¡Œæ¯ä¸ªå…ƒç´ ï¼Œå¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ é€šè¿‡äº†æµ‹è¯•ï¼Œå°±è¿”å›`true`ã€‚

```
// Returns true or false, indicating whether a given teacher has a given student.
function teacherHasStudent(teacherId, studentId) {
  return teachersToStudents.some(/* @todo: Test function that returns true if we find a match. */);
} 
```

å› æ­¤ï¼Œæ‰€ç¼ºå°‘çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†å‘Šè¯‰æˆ‘ä»¬`teachersToStudents`æ•°ç»„æ˜¯å¦åŒ…å«æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾çš„å¸¦æœ‰æ•™å¸ˆå’Œå­¦ç”Ÿçš„å¯¹è±¡ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œå®ƒé€šè¿‡æ¯”è¾ƒ IDs æ¥å®ç°è¿™ä¸€ç›®çš„ã€‚

```
// Returns true if this item matches, and false otherwise.
teacherToStudent =>
  teacherToStudent.teacherId === teacherId &&
  teacherToStudent.studentId === studentId; 
```

é€šè¿‡å°†è¯¥å‡½æ•°ä¼ é€’ç»™`some()`ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªå·¥ä½œå‡½æ•°ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ä¸€ä¸ªç»™å®šçš„è€å¸ˆæ˜¯å¦æœ‰ä¸€ä¸ªç»™å®šçš„å­¦ç”Ÿï¼

```
// Returns true or false, indicating whether a teacher has a given student.
function teacherHasStudent(teacherId, studentId) {
  return teachersToStudents.some(
    teacherToStudent =>
      teacherToStudent.teacherId === teacherId &&
      teacherToStudent.studentId === studentId
  );
} 
```

æˆ‘ä»¬å¯ä»¥æ›´æ–°`getStudentsForTeacher()`æ¥ä½¿ç”¨å®ƒï¼Œè¿™æ ·å®ƒå°†é€šè¿‡`students`å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œè¯¥æ•°ç»„åªåŒ…å«é‚£äº›ä¸æŒ‡å®šæ•™å¸ˆç›¸å…³è”çš„å­¦ç”Ÿã€‚

```
// Returns an array of students for a given teacher.
function getStudentsForTeacher(teacherId) {
  return students.filter(student => teacherHasStudent(teacherId, student.id));
}

// Test it out!
console.log(getStudentsForTeacher(1)); // Returns 3 students.
console.log(getStudentsForTeacher(2)); // Returns 2 students. 
```

æˆåŠŸï¼æˆ‘ä»¬é‡‡ç”¨äº†ä¸¤ä¸ªæ•°ç»„ï¼Œä½¿ç”¨ç¬¬ä¸‰ä¸ªæ•°ç»„æè¿°äº†å®ƒä»¬çš„å…ƒç´ ä¹‹é—´çš„å…³ç³»ï¼Œç„¶åæŸ¥è¯¢æˆ‘ä»¬çš„æ•°æ®ä»¥è·å¾—éœ€è¦åœ¨æ•™å¸ˆçš„ä¸ªäººèµ„æ–™é¡µé¢ä¸Šæ˜¾ç¤ºçš„å†…å®¹ã€‚çœ‹ä¸€çœ‹ [CodePen æ¼”ç¤º](https://codepen.io/mikewheaton/pen/Nerxqd?editors=0012)ï¼Œçœ‹çœ‹è¿™ä¸€åˆ‡æ˜¯å¦‚ä½•ç»„åˆåœ¨ä¸€èµ·çš„ã€‚

è™½ç„¶è¿™ç§ç¡®åˆ‡çš„ç”¨ä¾‹å¯ä»¥é€šè¿‡åœ¨æœåŠ¡å™¨ç«¯è¿›è¡ŒæŸ¥è¯¢æ¥æ›´å¥½åœ°å¤„ç†(ç‰¹åˆ«æ˜¯å½“æ‚¨å¤„ç†æˆåƒä¸Šä¸‡çš„è®°å½•æˆ–æ•æ„Ÿæ•°æ®æ—¶)ï¼Œä½†æ˜¯è¿™äº›æ•°ç»„æ–¹æ³•å¯¹äºæ‚¨å¯èƒ½é‡åˆ°çš„å…¶ä»–é—®é¢˜ä¹Ÿå¾ˆæœ‰ç”¨ã€‚

## [](#exercises-and-further-reading)ä¹ é¢˜ä¸å»¶ä¼¸é˜…è¯»

æƒ³å¾—åˆ°æ›´å¤šçš„å®è·µæˆ–äº†è§£æ›´å¤šï¼Ÿæˆ‘å»ºè®®ä½ :

*   ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ç»™å®šå­¦ç”Ÿçš„æ•™å¸ˆã€‚
*   ä»”ç»†é˜…è¯»[æ¨¡å¼](http://learnmongodbthehardway.com/schema/schemabasics/),æ‰¾åˆ°ç»„ç»‡è¿™äº›æ•°æ®çš„å…¶ä»–æ–¹æ³•ã€‚
*   éå†æ•™å¸ˆï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºæ¯ä½æ•™å¸ˆçš„å­¦ç”Ÿåˆ—è¡¨ã€‚
*   æ·»åŠ ä¸€ç³»åˆ—è¯¾ç¨‹ï¼Œå°†è¿™äº›è¯¾ç¨‹ä¸æ•™å¸ˆå’Œå­¦ç”Ÿè”ç³»èµ·æ¥ã€‚æ³¨æ„å†—ä½™æ•°æ®ã€‚
*   å°è¯•å…¶ä»–å¸¸è§çš„æ•°ç»„æ–¹æ³•ï¼Œå¦‚ [reduce()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce) å’Œ [forEach()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach) ã€‚