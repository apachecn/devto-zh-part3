# åœ¨ Azure ç®¡é“ä¸Šä½¿ç”¨ç‰¹å®šçš„ Go ç‰ˆæœ¬

> åŸæ–‡:[https://dev . to/azure/using-a-specific-go-version-on-azure-pipelines-1k9k](https://dev.to/azure/using-a-specific-go-version-on-azure-pipelines-1k9k)

æœ‰äº† Azure Pipelinesï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è®¸å¤šä¸åŒçš„è¯­è¨€æ„å»ºåº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯ T2 Go T3ã€‚

å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯[æ‰˜ç®¡ä»£ç†](https://docs.microsoft.com/en-us/azure/devops/pipelines/agents/hosted?view=azure-devops&WT.mc_id=devto-blog-aapowell)ï¼Œè¿™æ˜¯æ¨èçš„æ–¹å¼(å› ä¸ºæ‚¨ä¸éœ€è¦ç®¡ç†è‡ªå·±çš„æœºå™¨)ï¼Œé‚£ä¹ˆæ‚¨å°†å—åˆ°ä»£ç†ä¸Šå®‰è£…çš„è½¯ä»¶çš„æ”¯é…ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æ­£åœ¨æ„å»ºä¸€ä¸ªé’ˆå¯¹ç‰¹å®šè¿è¡Œæ—¶çš„åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚ Go 1.12.3(æ’°å†™æœ¬æ–‡æ—¶çš„æœ€æ–°ç‰ˆæœ¬)ï¼Œé‚£ä¹ˆæ‚¨å¯èƒ½å°±ä¸å¤ªèµ°è¿äº†ï¼Œå› ä¸ºä»£ç†æ²¡æœ‰å®‰è£…è¿™ä¸ªç‰ˆæœ¬ã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å°† Go è®¾ç½®ä¸ºæ‚¨çš„ç®¡é“çš„ä¸€éƒ¨åˆ†ã€‚

*è¾¹æ³¨:ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ [Docker æ¥æ„å»º](https://docs.microsoft.com/en-us/azure/devops/pipelines/languages/docker?view=azure-devops&WT.mc_id=devto-blog-aapowell)ï¼Œä½†æ˜¯ Docker å¹¶ä¸é€‚åˆæ‰€æœ‰äººï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œå°†é‡ç‚¹æ”¾åœ¨éé›†è£…ç®±ä»£ç†ä¸Šã€‚å¦‚æœä½ éœ€è¦å‡ ä¸ªè¿è¡Œæ—¶ï¼ŒDocker ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œæ¯”å¦‚è¯´ï¼Œ[ç”¨ Go + WASM æ”¯æŒ](https://dev.to/aaronpowell/learning-golang-through-webassembly---go-wasm-typescript-and-react-klm)æ„å»ºä¸€ä¸ª web åº”ç”¨ã€‚*

æˆ‘ä»¬å°†ä¿®æ”¹æ ‡å‡†çš„ [Go Azure ç®¡é“](https://docs.microsoft.com/en-us/azure/devops/pipelines/languages/go?view=azure-devops&WT.mc_id=devto-blog-aapowell)ï¼Œæ‰€ä»¥ä»æ¨¡æ¿å¼€å§‹ã€‚

## [](#setting-up-our-variables)è®¾ç½®æˆ‘ä»¬çš„å˜é‡

æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯ä¿®æ”¹ Go å°†ä¼šæœŸæœ›çš„å˜é‡ï¼Œç‰¹åˆ«æ˜¯`GOPATH`å’Œ`GOROOT`ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬æŒ‡å‘ä»£ç†ä¸Šçš„ä¸€ä¸ª Go ç‰ˆæœ¬ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä¿®æ”¹å®ƒä»¬ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ Go ç‰ˆæœ¬ã€‚

```
variables:
  GOPATH: '$(Agent.BuildDirectory)/gopath' # Go workspace path
  GOROOT: '$(Agent.BuildDirectory)/go' # Go installation path
  GOBIN: '$(GOPATH)/bin' # Go binaries path
  modulePath: '$(GOPATH)/src/github.com/$(build.repository.name)' # Path to the module's code 
```

æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ª[ä»£ç†é¢„å®šä¹‰çš„å˜é‡](https://docs.microsoft.com/en-us/azure/devops/pipelines/build/variables?view=azure-devops&tabs=yaml&WT.mc_id=devto-blog-aapowell#agent-variables)ï¼Œ`Agent.BuildDirectory`ï¼Œå› ä¸ºå®ƒæ˜¯æˆ‘çŸ¥é“æˆ‘å¯ä»¥åœ¨ä»£ç†ä¸Šå†™å…¥çš„åœ°æ–¹ï¼Œå¹¶ä¸”å®ƒçš„èŒƒå›´ç‰¹åˆ«æ˜¯æˆ‘çš„æ„å»ºã€‚

`GOPATH`å°†æ˜¯æˆ‘ä»¬åˆ›å»ºçš„ä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ï¼Œè€Œ`GOROOT`å°†æ˜¯ Go è§£å‹åˆ°çš„åœ°æ–¹ã€‚è¿™äº›ç°åœ¨å°†æ˜¯ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥å½“ Go æœ€ç»ˆæ‰§è¡Œæ—¶ï¼Œå®ƒå°†æ˜¯ Go çš„æ­£ç¡®ç‰ˆæœ¬ã€‚

## [](#downloading-go)ä¸‹è½½ Go

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªæ–°æ­¥éª¤æ¥ä¸‹è½½å’Œè§£åŒ…æˆ‘ä»¬æƒ³è¦çš„ Go ç‰ˆæœ¬:

```
steps:
- script: |
    wget "https://storage.googleapis.com/golang/go1.12.3.linux-amd64.tar.gz" --output-document "$(Agent.BuildDirectory)/go1.12.3.tar.gz"
    tar -C '$(Agent.BuildDirectory)' -xzf "$(Agent.BuildDirectory)/go1.12.3.tar.gz"
  displayName: 'Install  Go  1.12' 
```

å› ä¸ºæˆ‘ä»¬çŸ¥é“æˆ‘çš„ä»£ç†æ˜¯ä¸€ä¸ª Linux ä»£ç†(ä»æ¨¡æ¿ä¸­å®šä¹‰çš„`pool`å¼€å§‹),æˆ‘ä»¬å°†ä½¿ç”¨`wget`ä¸‹è½½ Linux äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶æŠŠå®ƒä»¬æ”¾åˆ°`Agent.BuildDirectory`ä¸­ã€‚å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ç”¨`tar`è§£åŒ…å®ƒï¼ŒæŒ‡å®šæˆ‘ä»¬æƒ³è¦è§£åŒ…åˆ°`Agent.BuildDirectory`ï¼Œå¹¶ä¸”ç»™å®š`tar.gz`çš„ç»“æ„åŒ…å«ä¸€ä¸ªåä¸º`go`çš„æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬å°†æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªä¸`GOROOT`å®Œç¾åŒ¹é…çš„è·¯å¾„ã€‚

æœ€åï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ä»£ç†çš„`PATH`çŸ¥é“è¿™ä¸ªç‰ˆæœ¬çš„ Goï¼Œæˆ‘ä»¬é€šè¿‡[è®¾ç½®è¾“å‡ºå˜é‡](https://docs.microsoft.com/en-us/azure/devops/pipelines/process/variables?view=azure-devops&tabs=yaml%2Cbatch&WT.mc_id=devto-blog-aapowell#set-in-script)æ¥å®ç°:

```
- script: |
    echo '##vso[task.prependpath]$(GOBIN)'
    echo '##vso[task.prependpath]$(GOROOT)/bin' 
```

*æ–‡æ¡£æŒ‡å—ä¸­çš„[è®¾ç½® Go å·¥ä½œåŒº](https://docs.microsoft.com/en-us/azure/devops/pipelines/languages/go?view=azure-devops&WT.mc_id=devto-blog-aapowell#set-up-a-go-workspace)æ­¥éª¤å¯¹æ­¤è¿›è¡Œäº†ä»‹ç»ã€‚*

ç°åœ¨ï¼Œç®¡é“çš„å…¶ä½™éƒ¨åˆ†å¯ä»¥æŒ‰ç…§æ¨¡æ¿æè¿°çš„å‡†ç¡®åœ°è·Ÿéš[ï¼](https://docs.microsoft.com/en-us/azure/devops/pipelines/languages/go?view=azure-devops&WT.mc_id=devto-blog-aapowell)

## [](#conclusion)ç»“è®º

ä¾èµ–é¡¹çš„ç‰ˆæœ¬å›ºå®šå¯¹äºç¡®ä¿æˆ‘ä»¬éšç€æ—¶é—´çš„æ¨ç§»æ‹¥æœ‰å¯é‡å¤çš„æ„å»ºéå¸¸é‡è¦ã€‚å› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›æœ€ç»ˆé™·å…¥æ‰‹åŠ¨ç®¡ç†ä»£ç†æ± çš„å¢ƒåœ°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æ„å»ºå®šä¹‰ä¸ºæˆ‘ä»¬æœŸæœ›çš„ç¯å¢ƒå‡†å¤‡å¥½ä»£ç†ï¼ŒåŒ…æ‹¬è®¾ç½®é€‚å½“çš„è¿è¡Œæ—¶ã€‚

ä½ å¯ä»¥åœ¨æˆ‘çš„ GitHub ä¸Šçœ‹åˆ°å®Œæ•´çš„ç®¡é“å®šä¹‰[ï¼Œå®ƒåˆ©ç”¨äº†è¿™ç§æ–¹æ³•ã€‚](https://github.com/aaronpowell/oz-dev-events/blob/dcd3fc3c6c74f1da037d17993380c51ffe996bda/azure-pipelines.yml)

æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥å‡†å¤‡å¤šä¸ªä¸åŒç‰ˆæœ¬çš„ Goï¼Œä»¥åˆ›å»ºä¸€ä¸ªé’ˆå¯¹å¤šä¸ªè¿è¡Œæ—¶ç‰ˆæœ¬çš„æ„å»ºçŸ©é˜µï¼Œä½†æ˜¯äº²çˆ±çš„è¯»è€…ï¼Œæˆ‘å°†æŠŠå®ƒä½œä¸ºä¸€ä¸ªç»ƒä¹ ç•™ç»™ä½ ğŸ˜‰ã€‚