# ä»€ä¹ˆæ˜¯å¥½çš„æäº¤æ¶ˆæ¯ï¼Ÿ

> åŸæ–‡:[https://dev . to/cvortmann/what-makes-a-good-commit-message-181 I](https://dev.to/cvortmann/what-makes-a-good-commit-message-181i)

# ä»€ä¹ˆæ˜¯å¥½çš„æäº¤æ¶ˆæ¯ï¼Ÿ

é€šä¿¡å¯ä»¥è¯´æ˜¯æé™ç¼–ç¨‹(XP)äº”ä¸ªä»·å€¼è§‚ä¸­æœ€é‡è¦çš„ã€‚

éšç€åˆ†å¸ƒå¼å›¢é˜Ÿçš„å…´èµ·ï¼Œä¿æŒå„ç§å½¢å¼çš„è‰¯å¥½æ²Ÿé€šä¹ æƒ¯æå…¶é‡è¦ã€‚é‰´äºæ—¶åŒºçš„å·®å¼‚ï¼Œä¹¦é¢äº¤æµå˜å¾—éå¸¸é‡è¦ã€‚æäº¤æ¶ˆæ¯æ˜¯å›¢é˜Ÿæˆå‘˜ä¹‹é—´ä»¥åŠå›¢é˜Ÿå’Œé¡¹ç›®ç”Ÿå‘½å‘¨æœŸä¸­é‡è¦çš„äº¤æµæ–¹å¼ï¼Œå› ä¸ºå®ƒä»¬åŒ…å«äº†åˆ›å»ºå®ƒä»¬çš„ä¸Šä¸‹æ–‡ã€‚é€šè¿‡æ£€æŸ¥é¡¹ç›®å†å²ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡º*ä¸ºä»€ä¹ˆ*ä¸€äº›å†³ç­–æ˜¯åœ¨åšå‡ºçš„*ã€‚*

åœ¨å†™è¿™ç¯‡æ–‡ç« çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°äº†ä¸¤ç§ä¿¡æ¯:

1.  æ— æ•°**æ— ä¿¡æ¯**æäº¤**æ¶ˆæ¯**
2.  é€šè¿‡æŒ‡å‘å­˜å‚¨åº“ä¹‹å¤–ï¼Œä»¥ä¸€ç§æ¨¡ç³Šäº†å˜æ›´çš„é‡è¦å†…å®¹çš„æ ¼å¼ç¼–å†™çš„æ¶ˆæ¯ã€‚è®©æˆ‘ä»¬ç§°å®ƒä»¬ä¸º**çœ‹åˆ«å¤„æ¶ˆæ¯**ã€‚

æˆ‘å°†è®¨è®ºæ¯ä¸€ç§ç±»å‹ï¼Œæˆ‘ä»¬å¦‚ä½•æ”¹è¿›æ¶ˆæ¯ä»¥ä¼ è¾¾æ›´å¤šçš„æ„ä¹‰å’Œä¿¡æ¯ï¼Œæœ€åï¼Œç»™å‡ºä¸€äº›å¥½çš„æäº¤æ¶ˆæ¯çš„ä¾‹å­ã€‚

> å›¢é˜Ÿè½¯ä»¶å¼€å‘ä¸­æœ€é‡è¦çš„æ˜¯æ²Ÿé€šã€‚(è‚¯ç‰¹Â·è´å…‹ï¼Œæé™ç¼–ç¨‹è§£é‡Š:æ‹¥æŠ±å˜åŒ–)

## [](#uninformative-messages)æ— ä¿¡æ¯æ¶ˆæ¯

æ— ä¿¡æ¯çš„æ¶ˆæ¯æ˜¯é‚£äº›åœ¨ä½ é˜…è¯»æ—¶æ²¡æœ‰ä¼ è¾¾ä»»ä½•ä¿¡æ¯çš„æ¶ˆæ¯ã€‚ä¾‹å¦‚:

*   `add cli new`
*   `fixes`
*   `fix code review comments`
*   `no message`
*   `description`
*   `wip`
*   `hackz`

åœ¨æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Git å†å²æ¥å¸®åŠ©æˆ‘ä»¬å‘ç°é—®é¢˜ä¿¡æ¯çš„å‹åŠ›æƒ…å†µä¸‹ï¼Œå®ƒä»¬å°¤å…¶ç³Ÿç³•ã€‚

æƒ³è±¡ä¸€ä¸‹ä¸‹é¢çš„æƒ…å†µ:ä½ åˆšåˆ°åŠå…¬å®¤ï¼Œæœ‰ä¸€ä¸ªé‡å¤§çš„ bugï¼Œä½ çš„å…¬å¸æ­£åœ¨äºæŸã€‚å› ä¸ºå®ƒä¼¼ä¹ä¸ä½ ä¹ æƒ¯ä½¿ç”¨çš„ä»£ç åº“éƒ¨åˆ†æ— å…³ï¼Œæ‰€ä»¥ä½ å¼€å§‹ä½¿ç”¨`git log --grep`å’Œä¸€äº›å…³é”®å­—è¿›è¡Œè°ƒæŸ¥ã€‚ä½ ä»€ä¹ˆä¹Ÿæ²¡æ‰¾åˆ°ã€‚ç„¶åä½ åœ¨ä¸€ä¸ªä½ è®¤ä¸ºå¯èƒ½ä¸é—®é¢˜æœ‰å…³çš„æ–‡ä»¶ä¸­ä½¿ç”¨`git log -- file/path`ã€‚æ‚¨å‘ç°ä¸€ä¸ªçœ‹èµ·æ¥å¯ç–‘çš„æäº¤ï¼Œå¯èƒ½è¯¥æäº¤å¼•å…¥äº†æ‚¨çœ‹åˆ°çš„é”™è¯¯æ¶ˆæ¯ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæäº¤æ¶ˆæ¯æ²¡æœ‰å‘Šè¯‰ä½ *ä¸ºä»€ä¹ˆ*ä»£ç æ˜¯é‚£æ ·çš„ã€‚ç„¶åä½ çœ‹ç€ä½œè€…çš„åå­—ï¼Œå¸Œæœ›ä½ å¯ä»¥å‘é‚£ä¸ªäººå¯»æ±‚å¸®åŠ©ã€‚ä¸èµ°è¿ï¼Œé‚£ä¸ªäººæ—©å°±ç¦»å¼€å…¬å¸äº†ã€‚

å¦‚æœæäº¤æ¶ˆæ¯å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸æ˜¯å¾ˆå¥½å—ï¼Ÿåœ¨è¿™äº›ä¿¡æ¯ä¸­ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯ä¸å¯èƒ½çš„ã€‚æ­£å¦‚æˆ‘æ‰€è¯´çš„ï¼Œå®ƒä»¬æ²¡æœ‰å‘è¯»è€…ä¼ è¾¾ä»»ä½•ä¿¡æ¯ã€‚æˆ‘ä»¬åº”è¯¥é¿å¼€ä»–ä»¬ã€‚

## [](#lookelsewhere-messages)çœ‹åˆ«å¤„æ¶ˆæ¯

åœ¨è¿™ä¸€ç±»åˆ«ä¸­ï¼Œæ¶ˆæ¯æè¿°ä¸­åŒ…å« Github é—®é¢˜ç¼–å·æˆ–å‰æ‹‰æ ‡è¯†ã€‚ä»–ä»¬å€¾å‘äºä¸åŒ…å«æ›´å¤šçš„ä¿¡æ¯ã€‚ä¾‹å¦‚:

*   `Fix issue #123`
*   `[JIRA-1234] Fix a problem with the route system when...`

è¿™äº›æ¶ˆæ¯æœ‰ä¸¤ä¸ªé—®é¢˜:

1.  åçˆ±ä»£ç åº“ä¹‹å¤–çš„ä¿¡æ¯
2.  æ ‡è¯†å ç”¨äº†æäº¤æ¶ˆæ¯çš„å®è´µç©ºé—´

### [](#favouring-information-that-is-outside-the-codebase)åçˆ±ä»£ç åº“ä¹‹å¤–çš„ä¿¡æ¯

å¯¹äºä¿¡æ¯æ¥è¯´ï¼Œå°½å¯èƒ½æ¥è¿‘ä»£ç åº“æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºä»£ç åº“æ˜¯çœŸç†çš„å”¯ä¸€æ¥æºã€‚[å‰æ‹‰](https://www.atlassian.com/software/jira)æˆ– [Github](https://www.github.com) æˆ–ä»»ä½•ä» Git åˆ†ç¦»å‡ºæ¥çš„å·¥å…·éƒ½æ˜¯äºŒçº§å·¥å…·ã€‚ä¸‡ä¸€å®ƒä»¬ä¸­çš„ä»»ä½•ä¸€ä¸ªè¢«çƒ§æ¯æˆ–è€…æˆ‘ä»¬å†³å®šæ›´æ¢æä¾›å•†ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è®¿é—® Git åº“ã€‚å¦‚æœæ‰€æœ‰ä¿¡æ¯éƒ½å­˜åœ¨äº Git å­˜å‚¨åº“ä¹‹å¤–çš„å…¶ä»–åœ°æ–¹ï¼Œæˆ‘ä»¬çš„å¤„å¢ƒå°†ä¼šéå¸¸ç³Ÿç³•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥åŠªåŠ›åœ¨æäº¤æ¶ˆæ¯ä¸­å†™å…¥å°½å¯èƒ½å¤šçš„ä¿¡æ¯ã€‚é‚£äº›é¢å¤–çš„æ€è€ƒæ—¶é—´å‘ä¸‹ä¸€ä½*è§£é‡Šä¸ºä»€ä¹ˆ*åšå‡ºæ”¹å˜(è€Œä¸æ˜¯*ä»€ä¹ˆ*ï¼Œå› ä¸º`git show`ä¼šå‘Šè¯‰ä½ )æ˜¯å€¼å¾—çš„ã€‚

### [](#identifications-take-valuable-space-from-the-commit-message)æ ‡è¯†å ç”¨äº†æäº¤æ¶ˆæ¯çš„å®è´µç©ºé—´

å…·æœ‰ 10 ä¸ªå­—ç¬¦çš„å‰æ‹‰æœºç¥¨æ ‡è¯†å ä¸»é¢˜è¡Œçš„å»ºè®® 50 ä¸ªå­—ç¬¦çš„ 20%ã€‚æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘ä»¬çš„çœ¼ç›ä¼¼ä¹å¾ˆè‡ªç„¶åœ°è·³è¿‡äº†æäº¤ä¿¡æ¯çš„è¿™ä¸€éƒ¨åˆ†ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ˜¯å› ä¸ºé€šå¸¸æˆ‘ä»¬åœ¨ Git å†å²ä¸­å¯»æ‰¾ä¸€äº›æˆ‘ä»¬ä»ç„¶ä¸çŸ¥é“å®ƒä¸å“ªä¸ªç¥¨è¯ç›¸å…³çš„ä¸œè¥¿ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœä½ å» Github é¡¹ç›®æœç´¢ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œæ‰€æœ‰çš„æäº¤æ¶ˆæ¯éƒ½ä»¥ä¸€ä¸ªé”™è¯¯è·Ÿè¸ªå·å¼€å§‹ï¼Œä½ å¾ˆå¿«å°±ä¼šæ³¨æ„åˆ°ä½ çš„çœ¼ç›è·³è¿‡äº†é‚£äº›éƒ¨åˆ†ã€‚ä½ çš„çœ¼ç›å‘Šè¯‰ä½ ï¼Œå®ƒä»¬ä¸æ˜¯ä½ è¦å¯»æ‰¾çš„ä¿¡æ¯ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å°±æ²¡æœ‰å¤šå°‘ç©ºé—´æ¥å†™çœŸæ­£é‡è¦çš„ä¸œè¥¿äº†ã€‚å½“æŸ¥çœ‹ Git å†å²æ ‘æ—¶ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ä»£ç æ˜¯å¦‚ä½•å‘å±•çš„ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„å˜åŒ–ã€‚æˆ‘ä»¬å‡ ä¹æ²¡æœ‰åœ¨å¯»æ‰¾ä¸€ä¸ªæ ‡è¯†ï¼Œå› ä¸ºåœ¨è°ƒæŸ¥ç¼“å­˜è§’è‰²é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬è¿˜ä¸çŸ¥é“`JIRA-1234`ä¸ç¼“å­˜è§’è‰²æœ‰å…³ã€‚

è¿™å¹¶ä¸æ˜¯è¯´å‰æ‹‰æ ‡è¯†æ²¡æœ‰ç”¨ï¼Œè€Œæ˜¯è¯´å®ƒä»¬ä¸åº”è¯¥å ç”¨å¤§å¤šæ•°é‡è¦ä¿¡æ¯çš„ç©ºé—´ã€‚ç®€å•åœ°è¯´ï¼Œå®ƒä»¬ä¸åº”è¯¥é¦–å…ˆå‡ºç°ï¼Œè€Œåº”è¯¥å‡ºç°åœ¨å…¶ä»–åœ°æ–¹ã€‚ä¸€ä¸ªå»ºè®®æ˜¯æŠŠå®ƒä»¬ä½œä¸ºä¿¡æ¯çš„æœ€åä¸€éƒ¨åˆ†ï¼Œå†™åœ¨ä¿¡æ¯æ­£æ–‡ä¹‹åã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`---`ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå¹¶ç”¨ç¼–å·æˆ–é¡¹ç›®ç¬¦å·åˆ—å‡ºæœ‰ç”¨çš„ä¿¡æ¯ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ•´ä¸ªä¿¡æ¯ä¸­ä½¿ç”¨`[1]`æ ‡ç­¾ï¼Œç±»ä¼¼äºç§‘å­¦è®ºæ–‡ä¸­å‚è€ƒæ–‡çŒ®çš„å†™æ³•ã€‚

æœ‰äº†è¿™äº›å»ºè®®ï¼Œæˆ‘ä»¬åœ¨åš`git log`çš„æ—¶å€™ä»ç„¶å¯ä»¥ç¥è§ä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬å®é™…ä¸Šåœ¨å¯»æ‰¾ä¸`JIRA-1234`ç›¸å…³çš„æäº¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰¾åˆ°å¸¦æœ‰`git log --oneline --grep=JIRA-1234`çš„æäº¤ã€‚è¿™æ ·ï¼Œæ‰€æœ‰ä¿¡æ¯éƒ½ä¿ç•™åœ¨ Git å­˜å‚¨åº“ä¸­ï¼Œç„¶åæŒ‡å‘å…¶ä»–æœ‰ç”¨çš„å·¥å…·ã€‚

## [](#good-commit%C2%A0messages)å¥½çš„æäº¤æ¶ˆæ¯

ä¸‹é¢æ˜¯æˆ‘è®¤ä¸ºå¥½çš„æäº¤æ¶ˆæ¯çš„ä¾‹å­ï¼Œç»™å‡ºäº†æˆ‘çš„è®ºç‚¹å’Œå…¶ä»–äººæå‡ºçš„æŒ‡å¯¼æ–¹é’ˆ(æŸ¥çœ‹é“¾æ¥éƒ¨åˆ†)ã€‚å®ƒä»¬å–è‡ªå¼€æºé¡¹ç›®(ç»è¿‡ä¸€äº›ä¿®æ”¹)ã€‚æˆ‘å·²ç»å°†ä½œè€…å’Œé¡¹ç›®åç§°æ”¾åœ¨æ¶ˆæ¯æœ¬èº«ã€‚

```
Make the cached role coherrent with the actual one

When observing the leader running a master role, set the cached role stored in the state_handler to master as well. Failure to do so resulted in the manually promoted node to continue running with a cached 'replica' role. This led to the failure to create replication slots for the new replicas.

We could do it conditionally, but both reading and writing the role require the same lock, and the unconditional approach makes the unit tests simpler. 
```

```
Fix rewind behavior when paused

* Check if we can rewind when deciding to call Postgresql.follow during pause.

Without this the following sequence of events occurs:

1\. Manual failover from node, demotion sets need_rewind flag. Rewind is not done because can_rewind is False.
2\. Cluster is put into paused mode. Rewind is not attempted because recovery.conf matches.
3\. PostgreSQL goes down (pg_ctl stop).
4\. Because need_rewind is set PostgreSQL is restarted.
5\. Sysadmin is unhappy because Patroni is doing stuff behind his back during pause.

* Allow superuser user to be missing from config for rewind.

In other places a missing superuser authentication section is allowed and we default to libpq's use default OS user with no password. This makes rewind work with a missing superuser configuration.

---

Issue: [#365](https://link/to/issue/365) 
```

```
Make Source.indexOf(ByteString) significantly faster

Previously the algorithm that did this was extremely inefficient, and had worst case runtime of O(N * S * S) for N is size of the bytestring and S is the number of segments.

The new code runs in O(N * S). It accomplishes this by not starting each search at the first segment, which could occur many times when called by RealBufferedSource. 
```

```
Convert specs to RSpec 3.1.7 syntax with Transpec

This conversion is done by Transpec 2.3.8 with the following command:

    transpec

* 46 conversions
    from: it { should ... }
      to: it { is_expected.to ... }

* 7 conversions
    from: it { should_not ... }
      to: it { is_expected.not_to ... }

* 2 conversions
    from: it { should have(n).items }
      to: it 'has n dependencies' do expect(subject.size).to eq(n) end

* 2 conversions
    from: obj.should
      to: expect(obj).to

* 2 conversions
    from: obj.stub(:message)
      to: allow(obj).to receive(:message)

* 1 conversion
    from: == expected
      to: eq(expected)

* 1 conversion
    from: it { should have(n).items }
      to: it 'has n feature' do expect(subject.size).to eq(n) end

* 1 conversion
    from: it { should have(n).items }
      to: it 'has n features' do expect(subject.size).to eq(n) end

* 1 conversion
    from: it { should have(n).items }
      to: it 'has n files' do expect(subject.size).to eq(n) end

For more details: https://github.com/yujinakayama/transpec#supported-conversions 
```

## [](#formatting)æ ¼å¼åŒ–

é™¤äº†ä»¥ä¸Šå‡ ç‚¹ï¼Œè¯»ä¸€äº›å†™å¾—å¥½çš„ä¸œè¥¿æ€»æ˜¯å¾ˆå¥½çš„ã€‚å½“æœ‰äººæ³¨æ„åˆ°é€‚å½“çš„æ ¼å¼å’Œé—´è·æ—¶ï¼Œæˆ‘ä»¬ä¼šæ„Ÿè§‰æ›´å¥½ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†æäº¤æ¶ˆæ¯è§†ä¸ºå¸¦æœ‰ä¸»é¢˜å’Œæ–‡æœ¬çš„ç”µå­é‚®ä»¶ã€‚äº‹å®ä¸Šï¼Œå®ƒä»¬æ˜¯åœ¨é€šè¿‡ç”µå­é‚®ä»¶åˆ›å»ºå’Œå‘é€è¡¥ä¸æ—¶ä½¿ç”¨çš„ã€‚æˆ–è€…ç”šè‡³æ˜¯ä¸€å°ä¿¡ï¼Œå› ä¸ºåœ¨ä¸–ç•Œçš„ä¸€äº›åœ°æ–¹(ğŸ‡©ğŸ‡ª).)ä»ç„¶å¤§é‡ä½¿ç”¨æ‰€ä»¥ï¼Œè®°ä½:

1.  ç”¨å¤§å†™å­—æ¯å¼€å§‹ä½ çš„å¥å­
2.  ä¸è¦ç”¨åœ†ç‚¹ç»“æŸä¸»é¢˜è¡Œ

### [](#messages-generated-by-git)æ¶ˆæ¯ç”± Git ç”Ÿæˆ

è¿˜å»ºè®®æˆ‘ä»¬ä¸è¦ç¼–è¾‘ç”Ÿæˆçš„æäº¤æ¶ˆæ¯ï¼Œå› ä¸ºè¿™ä¼šè¯¯å¯¼ Git ç”¨æˆ·ã€‚å½“æˆ‘ä»¬çœ‹åˆ°ä»¥ **Revert** å¼€å§‹çš„æäº¤æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬ç«‹å³è®¤ä¸ºå®ƒæ˜¯é€šè¿‡è°ƒç”¨`git revert`ç”Ÿæˆçš„ã€‚åŒæ ·çš„å»ºè®®ä¹Ÿé€‚ç”¨äº**åˆå¹¶**æ¶ˆæ¯æˆ– Git ç”Ÿæˆçš„ä»»ä½•å…¶ä»–æ¶ˆæ¯ã€‚

## [](#links)é“¾æ¥

*   [å…³äº Git æäº¤æ¶ˆæ¯çš„è¯´æ˜](https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html)
*   [æ›´å¥½æäº¤æ¶ˆæ¯çš„ 5 ä¸ªæœ‰ç”¨æç¤º](https://thoughtbot.com/blog/5-useful-tips-for-a-better-commit-message)
*   [å¦‚ä½•ç¼–å†™ Git æäº¤æ¶ˆæ¯](https://chris.beams.io/posts/git-commit/)
*   [GitCommitMessages-open stack](https://wiki.openstack.org/wiki/GitCommitMessages)

* * *

ä»åŸå§‹ç‰ˆæœ¬ä¿®æ”¹å’Œæ›´æ–°

[![CÃ©sar H. Vortmann](../Images/93804275ae8c4c84535cd95056181398.png)](https://medium.com/@cvortmann/what-makes-a-good-commit-message-995d23687ad) [## ä»€ä¹ˆæ˜¯å¥½çš„æäº¤æ¶ˆæ¯ï¼Ÿ|å¡è¨å°”Â·hÂ·æ²ƒç‰¹æ›¼|ä¸­å‹

### å¡è¨å°”Â·hÂ·æ²ƒç‰¹æ›¼<time datetime="2019-08-21T12:12:40.224Z">2019 å¹´ 8 æœˆ 21 æ—¥</time>6 åˆ†é’Ÿè¯»T3ã€‘ä¸­](https://medium.com/@cvortmann/what-makes-a-good-commit-message-995d23687ad)