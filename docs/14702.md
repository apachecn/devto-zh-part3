# å¦‚ä½•å°† Web åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° Heroku

> åŸæ–‡:[https://dev . to/ellehallal/how-to-deploy-a-web-app-to-heroku-2f4l](https://dev.to/ellehallal/how-to-deploy-a-web-app-to-heroku-2f4l)

<center>

### æœ€åˆå‘å¸ƒäº [ellehallal.dev](https://ellehallal.dev) ğŸ‘©ğŸ½â€ğŸ’»

</center>

* * *

[![](../Images/559d828b735fe4964d0d2726928c819e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s---Vo5jvu5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i.imgur.com/oVoqC2t.png)

è¿™æ˜¯ä¸€ç¯‡å…³äºæˆ‘å¦‚ä½•å°†æˆ‘çš„å¤©æ°”ç®¡ç†å™¨åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° Heroku çš„å¿«é€Ÿåšå®¢ã€‚

*   [Github åº“](https://github.com/ellehallal/js-weather-manager)
*   Heroku ä¸Šçš„å¤©æ°”ç®¡ç†å‘˜ã€‚

* * *

ç”±äºæˆ‘åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ dotenv-webpack å’Œ dotenv æ—¶é‡åˆ°çš„é—®é¢˜ï¼Œéƒ¨ç½²æ—¶é—´æ¯”é¢„æœŸçš„è¦é•¿ã€‚éƒ¨ç½²åˆ° Heroku æ—¶ä¸æ–­å¼¹å‡ºä»¥ä¸‹é”™è¯¯:

```
failed to load ./.env 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ„Ÿè°¢æˆ‘çš„ä¸€ä½å¯¼å¸ˆï¼Œä¸¹ï¼Œå¸®åŠ©æˆ‘å¼„æ¸…æ¥šå‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼ç”±äºè¿™ä¸ªé—®é¢˜å·²ç»è§£å†³ï¼Œæœ¬åšå®¢å°†æŒ‰ç…§åœ¨éƒ¨ç½²æ—¶ä¸ä¼šå¯¼è‡´é”™è¯¯çš„é¡ºåºæ¦‚è¿°è¿™äº›æ­¥éª¤ã€‚

ä½œä¸ºå‚è€ƒï¼Œä¸‹é¢æ˜¯æˆ‘çš„å¤©æ°”ç®¡ç†å™¨æ–‡ä»¶çš„ç»„ç»‡æ–¹å¼ã€‚æœ‰éšè—æ–‡ä»¶:

[![](../Images/e50c14aebf824fd9cc482afaae1b42f4.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--nAirRoJu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i.imgur.com/Xls1A5f.png)

*   `./dist`åŒ…å«`main.js`

*   `.env`(åŒ…å«æˆ‘çš„ API å¯†åŒ™)åœ¨æ ¹ç›®å½•ä¸‹

* * *

## [](#step-1-expressjs-web-app-framework)ç¬¬ä¸€æ­¥:Express.js â€” web app æ¡†æ¶

*   åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º`server.js`ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç :

```
const express = require("express");
const path = require("path");
const port = process.env.PORT || 8080;
const app = express();

app.use(express.static(__dirname + '/dist'));

app.get('*', (req, res) => {
  res.sendFile(path.resolve(__dirname, 'index.html'));
});

app.listen(port); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*   è¿è¡Œ`npm install express`

### [](#key-points)è¦ç‚¹

*   `__dirname`æ˜¯`server.js`æ‰€åœ¨çš„ç›®å½•

*   `__dirname + â€˜/dist'`æ˜¯è¿è¡Œ`main.js`çš„å½“å‰ç›®å½•

* * *

## [](#step-2-create-webpackprodjs)ç¬¬äºŒæ­¥:åˆ›å»º webpack.prod.js

å¦‚æœä½ å·²ç»å®‰è£…äº†`dotenv-webpack`ï¼Œè¿™ä¸€æ­¥å¾ˆé‡è¦ã€‚å¦‚æœå®‰è£…åœ¨`webpack.config.js`ä¸­ï¼Œåˆ™éœ€è¦`dotenv-webpack`:

```
const path = require("path");
const Dotenv = require("dotenv-webpack");

module.exports = {
  entry: "./src/index.js",
  mode: "development",
  output: {
    filename: "main.js",
    path: path.resolve(__dirname, "dist"),
  },
  node: {
    fs: "empty",
  },
  plugins: [new Dotenv()],
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å¯¹äºå¼€å‘æ¥è¯´å¾ˆå¥½ï¼Œä½†æ˜¯å¯¹äºç”Ÿäº§æ¥è¯´ä¼¼ä¹ä¸å¤ªå¥½ã€‚å› æ­¤ï¼Œç±»ä¼¼çš„æ–‡ä»¶åªåœ¨ç”Ÿäº§ä¸­éœ€è¦ï¼Œå®ƒä¸åŒ…å«å¯¹`dotenv-webpack`çš„å¼•ç”¨ã€‚

*   åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª`webpack.config.js`çš„å‰¯æœ¬ï¼Œå¹¶å°†å…¶å‘½åä¸º`webpack.prod.js`

*   åœ¨`webpack.prod.js`ä¸­ï¼Œåˆ é™¤å¯¹`dotenv-webpack`çš„å¼•ç”¨ï¼Œå¹¶æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹:

```
const path = require("path");
const webpack = require("webpack");

module.exports = {
  entry: "./src/index.js",
  mode: "production",
  output: {
    filename: "main.js",
    path: path.resolve(__dirname, "dist"),
  },
  node: {
    fs: "empty",
  },
  plugins: [
    new webpack.DefinePlugin({
      "process.env": {},
    }),
  ],
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*   åœ¨`package.json`ä¸­çš„è„šæœ¬ä¸‹ï¼Œæ·»åŠ :

```
"scripts": {
  "start": "node server.js",
  "heroku-postbuild": "webpack --config webpack.prod.js"
}, 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å› æ­¤ï¼ŒHeroku å°†ä½¿ç”¨`webpack.prod.js`æ–‡ä»¶ï¼Œè€Œä¸æ˜¯`webpack.config.js`æ–‡ä»¶ã€‚

*   é€šè¿‡å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°`package.json:`æ¥è®¾ç½® npm å’Œ Node.js çš„ç‰ˆæœ¬

```
"engines": {
  "node": "11.6.0",
  "npm": "6.5.0"
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

* * *

## [](#step-3-only-require-dotenv-when-nodeenv-is-set-to-development)ç¬¬ä¸‰æ­¥:ä»…åœ¨ NODE_ENV è®¾ç½®ä¸º development æ—¶éœ€è¦ dotenv

*   å‡è®¾è¿˜å®‰è£…äº† dotenvï¼Œåœ¨`const app = express()`ä¸‹çš„`server.js`ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼›

```
if (process.env.NODE_ENV == 'development')
require('dotenv').config({ silent: true }); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

* * *

## [](#step-4-set-dotenvwebpack-and-dotenv-as-devdependencies)ç¬¬å››æ­¥:å°† dotenv-webpack å’Œ dotenv è®¾ç½®ä¸º devDependencies

*   å¯¹äºä»…åœ¨å¼€å‘æœŸé—´éœ€è¦çš„`dotenv-webpack`å’Œ`dotenv`,è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
npm install dotenv --save-dev
npm install dotenv-webpack --save-dev 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

* * *

## [](#step-5-deploying-to-heroku)ç¬¬äº”æ­¥:éƒ¨ç½²åˆ° Heroku

*   [æ³¨å†Œ Heroku](https://signup.heroku.com/)

*   å®‰è£… Heroku CLI

*   ç”¨`heroku login`é€šè¿‡ç»ˆç«¯ç™»å½• Heroku

*   è¿è¡Œ`heroku create`åœ¨ Heroku ä¸Šåˆ›å»ºæ‚¨çš„åº”ç”¨ç¨‹åºã€‚å°†ç”Ÿæˆä¸€ä¸ªåº”ç”¨ç¨‹åºåç§°

*   é€šè¿‡è¿è¡Œ`git init`é‡æ–°åˆå§‹åŒ–é¡¹ç›®

*   é€šè¿‡`heroku git:remote --app [your-heroku-app-name]`è®¾ç½® Heroku è¿œç¨‹åˆ†æ”¯

*   è®¾ç½®æ‚¨çš„ç¯å¢ƒå˜é‡â€”â€”æˆ– Heroku ä¸­æåˆ°çš„é…ç½®å˜é‡ã€‚ä¸‹é¢æ˜¯æˆ‘å¦‚ä½•ä¸º openweathermap è®¾ç½® API é”®:`heroku config:set API_KEY=myapikey3902e92e802e8`

*   Git æ·»åŠ å¹¶æäº¤

*   ç”¨`git push heroku master`æ¨åˆ° Heroku

ä¹Ÿå°±è¿™æ ·äº†(å¸Œæœ›å¦‚æ­¤)ï¼

* * *

## [](#helpful-resources)æœ‰ç”¨çš„èµ„æº

*   [ç½‘é¡µåŒ…. js æ–‡ä»¶](https://webpack.js.org/guides/production/)
*   [å †æ ˆæº¢å‡º:é€šè¿‡ Webpack ä¼ é€’å˜é‡çš„æœ€ä½³æ–¹å¼ï¼Ÿ](https://github.com/gdi2290/angular-starter/issues/386)
*   [é€šè¿‡ 3 ä¸ªç®€å•çš„æ­¥éª¤å°†æ‚¨çš„ Webpack åº”ç”¨éƒ¨ç½²åˆ° Heroku](https://codeburst.io/deploy-your-webpack-apps-to-heroku-in-3-simple-steps-4ae072af93a8)
*   [é…ç½®å’Œé…ç½®å˜é‡| Heroku å¼€å‘ä¸­å¿ƒ](https://devcenter.heroku.com/articles/config-vars)