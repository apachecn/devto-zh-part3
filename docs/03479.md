# Angular 8 + Spring Boot 2.2:ç«‹å³æ„å»º CRUD åº”ç”¨ç¨‹åºï¼

> åŸæ–‡:[https://dev . to/oktadev/angular-8-spring-boot-2-2-build-a-crud-app-today-3n 98](https://dev.to/oktadev/angular-8-spring-boot-2-2-build-a-crud-app-today-3n98)

å¦‚æœæ‚¨æ˜¯ä¸€åè¶…è¿‡ 15 å¹´çš„ Java å¼€å‘äººå‘˜ï¼Œæ‚¨å¯èƒ½è¿˜è®°å¾— Java web æ¡†æ¶æ³›æ»¥çš„æ—¶ä»£ã€‚å®ƒå§‹äº Struts å’Œ WebWorkã€‚ç„¶å Tapestryã€Wicket å’Œ JSF å‡ºç°äº†ï¼Œå¹¶æ”¯æŒåŸºäºç»„ä»¶çš„æ¡†æ¶çš„æ€æƒ³ã€‚Spring MVC å‘å¸ƒäº 2004 å¹´(ä¸ Flex 1.0 å’Œ JSF 1.0 åœ¨åŒä¸€ä¸ªæœˆ)ï¼Œå¹¶åœ¨æ¥ä¸‹æ¥çš„å…­å¹´ä¸­æˆä¸º Java web æ¡†æ¶ä¸­äº‹å®ä¸Šçš„æ ‡å‡†ã€‚

ç„¶å AngularJS å‡ºç°äº†ï¼Œæ¯ä¸ªäººéƒ½å¼€å§‹å°†ä»–ä»¬çš„ UI æ¶æ„è½¬ç§»åˆ° JavaScriptã€‚Angular 2 æ˜¯åœ¨ 2014 å¹´ Spring Boot é¦–æ¬¡äº®ç›¸çš„åŒæ—¶å®£å¸ƒçš„ï¼Œå®ƒèŠ±äº†å‡ å¹´æ—¶é—´æ‰è¢«å‘å¸ƒã€å›ºåŒ–å¹¶æˆä¸ºä¸€ä¸ªå¯è¡Œçš„é€‰æ‹©ã€‚è¿™äº›å¤©ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºè§’ï¼Œæ²¡æœ‰ç‰ˆæœ¬å·ã€‚æœ€è¿‘å‡ ä¸ªç‰ˆæœ¬ç›¸å½“ç¨³å®šï¼Œä¸»è¦ç‰ˆæœ¬ä¹‹é—´çš„å‡çº§è·¯å¾„å¾ˆå¹³æ»‘ã€‚

ä»Šå¤©ï¼Œæˆ‘æƒ³å‘ä½ å±•ç¤ºå¦‚ä½•ç”¨æœ€æ–°æœ€å¥½çš„ Angular å’Œ Spring Boot ç‰ˆæœ¬æ¥æ„å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚Angular 8 å’Œ Spring Boot 2.2 éƒ½æœ‰æ€§èƒ½æ”¹è¿›ï¼Œè®©ä½ çš„å¼€å‘è€…ç”Ÿæ´»æ›´ç¾å¥½ã€‚

## Angular 8 æœ‰ä»€ä¹ˆæ–°åŠŸèƒ½ï¼Ÿ

Angular 8 å¢åŠ äº†å·®åˆ†åŠ è½½ã€å¯é€‰çš„ Ivy æ¸²æŸ“å™¨å’Œä½œä¸ºæ„å»ºé€‰é¡¹çš„ Bazelã€‚å·®å¼‚åŠ è½½æ˜¯æŒ‡ CLI æ„å»ºä¸¤ä¸ªç‹¬ç«‹çš„åŒ…ï¼Œä½œä¸ºéƒ¨ç½²çš„åº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ã€‚ç°ä»£æ†ç»‘åŒ…æ˜¯ä¸º evergreen æµè§ˆå™¨æä¾›çš„ï¼Œè€Œé—ç•™æ†ç»‘åŒ…åŒ…å«äº†æ—§æµè§ˆå™¨æ‰€éœ€çš„æ‰€æœ‰ polyfillsã€‚

[![Differential Loading](../Images/964db9b5a2c6fc11febd2c796b2354e2.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--jabdT5HP--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/differential-loading-slide-96a8f9e28945254efff078756aa5eb95cecd138e7e5d702253160bd968d98c77.jpg)

Ivy æ¸²æŸ“å™¨æ›´å°ã€æ›´å¿«ã€è°ƒè¯•æ›´ç®€å•ï¼Œæ”¹è¿›äº†ç±»å‹æ£€æŸ¥ï¼Œæœ€é‡è¦çš„æ˜¯å‘åå…¼å®¹ã€‚

[![Ivy Renderer](../Images/684264e6c89282791645869e5f429b5f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--CNJGVoUq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/ivy-renderer-slide-e3709642c18741f12cc464edb50cffc6c9a09f28e7247e1b23008bc078d37993.jpg)

*ä»¥ä¸Šä¸¤å¼ å¹»ç¯ç‰‡å‡æ¥è‡ª ng-conf 2019 çš„ [Day 1 ä¸»é¢˜æ¼”è®²ã€‚ä½ å¯ä»¥åœ¨ YouTube](https://docs.google.com/presentation/d/19yTRqHT1v4SQz5kXCL6OrIWvH9M20029s_ri5Eil03Y/edit?usp=sharing) ä¸Šè§‚çœ‹ä¸»é¢˜æ¼”è®²ã€‚*

## Spring Boot 2.2 æœ‰ä»€ä¹ˆæ–°åŠŸèƒ½ï¼Ÿ

Spring Boot æ„Ÿå—åˆ°äº† Micronaut å’Œ Quarkus ç­‰å¿«é€Ÿå¯åŠ¨æ¡†æ¶çš„å‹åŠ›ï¼Œä¹Ÿåšäº†è®¸å¤šæ€§èƒ½æ”¹è¿›ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒJMX æ˜¯ç¦ç”¨çš„ï¼ŒHibernate çš„å®ä½“æ‰«ææ˜¯ç¦ç”¨çš„ï¼Œbeans çš„å»¶è¿Ÿåˆå§‹åŒ–æ˜¯å¯ç”¨çš„ã€‚æ­¤å¤–ï¼Œé€šè¿‡ä½¿ç”¨ Spring Boot çš„`@Configuration`ç±»ä¸­çš„`proxyBeanMethods=false`å‡å°‘äº†å¯åŠ¨æ—¶é—´å’Œå†…å­˜ä½¿ç”¨ã€‚æ›´å¤šä¿¡æ¯å‚è§ [Spring Boot 2.2 å‘è¡Œè¯´æ˜](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.2-Release-Notes)ã€‚

å¦‚æœä½ è¿˜åœç•™åœ¨è¿™äº›æ¡†æ¶çš„è€ç‰ˆæœ¬ä¸Šï¼Œä½ å¯èƒ½æƒ³çœ‹çœ‹æˆ‘ä»¥å‰çš„å‡ ç¯‡æ–‡ç« :

*   [ç”¨ Angular 7.0 å’Œ Spring Boot 2.1 æ„å»ºä¸€ä¸ªåŸºæœ¬çš„ CRUD åº”ç”¨](https://dev.to/blog/2018/08/22/basic-crud-angular-7-and-spring-boot-2)
*   [ç”¨ Angular 5.0 å’Œ Spring Boot 2.0 æ„å»ºä¸€ä¸ªåŸºæœ¬çš„ CRUD åº”ç”¨](https://dev.to/blog/2017/12/04/basic-crud-angular-and-spring-boot)

è¿™ç¯‡æ–‡ç« æè¿°äº†å¦‚ä½•æ„å»ºä¸€ä¸ªç®€å•çš„ CRUD åº”ç”¨ç¨‹åºæ¥æ˜¾ç¤ºé…·è½¦åˆ—è¡¨ã€‚å®ƒå°†å…è®¸ä½ ç¼–è¾‘æ±½è½¦ï¼Œå¹¶ä¸”å®ƒå°†æ˜¾ç¤ºæ¥è‡ª [GIPHY](http://giphy.com) çš„ä¸æ±½è½¦åç§°åŒ¹é…çš„åŠ¨ç”» gifã€‚æ‚¨è¿˜å°†äº†è§£å¦‚ä½•ä½¿ç”¨ Okta çš„ Spring Boot å¯åŠ¨å™¨å’Œ Angular SDK æ¥ä¿æŠ¤æ‚¨çš„åº”ç”¨ç¨‹åºã€‚ä¸‹é¢æ˜¯åº”ç”¨ç¨‹åºå®Œæˆæ—¶çš„æˆªå›¾ã€‚

[![Screenshot of completed app](../Images/3013f30fc91759e3c5259a0e2a7c2ad6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--v6EnVgCV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/success-at-last-2af183fc8fdb5605a64c2f3b91a0dfed5dd6b3a3fb2636ea0d54177ab0e8f82b.png)

ä½ éœ€è¦å®‰è£… [Java 11](https://adoptopenjdk.net/) å’Œ [Node.js 10+](https://nodejs.org/) æ¥å®Œæˆæœ¬æ•™ç¨‹ã€‚

## [](#build-an-api-with-spring-boot-22)ç”¨ Spring Boot 2.2 æ„å»ºä¸€ä¸ª API

è¦å¼€å§‹ä½¿ç”¨ [Spring Boot](https://projects.spring.io/spring-boot/) 2.2ï¼Œè¯·å‰å¾€ [start.spring.io](https://start.spring.io) å¹¶åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œè¯¥é¡¹ç›®ä½¿ç”¨ Java 11(åœ¨æ›´å¤šé€‰é¡¹ä¸‹)ã€Spring Boot 2 . 2 . 0 ç‰ˆ M2 å’Œä¾èµ–é¡¹æ¥åˆ›å»ºä¸€ä¸ªå®‰å…¨çš„ API: JPAã€H2ã€Rest Repositoriesã€Lombokã€Okta å’Œ Webã€‚

[![start.spring.io](../Images/d1bbf53a1d25adc7b30bf18dfe81a8aa.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--BE0bRMwG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/start.spring.io-391bddebe50e713866cf678e57cf55c5c3e1e02cfc83b79e2cd584568962172a.gif)

åˆ›å»ºä¸€ä¸ªç›®å½•æ¥å­˜æ”¾æ‚¨çš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚æˆ‘æŠŠæˆ‘çš„å«åš`okta-spring-boot-2-angular-8-example`ï¼Œä½†æ˜¯ä½ å¯ä»¥éšä¾¿å«ä½ çš„ã€‚

> å¦‚æœä½ æ›´å¸Œæœ›çœ‹åˆ°åº”ç”¨ç¨‹åºè¿è¡Œè€Œä¸æ˜¯ç¼–å†™ä»£ç ï¼Œä½ å¯ä»¥[åœ¨ GitHub](https://github.com/oktadeveloper/okta-spring-boot-2-angular-8-example) ä¸Šçœ‹åˆ°ä¾‹å­ï¼Œæˆ–è€…ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å…‹éš†å¹¶åœ¨æœ¬åœ°è¿è¡Œã€‚
> 
> ```
> git clone https://github.com/oktadeveloper/okta-spring-boot-2-angular-8-example.git
> cd okta-spring-boot-2-angular-8-example/client
> npm install ng serve &
> cd ../server
> ./mvnw spring-boot:run 
> ```

ä» start.spring.io ä¸‹è½½`demo.zip`åï¼Œå°†å…¶å±•å¼€ï¼Œå°†`demo`ç›®å½•å¤åˆ¶åˆ°ä½ çš„ app-holder ç›®å½•ã€‚å°†`demo`æ›´åä¸º`server`ã€‚æ‰“å¼€`server/pom.xml`ï¼Œæ³¨é‡Šæ‰å¯¹ Okta çš„ Spring Boot é¦–å‘çš„ä¾èµ–ã€‚

```
<!--dependency>
    <groupId>com.okta.spring</groupId>
    <artifactId>okta-spring-boot-starter</artifactId>
    <version>1.1.0</version>
</dependency--> 
```

åœ¨æ‚¨å–œæ¬¢çš„ IDE ä¸­æ‰“å¼€é¡¹ç›®ï¼Œå¹¶åœ¨`src/main/java/com/okta/developer/demo`ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª`Car.java`ç±»ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Lombok çš„æ³¨é‡Šæ¥å‡å°‘æ ·æ¿ä»£ç ã€‚

```
package com.okta.developer.demo;

import lombok.*;

import javax.persistence.Id;
import javax.persistence.GeneratedValue;
import javax.persistence.Entity;

@Entity
@Data
@NoArgsConstructor
public class Car {
    @Id @GeneratedValue
    private Long id;
    private @NonNull String name;
} 
```

åˆ›å»ºä¸€ä¸ª`CarRepository`ç±»æ¥å¯¹`Car`å®ä½“æ‰§è¡Œ CRUD(åˆ›å»ºã€è¯»å–ã€æ›´æ–°å’Œåˆ é™¤)ã€‚

```
package com.okta.developer.demo;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.rest.core.annotation.RepositoryRestResource;

@RepositoryRestResource
interface CarRepository extends JpaRepository<Car, Long> {
} 
```

å‘`DemoApplication`ç±»(åœ¨`src/main/java/com/okta/developer/demo/DemoApplication.java`ä¸­)æ·»åŠ ä¸€ä¸ª`ApplicationRunner` beanï¼Œå¹¶ä½¿ç”¨å®ƒå‘æ•°æ®åº“æ·»åŠ ä¸€äº›é»˜è®¤æ•°æ®ã€‚

```
package com.okta.developer.demo;

import org.springframework.boot.ApplicationRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import java.util.stream.Stream;

@SpringBootApplication
public class DemoApplication {

    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

    @Bean
    ApplicationRunner init(CarRepository repository) {
        return args -> {
            Stream.of("Ferrari", "Jaguar", "Porsche", "Lamborghini", "Bugatti",
                      "AMC Gremlin", "Triumph Stag", "Ford Pinto", "Yugo GV").forEach(name -> {
                Car car = new Car();
                car.setName(name);
                repository.save(car);
            });
            repository.findAll().forEach(System.out::println);
        };
    }
} 
```

å¦‚æœæ‚¨åœ¨æ·»åŠ æ­¤ä»£ç åå¯åŠ¨æ‚¨çš„åº”ç”¨ç¨‹åº(ä½¿ç”¨`./mvnw spring-boot:run`),æ‚¨å°†åœ¨å¯åŠ¨æ—¶çœ‹åˆ°æ§åˆ¶å°ä¸­æ˜¾ç¤ºçš„æ±½è½¦åˆ—è¡¨ã€‚

```
Car(id=1, name=Ferrari)
Car(id=2, name=Jaguar)
Car(id=3, name=Porsche)
Car(id=4, name=Lamborghini)
Car(id=5, name=Bugatti)
Car(id=6, name=AMC Gremlin)
Car(id=7, name=Triumph Stag)
Car(id=8, name=Ford Pinto)
Car(id=9, name=Yugo GV) 
```

**æ³¨æ„:**å¦‚æœä½ çœ‹åˆ°`Fatal error compiling: invalid target release: 11`ï¼Œé‚£æ˜¯å› ä¸ºä½ åœ¨ç”¨ Java 8ã€‚å¦‚æœæ”¹ä¸ºä½¿ç”¨ Java 11ï¼Œè¿™ä¸ªé”™è¯¯å°±ä¼šæ¶ˆå¤±ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ [SDKMAN](https://sdkman.io/) ï¼Œè¿è¡Œ`sdk install java 11.0.2-open`ç„¶åè¿è¡Œ`sdk default java 11.0.2-open`ã€‚

æ·»åŠ ä¸€ä¸ª`CoolCarController`ç±»(åœ¨`src/main/java/com/okta/developer/demo`ä¸­),è¿”å›ä¸€ä¸ªé…·è½¦åˆ—è¡¨ï¼Œæ˜¾ç¤ºåœ¨ Angular å®¢æˆ·ç«¯ä¸­ã€‚

```
package com.okta.developer.demo;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import java.util.Collection;
import java.util.stream.Collectors;

@RestController
class CoolCarController {
    private CarRepository repository;

    public CoolCarController(CarRepository repository) {
        this.repository = repository;
    }

    @GetMapping("/cool-cars")
    public Collection<Car> coolCars() {
        return repository.findAll().stream()
                .filter(this::isCool)
                .collect(Collectors.toList());
    }

    private boolean isCool(Car car) {
        return !car.getName().equals("AMC Gremlin") &&
                !car.getName().equals("Triumph Stag") &&
                !car.getName().equals("Ford Pinto") &&
                !car.getName().equals("Yugo GV");
    }
} 
```

å¦‚æœæ‚¨é‡å¯æœåŠ¡å™¨ï¼Œç”¨æµè§ˆå™¨æˆ–å‘½ä»¤è¡Œå®¢æˆ·ç«¯ç‚¹å‡»`http://localhost:8080/cool-cars`ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°è¿‡æ»¤åçš„æ±½è½¦åˆ—è¡¨ã€‚

```
$ http :8080/cool-cars
HTTP/1.1 200
Content-Type: application/json;charset=UTF-8
Date: Tue, 07 May 2019 18:07:33 GMT
Transfer-Encoding: chunked

[
    {
        "id": 1,
        "name": "Ferrari"
    },
    {
        "id": 2,
        "name": "Jaguar"
    },
    {
        "id": 3,
        "name": "Porsche"
    },
    {
        "id": 4,
        "name": "Lamborghini"
    },
    {
        "id": 5,
        "name": "Bugatti"
    }
] 
```

## [](#create-a-client-with-angular-cli)ä½¿ç”¨ Angular CLI åˆ›å»ºå®¢æˆ·ç«¯

Angular CLI æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå®ç”¨ç¨‹åºï¼Œå¯ä»¥ä¸ºæ‚¨ç”Ÿæˆè§’åº¦é¡¹ç›®ã€‚å®ƒä¸ä»…å¯ä»¥åˆ›å»ºæ–°é¡¹ç›®ï¼Œè¿˜å¯ä»¥ç”Ÿæˆä»£ç ã€‚è¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„å·¥å…·ï¼Œå› ä¸ºå®ƒè¿˜æä¾›äº†æ„å»ºå’Œä¼˜åŒ–ç”Ÿäº§é¡¹ç›®çš„å‘½ä»¤ã€‚å®ƒåœ¨å¹•åä½¿ç”¨ webpack è¿›è¡Œæ„å»ºã€‚

å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Angular CLI(åœ¨æ’°å†™æœ¬æ–‡æ—¶æ˜¯ç‰ˆæœ¬ v8.0.0-rc.3)ã€‚

```
npm i -g @angular/cli@v8.0.0-rc.3 
```

åœ¨æ‚¨åˆ›å»ºçš„ä¼çŠ¶ç›®å½•ä¸­åˆ›å»ºæ–°é¡¹ç›®ã€‚

```
ng new client --routing --style css --enable-ivy 
```

åˆ›å»ºå®¢æˆ·ç«¯åï¼Œå¯¼èˆªåˆ°å…¶ç›®å½•ï¼Œç§»é™¤`.git`ï¼Œå¹¶å®‰è£… Angular Materialã€‚

```
cd client
rm -rf .git # optional: .git won't be created if you don't have Git installed
ng add @angular/material 
```

å½“æç¤ºè¾“å…¥ä¸»é¢˜å’Œå…¶ä»–é€‰é¡¹æ—¶ï¼Œé€‰æ‹©é»˜è®¤å€¼ã€‚

æ‚¨å°†ä½¿ç”¨ Angular Material çš„ç»„ä»¶æ¥ä½¿ UI çœ‹èµ·æ¥æ›´å¥½ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨ç”µè¯ä¸Šã€‚å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äºè§’çŠ¶ææ–™çš„ä¿¡æ¯ï¼Œè¯·å‚è§ [material.angular.io](https://material.angular.io) ã€‚å®ƒæœ‰å¤§é‡å…³äºå…¶å„ç§ç»„ä»¶ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„æ–‡æ¡£ã€‚å³ä¸Šè§’çš„æ²¹æ¼†æ¡¶å°†å…è®¸ä½ é¢„è§ˆå¯ç”¨çš„ä¸»é¢˜é¢œè‰²ã€‚

[![Angular Material Homepage](../Images/7f915b391280e8ffb731faf098a21250.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Pu35snVS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/material.angular.io-7afb8a74be1d0bb21a7e569b3df9f9336d1e36180e819d33f0d21b7cba400412.png)

## [](#build-a-car-list-page-with-angular-cli)ç”¨ Angular CLI æ„å»ºæ±½è½¦åˆ—è¡¨é¡µé¢

ä½¿ç”¨ Angular CLI ç”Ÿæˆå¯ä»¥ä¸é…·è½¦ API å¯¹è¯çš„æ±½è½¦æœåŠ¡ã€‚

```
ng g s shared/car/car 
```

æ›´æ–°`client/src/app/shared/car/car.service.ts`ä¸­çš„ä»£ç ï¼Œä»æœåŠ¡å™¨è·å–æ±½è½¦åˆ—è¡¨ã€‚

```
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class CarService {

  constructor(private http: HttpClient) {
  }

  getAll(): Observable<any> {
    return this.http.get('//localhost:8080/cool-cars');
  }
} 
```

æ‰“å¼€`src/app/app.module.ts`ï¼Œæ·»åŠ `HttpClientModule`ä½œä¸ºå¯¼å…¥ã€‚

```
import { HttpClientModule } from '@angular/common/http';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule,
    BrowserAnimationsModule,
    HttpClientModule
  ],
  providers: [],
  bootstrap: [AppComponent]
}) 
```

ç”Ÿæˆä¸€ä¸ª`car-list`ç»„ä»¶æ¥æ˜¾ç¤ºæ±½è½¦åˆ—è¡¨ã€‚

```
ng g c car-list 
```

æ›´æ–°`client/src/app/car-list/car-list.component.ts`ä»¥ä½¿ç”¨`CarService`è·å–åˆ—è¡¨å¹¶åœ¨æœ¬åœ°`cars`å˜é‡ä¸­è®¾ç½®å€¼ã€‚

```
import { Component, OnInit } from '@angular/core';
import { CarService } from '../shared/car/car.service';

@Component({
  selector: 'app-car-list',
  templateUrl: './car-list.component.html',
  styleUrls: ['./car-list.component.css']
})
export class CarListComponent implements OnInit {
  cars: Array<any>;

  constructor(private carService: CarService) { }

  ngOnInit() {
    this.carService.getAll().subscribe(data => {
      this.cars = data;
    });
  }
} 
```

æ›´æ–°`client/src/app/car-list/car-list.component.html`ä»¥æ˜¾ç¤ºæ±½è½¦åˆ—è¡¨ã€‚

```
<h2>Car List</h2>

<div *ngFor="let car of cars">
  {{car.name}}
</div> 
```

æ›´æ–°`client/src/app/app.component.html`ä»¥æ‹¥æœ‰`app-car-list`å…ƒç´ ã€‚

```
<div style="text-align:center">
  <h1>
    Welcome to {{ title }}!
  </h1>
</div>

<app-car-list></app-car-list>
<router-outlet></router-outlet> 
```

ä½¿ç”¨`ng serve -o`å¯åŠ¨å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚ä½ è¿˜ä¸ä¼šçœ‹åˆ°æ±½è½¦åˆ—è¡¨ï¼Œå¦‚æœä½ æ‰“å¼€ä½ çš„å¼€å‘è€…æ§åˆ¶å°ï¼Œä½ ä¼šçœ‹åˆ°ä¸ºä»€ä¹ˆã€‚

[![CORS Error](../Images/d37bab22e3597123e9f93c028601b2c8.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--AjbYZtS_--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/cors-error-6c9fe9000ed788641be53b33a166a8dcf3499d155ac7aec6b380b1a4af86bbe3.png)

å‘ç”Ÿæ­¤é”™è¯¯æ˜¯å› ä¸ºæ‚¨å°šæœªåœ¨æœåŠ¡å™¨ä¸Šå¯ç”¨ CORS(è·¨æºèµ„æºå…±äº«)ã€‚

### [](#enable-cors-on-the-server)åœ¨æœåŠ¡å™¨ä¸Šå¯ç”¨ CORS

è¦åœ¨æœåŠ¡å™¨ä¸Šå¯ç”¨ CORSï¼Œéœ€è¦ç»™`CoolCarController`(åœ¨`server/src/main/java/com/okta/developer/demo/CoolCarController.java`ä¸­)æ·»åŠ ä¸€ä¸ª`@CrossOrigin`æ³¨é‡Šã€‚

```
import org.springframework.web.bind.annotation.CrossOrigin;
...
@GetMapping("/cool-cars")
@CrossOrigin(origins = "http://localhost:4200")
public Collection<Car> coolCars() {
    return repository.findAll().stream()
            .filter(this::isCool)
            .collect(Collectors.toList());
} 
```

åœ¨ Spring Boot ç‰ˆæœ¬ 2.1.4 å’Œæ›´ä½ç‰ˆæœ¬ä¸­ï¼Œæ‚¨è¿˜å¯ä»¥å‘æ‚¨çš„`CarRepository`æ·»åŠ ä¸€ä¸ª`@CrossOrigin`æ³¨é‡Šã€‚è¿™å°†å…è®¸æ‚¨åœ¨ä» Angular æ·»åŠ /åˆ é™¤/ç¼–è¾‘æ—¶ä¸å…¶ç«¯ç‚¹è¿›è¡Œé€šä¿¡ã€‚

```
import org.springframework.web.bind.annotation.CrossOrigin;

@RepositoryRestResource
@CrossOrigin(origins = "http://localhost:4200")
interface CarRepository extends JpaRepository<Car, Long> {
} 
```

ç„¶è€Œï¼Œè¿™ç§[åœ¨ Spring Boot 2.2.0.M2](https://github.com/spring-projects/spring-boot/issues/16683) ä¸­ä¸å†èµ·ä½œç”¨ã€‚å¥½æ¶ˆæ¯æ˜¯æœ‰ä¸€ä¸ªå˜é€šåŠæ³•ã€‚æ‚¨å¯ä»¥å‘æ‚¨çš„`DemoApplication.java`ç±»æ·»åŠ ä¸€ä¸ª`CorsFilter` beanã€‚å½“æ‚¨é›†æˆ Spring Security æ—¶ï¼Œè¿™ä¹Ÿæ˜¯å¿…è¦çš„ï¼›ä½ åªæ˜¯åšå¾—æ—©äº†ä¸€ç‚¹ã€‚

```
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.core.Ordered;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;
import org.springframework.web.filter.CorsFilter;
import java.util.Collections;

...

public class DemoApplication {
    // main() and init() methods

    @Bean
    public FilterRegistrationBean<CorsFilter> simpleCorsFilter() {
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        CorsConfiguration config = new CorsConfiguration();
        config.setAllowCredentials(true);
        config.setAllowedOrigins(Collections.singletonList("http://localhost:4200"));
        config.setAllowedMethods(Collections.singletonList("*"));
        config.setAllowedHeaders(Collections.singletonList("*"));
        source.registerCorsConfiguration("/**", config);
        FilterRegistrationBean<CorsFilter> bean = new FilterRegistrationBean<>(new CorsFilter(source));
        bean.setOrder(Ordered.HIGHEST_PRECEDENCE);
        return bean;
    }
} 
```

é‡å¯æœåŠ¡å™¨ï¼Œåˆ·æ–°å®¢æˆ·ç«¯ï¼Œæ‚¨åº”è¯¥ä¼šåœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°æ±½è½¦åˆ—è¡¨ã€‚

## [](#add-angular-material)æ·»åŠ æœ‰æ£±è§’çš„ææ–™

æ‚¨å·²ç»å®‰è£…äº† Angular Materialï¼Œè¦ä½¿ç”¨å…¶ç»„ä»¶ï¼Œæ‚¨éœ€è¦å¯¼å…¥å®ƒä»¬ã€‚æ‰“å¼€`client/src/app/app.module.ts`å¹¶æ·»åŠ åŠ¨ç”»å¯¼å…¥ã€ç´ æå·¥å…·æ ã€æŒ‰é’®ã€è¾“å…¥ã€åˆ—è¡¨å’Œå¡ç‰‡å¸ƒå±€ã€‚

```
import { MatButtonModule, MatCardModule, MatInputModule, MatListModule, MatToolbarModule } from '@angular/material';

@NgModule({
  ...
  imports: [
    BrowserModule,
    AppRoutingModule,
    BrowserAnimationsModule,
    HttpClientModule,
    MatButtonModule,
    MatCardModule,
    MatInputModule,
    MatListModule,
    MatToolbarModule
  ],
  ...
}) 
```

æ›´æ–°`client/src/app/app.component.html`ä»¥ä½¿ç”¨å·¥å…·æ ç»„ä»¶ã€‚

```
<mat-toolbar color="primary">
  <span>Welcome to {{title}}!</span>
</mat-toolbar>

<app-car-list></app-car-list>
<router-outlet></router-outlet> 
```

æ›´æ–°`client/src/app/car-list/car-list.component.html`ä»¥ä½¿ç”¨å¡ç‰‡å¸ƒå±€å’Œåˆ—è¡¨ç»„ä»¶ã€‚

```
<mat-card>
  <mat-card-title>Car List</mat-card-title>
  <mat-card-content>
    <mat-list>
      <mat-list-item *ngFor="let car of cars">
        <img mat-list-avatar src="{{car.giphyUrl}}" alt="{{car.name}}">
        <h3 mat-line>{{car.name}}</h3>
      </mat-list-item>
    </mat-list>
  </mat-card-content>
</mat-card> 
```

å¦‚æœæ‚¨ä½¿ç”¨`ng serve`è¿è¡Œæ‚¨çš„å®¢æˆ·ç«¯å¹¶å¯¼èˆªåˆ°`http://localhost:4200`ï¼Œæ‚¨å°†çœ‹åˆ°æ±½è½¦åˆ—è¡¨ï¼Œä½†æ²¡æœ‰ä¸ä¹‹ç›¸å…³è”çš„å›¾åƒã€‚

[![Car List without images](../Images/9f87d78d108d9f63c009a55c91fcfe72.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--CelxrTjL--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/car-list-no-images-cb55fd492df65c9183654c948a1e27532a19c93a6973b36859ab251df08ab947.png)

## [](#add-animated-gifs-with-giphy)ç”¨ Giphy æ·»åŠ åŠ¨ç”» gif

è¦ä¸ºæ¯è¾†æ±½è½¦æ·»åŠ ä¸€ä¸ª`giphyUrl`å±æ€§ï¼Œåˆ›å»º`client/src/app/shared/giphy/giphy.service.ts`å¹¶ç”¨ä¸‹é¢çš„ä»£ç å¡«å……å®ƒã€‚

```
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { map } from 'rxjs/operators';

@Injectable({providedIn: 'root'})
export class GiphyService {

  // This is a Giphy API Key I created. Create your own at https://developers.giphy.com/dashboard/?create=true.
  giphyApi = '//api.giphy.com/v1/gifs/search?api_key=nOTRbUNMgD5mj4XowN2ERoPNudAkK6ft&limit=1&q=';

  constructor(public http: HttpClient) {
  }

  get(searchTerm) {
    const apiLink = this.giphyApi + searchTerm;
    return this.http.get(apiLink).pipe(map((response: any) => {
      if (response.data.length > 0) {
        return response.data[0].images.original.url;
      } else {
        return 'https://media.giphy.com/media/YaOxRsmrv9IeA/giphy.gif'; // dancing cat for 404
      }
    }));
  }
} 
```

æ›´æ–°`client/src/app/car-list/car-list.component.ts`ä¸­çš„ä»£ç ï¼Œè®¾ç½®æ¯è¾†æ±½è½¦çš„`giphyUrl`å±æ€§ã€‚

```
import { GiphyService } from '../shared/giphy/giphy.service';

export class CarListComponent implements OnInit {
  cars: Array<any>;

  constructor(private carService: CarService, private giphyService: GiphyService) { }

  ngOnInit() {
    this.carService.getAll().subscribe(data => {
      this.cars = data;
      for (const car of this.cars) {
        this.giphyService.get(car.name).subscribe(url => car.giphyUrl = url);
      }
    });
  }
} 
```

ç°åœ¨ä½ çš„æµè§ˆå™¨åº”è¯¥ä¼šæ˜¾ç¤ºæ±½è½¦åç§°åˆ—è¡¨ï¼Œæ—è¾¹è¿˜æœ‰ä¸€ä¸ªå¤´åƒå›¾ç‰‡ã€‚

[![Car List with Giphy avatars](../Images/82fcfbb2a3f7e3153c03a38c188f4a2b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--kQS494OZ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/car-list-giphy-images-f2e0dfa3b9c612f595f2126745fed71f79f0b8b0ecc2332619ae954af8d2ef11.png)

## [](#add-an-edit-feature-to-your-angular-app)å‘è§’åº¦åº”ç”¨æ·»åŠ ç¼–è¾‘ç‰¹å¾

æ‹¥æœ‰ä¸€ä¸ªæ±½è½¦åç§°å’Œå›¾ç‰‡çš„åˆ—è¡¨æ˜¯å¾ˆé…·çš„ï¼Œä½†æ˜¯å½“ä½ å¯ä»¥å’Œå®ƒäº’åŠ¨çš„æ—¶å€™ä¼šæ›´æœ‰è¶£ï¼è¦æ·»åŠ ç¼–è¾‘ç‰¹å¾ï¼Œé¦–å…ˆè¦ç”Ÿæˆä¸€ä¸ª`car-edit`ç»„ä»¶ã€‚

```
ng g c car-edit 
```

æ›´æ–°`client/src/app/shared/car/car.service.ts`ä»¥è·å¾—æ·»åŠ ã€åˆ é™¤å’Œæ›´æ–°æ±½è½¦çš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ä¸ç”±`CarRepository`åŠå…¶`@RepositoryRestResource`æ³¨é‡Šæä¾›çš„ç«¯ç‚¹å¯¹è¯ã€‚

```
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({providedIn: 'root'})
export class CarService {
  public API = '//localhost:8080';
  public CAR_API = this.API + '/cars';

  constructor(private http: HttpClient) {
  }

  getAll(): Observable<any> {
    return this.http.get(this.API + '/cool-cars');
  }

  get(id: string) {
    return this.http.get(this.CAR_API + '/' + id);
  }

  save(car: any): Observable<any> {
    let result: Observable<any>;
    if (car.href) {
      result = this.http.put(car.href, car);
    } else {
      result = this.http.post(this.CAR_API, car);
    }
    return result;
  }

  remove(href: string) {
    return this.http.delete(href);
  }
} 
```

åœ¨`client/src/app/car-list/car-list.component.html`ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªåˆ°ç¼–è¾‘ç»„ä»¶çš„é“¾æ¥ã€‚å¦å¤–ï¼Œåœ¨åº•éƒ¨æ·»åŠ ä¸€ä¸ªæŒ‰é’®æ¥æ·»åŠ æ–°è½¦ã€‚

```
<mat-card>
  <mat-card-title>Car List</mat-card-title>
  <mat-card-content>
    <mat-list>
      <mat-list-item *ngFor="let car of cars">
        <img mat-list-avatar src="{{car.giphyUrl}}" alt="{{car.name}}">
        <h3 mat-line>
          <a mat-button [routerLink]="['/car-edit', car.id]">{{car.name}}</a>
        </h3>
      </mat-list-item>
    </mat-list>
  </mat-card-content>

  <button mat-fab color="primary" [routerLink]="['/car-add']">Add</button>
</mat-card> 
```

åœ¨`client/src/app/app.module.ts`ä¸­ï¼Œå¯¼å…¥`FormsModule`ã€‚

```
import { FormsModule } from '@angular/forms';

@NgModule({
  ...
  imports: [
    ...
    FormsModule
  ],
  ...
}) 
```

åœ¨`client/src/app/app-routing.module.ts`ä¸­ï¼Œæ·»åŠ `CarListComponent`å’Œ`CarEditComponent`çš„è·¯çº¿ã€‚

```
import { NgModule } from '@angular/core';
import { Routes, RouterModule } from '@angular/router';
import { CarListComponent } from './car-list/car-list.component';
import { CarEditComponent } from './car-edit/car-edit.component';

const routes: Routes = [
  { path: '', redirectTo: '/car-list', pathMatch: 'full' },
  {
    path: 'car-list',
    component: CarListComponent
  },
  {
    path: 'car-add',
    component: CarEditComponent
  },
  {
    path: 'car-edit/:id',
    component: CarEditComponent
  }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { } 
```

ä¿®æ”¹`client/src/app/car-edit/car-edit.component.ts`ä»¥ä» URL ä¸Šä¼ é€’çš„ id ä¸­è·å–æ±½è½¦ä¿¡æ¯ï¼Œå¹¶æ·»åŠ ä¿å­˜å’Œåˆ é™¤çš„æ–¹æ³•ã€‚

```
import { Component, OnDestroy, OnInit } from '@angular/core';
import { Subscription } from 'rxjs';
import { ActivatedRoute, Router } from '@angular/router';
import { CarService } from '../shared/car/car.service';
import { GiphyService } from '../shared/giphy/giphy.service';
import { NgForm } from '@angular/forms';

@Component({
  selector: 'app-car-edit',
  templateUrl: './car-edit.component.html',
  styleUrls: ['./car-edit.component.css']
})
export class CarEditComponent implements OnInit, OnDestroy {
  car: any = {};

  sub: Subscription;

  constructor(private route: ActivatedRoute,
              private router: Router,
              private carService: CarService,
              private giphyService: GiphyService) {
  }

  ngOnInit() {
    this.sub = this.route.params.subscribe(params => {
      const id = params.id;
      if (id) {
        this.carService.get(id).subscribe((car: any) => {
          if (car) {
            this.car = car;
            this.car.href = car._links.self.href;
            this.giphyService.get(car.name).subscribe(url => car.giphyUrl = url);
          } else {
            console.log(`Car with id '${id}' not found, returning to list`);
            this.gotoList();
          }
        });
      }
    });
  }

  ngOnDestroy() {
    this.sub.unsubscribe();
  }

  gotoList() {
    this.router.navigate(['/car-list']);
  }

  save(form: NgForm) {
    this.carService.save(form).subscribe(result => {
      this.gotoList();
    }, error => console.error(error));
  }

  remove(href) {
    this.carService.remove(href).subscribe(result => {
      this.gotoList();
    }, error => console.error(error));
  }
} 
```

æ›´æ–°`client/src/app/car-edit/car-edit.component.html`ä¸­çš„ HTMLï¼Œå¾—åˆ°ä¸€ä¸ªåŒ…å«æ±½è½¦åç§°çš„è¡¨å•ï¼Œå¹¶æ˜¾ç¤ºæ¥è‡ª Giphy çš„å›¾åƒã€‚

```
<mat-card>
  <form #carForm="ngForm" (ngSubmit)="save(carForm.value)">
    <mat-card-header>
      <mat-card-title><h2>{{car.name ? 'Edit' : 'Add'}} Car</h2></mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <input type="hidden" name="href" [(ngModel)]="car.href">
      <mat-form-field>
        <input matInput placeholder="Car Name" [(ngModel)]="car.name"
               required name="name" #name>
      </mat-form-field>
    </mat-card-content>
    <mat-card-actions>
      <button mat-raised-button color="primary" type="submit"
              [disabled]="!carForm.valid">Save</button>
      <button mat-raised-button color="secondary" (click)="remove(car.href)"
              *ngIf="car.href" type="button">Delete</button>
      <a mat-button routerLink="/car-list">Cancel</a>
    </mat-card-actions>
    <mat-card-footer>
      <div class="giphy">
        <img src="{{car.giphyUrl}}" alt="{{car.name}}">
      </div>
    </mat-card-footer>
  </form>
</mat-card> 
```

é€šè¿‡å°†ä¸‹é¢çš„ CSS æ·»åŠ åˆ°`client/src/app/car-edit/car-edit.component.css`ä¸­ï¼Œåœ¨å›¾åƒå‘¨å›´æ·»åŠ ä¸€äº›å¡«å……ã€‚

```
.giphy {
  margin: 10px;
} 
```

ä¿®æ”¹`client/src/app/app.component.html`å¹¶åˆ é™¤`<app-car-list></app-car-list>`ã€‚

```
<mat-toolbar color="primary">
  <span>Welcome to {{title}}!</span>
</mat-toolbar>

<router-outlet></router-outlet> 
```

å®Œæˆæ‰€æœ‰è¿™äº›æ›´æ”¹åï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿæ·»åŠ ã€ç¼–è¾‘æˆ–åˆ é™¤ä»»ä½•æ±½è½¦ã€‚ä¸‹é¢æ˜¯æ˜¾ç¤ºå¸¦æœ‰æ·»åŠ æŒ‰é’®çš„åˆ—è¡¨çš„å±å¹•æˆªå›¾ã€‚

[![Car List with Add button](../Images/38bf61a844bde573fb7a9d63f3c85996.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Vfh3flrf--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/car-list-add-btn-cd39137b8f8a073df4535fec494aa288200273800d1ce25fdb942680d81b2bff.png)

ä¸‹é¢çš„æˆªå›¾æ˜¾ç¤ºäº†ç¼–è¾‘æ‚¨æ·»åŠ çš„æ±½è½¦çš„æ ·å­ã€‚

[![Car Edit Component](../Images/fa0f014404832d5ba66fb959266c1900.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--kB6ocs-w--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/car-edit-6282a191dc88f1bef351e048c1fa64042191d62dae2c03541d74752e81084f86.png)

## [](#add-oidc-authentication-to-your-spring-boot-angular-app)ä¸ºæ‚¨çš„ Spring Boot + Angular åº”ç”¨æ·»åŠ  OIDC è®¤è¯

æ·»åŠ  OIDC è®¤è¯æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ç‰¹æ€§ï¼Œä½ å¯ä»¥æ·»åŠ åˆ°è¿™ä¸ªåº”ç”¨ç¨‹åºä¸­ã€‚å¦‚æœæ‚¨æƒ³æ·»åŠ å®¡è®¡æˆ–ä¸ªæ€§åŒ–æ‚¨çš„åº”ç”¨ç¨‹åº(ä¾‹å¦‚ï¼Œä½¿ç”¨è¯„çº§åŠŸèƒ½)ï¼ŒçŸ¥é“è¿™ä¸ªäººæ˜¯è°ä¼šå¾ˆæ–¹ä¾¿ã€‚

### [](#spring-security-oidc)æ˜¥å®‰+ OIDC

åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Okta çš„ Spring Boot å¯åŠ¨å™¨é”å®šäº‹æƒ…ï¼Œå®ƒåˆ©ç”¨äº† Spring å®‰å…¨æ€§åŠå…¶ OIDC æ”¯æŒã€‚æ‰“å¼€`server/pom.xml`å¹¶å–æ¶ˆ Okta Spring Boot å¯åŠ¨å™¨çš„æ³¨é‡Šã€‚

```
<dependency>
    <groupId>com.okta.spring</groupId>
    <artifactId>okta-spring-boot-starter</artifactId>
    <version>1.1.0</version>
</dependency> 
```

ç°åœ¨æ‚¨éœ€è¦é…ç½®æœåŠ¡å™¨ä½¿ç”¨ Okta è¿›è¡Œèº«ä»½éªŒè¯ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦åœ¨ Okta åˆ›å»ºä¸€ä¸ª OIDC åº”ç”¨ç¨‹åºã€‚

### [](#create-an-oidc-app-in-okta)åœ¨ Okta åˆ›å»ºä¸€ä¸ª OIDC App

ç™»å½•æ‚¨çš„ Okta å¼€å‘è€…è´¦æˆ·(å¦‚æœæ‚¨æ²¡æœ‰è´¦æˆ·ï¼Œè¯·æ³¨å†Œï¼Œç„¶åå¯¼èˆªè‡³**åº”ç”¨** > **æ·»åŠ åº”ç”¨**ã€‚ç‚¹å‡»**å•é¡µåº”ç”¨**ï¼Œç‚¹å‡»ä¸‹ä¸€ä¸ªçš„**ï¼Œç»™åº”ç”¨å–ä¸€ä¸ªä½ ä¼šè®°ä½çš„åå­—ã€‚å°†`http://localhost:8080`çš„æ‰€æœ‰å®ä¾‹æ›´æ”¹ä¸º`http://localhost:4200`å¹¶ç‚¹å‡»**å®Œæˆ**ã€‚**

[![OIDC App Settings](../Images/38612cb36bc7712fe29735d0e60f4ecf.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--xfnimC4S--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/oidc-settings-980e05cda53609ed905297c1a0d241c533870cf0222f5ff924117f299c055de7.png)

æ‚¨ä¼šåœ¨é¡µé¢åº•éƒ¨çœ‹åˆ°ä¸€ä¸ªå®¢æˆ· IDã€‚å°†å®ƒå’Œä¸€ä¸ª`issuer`å±æ€§æ·»åŠ åˆ°`server/src/main/resources/application.properties`ã€‚

```
okta.oauth2.client-id={yourClientId}
okta.oauth2.issuer=https://{yourOktaDomain}/oauth2/default 
```

åˆ›å»º
`server/src/main/java/com/okta/developer/demo/SecurityConfiguration.java`å°†æ‚¨çš„ Spring Boot åº”ç”¨ç¨‹åºé…ç½®ä¸ºèµ„æºæœåŠ¡å™¨ã€‚

```
package com.okta.developer.demo;

import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@EnableWebSecurity
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests().anyRequest().authenticated()
            .and()
            .oauth2ResourceServer().jwt();
    }
} 
```

å®Œæˆè¿™äº›æ›´æ”¹åï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿé‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œå¹¶åœ¨å°è¯•å¯¼èˆªåˆ°`http://localhost:8080`æ—¶çœ‹åˆ°ä¸€ä¸ªé”™è¯¯ã€‚

[![Access Denied](../Images/3e2d03cf170e97765393c8304bcbca1e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--RmdkPWJp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/400-error-25aa5f4ff679212a117a84b4468ab7a8fd8decc0cedbaf892144f791307cff70.png)

**æ³¨æ„:**ä½ å¯ä»¥é€šè¿‡åœ¨ä½ çš„åº”ç”¨ä¸­æ·»åŠ `http://localhost:8080/login/oauth2/code/okta`ä½œä¸ºé‡å®šå‘ URI æ¥ä¿®å¤è¿™ä¸ªé”™è¯¯ï¼Œä½†è¿™å¹¶ä¸èƒ½è§£å†³é—®é¢˜ã€‚å¦‚æœä½ æƒ³é€šè¿‡ Spring Boot æ”¯æŒ OIDC ç™»å½•ï¼Œä½ éœ€è¦æ³¨å†Œä¸€ä¸ª **Web** åº”ç”¨(è€Œä¸æ˜¯ SPA ),å¹¶åœ¨ä½ çš„`application.properties`ä¸­åŒ…å«ä¸€ä¸ªå®¢æˆ·ç«¯å¯†ç ã€‚è¿™ä¸æ˜¯æœ¬æ•™ç¨‹ä¸­çš„å¿…è¦æ­¥éª¤ã€‚

ç°åœ¨æ‚¨çš„æœåŠ¡å™¨è¢«é”å®šäº†ï¼Œæ‚¨éœ€è¦é…ç½®æ‚¨çš„å®¢æˆ·æœºç”¨ä¸€ä¸ªè®¿é—®ä»¤ç‰Œä¸å®ƒå¯¹è¯ã€‚è¿™å°±æ˜¯ Okta çš„ Angular SDK æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚

### [](#oktas-angular-support)ç§‹ç”°çš„è§’æ’‘

Okta Angular SDK æ˜¯åŸºäº OIDC æ„å»ºçš„ Okta Auth JS T1 çš„åŒ…è£…å™¨ã€‚æ›´å¤šå…³äº Okta è§’å›¾ä¹¦é¦†çš„ä¿¡æ¯å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°[ã€‚](https://github.com/okta/okta-oidc-js/tree/master/packages/okta-angular)

ä¸ºäº†ç®€åŒ–æˆ‘ä»¬çš„ Angular SDK çš„å®‰è£…å’Œé…ç½®ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª@oktadev/schematics é¡¹ç›®æ¥ä¸ºæ‚¨å®Œæˆæ‰€æœ‰å·¥ä½œã€‚ä½ å¯ä»¥åœ¨[ä½¿ç”¨è§’åº¦ç¤ºæ„å›¾ç®€åŒ–ä½ çš„ç”Ÿæ´»](https://dev.to/blog/2019/02/13/angular-schematics)ä¸­é˜…è¯»æ›´å¤šå…³äº@oktadev/schematics å¦‚ä½•å·¥ä½œçš„ä¿¡æ¯ã€‚

åœ¨å®‰è£…ä¹‹å‰ï¼Œæœ€å¥½å°†é¡¹ç›®ç­¾å…¥æºä»£ç æ§åˆ¶ã€‚å¦‚æœæ²¡æœ‰å®‰è£… Gitï¼Œå¯ä»¥å°†é¡¹ç›®å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®ä½œä¸ºå¤‡ä»½ã€‚å¦‚æœæ‚¨å®‰è£…äº† Gitï¼Œä»é¡¹ç›®çš„æ ¹ç›®å½•è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚

```
git init
git add .
git commit -m "Initialize project" 
```

è¦å®‰è£…å’Œé…ç½® Okta çš„ Angular SDKï¼Œåœ¨`client`ç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
ng add @oktadev/schematics --issuer=https://{yourOktaDomain}/oauth2/default --clientId={yourClientId} 
```

è¯¥å‘½ä»¤å°†:

*   å®‰è£…`@okta/okta-angular`
*   åœ¨`auth-routing.module.ts`ä¸­ä¸ºä½ çš„ app é…ç½® Okta çš„ Angular SDK
*   å°†`isAuthenticated`é€»è¾‘æ·»åŠ åˆ°`app.component.ts`
*   æ·»åŠ ä¸€ä¸ªå¸¦æœ‰ç™»å½•å’Œæ³¨é”€æŒ‰é’®çš„`HomeComponent`
*   ä½¿ç”¨åˆ°`/home`çš„é»˜è®¤è·¯ç”±å’Œ`/implicit/callback`è·¯ç”±é…ç½®è·¯ç”±
*   æ·»åŠ ä¸€ä¸ª`HttpInterceptor`ï¼Œå‘`localhost`è¯·æ±‚æ·»åŠ ä¸€ä¸ªå¸¦æœ‰è®¿é—®ä»¤ç‰Œçš„`Authorization`æŠ¥å¤´

`auth-routing.module.ts`æ–‡ä»¶å‘`HomeComponent`æ·»åŠ äº†ä¸€æ¡é»˜è®¤è·¯å¾„ï¼Œå› æ­¤æ‚¨éœ€è¦åœ¨`app-routing.module.ts`ä¸­åˆ é™¤é»˜è®¤è·¯å¾„ã€‚ä¿®æ”¹`app-routing.module.ts`ä¸­çš„è·¯çº¿ï¼Œå»æ‰ç¬¬ä¸€æ¡ï¼Œå¢åŠ `OktaAuthGuard`ã€‚è¿™å¯ä»¥ç¡®ä¿ç”¨æˆ·åœ¨è®¿é—®è·¯ç”±ä¹‹å‰é€šè¿‡èº«ä»½éªŒè¯ã€‚

```
import { OktaAuthGuard } from '@okta/okta-angular';

const routes: Routes = [
  {
    path: 'car-list',
    component: CarListComponent,
    canActivate: [OktaAuthGuard]
  },
  {
    path: 'car-add',
    component: CarEditComponent,
    canActivate: [OktaAuthGuard]
  },
  {
    path: 'car-edit/:id',
    component: CarEditComponent,
    canActivate: [OktaAuthGuard]
  }
]; 
```

ä¿®æ”¹`client/src/app/app.component.html`ä»¥ä½¿ç”¨ææ–™ç»„ä»¶å¹¶æœ‰ä¸€ä¸ªæ³¨é”€æŒ‰é’®ã€‚

```
<mat-toolbar color="primary">
  <span>Welcome to {{title}}!</span>
  <span class="toolbar-spacer"></span>
  <button mat-raised-button color="accent" *ngIf="isAuthenticated"
          (click)="oktaAuth.logout()" [routerLink]="['/home']">Logout
  </button>
</mat-toolbar>

<router-outlet></router-outlet> 
```

æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°æœ‰ä¸€ä¸ªå¸¦æœ‰`toolbar-spacer`ç±»çš„ spanã€‚ä¸ºäº†ä½¿è¿™ä¸€å·¥ä½œå¦‚é¢„æœŸçš„é‚£æ ·ï¼Œç»™`client/src/app/app.component.css`æ·»åŠ ä¸€ä¸ª`toolbar-spacer`è§„åˆ™ã€‚

```
.toolbar-spacer {
  flex: 1 1 auto;
} 
```

ç„¶åæ›´æ–°`client/src/app/home/home.component.html`ä½¿ç”¨è§’æï¼Œé“¾æ¥åˆ°è½¦å•ã€‚

```
<mat-card>
  <mat-card-content>
    <button mat-raised-button color="accent" *ngIf="!isAuthenticated"
            (click)="oktaAuth.loginRedirect()">Login
    </button>
    <button mat-raised-button color="accent" *ngIf="isAuthenticated"
            [routerLink]="['/car-list']">Car List
    </button>
  </mat-card-content>
</mat-card> 
```

ç”±äºæ‚¨ä½¿ç”¨çš„æ˜¯`HomeComponent`ä¸­çš„ç‰©æ–™ç»„ä»¶ï¼Œè€Œè¯¥ç»„ä»¶ç”±æ–°æ·»åŠ çš„`client/src/app/auth-routing.module.ts`ç®¡ç†ï¼Œå› æ­¤æ‚¨éœ€è¦å¯¼å…¥`MatCardModule`ã€‚

```
import { MatCardModule } from '@angular/material';

@NgModule({
  ...
  imports: [
    ...
    MatCardModule
  ],
  ...
}) 
```

ä¸ºäº†ä½¿å†…å®¹çš„åº•éƒ¨æ²¡æœ‰åº•éƒ¨è¾¹æ¡†ï¼Œé€šè¿‡å°†ä¸‹é¢çš„å†…å®¹æ·»åŠ åˆ°`client/src/styles.css`ä¸­ï¼Œä½¿`<mat-card>`å…ƒç´ å……æ»¡å±å¹•ã€‚

```
mat-card {
  height: 100vh;
} 
```

ç°åœ¨ï¼Œå¦‚æœä½ é‡å¯ä½ çš„å®¢æˆ·ç«¯ï¼Œä¸€åˆ‡*åº”è¯¥*å·¥ä½œã€‚ä¸å¹¸çš„æ˜¯ï¼Œå¹¶æ²¡æœ‰ï¼Œå› ä¸º [Ivy è¿˜æ²¡æœ‰å®ç° CommonJS/UMD æ”¯æŒ](https://github.com/angular/angular/issues/29564)ã€‚ä½œä¸ºä¸€ç§å˜é€šæ–¹æ³•ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹`tsconfig.app.json`æ¥ç¦ç”¨ Ivyã€‚

```
"angularCompilerOptions":  {  "enableIvy":  false  } 
```

åœæ­¢å¹¶é‡å¯`ng serve`è¿‡ç¨‹ã€‚æ‰“å¼€æµè§ˆå™¨è¿›å…¥`http://localhost:4200`ã€‚

[![Login Button](../Images/d7f3d777939a247d46320ee2baa95b2c.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--cS2G2SnK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/login-button-2f282cf5d2bf12f79d6e509fc1739941a44c93150df466a897eead69047847d4.png)

ç‚¹å‡»**ç™»å½•**æŒ‰é’®ã€‚å¦‚æœä½ å·²ç»æ­£ç¡®åœ°é…ç½®äº†ä¸€åˆ‡ï¼Œä½ å°†è¢«é‡å®šå‘åˆ° Okta ç™»å½•ã€‚

[![Okta Login](../Images/184cdb9d4c23b8db9ac2abb9c6b2cb7c.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--UHRJJW4m--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/okta-login-07278b9750ab8c6babda66d611b16c385ae764146af9a10c8024b1109a09c42c.png)

è¾“å…¥æœ‰æ•ˆå‡­æ®ï¼Œæ‚¨å°†è¢«é‡å®šå‘å›æ‚¨çš„åº”ç”¨ã€‚å½“ä¸€åˆ‡é¡ºåˆ©æ—¶ï¼Œåº†ç¥ä¸€ä¸‹å§ï¼ğŸ‰

[![Success!](../Images/3013f30fc91759e3c5259a0e2a7c2ad6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--v6EnVgCV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.okta.com/assets-jekyll/blog/spring-boot-2-angular-8/success-at-last-2af183fc8fdb5605a64c2f3b91a0dfed5dd6b3a3fb2636ea0d54177ab0e8f82b.png)

## [](#learn-more-about-spring-boot-and-angular)äº†è§£æ›´å¤šå…³äº Spring Boot å’Œæ£±è§’åˆ†æ˜

å¾ˆéš¾è·Ÿä¸Šåƒ Spring Boot å’Œ Angular è¿™æ ·å¿«é€Ÿå‘å±•çš„æ¡†æ¶ã€‚è¿™ç¯‡æ–‡ç« æ—¨åœ¨ç»™ä½ ä¸€ä¸ªå…³äºæœ€æ–°ç‰ˆæœ¬çš„å¿«é€Ÿå…¥é—¨ã€‚å…³äº Angular 8 çš„å…·ä½“å˜åŒ–ï¼Œå‚è§ Angular å›¢é˜Ÿå¯¹ 8.0 ç‰ˆæœ¬å’Œ Ivy çš„[è®¡åˆ’ã€‚Spring Boot è¯·å‚è§å…¶](https://blog.angular.io/a-plan-for-version-8-0-and-ivy-b3318dfc19f7) [2.2 ç‰ˆæœ¬è¯´æ˜](https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.2-Release-Notes)ã€‚

ä½ å¯ä»¥åœ¨ GitHub ä¸Šçš„[okta developer/okta-spring-boot-2-angular-8-example](https://github.com/oktadeveloper/okta-spring-boot-2-angular-8-example)çœ‹åˆ°æœ¬æ•™ç¨‹ä¸­å¼€å‘çš„åº”ç”¨ç¨‹åºçš„å®Œæ•´æºä»£ç ã€‚

è¿™ä¸ªåšå®¢æœ‰è¿‡å¤šçš„ Spring Boot å’Œè§’åº¦æ•™ç¨‹ã€‚ä»¥ä¸‹æ˜¯æˆ‘æœ€å–œæ¬¢çš„ä¸€äº›:

*   [ç”¨ Angular å’Œ electronic æ„å»ºæ¡Œé¢åº”ç”¨](https://dev.to/blog/2019/03/20/build-desktop-app-with-angular-electron)
*   [å°†ä½ çš„ Spring Boot åº”ç”¨è¿ç§»åˆ°æœ€æ–°æœ€å¥½çš„ Spring Security å’Œ OAuth 2.0](https://dev.to/blog/2019/03/05/spring-boot-migration)
*   [i18n åœ¨ Java 11 ä¸­ï¼ŒSpring Boot å’Œ JavaScript](https://dev.to/blog/2019/02/25/java-i18n-internationalization-localization)
*   [ä¸ºæ‚¨çš„ Angular åº”ç”¨å»ºç«‹å®‰å…¨ç™»å½•](https://dev.to/blog/2019/02/12/secure-angular-login)
*   [ç”¨ Spring WebFlux æ„å»ºååº”å¼ APIsã€‘](https://dev.to/blog/2018/09/24/reactive-apis-with-spring-webflux)

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·ä¸è¦çŠ¹è±«åœ¨ä¸‹é¢ç•™ä¸‹è¯„è®ºï¼Œæˆ–è€…åœ¨æˆ‘ä»¬çš„ [Okta å¼€å‘è€…è®ºå›](https://devforum.okta.com/)ä¸Šè¯¢é—®æˆ‘ä»¬ã€‚åˆ«å¿˜äº†åœ¨ Twitter å’Œ YouTube ä¸Šå…³æ³¨æˆ‘ä»¬[ï¼](https://twitter.com/oktadev)