# ç”Ÿäº§ååº”åº”ç”¨çš„åŸå› ï¼ŸğŸ¤”(ç¬¬ä¸€éƒ¨åˆ†)

> åŸæ–‡:[https://dev . to/seif _ ghe zala/reason ml-for-production-react-apps-part-1-3n fk](https://dev.to/seif_ghezala/reasonml-for-production-react-apps-part-1-3nfk)

ReasonML æ˜¯ä¸€ç§å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œå…·æœ‰æ™ºèƒ½æ¨æ–­çš„ä¸¥æ ¼ç±»å‹ï¼Œå¯ä»¥ç¼–è¯‘æˆ JavaScriptã€‚ReasonReact æ˜¯ ReactJS çš„åŸå› ç»‘å®š(ä¹Ÿç§°ä¸º ReactJS çš„ ReasonML ç¿»è¯‘ç‰ˆæœ¬)ã€‚å®ƒæœ€è¿‘æ”¹è¿›äº†å¾ˆå¤šï¼Œç”šè‡³åœ¨å‡ å¤©å‰çš„å‘å¸ƒä¸­å¢åŠ äº†å¯¹é’©å­çš„æ”¯æŒã€‚

åœ¨è¿™ä¸€ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘å°†åœ¨ ReasonReact ä¸­æ„å»ºåº”ç”¨ç¨‹åºï¼Œå¹¶å°è¯•å®Œæˆæˆ‘é€šå¸¸ç”¨ ReactJS å®Œæˆçš„å¤§å¤šæ•°ä»»åŠ¡ã€‚å¯¹äºæ¯ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘éƒ½ä¼šåˆ†äº«æˆ‘å–œæ¬¢/ä¸å–œæ¬¢åœ¨ rational ä¸­æ„å»º React åº”ç”¨ç¨‹åºçš„åœ°æ–¹ã€‚ç›®æ ‡æ˜¯ç¡®å®š React åº”ç”¨ç¨‹åºçš„å‡†å¤‡ç¨‹åº¦ã€‚

# [](#what-are-we-going-to%C2%A0build)æˆ‘ä»¬è¦é€ ä»€ä¹ˆï¼Ÿ

æˆ‘å†³å®šä»ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºå¼€å§‹ã€‚æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå…·æœ‰ä»¥ä¸‹ç‰¹æ€§çš„å°å•è¯è®¡æ•°å™¨:

*   æœ‰ä¸€ä¸ªè¾“å…¥ï¼Œæˆ‘å¯ä»¥å†™æ–‡æœ¬ã€‚
*   å½“æˆ‘å†™æ–‡å­—æ—¶ï¼Œå­—æ•°ä¼šæ›´æ–°ã€‚
*   æœ‰ä¸€ä¸ªæ¸…é™¤æ–‡æœ¬çš„æŒ‰é’®ã€‚
*   æœ‰ä¸€ä¸ªå¤åˆ¶æ–‡æœ¬çš„æŒ‰é’®ã€‚

[![Final result](../Images/b24e6506e69c75bc85d75628e4c6f968.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--YUVH0Qt0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/1rl3gdneih3awmreato1.gif) 

<figure>

<figcaption>æœ€ç»ˆç»“æœ</figcaption>

</figure>

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æœ€ç»ˆçš„æºä»£ç [ã€‚å› ä¸ºæˆ‘ä»¬å°†åœ¨è¿­ä»£ä¸­æ„å»ºåº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥æ¯ä¸ªè¿­ä»£éƒ½æœ‰ä¸€ä¸ªåˆ†æ”¯ã€‚](https://github.com/siffogh/words-counter)

# [](#setting-up-the-project-amp%C2%A0editor)è®¾ç½®é¡¹ç›®&ç¼–è¾‘

å…ˆæŠŠåŸå› ä¸‹è½½åˆ° JavaScript ç¼–è¯‘å™¨[bs-platform](https://bucklescript.github.io/)(BuckleScript):

```
npm install -g bs-platform 
```

è¿™ä¸ªåŒ…é™„å¸¦äº† *bsb* ï¼Œè¿™æ˜¯ä¸€ä¸ª CLI å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿå¼•å¯¼ä¸€ä¸ªåŸºäºæ¨¡æ¿çš„ Reason é¡¹ç›®ã€‚
è®©æˆ‘ä»¬åŸºäº react-hooks æ¨¡æ¿ç”Ÿæˆæˆ‘ä»¬çš„é¡¹ç›®:

```
bsb -init words-counter -theme react-hooks 
```

è®©æˆ‘ä»¬ä¹Ÿä½¿ç”¨ VSCode ä½œä¸ºæˆ‘ä»¬çš„ä»£ç ç¼–è¾‘å™¨ï¼Œå¹¶ä¸‹è½½ [reason-vscode](https://marketplace.visualstudio.com/items?itemName=jaredly.reason-vscode) ã€‚è¿™æ˜¯ [ReasonML](https://reasonml.github.io/docs/en/editor-plugins) å®˜æ–¹æ¨èçš„ç¼–è¾‘å™¨æ’ä»¶ã€‚

ä¸ºäº†åˆ©ç”¨æ ¼å¼åŒ–ç‰¹æ€§ï¼Œè®©æˆ‘ä»¬åœ¨ç¼–è¾‘å™¨çš„è®¾ç½®ä¸­å¯ç”¨ä¿å­˜æ—¶çš„*æ ¼å¼*é€‰é¡¹:

[![Enabling the Format On Save option on VSCode](../Images/939c57e8fd68a60affa6ee51fabc4471.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--UX0XpL4p--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/71vo3wmgs1e9revyjyza.png) 

<figure>

<figcaption>å¯ç”¨ VSCode ä¸Šçš„æ ¼å¼ä¿å­˜é€‰é¡¹</figcaption>

</figure>

## [](#i-like%C2%A0)æˆ‘å–œæ¬¢ğŸ‘

*   å…¥é—¨ä½“éªŒéå¸¸å¥½ã€‚BuckleScript æ„å»ºå·¥å…·(bsb)æ˜¯ *create-react-app* æˆ– *yeoman* çš„æ›´å¿«ç‰ˆæœ¬ã€‚

*   ç¼–è¾‘å™¨å·¥å…·ä¹Ÿå¾ˆæ£’:

    *   å®ƒæ ¼å¼åŒ–ä»£ç æ ·å¼å’Œè¯­æ³•(å°±åƒç”¨ Prettier é…ç½® ESLint ä¸€æ ·)ã€‚
    *   å®ƒè¿˜æä¾›æ‚¬åœåœ¨å€¼ä¸Šæ—¶æœ‰å…³ç±»å‹çš„ä¿¡æ¯ã€‚

# [](#iteration-1-there-is-an-input-where-i-can-write%C2%A0text)è¿­ä»£#1:æœ‰ä¸€ä¸ªæˆ‘å¯ä»¥å†™æ–‡æœ¬çš„è¾“å…¥

åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬åªæƒ³æœ‰ä¸€ä¸ªæ¼‚äº®çš„æ–‡æœ¬åŒºåŸŸï¼Œå®ƒå¸¦æœ‰ä¸€ä¸ªæ ‡é¢˜ï¼Œç”¨äºç¼–å†™æ–‡æœ¬å¹¶å°†å…¶å­˜å‚¨åœ¨ä¸€ä¸ªçŠ¶æ€å˜é‡ä¸­:

[![Iteration #1: there is an input where I can writeÂ text](../Images/384deb0b5e24d0c8a9a0d1ae24a5afe8.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--TwvIe4Pa--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/pi8g9lchiksny3xymgxi.gif) 

<figure>

<figcaption>è¿­ä»£#1:æœ‰ä¸€ä¸ªæˆ‘å¯ä»¥å†™æ–‡æœ¬çš„è¾“å…¥</figcaption>

</figure>

```
/* src/App.re */

[%bs.raw {|require('./App.css')|}];

[@react.component]
let make = () => {
  let (text, setText) = React.useState(() => "");

  let handleTextChange = e => ReactEvent.Form.target(e)##value |> setText;

  <div className="App">
    <div className="header">
      <h3> {"Words Counter" |> ReasonReact.string} </h3>
    </div>
    <textarea
      placeholder="Express yourself..."
      value=text
      onChange=handleTextChange
    />
  </div>;
}; 
```

## [](#i-dislike%C2%A0)æˆ‘ä¸å–œæ¬¢ğŸ‘

*   è®¿é—®è¡¨å•äº‹ä»¶çš„ç›®æ ‡å€¼ä¼šæœ‰ä¸€ç‚¹å¼€é”€ã€‚
*   ä¸å¾—ä¸å¯¹æ¯ä¸ª`string`å€¼ä½¿ç”¨`ReasonReact.string`éœ€è¦ä¸€äº›ä¹ æƒ¯ï¼Œå³ä½¿å¤åˆè¿ç®—ç¬¦`|>`æœ‰æ‰€å¸®åŠ©ã€‚
*   `useState`éœ€è¦ä¸€ä¸ªå‡½æ•°ã€‚è™½ç„¶è¿™åœ¨è¿›è¡Œæ˜‚è´µçš„åˆå§‹çŠ¶æ€è®¡ç®—æ—¶å¾ˆæœ‰ç”¨ï¼Œä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ä¸å¿…è¦çš„ã€‚æˆ‘æ›´å–œæ¬¢è¿™ä¸ªé’©å­çš„ä¸¤ç§å½¢å¼(ä¸€ç§æ¥å—å€¼ï¼Œä¸€ç§æ¥å—å‡½æ•°)æœ‰ä¸åŒçš„åå­—ã€‚

## [](#i-like%C2%A0)æˆ‘å–œæ¬¢ğŸ‘

*   ç”¨ CSS å¼€å‘ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºéå¸¸å®¹æ˜“ã€‚è™½ç„¶è¦æ±‚ CSS æ–‡ä»¶çš„è¯­æ³•æœ‰ç‚¹å¥‡æ€ªï¼Œä½†æ•´ä¸ªä½“éªŒä»ç„¶å¾ˆæ£’ã€‚

*   DOM å…ƒç´ æ˜¯å®Œå…¨ç±»å‹åŒ–çš„ï¼Œè¿™æœ‰ä¸¤ä¸ªå¥½å¤„:

    *   ä½ å¯ä»¥åœ¨è¿è¡Œä¹‹å‰çŸ¥é“ä½ æ˜¯å¦ç»™ä¸€ä¸ªé“å…·åˆ†é…äº†ä¸€ä¸ªé”™è¯¯çš„å€¼:æ²¡æœ‰æ‰“å­—é”™è¯¯äº†ï¼è¿™å°±åƒä¸ºæ‰€æœ‰ DOM å…ƒç´ çš„å±æ€§å†…ç½®äº† propTypes ä¸€æ ·ã€‚
    *   DOM å…ƒç´ æ˜¯è‡ªæ–‡æ¡£åŒ–çš„ã€‚æ‚¨å¯ä»¥ç«‹å³å°†é¼ æ ‡æ‚¬åœåœ¨ä¸€ä¸ªå…ƒç´ ä¸Šï¼ŒæŸ¥çœ‹å®ƒæ¥å—çš„å¯èƒ½å±æ€§(ä¸å†éœ€è¦ Google å®ƒä»¬)ã€‚

## è¿­ä»£#2:å½“æˆ‘å†™æ–‡ç« æ—¶ï¼Œå­—æ•°ä¼šæ›´æ–°

åœ¨è¿™ä¸ªè¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ˜¾ç¤ºåˆ°ç›®å‰ä¸ºæ­¢è¾“å…¥çš„å•è¯æ•°:

[![Iteration #2: there is a word count that updates while I writeÂ text](../Images/24d2f2ef9a812811f11ee8d179c0a02b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--IQFdCFWd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/v5jniuicgm8jucye597k.gif) 

<figure>

<figcaption>è¿­ä»£#2:æœ‰ä¸€ä¸ªå­—æ•°åœ¨æˆ‘å†™æ–‡å­—çš„æ—¶å€™æ›´æ–°</figcaption>

</figure>

é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›å­—ç¬¦ä¸²è¾“å…¥ä¸­çš„å•è¯æ•°:

```
let countWordsInString = text => {
  let spacesRegex = Js.Re.fromString("\s+");

  switch (text) {
  | "" => 0
  | noneEmptyText =>
    noneEmptyText
    |> Js.String.trim
    |> Js.String.splitByRe(spacesRegex)
    |> Js.Array.length
  };
}; 
```

ä¸‹é¢æ˜¯è¿™ä¸ªå‡½æ•°çš„ä½œç”¨:

*   å¦‚æœæ–‡æœ¬ä¸ºç©ºï¼Œæˆ‘ä»¬åªè¿”å› 0ã€‚
*   å¦åˆ™ï¼Œæˆ‘ä»¬åªéœ€ä¿®å‰ªæ–‡æœ¬å¹¶ä½¿ç”¨`Js.String.splitByRe`é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼`\s+`å¯¹å…¶è¿›è¡Œåˆ†å‰²(è¿™åŸºæœ¬ä¸Šæ„å‘³ç€ 1 ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åè·Ÿä»»ä½•å­—ç¬¦)å¹¶è¿”å›æˆ‘ä»¬è·å¾—çš„æ•°ç»„çš„é•¿åº¦ã€‚

```
/* src/App.re */

[%bs.raw {|require('./App.css')|}];

let countWordsInString = text => {
  let spacesRegex = Js.Re.fromString("\s+");

  switch (text) {
  | "" => 0
  | noneEmptyText =>
    noneEmptyText
    |> Js.String.trim
    |> Js.String.splitByRe(spacesRegex)
    |> Js.Array.length
  };
};

[@react.component]
let make = () => {
  let (text, setText) = React.useState(() => "");

  let handleTextChange = e => ReactEvent.Form.target(e)##value |> setText;

  let wordsCountText =
    (text |> countWordsInString |> string_of_int) ++ " words";

  <div className="App">
    <div className="header">
      <h3> {"Words Counter" |> ReasonReact.string} </h3>
      <span> {ReasonReact.string(wordsCountText)} </span>
    </div>
    <textarea
      placeholder="Express yourself..."
      value=text
      onChange=handleTextChange
    />
  </div>;
}; 
```

## [](#i-like%C2%A0)æˆ‘å–œæ¬¢ğŸ‘

*   ç†æ€§çš„èªæ˜æ¨è®ºæ˜¯ä¼Ÿå¤§çš„:
    *   è™½ç„¶æˆ‘æ²¡æœ‰æä¾›ä»»ä½•ç±»å‹æ³¨é‡Šï¼Œä½†æ˜¯`countWordsInString`å‡½æ•°æ˜¯è‡ªæ–‡æ¡£åŒ–çš„ã€‚æ‚¬åœåœ¨å®ƒä¸Šé¢æ˜¾ç¤ºå®ƒæ¥å—ä¸€ä¸ª`string`å¹¶è¿”å›ä¸€ä¸ª`int`ã€‚
    *   åœ¨æŸäº›æ—¶å€™ï¼Œæˆ‘ä»`countWordsInString`è¿”å›äº†åˆ†å‰²æ•°ç»„ï¼Œè€Œä¸æ˜¯å®ƒçš„é•¿åº¦ã€‚ç”šè‡³åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œæˆ‘å°±èƒ½å¤Ÿåœ¨æ„å»ºæ—¶å‘ç°è¿™ä¸ªé”™è¯¯ã€‚

## [](#iteration-3-there-is-a-button-to-clear%C2%A0text)è¿­ä»£#3:æœ‰ä¸€ä¸ªæ¸…é™¤æ–‡æœ¬çš„æŒ‰é’®

åœ¨è¿™æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªæŒ‰é’®æ¥æ¸…é™¤æ–‡æœ¬:

[![Iteration #3: there is a button to clearÂ textLet's add a button to clear the text in the textarea.](../Images/88b379a505657cb35a2eefa333e21f46.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--nJhprTCv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/hbmtb7lvggsrvvlklbmh.gif) 

<figure>

<figcaption>è¿­ä»£#3:æœ‰ä¸€ä¸ªæ¸…é™¤æ–‡æœ¬çš„æŒ‰é’®è®©æˆ‘ä»¬åœ¨ textarea ä¸­æ·»åŠ ä¸€ä¸ªæ¸…é™¤æ–‡æœ¬çš„æŒ‰é’®ã€‚</figcaption>

</figure>

åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä½¿ç”¨ [svgr](https://github.com/smooth-code/svgr) Webpack åŠ è½½å™¨ç›´æ¥ä»å¯¹åº”çš„`.svg`æ–‡ä»¶ä¸­å¯¼å…¥ SVG å›¾æ ‡ä½œä¸º React ç»„ä»¶ã€‚

å› ä¸ºå¯¼å…¥æ˜¯åœ¨ Reason ä¸­è¾“å…¥çš„ï¼Œæ‰€ä»¥æˆ‘å†³å®šåœ¨ clear æŒ‰é’®ä¸­æ”¾ç½®ä¸€ä¸ªå›¾æ ‡ï¼Œçœ‹çœ‹å°† SVG å›¾æ ‡ä½œä¸º React ç»„ä»¶å¯¼å…¥ä¼šæœ‰å¤šç—›è‹¦ã€‚

ç”±äºæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ¬¡è¿­ä»£ä¸­æœ‰å¦ä¸€ä¸ªæŒ‰é’®ï¼Œçœ‹èµ·æ¥ä¼šæœ‰æ‰€ä¸åŒ(å‰§é€è­¦æŠ¥)ï¼Œè®©æˆ‘ä»¬å°†æˆ‘ä»¬çš„æŒ‰é’®ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ç»„ä»¶ï¼Œå¹¶ä½¿å…¶å…·æœ‰ä¸¤ä¸ªç±»åˆ«çš„æ ·å¼:

*   ä¸»è¦:è“è‰²æŒ‰é’®
*   æ¬¡è¦:ç°è‰²æŒ‰é’®

```
/* src/Button.re */

[%bs.raw {|require('./Button.css')|}];

type categoryT =
  | SECONDARY
  | PRIMARY;

let classNameOfCategory = category =>
  "Button "
  ++ (
    switch (category) {
    | SECONDARY => "secondary"
    | PRIMARY => "primary"
    }
  );

[@react.component]
let make =
    (
      ~onClick,
      ~title: string,
      ~children: ReasonReact.reactElement,
      ~disabled=false,
      ~category=SECONDARY,
    ) => {
  <button onClick className={category |> classNameOfCategory} title disabled>
    children
  </button>;
}; 
```

ä¸ºäº†ä½¿ç”¨ svgrï¼Œè®©æˆ‘ä»¬åœ¨ Webpack `module`é…ç½®ä¸­æ·»åŠ ä»¥ä¸‹è§„åˆ™:

```
{
  test: /\.svg$/,
  use: ['@svgr/webpack'],
} 
```

åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å¯¼å…¥ä¸€ä¸ª svg ç»„ä»¶:

```
import {ReactComponent as Times} from './times'; 
```

ç”±äº Webpack å°† svgr åº”ç”¨äºç¼–è¯‘æˆ‘ä»¬çš„ Reason æºä»£ç å¾—åˆ°çš„ JavaScriptï¼Œæˆ‘ä»¬åªéœ€è¦è®© BuckleScript å°†æˆ‘ä»¬çš„ Reason å¯¼å…¥è½¬æ¢æˆä¸€ä¸ªå‘½åçš„ es6 å¯¼å…¥ã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆå¿…é¡»é…ç½®`/bs-config.json`(BuckleScript ç¼–è¯‘å™¨çš„é…ç½®æ–‡ä»¶)æ¥ä½¿ç”¨ es6 å¯¼å…¥:

```
 "package-specs":  [  {  "module":  "es6",  "in-source":  true  }  ], 
```

React `make`å‡½æ•°ç¼–è¯‘æˆ JavaScript React ç»„ä»¶ï¼è¿™æ„å‘³ç€ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨ä¸€ä¸ªç”¨ JavaScript ç¼–å†™çš„ç»„ä»¶â€œFooâ€ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯:
1-åˆç†åœ°åˆ›å»ºç»„ä»¶ã€‚
2-å¯¼å…¥ JS ç»„ä»¶ä½œä¸º Reason ç»„ä»¶çš„`make`å‡½æ•°ï¼Œå¹¶æ³¨é‡Šå…¶ propsã€‚

å› æ­¤ï¼Œåœ¨æ¨¡å—`Foo.re`ä¸­ï¼Œæˆ‘ä»¬å°†æ‹¥æœ‰ä»¥ä¸‹å†…å®¹:

```
[@bs.module "./path/to/Foo.js"][@react.component]
external make: (~someProp: string, ~someOtherProp: int) => React.element = "default"; 
```

è¿™æ„å‘³ç€...æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å¯¼å…¥å¸¦æœ‰ svgr çš„ SVG ç»„ä»¶ï¼
è®©æˆ‘ä»¬ç”¨å®ƒæ¥å¯¼å…¥`./times.svg`å›¾æ ‡ï¼Œå¹¶åªæ³¨é‡Š`height`é“å…·ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨çš„å”¯ä¸€é“å…·:

```
[@bs.module "./times.svg"] [@react.component]
external make: (~height: string) => React.element = "default"; 
```

æˆ‘ä»¬çš„åŸå›  React ç»„ä»¶è¢«è‡ªåŠ¨è§†ä¸ºæ¨¡å—ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å•ç‹¬çš„æ–‡ä»¶(Button.reï¼ŒApp.re)ä¸­åˆ›å»ºäº†å®ƒä»¬ã€‚ç”±äº Times ç»„ä»¶éå¸¸å°(åªæœ‰ 2 è¡Œ)ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Reason çš„æ¨¡å—è¯­æ³•æ¥åˆ›å»ºå®ƒ:

```
/* src/App.re */

[%bs.raw {|require('./App.css')|}];

let countWordsInString = text => {
  let spacesRegex = Js.Re.fromString("\s+");

  switch (text) {
  | "" => 0
  | noneEmptyText =>
    noneEmptyText
    |> Js.String.trim
    |> Js.String.splitByRe(spacesRegex)
    |> Js.Array.length
  };
};

module Times = {
  [@bs.module "./times.svg"] [@react.component]
  external make: (~height: string) => React.element = "default";
};

[@react.component]
let make = () => {
  let (text, setText) = React.useState(() => "");

  let handleTextChange = e => ReactEvent.Form.target(e)##value |> setText;

  let handleClearClick = _ => setText(_ => "");

  let wordsCountText =
    (text |> countWordsInString |> string_of_int) ++ " words";

  <div className="App">
    <div className="header">
      <h3> {"Words Counter" |> ReasonReact.string} </h3>
      <span> {ReasonReact.string(wordsCountText)} </span>
    </div>
    <textarea
      placeholder="Express yourself..."
      value=text
      onChange=handleTextChange
    />
    <div className="footer">
      <Button
        title="Clear text"
        onClick=handleClearClick
        disabled={String.length(text) === 0}>
        <Times height="20px" />
      </Button>
    </div>
  </div>;
}; 
```

## [](#i-dislike%C2%A0)æˆ‘ä¸å–œæ¬¢ğŸ‘

å¦‚æœæˆ‘æƒ³åˆ¶ä½œä¸€ä¸ªå¯é‡ç”¨çš„æŒ‰é’®ï¼Œå®ƒåº”è¯¥æ¥å—åŸç”Ÿ DOM æŒ‰é’®çš„æ‰€æœ‰å±æ€§ï¼Œæˆ‘å¿…é¡»åˆ—å‡ºæ‰€æœ‰è¿™äº›å±æ€§ã€‚åœ¨ JavaScript ä¸­ï¼Œæˆ‘å¯ä»¥é€šè¿‡ä½¿ç”¨ spread æ“ä½œæ¥é¿å…è¿™ç§æƒ…å†µ:

```
function Button(props) {
    return <button {...props} /> } 
```

ä½†æ˜¯ï¼ŒReasonReact ä¸å…è®¸ spread è¿ç®—ç¬¦ã€‚(ä¸çŸ¥é“æœ‰æ²¡æœ‰åŠæ³•ç”¨ ReasonReact è¾¾åˆ°æˆ‘æƒ³è¦çš„ğŸ¤”)

## [](#i-like%C2%A0)æˆ‘å–œæ¬¢ğŸ‘

*   æŒ‡å®šå­©å­ç±»å‹çš„èƒ½åŠ›éå¸¸å¼ºå¤§ã€‚è¿™åœ¨ JavaScript çš„ PropTypes ä¸­æ˜¯å¯èƒ½çš„ï¼Œä½†æ˜¯ä¸ Reason ç›¸æ¯”éå¸¸æœ‰é™ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šç»„ä»¶åªæ¥å— 2 ä¸ªå­ç»„ä»¶(ä½œä¸ºä¸€ä¸ªå…ƒç»„)ã€‚
*   å˜ä½“æœ‰åŠ©äºå¯¹æŒ‰é’®è¿›è¡Œåˆ†ç±»ã€‚å¯¹ç»„ä»¶è¿›è¡Œåˆ†ç±»æ˜¯ç»å¸¸å‘ç”Ÿçš„äº‹æƒ…ï¼Œæ‰€ä»¥èƒ½å¤Ÿç”¨å®é™…çš„å¯é ç±»å‹è€Œä¸æ˜¯å­—ç¬¦ä¸²å¸¸é‡æ¥åšè¿™ä»¶äº‹æ˜¯ä¸€ä¸ªå·¨å¤§çš„èƒœåˆ©ã€‚
*   ä½¿ç”¨ Webpack svgr æ’ä»¶å°† SVG ä½œä¸ºä¸€ä¸ªç»„ä»¶å¯¼å…¥å®é™…ä¸Šç›¸å½“å®¹æ˜“ã€‚è¿™éå¸¸ç®€å•ï¼Œä½†ç¡®ä¿äº†ç±»å‹å®‰å…¨ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»å¯¹ç±»å‹è¿›è¡Œæ³¨é‡Šã€‚

## [](#iteration-4-there-is-a-button-to-copy%C2%A0text)è¿­ä»£#4:æœ‰ä¸€ä¸ªå¤åˆ¶æ–‡æœ¬çš„æŒ‰é’®

åœ¨è¿™æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªæŒ‰é’®å°†æ–‡æœ¬å¤åˆ¶åˆ°å‰ªè´´æ¿:

[![Iteration #4: there is a button to copyÂ text](../Images/b24e6506e69c75bc85d75628e4c6f968.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--YUVH0Qt0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/1rl3gdneih3awmreato1.gif) 

<figure>

<figcaption>è¿­ä»£#4:æœ‰ä¸€ä¸ªå¤åˆ¶æ–‡æœ¬çš„æŒ‰é’®</figcaption>

</figure>

ä¸ºæ­¤ï¼Œæˆ‘æƒ³ä½¿ç”¨ [react-copy-to-clipboard](https://www.npmjs.com/package/react-copy-to-clipboard) ï¼Œè¿™æ˜¯ä¸€ä¸ª react ç»„ä»¶åº“ï¼Œå…è®¸éå¸¸å®¹æ˜“åœ°å°†æ–‡æœ¬å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ª JavaScript åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸ä¸Šä¸€æ¬¡è¿­ä»£ä¸­ç›¸åŒçš„å¯¼å…¥æ–¹æ³•ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œæˆ‘ä»¬å°†è¿›è¡Œå‘½åå¯¼å…¥ï¼Œè€Œä¸æ˜¯é»˜è®¤å¯¼å…¥ã€‚

```
/* src/App.re */

[%bs.raw {|require('./App.css')|}];

let countWordsInString = text => {
  let spacesRegex = Js.Re.fromString("\s+");

  switch (text) {
  | "" => 0
  | noneEmptyText =>
    noneEmptyText
    |> Js.String.trim
    |> Js.String.splitByRe(spacesRegex)
    |> Js.Array.length
  };
};

module Times = {
  [@bs.module "./icons/times.svg"] [@react.component]
  external make: (~height: string) => React.element = "default";
};

module Copy = {
  [@bs.module "./icons/copy.svg"] [@react.component]
  external make: (~height: string) => React.element = "default";
};

module CopyClipboard = {
  [@bs.module "react-copy-to-clipboard"] [@react.component]
  external make: (~text: string, ~children: React.element) => React.element =
    "CopyToClipboard";
};

[@react.component]
let make = () => {
  let (text, setText) = React.useState(() => "");

  let handleTextChange = e => ReactEvent.Form.target(e)##value |> setText;

  let handleClearClick = _ => setText(_ => "");

  let wordsCountText =
    (text |> countWordsInString |> string_of_int) ++ " words";

  <div className="App">
    <div className="header">
      <h3> {"Words Counter" |> ReasonReact.string} </h3>
      <span> {ReasonReact.string(wordsCountText)} </span>
    </div>
    <textarea
      placeholder="Express yourself..."
      value=text
      onChange=handleTextChange
    />
    <div className="footer">
      <Button
        title="Clear text"
        onClick=handleClearClick
        disabled={String.length(text) === 0}>
        <Times height="20px" />
      </Button>
      <CopyClipboard text>
        <Button
          title="Copy text"
          disabled={String.length(text) === 0}
          category=Button.PRIMARY>
          <Copy height="20px" />
        </Button>
      </CopyClipboard>
    </div>
  </div>;
}; 
```

## [](#i-like%C2%A0)æˆ‘å–œæ¬¢ğŸ‘

å¯¼å…¥ JavaScript React ç»„ä»¶åº“ä¹Ÿéå¸¸ç®€å•ï¼Œå¹¶ä¸”å¯ä»¥ç¡®ä¿ç±»å‹å®‰å…¨ã€‚