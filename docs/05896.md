# ä¸ºä»€ä¹ˆè¿è¡Œâ€œyarn upgradeâ€ä¸èƒ½æ›´æ–°æˆ‘çš„â€œpackage.jsonâ€

> åŸæ–‡:[https://dev . to/wgao 19/why-running-yarn-upgrade-does-not-update-my-package-JSON-3mon](https://dev.to/wgao19/why-running-yarn-upgrade-does-not-update-my-package-json-3mon)

# [](#why-running-raw-yarn-upgrade-endraw-does-not-update-my-raw-packagejson-endraw-)ä¸ºä»€ä¹ˆè¿è¡Œ`yarn upgrade`ä¸æ›´æ–°æˆ‘çš„`package.json`

ä»Šå¤©æˆ‘æƒ³å‡çº§æˆ‘çš„ä¸€ä¸ªé¡¹ç›®å¯¹ React çš„ä¾èµ–ã€‚æ‰€ä»¥æˆ‘è·‘äº†

```
yarn upgrade react 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¼¼ä¹æ¯ä¸ªäººéƒ½å¾ˆå¼€å¿ƒã€‚

[![](../Images/7d6e6b7a2d87629af6d0f75d073df202.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--8O91YPfI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i.imgur.com/tlJH8KR.png)

ç„¶åæˆ‘æŸ¥äº†ä¸€ä¸‹æˆ‘çš„`package.json`ï¼Œä»€ä¹ˆéƒ½æ²¡å˜ã€‚

```
"react" "^16.5.1",
"react-dom": "^16.5.1", 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘çš„ç¬¬ä¸€ä¸ªè°·æ­ŒæŸ¥è¯¢æ˜¯ [yarn å‡çº§ä¸æ›´æ–° package.json](https://www.google.com/search?q=yarn+upgrade+does+not+update+package.json) ã€‚ä¸€äº›ç»“æœä¼¼ä¹è¡¨æ˜äº†æ—©æœŸç‰ˆæœ¬çš„ Yarn ä¸­çš„é”™è¯¯ã€‚ä½†å®ƒä¼¼ä¹ä¸ä¼šå»ä»»ä½•åœ°æ–¹ã€‚

Yarn çš„å®˜æ–¹æ–‡æ¡£æ˜ç¡®æŒ‡å‡ºè¿è¡Œè¿™æ ·çš„å‘½ä»¤åº”è¯¥æ›´æ–°è¿™é‡Œçš„ä¾èµ–å…³ç³»ã€‚

ç„¶åæˆ‘æ£€æŸ¥äº†æˆ‘çš„`yarn.lock`ï¼Œå‘ç°æˆ‘çš„å‡çº§åŒ…çš„æœ€æ–°ç‰ˆæœ¬å·²ç»å®‰è£…å¥½äº†ã€‚

[![](../Images/94eb5bbfa198c1501b275d9b43023a53.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Tqb612yw--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i.imgur.com/ekEn1dG.png)

ä¸ºä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆğŸ¤·ğŸ»â€â™€ï¸

æˆ‘å¯¹è¿™é‡Œå¯èƒ½å‘ç”Ÿçš„äº‹æƒ…æœ‰äº†ä¸€ä¸ªç²—ç•¥çš„äº†è§£ã€‚å½“å‰`react@^16.5.1`æ¥å—å‡çº§ç‰ˆæœ¬`16.8.6`ï¼Œå¦‚`yarn.lock`æ‰€ç¤ºã€‚

ä½†æ˜¯å¯¹äºæˆ‘æ¥è¯´ï¼Œåœ¨è¿™ç§è¯­ä¹‰æƒ…å†µä¸‹ï¼Œå‡çº§ä¾èµ–å…³ç³»çš„é€‚å½“æ–¹å¼æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œå°†ä¾èµ–å…³ç³»å‡çº§åˆ°æœ€æ–°çš„åŒ…*å’Œ*ï¼Œè¡¨æ˜æˆ‘çš„åº”ç”¨ç¨‹åºç°åœ¨ä¾èµ–äºé‚£ä¸ªç‰ˆæœ¬ï¼Ÿ

æˆ‘çš„æ„æ€æ˜¯ï¼Œé™¤äº†æ‰‹åŠ¨æ›´æ”¹`package.json`ï¼Ÿ

æˆ‘å››å¤„æ¸¸ç©äº†å‡ ä»¶äº‹ã€‚æœ‰äº›æ˜¾ç„¶ä¸æ˜¯æ­£ç¡®çš„æ–¹å‘ï¼Œä½†å®ƒä»¬æœ‰åŠ©äºå¯¹æƒ…å†µæœ‰æ‰€äº†è§£ã€‚

## [](#understanding-the-semantic-versioning-ranges)äº†è§£è¯­ä¹‰ç‰ˆæœ¬èŒƒå›´

æˆ‘ä»¬çš„`node_modules`ä¸­å®‰è£…çš„ç‰ˆæœ¬å¯èƒ½ä¸æ˜¯æˆ‘ä»¬åœ¨`package.json`ä¸­çœ‹åˆ°çš„å­—é¢æ•°å­—ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æŒ‡å‡ºçš„ç‰ˆæœ¬å¯ä»¥æ˜¯ä¸€ä¸ªèŒƒå›´ã€‚

ä¾‹å¦‚ï¼Œ[æ’å…¥ç¬¦å·èŒƒå›´](https://yarnpkg.com/en/docs/dependency-versions#toc-caret-ranges)æŒ‡å®šå¦‚ä¸‹:

> å…è®¸ä¸ä¿®æ”¹ç‰ˆæœ¬ä¸­ç¬¬ä¸€ä¸ªéé›¶æ•°å­—çš„æ›´æ”¹ï¼Œ3.1.4 ä¸­çš„ 3 æˆ– 0.4.2 ä¸­çš„ 4ã€‚

é€šè¿‡è¿è¡Œ
æ·»åŠ åŒ…æ—¶ï¼Œç¼ºçœæƒ…å†µä¸‹ä½¿ç”¨æ’å…¥ç¬¦å·èŒƒå›´

```
$ yarn add package-name 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°†å®‰è£…å¸¦æœ‰æœ€æ–°ç¨³å®šç‰ˆæœ¬çš„åŒ…ï¼ŒYarn ç”¨æ’å…¥ç¬¦å·èŒƒå›´ç¼–å†™æˆ‘ä»¬çš„é‚£ä¸ªç‰ˆæœ¬çš„`package.json`ã€‚

å¦‚æœæˆ‘ç†è§£æ­£ç¡®çš„è¯ï¼Œä¼¼ä¹å¦‚æœæˆ‘å°†æ¥è¿è¡Œ`yarn`æˆ‘çš„åŒ…ï¼Œæˆ–è€…å…¶ä»–æŸä¸ªåŒ…ä¾èµ–äºä¸€ä¸ªæ›´é«˜çš„ç‰ˆæœ¬ï¼Œåªè¦æ»¡è¶³èŒƒå›´ï¼Œå®ƒå°±ä¼šä½¿ç”¨æ›´é«˜çš„ç‰ˆæœ¬ã€‚

è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶æœ‰æ›´å¤šçš„èŒƒå›´:

*   [æ’å…¥ç¬¦å·èŒƒå›´](https://yarnpkg.com/en/docs/dependency-versions#toc-caret-ranges)
*   [æ³¢æµªå·èŒƒå›´](https://yarnpkg.com/en/docs/dependency-versions#toc-tilde-ranges)
*   [è¿å­—ç¬¦èŒƒå›´](https://yarnpkg.com/en/docs/dependency-versions#toc-hyphen-ranges)
*   [x èŒƒå›´](https://yarnpkg.com/en/docs/dependency-versions#toc-x-ranges)

ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»çº±çº¿çš„æ–‡ä»¶[ï¼Œæˆ–è€…åœ¨è¿™é‡Œ](https://yarnpkg.com/en/docs/dependency-versions)é˜…è¯» NPM çš„æ–‡ä»¶[ã€‚](https://docs.npmjs.com/files/package.json#dependencies)

## [](#understanding-the-command-raw-yarn-upgrade-endraw-)ç†è§£å‘½ä»¤`yarn upgrade`

æ‰€ä»¥æˆ‘ä»Šå¤©å­¦åˆ°çš„æ˜¯ï¼Œè¿è¡Œ`yarn upgrade`ä¸ä¸€å®šä¼šåƒæˆ‘æƒ³è±¡çš„é‚£æ ·æ›´æ–°`package.json`ã€‚

### [](#-raw-yarn-upgrade-endraw-without-modifier)`yarn upgrade`(ä¸å¸¦ä¿®é¥°è¯­)

ä¸å¸¦ä»»ä½•ä¿®æ”¹å™¨è¿è¡Œ`yarn upgrade`ä¸ä¼šæ›´æ–°`package.json`ã€‚

å¦‚æœæˆ‘ä»¬ä¸å¸¦ä»»ä½•æ ‡å¿—è¿è¡Œ`yarn upgrade`ï¼Œå®ƒå°†å®‰è£…ä¸æŒ‡ç¤ºçš„ç‰ˆæœ¬æ¨¡å¼ç›¸åŒ¹é…çš„æœ€æ–°ç‰ˆæœ¬*ã€‚å¹¶ä¸”å®ƒä¼š*è€Œä¸æ˜¯*æ›´æ–°`package.json`ã€‚*

*   `yarn upgrade`ä¾èµ–`"react": "~16.5.1"`:åœ¨*æ³¢æµªå·èŒƒå›´*ä¸Šå®‰è£…æœ€æ–°ç‰ˆæœ¬`~16.5.1`ä¸º`16.5.2`
*   `yarn upgrade`ä¾èµ–`"react": "^16.5.1"`:åœ¨*æ’å…¥ç¬¦å·èŒƒå›´*ä¸Šå®‰è£…æœ€æ–°ç‰ˆæœ¬`~16.5.1`ï¼Œä»ä»Šå¤©èµ·ä¸º`16.8.6`
*   `yarn upgrade` on *ç¡®åˆ‡çš„è¯´*ä¾èµ–`"react": "16.5.1"`æ ¹æœ¬ä¸ä¼šå®‰è£…ä»»ä½•æ–°çš„ğŸ§

### [](#-raw-yarn-upgrade-latest-endraw-)`yarn upgrade --latest`

è¿è¡Œ`yarn upgrade` *å¯èƒ½*æ›´æ–°`package.json`ï¼Œå½“æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ä¸å†åŒ¹é…å½“å‰èŒƒå›´ã€‚

ä½†å®ƒä»ç„¶*å¯èƒ½ä¸ä¼š*æ›´æ–°`package.json`ã€‚å…·ä½“åœ°ï¼Œå½“æœ€æ–°ç‰ˆæœ¬ä¸`package.json`ä¸­æŒ‡ç¤ºçš„è¯­ä¹‰ç‰ˆæœ¬èŒƒå›´ç›¸åŒ¹é…æ—¶ã€‚

*   `yarn upgrade --latest`ä¾èµ–`"react": "~16.5.1"`:å®‰è£…åˆ°ä»Šå¤©ä¸ºæ­¢çš„æœ€æ–°ç‰ˆæœ¬`16.8.6`ï¼Œæ›´æ–°`package.json`åˆ°`"react": ~16.8.6"`
*   `yarn upgrade --latest`ä¾èµ–`"react": "^16.5.1"`:å®‰è£…åˆ°ä»Šå¤©ä¸ºæ­¢çš„æœ€æ–°ç‰ˆæœ¬`16.8.6`ï¼Œæ›´æ–°`package.json`åˆ°`"react": ^16.8.6"`
*   `yarn upgrade --latest`äº*ç¡®åˆ‡çš„*ä¾èµ–`"react": "16.5.1"`å®‰è£…åˆ°ä»Šå¤©ä¸ºæ­¢çš„æœ€æ–°ç‰ˆæœ¬`16.8.6`ï¼Œæ›´æ–°`package.json`åˆ°`"react": 16.8.6"`

## [](#what-should-i-do-if-i-want-to-upgrade-to-a-version-and-update-raw-packagejson-endraw-)æƒ³å‡çº§ä¸€ä¸ªç‰ˆæœ¬*æ›´æ–°`package.json`è¯¥æ€ä¹ˆåš*

 *å¦‚æœå¤„ç†ä¸€ä¸ªå³ä½¿æ˜¯æ¬¡è¦ç‰ˆæœ¬ä¹Ÿå¾ˆæ•æ„Ÿçš„åº“ï¼Œæœ€å¥½æŒ‡æ˜ä¸€ä¸ªæ›´ä¸¥æ ¼çš„ç‰ˆæœ¬èŒƒå›´ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªç²¾ç¡®çš„ç‰ˆæœ¬èŒƒå›´ã€‚å¹¶ä¸”ç”¨`--latest`å‡çº§ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ä½¿ç”¨äº†å‡ ä¸ªå‘½ä»¤ä¹‹åï¼Œæˆ‘å‘ç°è¿™ä¸ªå‘½ä»¤å¾ˆæœ‰è¶£ï¼Œå¹¶ä¸”åœ¨è¿™ç§æƒ…å†µä¸‹æœ€ç®€å•:

```
$ yarn upgrade react@^ 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°†å¼¹å‡ºä¸€ä¸ªäº¤äº’å¼ç‰ˆæœ¬åˆ—è¡¨ä¾›æ‚¨é€‰æ‹©ã€‚å¹¶ä¸”å®‰è£…åï¼Œå®ƒä¼šå†æ¬¡ç”¨è„±å­—ç¬¦å·èŒƒå›´å°†`package.json`æ›´æ–°åˆ°æ‰€é€‰ç‰ˆæœ¬ã€‚

[![](../Images/817b41c2e15c89e3669c1951b555306e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ZjuoTUCP--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i.imgur.com/v1kub69.png)

## [](#wrapping-up)åŒ…è£…å®Œæ¯•

å¯¹äºç‰ˆæœ¬æ•æ„Ÿåº“(æ¯”å¦‚ Flowï¼Ÿï¼Ÿï¼ŸğŸ™ˆ)ï¼Œè¡¨ç¤ºæ²¡æœ‰ä»»ä½•èŒƒå›´çš„ç‰ˆæœ¬ä¾èµ–å…³ç³»ã€‚

ä½¿ç”¨`yarn upgrade package@[version]`å¯èƒ½æ˜¯å‡çº§è½¯ä»¶åŒ…çš„å®é™…æ“ä½œä¸­æœ€ç›´è§‚çš„æ–¹å¼ã€‚

## [](#references)å‚è€ƒæ–‡çŒ®

*   [Yarn æ–‡æ¡£:ä¾èµ–å…³ç³»çš„ç‰ˆæœ¬](https://yarnpkg.com/en/docs/dependency-versions)
*   [yarn upgrade.js æºä»£ç ](https://github.com/yarnpkg/yarn/blob/82d5891f3726abf275c9753b97bdcc54e85637f3/src/cli/commands/upgrade.js)
*   [npm-package.json](https://docs.npmjs.com/files/package.json)*