# Windows ä¸Šå¸¦æœ‰ AWS è”é‚¦çš„ Git å’Œ SourceTree è®¾ç½®

> åŸæ–‡:[https://dev . to/katiekodes/git-and-source tree-setup-with-AWS-Federation-on-windows-1ek 5](https://dev.to/katiekodes/git-and-sourcetree-setup-with-aws-federation-on-windows-1ek5)

æ‚¨çš„ Amazon Web Services å¸æˆ·æœ‰â€œå•ç‚¹ç™»å½•â€åŠŸèƒ½ï¼Œä½†éœ€è¦è®¾ç½®æ‚¨çš„è®¡ç®—æœºæ¥ä¸ä»–ä»¬çš„ CodeCommit git å­˜å‚¨åº“ä¸»æœºå¯¹è¯å—ï¼Ÿå¦‚æœä½ çš„ç”µè„‘ä¸Šå®‰è£…äº† Windowsã€Python å’Œ Gitï¼Œè¿™é‡Œå‘Šè¯‰ä½ å¦‚ä½•åœ¨ä¸å¼„ä¹±ä½ è¿æ¥çš„ä»»ä½•å…¶ä»–æ™®é€šçš„æ—§ç”¨æˆ·åå’Œå¯†ç åº“çš„æƒ…å†µä¸‹åšåˆ°è¿™ä¸€ç‚¹ï¼

è¿™äº›æˆ‘éƒ½æ²¡æƒ³å‡ºæ¥â€”â€”æˆ‘åªæ˜¯æŠŠå®ƒè½¬å½•æˆâ€œç»™å‡äººâ€
*(ä¹Ÿå°±æ˜¯æˆ‘çš„ç”µè„‘è¢«å–ä»£åçš„æœªæ¥çš„è‡ªå·±)*ã€‚

## [](#summary)æ€»ç»“

ä¸‹é¢æ˜¯æˆ‘ä»¬å°†è¦å‘Šè¯‰ Git å¦‚ä½•ä¸ Amazon å¯¹è¯çš„è¦ç‚¹:

1.  æˆ‘ä»¬å°†è®¾ç½®ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œæ¯å°æ—¶å‘`c:\users\MY_USERNAME\.aws\credentials`ä¸­æ”¾å…¥ä¸€æ¬¡æ–°å†…å®¹*(ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†ä½¿è¿è¡Œä¸€ä¸ª 300 è¡Œçš„ Python è„šæœ¬å˜å¾—å®¹æ˜“ï¼Œè¿™ä¸ªè„šæœ¬ä¸“é—¨ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªæ¼‚äº®çš„å°â€œç”¨æˆ·åâ€&â€œå¯†ç â€æç¤º)*
2.  æˆ‘ä»¬å°†å‘Šè¯‰ Git å®‰è£…ç¨‹åºï¼ŒAWS CloudCommit ä¸Šæ‰˜ç®¡çš„ä»»ä½•å­˜å‚¨åº“éƒ½åº”è¯¥ä½¿ç”¨ AWS CLI æ¥æ–¹ä¾¿ç™»å½•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ï¼Œè€Œæ˜¯ç»§ç»­ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œå…¶ä»–æ“ä½œ
3.  æˆ‘ä»¬å°†æŠŠâ€œAWS CLIâ€å®‰è£…åˆ°æˆ‘ä»¬çš„è®¡ç®—æœºä¸Šï¼Œå¹¶å‘Šè¯‰ Git åœ¨æ‰§è¡Œå‘½ä»¤â€œ`aws`â€æ—¶å¦‚ä½•æ‰¾åˆ°å®ƒ

### [](#level-intermediate)ç­‰çº§:ä¸­çº§+çº§

è¿™é‡Œå¹¶æ²¡æœ‰æ¶µç›–æ‰€æœ‰å†…å®¹ã€‚æˆ‘å‡è®¾æ‚¨æœ‰ç‹¬ç«‹å®Œæˆä»¥ä¸‹å·¥ä½œçš„å¿…è¦ç»éªŒï¼Œå¹¶ä¸”æ‚¨æ‹¥æœ‰è®¡ç®—æœºçš„ç®¡ç†å‘˜æƒé™ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®‰è£…è½¯ä»¶:

1.  èˆ’é€‚åœ°ä½¿ç”¨å‘½ä»¤è¡Œ
2.  è®¾ç½® Git / SourceTreeï¼Œå¹¶åœ¨ç¡¬ç›˜ä¸Šçš„å­˜å‚¨åº“å’Œå¦ä¸€å°æœºå™¨ä¸Šçš„æ™®é€šâ€œè¿œç¨‹â€å­˜å‚¨åº“ä¹‹é—´å»ºç«‹å·¥ä½œå…³ç³»*(å½“è¿æ¥åˆ°â€œè¿œç¨‹â€æ—¶ï¼Œåªéœ€æŒ‰ç…§ Git æˆ– SourceTree çš„æç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç å³å¯)*
3.  ç¼–è¾‘æ‚¨çš„ Windowsâ€œè·¯å¾„â€ç¯å¢ƒå˜é‡
4.  åœ¨ä½ çš„ç”µè„‘ä¸Šå®‰è£… Pythonï¼Œå¹¶æ¼”ç¤ºä½ çš„ç”µè„‘èƒ½å¤Ÿæ‰§è¡Œ`print('Hello World')` *(å³ä½¿åªæ˜¯é€šè¿‡åƒ Spyder è¿™æ ·çš„ IDE)*
5.  åœ¨æ‚¨å®‰è£…/é…ç½®ä¸ºèƒ½å¤Ÿè¿è¡Œ`pip` *(ä¾‹å¦‚â€œAnaconda Promptâ€)*çš„ä»»ä½•å‘½ä»¤è¡Œç¯å¢ƒä¸­ï¼Œä½¿ç”¨`pip`å‘½ä»¤å®‰è£…æ‚¨å°šæœªå®‰è£…çš„ Python æ¨¡å—ï¼Œä½œä¸º Python å®‰è£…çš„ä¸€éƒ¨åˆ†

* * *

[![Screenshot of a web browser's URL bar](../Images/97bf6df1365232d2c3190f7be0eb4a00.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ZG2M64LC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://katiekodes.com/images/urlbar.png)

## [](#getting-the-url-for-your-repository)è·å–å­˜å‚¨åº“çš„ URL

1.  åªæœ‰â€œn . Virginiaâ€(â€œEast 1â€)æ˜¯æ‰€æœ‰ CodeCommit ç°åœ¨å±…ä½çš„åœ°æ–¹ã€‚æ‰€ä»¥æŸ¥çœ‹ä½ çš„çŸ¥è¯†åº“çš„ç½‘å€æ˜¯:[https://console.aws.amazon.com/codecommit/home?åœ°åŒº=ç¾å›½ä¸œéƒ¨-1](https://console.aws.amazon.com/codecommit/home?region=us-east-1)
2.  è™½ç„¶é¦–å…ˆï¼Œè¦ç™»å½•ï¼Œä½ å¯èƒ½å¿…é¡»å»:[https://SOME-SORT-OF-WEB-SITE-YOUR-COMPANY-GIVES-YOU.com](https://SOME-SORT-OF-WEB-SITE-YOUR-COMPANY-GIVES-YOU.com)
3.  åœ¨å·¦ä¾§å¯¼èˆªä¸­ï¼Œå±•å¼€â€œSourceâ€å¹¶ç‚¹å‡»â€œRepositoriesâ€[https://console . AWS . Amazon . com/code suite/code commit/Repositoriesï¼Ÿåœ°åŒº=ç¾å›½ä¸œéƒ¨-1](https://console.aws.amazon.com/codesuite/codecommit/repositories?region=us-east-1)
4.  æ‰¾åˆ°æ‚¨æœ‰æƒè®¿é—®çš„å­˜å‚¨åº“ï¼Œç„¶åå•å‡»å®ƒã€‚[https://console . AWS . Amazon . com/code suite/code commit/repositories/OUR _ AWESOME _ REPOSITORY/browseï¼Ÿåœ°åŒº=ç¾å›½ä¸œéƒ¨-1](https://console.aws.amazon.com/codesuite/codecommit/repositories/OUR_AWESOME_REPOSITORY/browse?region=us-east-1)
5.  æœ€å³è¾¹ï¼Œé è¿‘é¡µé¢é¡¶éƒ¨ï¼Œä½†ä¸åœ¨é¡¶éƒ¨å¯¼èˆªä¸­ï¼Œæœ‰ä¸€ä¸ªæŒ‰é’®å’Œä¸€ä¸ªä¸‹æ‹‰æ¡†ï¼Œä¸Šé¢å†™ç€â€œå…‹éš†ç½‘å€â€ä¸‹æ‹‰å¹¶é€‰æ‹©â€œè¿æ¥æ­¥éª¤â€[https://console . AWS . Amazon . com/code suite/code commit/repositories/OUR _ AWESOME _ REPOSITORY/connectï¼Ÿåœ°åŒº=ç¾å›½ä¸œéƒ¨-1](https://console.aws.amazon.com/codesuite/codecommit/repositories/OUR_AWESOME_REPOSITORY/connect?region=us-east-1)
6.  å¦‚æœä½ åœ¨è¯´æ˜çš„é¡¶éƒ¨çœ‹åˆ°ä¸€æ¡è­¦å‘Šï¼Œå¹¶æœ‰ä»¥ä¸‹æ–‡å­—ï¼Œé‚£ä¹ˆè¿™ç¯‡åšæ–‡å°±æ˜¯ä¸ºä½ å†™çš„ï¼ >æ‚¨ä½¿ç”¨è”åˆè®¿é—®æˆ–ä¸´æ—¶å‡­è¯ç™»å½•ã€‚è¿™äº›ç™»å½•ç±»å‹å”¯ä¸€æ”¯æŒçš„è¿æ¥æ–¹æ³•æ˜¯ä½¿ç”¨ AWS CLI é™„å¸¦çš„å‡­æ®ç®¡ç†å™¨ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚è¦é€šè¿‡ HTTPS ä½¿ç”¨ SSH æˆ– Git å‡­æ®é…ç½®è¿æ¥ï¼Œè¯·ä»¥ IAM ç”¨æˆ·èº«ä»½ç™»å½•ã€‚
7.  ä»ç„¶åº”è¯¥æœ‰ä¸€ä¸ªâ€œå…‹éš† URLâ€ä¸‹æ‹‰åˆ—è¡¨ï¼Œå®ƒä½äºé¡µé¢ä¸Šä¸ä¸Šä¸€é¡µç›¸åŒçš„åŒºåŸŸã€‚æ”¾ä¸‹å®ƒï¼Œé€‰æ‹©â€œå…‹éš† HTTPSâ€
8.  ä¸€ä¸ªç»¿è‰²çš„è­¦å‘Šæ åº”è¯¥å‡ºç°åœ¨é¡µé¢çš„é¡¶éƒ¨ï¼Œåœ¨é¡¶éƒ¨å¯¼èˆªçš„ä¸‹é¢è¯´: >å¤åˆ¶> >[https://git-code commit . us-east-1 . amazonaws . com/v1/repos/OUR _ AWESOME _ REPOSITORY](https://git-codecommit.us-east-1.amazonaws.com/v1/repos/OUR_AWESOME_REPOSITORY)
9.  å°†å­˜å‚¨åº“ URL æ”¾åœ¨æŸä¸ªåœ°æ–¹...ä½ ä»¥åä¼šéœ€è¦å®ƒçš„ã€‚

* * *

[![Git logo](../Images/bbd5800f4955b4a22dccd917fe203452.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--OjZAcybE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://git-scm.com/images/logos/downloads/Git-Logo-2Color.png)

## åœ¨ä½ çš„ç”µè„‘ä¸Šå®‰è£… Git & SourceTreeï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰çš„è¯

æµ‹è¯•æ‚¨çš„ Git è®¾ç½®æ˜¯å¦èƒ½ä¸æ‚¨è¿‡å»å·²ç»ä½¿ç”¨è¿‡çš„â€œæ™®é€šâ€è¿œç¨‹å­˜å‚¨åº“ä¸€èµ·å·¥ä½œã€‚

*   åœ¨ Git Bash å‘½ä»¤è¡Œç•Œé¢ä¸­ä½¿ç”¨â€œ`git fetch --all`â€ï¼Œç¡®ä¿æç¤ºæ‚¨è¾“å…¥å¯†ç ï¼Œç„¶åä¿å­˜
*   ç¼–è¾‘è‡ªè¿°æ–‡ä»¶æˆ–åšå®¢ä¸­çš„å¸–å­ï¼Œå°†æ›´æ”¹æ¨é€åˆ° SourceTreeï¼Œå¹¶ç¡®ä¿å®ƒä»¬ç”Ÿæ•ˆ

å¦‚æœè¿™äº›éƒ½ä¸ç®¡ç”¨ï¼Œå°±æŠŠå®ƒä»¬éƒ½è§£å†³æ‰ã€‚

* * *

[![Screenshot of a gitconfig file icon](../Images/2a59edf6cabb1550e8d65630286f4ff0.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--gYUqHePz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://katiekodes.com/images/gitconfig-fileicon.png)

## [](#edit-your-git-installations-global-gitconfig-file)ç¼–è¾‘ Git å®‰è£…çš„â€œå…¨å±€â€GitConfig æ–‡ä»¶

æ‚¨å°†éœ€è¦ç¼–è¾‘æ‚¨çš„â€œå…¨å±€â€GitConfig æ–‡ä»¶æ¥åŒ…å«è¿™äº›è¡Œ:

```
[credential]
    helper = 

[credential "https://github.com"]
    helper = 

[credential "https://bitbucket.org"]
    helper = 

[credential "https://git-codecommit.us-east-1.amazonaws.com"]
    helper = "!aws codecommit credential-helper "
    UseHttpPath = true 
```

æˆ‘çš„å‚¨å­˜åœ¨ **`C:\users\MY_USERNAME\`** æ–‡ä»¶å¤¹ä¸­ï¼Œæ˜¯ä¸€ä¸ªåä¸º **`.gitconfig`** çš„æ–‡ä»¶

**å†æ¬¡ç”¨â€œæ™®é€šâ€é¥æ§å™¨æµ‹è¯•ä½ çš„ git è®¾ç½®**ä»¥ç¡®ä¿ä½ æ²¡æœ‰ç ´åä»»ä½•ä¸œè¥¿ã€‚

*(å…³é—­&ä¿å­˜ GitConfig å†…å®¹åï¼Œæµ‹è¯•å‰é‡æ–°æ‰“å¼€ SourceTreeã€‚)*

å¦‚æœä½ ä¸æƒ³è®© Git Bash åœ¨ä½ æ¯æ¬¡åš`fetch`ã€`push`ã€`pull`ã€`clone`ç­‰åŠ¨ä½œæ—¶æç¤ºä½ è¾“å…¥å¯†ç ï¼Œä½ å¯ä»¥å¯¹ GitHub å’Œ BitBucket è¯´`helper = wincred`è€Œä¸æ˜¯`helper =`ã€‚

å¦‚æœä½ æ›¾ç»æ„è¯†åˆ°ä½ åæ‚”åœ¨ Windows å‡­è¯ç®¡ç†å™¨ä¸­å­˜å‚¨ç»™å®šå¸æˆ·çš„å¯†ç ï¼Œåªéœ€é”®å…¥ Windows å¯†é’¥ï¼Œå¼€å§‹æœç´¢"**ç®¡ç† windo...**ï¼Œã€ç‚¹å‡»æ§åˆ¶é¢æ¿ appã€‘**ç®¡ç† Windows å‡­è¯**æ‚¨å¯ä»¥æµè§ˆåˆ—è¡¨ï¼Œå¹¶æ ¹æ®ç»™å®šçš„å­˜å‚¨åº“åˆ é™¤æ‚¨çš„å‡­æ®ã€‚

* * *

[![Screenshot of an Admit One ticket](../Images/9a14f30543232c1638b39a377b63f9df.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--48-e8SrY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://katiekodes.com/images/admitone.png)

## [](#getting-an-hourly-token-from-aws)ä» AWS è·å–æ¯å°æ—¶ä»¤ç‰Œ

[è’‚å§†Â·æ²™åˆ©æ–‡åˆ›å»ºäº†ä¸€ä¸ªæ–¹ä¾¿çš„ Python è„šæœ¬](https://github.com/tjsullivan1/aws_saml_auth)ï¼Œå®ƒå¯ä»¥è®©ä½ ä» AWS è·å–ä¸€ä¸ªæ–°çš„å‡­è¯ï¼Œå¹¶å°†å…¶è½¬å‚¨åˆ°ç¡¬ç›˜ä¸Š AWS çš„â€œå‘½ä»¤è¡Œç•Œé¢â€å·¥å…·å¯»æ‰¾è¿™äº›ä¸œè¥¿çš„éƒ¨åˆ†ï¼Œç§°ä¸ºâ€œ **`aws_saml_auth.py`** â€

*(æ‚¨éœ€è¦ç¼–è¾‘ç¬¬ 34 è¡Œ`idpentryurl`çš„å€¼ï¼Œå› ä¸º GitHub ä¸Šçš„è„šæœ¬æ˜¯ä¸ºä»–å†™è„šæœ¬æ—¶çš„é›‡ä¸»é‡èº«å®šåˆ¶çš„ã€‚)*

æˆ‘æ²¡æœ‰å°†â€œPythonâ€æ·»åŠ åˆ°æˆ‘çš„è·¯å¾„ä¸­ï¼Œæ‰€ä»¥ç°åœ¨ä»å‘½ä»¤è¡Œè¿è¡Œç»™å®šçš„ Python è„šæœ¬çœ‹èµ·æ¥æœ‰ç‚¹è’è°¬:

```
c:\users\MY_USERNAME\AppData\Local\Continuum\anaconda3\python.exe c:\users\MY_USERNAME\Desktop\auth_saml\aws_saml_auth.py 
```

å¦‚æœæˆ‘å°† Python æ”¾å…¥æˆ‘çš„ Windowsâ€œPATHâ€ç¯å¢ƒå˜é‡ä¸­ï¼Œå¹¶åœ¨æˆ‘æ”¾å…¥â€œ`aws_saml_auth.py`â€çš„åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œæˆ‘å¯ä»¥ç®€å•åœ°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:

```
python aws_saml_auth.py 
```

å‡è®¾æˆ‘å®‰è£…çš„ Python å·²ç»å®‰è£…äº†â€œ`aws_saml_auth.py`â€æ‰€æŒ‡çš„æ‰€æœ‰æ¨¡å—*(æŸ¥æ‰¾`pip install` )* ï¼Œåœ¨å‘½ä»¤è¡Œç•Œé¢ä¸Šè¿è¡Œè¿™ä¸ªè„šæœ¬åº”è¯¥è¦æ±‚æˆ‘è¾“å…¥ç”¨æˆ·å&å¯†ç *(è¿™æ˜¯æˆ‘æ£€æŸ¥å·¥ä½œç”µå­é‚®ä»¶çš„å•ç‚¹ç™»å½•å‡­è¯...ç”¨æˆ·ååé¢å¸¦â€œ@ company name . comâ€)*ã€‚

å¦‚æœæˆ‘è¾“å…¥äº†æ­£ç¡®çš„å€¼ï¼Œæˆ‘ä¼šçœ‹åˆ°ä¸‹é¢çš„è¾“å‡ºï¼Œå‘Šè¯‰æˆ‘åœ¨æˆ‘çš„ç¡¬ç›˜ä¸Šçš„ **`C:\Users\MY_USERNAME\`** ä¸‹æœ‰ä¸€ä¸ªåä¸º **`.aws`** çš„æ–°æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªåä¸º **`credentials`** *(æ²¡æœ‰æ–‡ä»¶æ‰©å±•å)*çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„å†…å®¹å°†æœ‰åŠ©äºåœ¨ä¸‹ä¸€ä¸ªå°æ—¶*ç™»å½• Amazon(ä¹‹åï¼Œæˆ‘å¿…é¡»å†æ¬¡è¿è¡Œè¿™ä¸ª Python è„šæœ¬æ¥ä¸ºâ€œ`credentials`â€*:
ç”Ÿæˆæ–°å†…å®¹)

```
----------------------------------------------------------------
Your new access key pair has been stored in the AWS configuration file C:\Users\MY_USERNAME\.aws\credentials under the default profile.
Note that it will expire at 2019-02-20 19:35:01+00:00.
After this time, you may safely rerun this script to refresh your access key pair.
If you specified a credential other than default, to use this credential, call the AWS CLI with the --profile option (e.g. aws --profile default ec2 describe-instances).
---------------------------------------------------------------- 
```

è¯·æ³¨æ„ï¼Œç¬¬ 1 è¡Œå’Œç¬¬ 4 è¡Œä¸­æ˜¾ç¤ºäº†å•è¯â€œ`default`â€ï¼Œå› ä¸ºç¬¬ 87 è¡Œä¸­çš„â€œ`aws_saml_auth.py`â€å°±æ˜¯è¿™ä¹ˆè¯´çš„:ğŸ¤·â€â™€ï¸

```
profile: ("The name of the profile we want to put it the credential file", 'option', 'p')='default', 
```

æ‚¨éœ€è¦å¤§çº¦æ¯å°æ—¶è¿è¡Œä¸€æ¬¡è¿™ä¸ª Python è„šæœ¬ã€‚

å› æ­¤ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°å‘æ‚¨çš„å‘½ä»¤è¡Œç¯å¢ƒä¸­æ·»åŠ ä¸€ä¸ªåä¸ºâ€œ`awslogin`â€çš„å‘½ä»¤éå¸¸æ–¹ä¾¿ï¼Œåªè¦æ‚¨æ³¨æ„åˆ°â€œ`git fetch`â€ç­‰ï¼Œå°±å¯ä»¥å¿«æ·åœ°å¼¹å‡ºç”¨æˆ·å&å¯†ç æç¤ºã€‚ä¸æ”¯æŒä½¿ç”¨â€œè”åˆâ€ç™»å½•çš„ AWS æ‰˜ç®¡çš„å­˜å‚¨åº“ã€‚

æˆ‘çš„åŒäº‹å°†å…¶è®¾ç½®ä¸ºä¸€ä¸ªåä¸ºâ€œ`login`â€çš„å‘½ä»¤ï¼Œè¯¥å‘½ä»¤åªèƒ½åœ¨â€œGit Bashâ€å‘½ä»¤è¡Œç•Œé¢ä¸­å·¥ä½œï¼Œæ–¹æ³•æ˜¯è½¬åˆ°`C:\Program Files\Git\usr\bin\`å¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºâ€œ`login`â€*(æ— æ–‡ä»¶æ‰©å±•å)*çš„æ–°æ–‡ä»¶ï¼Œå…¶å†…å®¹ä¸º:

```
python /usr/bin/aws_saml_auth.py 
```

*(åœ¨ä»–çš„ä¾‹å­ä¸­ï¼Œä»–å°†`aws_saml_auth.py`ä¿å­˜åˆ°äº†`C:\Program Files\Git\usr\bin\`ï¼Œ`python`æ˜¯ä»–çš„ä¸€éƒ¨åˆ†ã€‚)*

* * *

[![CodeCommit](../Images/c8bfe893e63cabca92a04d742a4f328f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--2O6EG_M8--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://katiekodes.com/images/awscodecommitlogo.png)

## [](#installing-the-aws-cli-so-that-gits-attempt-to-execute-the-command-raw-aws-codecommit-credentialhelper-endraw-actually-works)å®‰è£… AWS CLIï¼Œè¿™æ · Git æ‰§è¡Œå‘½ä»¤â€œ`aws codecommit credential-helper`â€çš„å°è¯•å°±èƒ½æ­£å¸¸å·¥ä½œ

ç°åœ¨æˆ‘ä»¬éœ€è¦å®‰è£… AWS CLIï¼Œè¿™æ · Git æ‰§è¡Œå‘½ä»¤â€œ`aws codecommit credential-helper`â€çš„å°è¯•å°±å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚

å¦åˆ™ï¼ŒGit Bash / SourceTree å°†å¿ å®åœ°æŒ‰ç…§æˆ‘ä»¬çš„æŒ‡ç¤ºâ€œå¯¹ AWS CloudCommit remotes ä½¿ç”¨å‘½ä»¤'`aws`'è€Œä¸æ˜¯ç”¨æˆ·åå’Œå¯†ç â€ï¼Œç„¶åâ€œé€€å›åˆ°â€æç¤ºè¾“å…¥ç”¨æˆ·å&å¯†ç *(è¿™ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºäºšé©¬é€Šä¸å…è®¸â€œè”åˆâ€ç™»å½•)*ã€‚

è®©æˆ‘ä»¬[ä¸‹è½½ AWS CLI å®‰è£…ç¨‹åº](https://docs.aws.amazon.com/cli/latest/userguide/install-windows.html#install-msi-on-windows)ï¼Œå®‰è£…å®ƒï¼Œ[å°†`aws`æ·»åŠ åˆ°æˆ‘ä»¬çš„ PATH ç¯å¢ƒå˜é‡](https://docs.aws.amazon.com/cli/latest/userguide/install-windows.html#awscli-install-windows-path)ä¸­ã€‚

åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼ŒAWS CLI å®‰è£…ç¨‹åºä¸ºæˆ‘å¤„ç†äº† PATH ç¯å¢ƒå˜é‡:å®ƒå°†`C:\Program Files\Amazon\AWSCLI\bin\`æ·»åŠ åˆ°ç³»ç»ŸèŒƒå›´çš„è·¯å¾„ä¸­ã€‚

å¦‚æœæˆ‘æ‰“å¼€ä¸€ä¸ªæ ‡å‡†çš„ Windows å‘½ä»¤æç¤ºç¬¦ *(Windows é”®- >é”®å…¥â€œ`cmd`â€å¹¶æŒ‰å›è½¦é”®)*ï¼Œå¦‚æœæˆ‘é”®å…¥â€œ`aws --version`â€ï¼Œæˆ‘ä¼šå¾—åˆ°ä¸€ä¸ªå…³äºæˆ‘çš„è®¡ç®—æœºä¸Šå®‰è£…çš„ AWS CLI ç‰ˆæœ¬çš„ç­”æ¡ˆã€‚

ç„¶è€Œï¼Œé¥­æ¡¶ ***è¿˜æ˜¯*** ä¸å¤ªæ˜ç™½*åº”è¯¥æ˜¯ä»€ä¹ˆæ„æ€ã€‚*

 *æˆ‘å¯ä»¥çœ‹åˆ°æˆ‘æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå¦‚æœæˆ‘æ‰“å¼€â€œGit Bashâ€CLI å¹¶é”®å…¥â€œ`aws --version`â€ï¼Œæˆ‘ä¼šå¾—åˆ°â€œaws: command not foundâ€çš„æŠ±æ€¨ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªåä¸ºâ€œ**`aws`**â€*(æ²¡æœ‰æ–‡ä»¶æ‰©å±•å)*åˆ°`C:\Program Files\Git\bin`çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹ä¸º:

```
C:\Program Files\Amazon\AWSCLI\bin\aws.cmd 
```

*( [è°¢äº†ï¼Œæ ˆæº¢å‡º](https://stackoverflow.com/questions/53015630/bash-aws-command-not-found-on-windows-7-in-git-bash)ã€‚)*

æˆ‘æƒ³è¿™å°±æ˜¯å®ƒçªç„¶å¼€å§‹å·¥ä½œçš„åŸå› ã€‚

æˆ‘æœ‰ç‚¹ç´§å¼ æ˜¯ä¸æ˜¯è¿™æ ·ï¼Œå› ä¸ºç°åœ¨æˆ‘å·²ç»è®©å®ƒå·¥ä½œäº†ï¼Œå¦‚æœæˆ‘åˆ é™¤è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œ`aws --version`ä»ç„¶å¯ä»¥å·¥ä½œã€‚

æ— è®ºå¦‚ä½•ï¼Œåªè¦"`aws --version`"ä» Git Bash CLI å¼€å§‹å·¥ä½œï¼Œæˆ‘å°±å¯ä»¥å¼€å§‹äº†ï¼

1.  æˆ‘æœ‰åŠæ³•æ¯å°æ—¶ç»™`c:\users\MY_USERNAME\.aws\credentials`æ”¾ä¸€æ¬¡æ–°å†…å®¹
2.  æˆ‘å·²ç»å‘Šè¯‰ Gitï¼ŒAWS CloudCommit ä¸Šæ‰˜ç®¡çš„ä»»ä½•å­˜å‚¨åº“éƒ½ä½¿ç”¨ AWS CLI æ¥æ–¹ä¾¿ç™»å½•ï¼Œè€Œä¸æ˜¯ç”¨æˆ·åå’Œå¯†ç ï¼Œè€Œæ˜¯ç»§ç»­ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œå…¶ä»–ä»»ä½•æ“ä½œ
3.  æˆ‘å·²ç»åœ¨æˆ‘çš„ç”µè„‘ä¸Šå®‰è£…äº† AWS CLIï¼Œå¹¶å‘Šè¯‰ Git å¦‚ä½•æ‰¾åˆ°å®ƒ

* * *

[![Photo of a clock](../Images/ae3418d6cde41b77b9b575fc9c4df67b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--IB_nO2bi--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://katiekodes.com/images/goldclock.jpg)

## [](#detecting-and-fixing-expired-credentials)æ£€æµ‹å¹¶ä¿®å¤è¿‡æœŸå‡­è¯

ä¸å¹¸çš„æ˜¯ï¼Œè®¾ç½®å¥½è¿™ä¸€åˆ‡å¹¶å†™åšå®¢éœ€è¦èŠ±è´¹å¤§é‡çš„æ•…éšœæ’é™¤æ—¶é—´ï¼Œæˆ‘åœ¨ Amazon çš„ 1 å°æ—¶å‡­è¯è¿‡æœŸäº†ï¼Œæ‰€ä»¥æˆ‘å¯èƒ½éœ€è¦å†æ¬¡ä»å‘½ä»¤è¡Œè¿è¡Œâ€œ`aws_saml_auth.py`â€ï¼Œå¹¶ç”¨ä¸€ä¸ªæ–°çš„ä»¤ç‰Œæ›´æ–°`c:\users\MY_USERNAME\.aws\credentials`çš„å†…å®¹ã€‚

å½“åœ¨ Git Bash CLI ä¸­å¯¹æˆ‘ä¹‹å‰ä¸ºä¹‹åŠªåŠ›çš„ repo æ‰§è¡Œ`git fetch --all`æ—¶ï¼Œè¿‡æœŸçš„å‡­è¯çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:

```
MY_USERNAME@MY_COMPUTER_ID MINGW64 ~/Desktop/aws_test3/test_repo_3 (master)
$ git fetch --all
Fetching origin
fatal: unable to access 'https://git-codecommit.us-east-1.amazonaws.com/v1/repos/OUR_AWESOME_REPOSITORY/': The requested URL returned error: 403
error: Could not fetch origin 
```

åœ¨ SourceTree ä¸­ï¼Œå³é”®å•å‡»å·¦ä¾§å¯¼èˆªä¸­â€œRemotesâ€ä¸‹çš„â€œorigin â€,ç„¶åå•å‡»â€œFetch from origin â€,å‡ºç°ä»¥ä¸‹é”™è¯¯:

```
git -c diff.mnemonicprefix=false -c core.quotepath=false fetch origin
fatal: unable to access 'https://git-codecommit.us-east-1.amazonaws.com/v1/repos/OUR_AWESOME_REPOSITORY/': The requested URL returned error: 403
Completed with errors, see above. 
```

Git Bash ä¸­ä¸€æ¬¡æˆåŠŸçš„è·å–çœ‹èµ·æ¥åƒè¿™æ ·:

```
MY_USERNAME@MY_COMPUTER_ID MINGW64 ~/Desktop/aws_test3/test_repo_3 (master)
$ git fetch --all
Fetching origin

MY_USERNAME@MY_COMPUTER_ID MINGW64 ~/Desktop/aws_test3/test_repo_3 (master) 
```

åœ¨ SourceTree ä¸­ï¼Œè¿›åº¦æ¡æ¶ˆå¤±äº†ï¼Œé™¤éä½ é€‰æ‹©äº†â€œæ˜¾ç¤ºå…¨éƒ¨è¾“å‡ºâ€ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾“å‡ºçœ‹èµ·æ¥åƒè¿™æ ·:

```
git -c diff.mnemonicprefix=false -c core.quotepath=false fetch origin
Completed successfully. 
```

* * *

[![Git logo](../Images/bbd5800f4955b4a22dccd917fe203452.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--OjZAcybE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://git-scm.com/images/logos/downloads/Git-Logo-2Color.png)

## [](#running-your-first-working-raw-git-endraw-command-against-aws)é’ˆå¯¹ AWS è¿è¡Œæ‚¨çš„ç¬¬ä¸€ä¸ªå·¥ä½œ`git`å‘½ä»¤

å½“ç„¶ï¼Œæˆ‘è®¤ä¸ºä½ ä¼šåšä¸€ä¸ªâ€œ`git fetch`â€æœ‰ç‚¹å†’æ˜§â€”â€”è¿™æ„å‘³ç€ä½ ä¸€å¼€å§‹å°±æœ‰ä¸€ä¸ªè¿œç¨‹-æœ¬åœ°é…å¯¹ã€‚:-)

è¿˜è®°å¾—æˆ‘ä»¬ä¸€å¼€å§‹ä»äºšé©¬é€Šå¾—åˆ°çš„é‚£ä¸ªç½‘å€å—ï¼Ÿ

```
https://git-codecommit.us-east-1.amazonaws.com/v1/repos/OUR_AWESOME_REPOSITORY 
```

è®©æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„è®¡ç®—æœºä¸Šè®¾ç½®ä¸¤ä¸ªæœ¬åœ°å­˜å‚¨åº“ï¼Œæ¯ä¸ªéƒ½å°†å…¶ä½œä¸ºâ€œè¿œç¨‹â€ä½¿ç”¨â€”â€”ä¸€ä¸ªä½¿ç”¨â€œg it Bashâ€CLI*(æˆ–è€…ä½¿ç”¨æˆ‘ä»¬çš„ Windows CLIï¼Œå¦‚æœæˆ‘ä»¬åœ¨å®‰è£… Git æ—¶è®¾ç½®å®ƒèƒ½å¤Ÿæ‰§è¡Œâ€œGitâ€å‘½ä»¤)*ï¼Œå¦ä¸€ä¸ªä½¿ç”¨ SourceTreeã€‚

### [](#clone-with-git-bash)ç”¨ Git Bash å…‹éš†

1.  åœ¨ç¡¬ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ï¼Œ`c:\example\`
2.  åœ¨ Git Bash å‘½ä»¤æç¤ºç¬¦ä¸‹æ‰§è¡Œ`cd c:\example`
3.  åš`git clone https://git-codecommit.us-east-1.amazonaws.com/v1/repos/OUR_AWESOME_REPOSITORY aws_test_1`

è¾“å‡ºåº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œå¹¶ä¸”æ‚¨çš„è®¡ç®—æœºä¸Šåº”è¯¥æœ‰ä¸€ä¸ªæ–°çš„`c:\example\aws_test_1\`æ–‡ä»¶å¤¹ã€‚é‡Œé¢åº”è¯¥æœ‰æ–‡ä»¶ï¼Œå¦‚æœé¥æ§å™¨é‡Œæœ‰æ–‡ä»¶çš„è¯ã€‚

```
MY_USERNAME@MY_COMPUTER_ID MINGW64 /c/example
$ git clone https://git-codecommit.us-east-1.amazonaws.com/v1/repos/OUR_AWESOME_REPOSITORY aws_test_1
Cloning into 'aws_test_1'...
remote: Counting objects: 3, done.
Unpacking objects: 100% (3/3), done. 
```

### [](#clone-with-sourcetree)ç”¨ SourceTree å…‹éš†

1.  å•å‡»é¡¶éƒ¨é™„è¿‘æ‰“å¼€çš„å­˜å‚¨åº“é€‰é¡¹å¡æ—è¾¹çš„â€œ+â€ï¼Œåœ¨â€œæœ¬åœ°å­˜å‚¨åº“â€å±å¹•é¡¶éƒ¨é™„è¿‘çš„å¤§æŒ‰é’®ä¸­ï¼Œå•å‡»å¸¦æœ‰å›¾æ ‡çš„â€œå…‹éš†â€æŒ‰é’®ï¼Œè¯¥å›¾æ ‡çœ‹èµ·æ¥åƒæŒ‡å‘æ‰“å¼€çš„æ¡†çš„ç®­å¤´ã€‚
2.  åœ¨â€œæºè·¯å¾„/ URLâ€ä¸­ï¼Œé”®å…¥:`https://git-codecommit.us-east-1.amazonaws.com/v1/repos/OUR_AWESOME_REPOSITORY`
3.  åœ¨â€œç›®æ ‡è·¯å¾„â€ä¸­ï¼Œé”®å…¥:`C:\example\aws_test_2`
4.  åœ¨â€œåç§°â€ä¸­ï¼Œé”®å…¥:`Best AWS Test 2`
5.  å•å‡»â€œå…‹éš†â€æŒ‰é’®

å¦‚æœä½ æ²¡æœ‰é€‰ä¸­è¿›åº¦æ¡çš„â€œæ˜¾ç¤ºå…¨éƒ¨è¾“å‡ºâ€å¤é€‰æ¡†ï¼Œå®ƒå¯èƒ½ä¼šåœ¨å®Œæˆåæ¶ˆå¤±ã€‚ä½†æ˜¯å¦‚æœä½ è¿™æ ·åšäº†ï¼Œå®ƒçš„æ—¥å¿—çœ‹èµ·æ¥ä¼šåƒè¿™æ ·:

```
git -c filter.lfs.smudge= -c filter.lfs.required=false -c diff.mnemonicprefix=false -c core.quotepath=false clone --branch master https://git-codecommit.us-east-1.amazonaws.com/v1/repos/OUR_AWESOME_REPOSITORY C:\example\aws_test_2
Cloning into 'C:\example\aws_test_2'...
warning: templates not found in C:\Program Files\Git\share\git-core\templates

remote: 
remote: Counting objects: 0
remote: Counting objects: 3
remote: Counting objects: 3
remote: Counting objects: 3, done.        
Completed successfully. 
```

åœ¨å·¦ä¾§å¯¼èˆªä¸­ï¼Œå¦‚æœæ‚¨å•å‡»â€œBranchesâ€å¹¶å•å‡»â€œmasterâ€*(æˆ–è€…æ‚¨çš„åˆ†æ”¯è¢«ç§°ä¸ºä»€ä¹ˆ)*ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿä»å­˜å‚¨åº“çš„è¿œç¨‹å‰¯æœ¬*(å³ AWS)* ä¸­çœ‹åˆ°å®Œæ•´çš„æäº¤æ—¥å¿—å†å²ï¼Œå‡è®¾æœ‰ä»»ä½•å†å²ã€‚

ä½ çš„ç”µè„‘ä¸Šåº”è¯¥æœ‰ä¸€ä¸ªæ–°çš„`c:\example\aws_test_2\`æ–‡ä»¶å¤¹ã€‚é‡Œé¢åº”è¯¥æœ‰æ–‡ä»¶ï¼Œå¦‚æœé¥æ§å™¨é‡Œæœ‰æ–‡ä»¶çš„è¯ã€‚

æ­å–œï¼Œä½ è¢«å½•å–äº†ï¼

å¿«ä¹å»å§ï¼

* * *

[![Stack of books](../Images/b4dd9474a544156607411eaad6a8c524.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--SA6zo9hj--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Book_sale_loot_%25284552277923%2529.jpg/800px-Book_sale_loot_%25284552277923%2529.jpg)

## [](#further-resources)è¿›ä¸€æ­¥èµ„æº

*   ä½¿ç”¨ CodeCommit å’Œ GitHub å‡­è¯åŠ©æ‰‹*