# ä½¿ç”¨ååº”æµ‹è¯•åº“è¿›è¡Œæµ‹è¯•

> åŸæ–‡:[https://dev . to/Chris wcs/testing-with-react-testing-library-42l 8](https://dev.to/chriswcs/testing-with-react-testing-library-42l8)

### [](#the-philosophy-of-reacttestinglibrary)ååº”-æµ‹è¯•-åº“çš„å“²å­¦

"ä½ çš„æµ‹è¯•è¶Šåƒä½ çš„è½¯ä»¶è¢«ä½¿ç”¨çš„æ–¹å¼ï¼Œå®ƒä»¬å°±èƒ½ç»™ä½ è¶Šå¤šçš„ä¿¡å¿ƒ."-è‚¯ç‰¹Â·cÂ·å¤šå…¹

è¿™æ˜¯[ååº”-æµ‹è¯•-åº“](https://github.com/kentcdodds/react-testing-library)ä¸­çš„æŒ‡å¯¼åŸåˆ™ã€‚è¯¥åº“å¸®åŠ©æ‚¨ç¼–å†™æµ‹è¯•ï¼Œè¿™äº›æµ‹è¯•ä»¥ç”¨æˆ·ä¸ç»„ä»¶äº¤äº’çš„æ–¹å¼ä¸ç»„ä»¶è¿›è¡Œäº¤äº’ã€‚è¯¥åº“è¿˜ä¾§é‡äºæµ‹è¯•ï¼Œè€Œæ²¡æœ‰æµ‹è¯•å®ç°ç»†èŠ‚ã€‚æˆ‘å°†åœ¨æœ¬æ–‡ä¸­æ¢è®¨è¿™äº›æƒ³æ³•ï¼Œå¹¶å¸Œæœ›è¯´æœæ‚¨å°è¯•ä¸€ä¸‹è¿™ä¸ªç¥å¥‡çš„åº“ã€‚éå¸¸æ„Ÿè°¢ Kent C. Dodds å’Œæ‰€æœ‰å…¶ä»–è´¡çŒ®è€…æä¾›äº†è¿™ä¸ªä¼Ÿå¤§çš„è½¯ä»¶ã€‚

### [](#basics)åŸºç¡€çŸ¥è¯†

å½“æˆ‘åœ¨ä¸‹é¢å±•ç¤ºä¸€äº›ä¾‹å­æ—¶ï¼Œè¯·æ³¨æ„æˆ‘ä½¿ç”¨ Jest ä½œä¸ºæˆ‘çš„æµ‹è¯•ç¨‹åºã€‚react-testing-library æ˜¯ä¸€ä¸ªæµ‹è¯• react ç»„ä»¶çš„å·¥å…·ã€‚å®ƒä¸æ˜¯ Jest æˆ– Jest ç­‰å…¶ä»–å·¥å…·çš„æ›¿ä»£å“ã€‚

æˆ‘å°†é¦–å…ˆå‘ˆç°æˆ‘çš„ç»„ä»¶ã€‚å½“ç„¶ï¼Œæˆ‘å°†ä½¿ç”¨æ¸²æŸ“å‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ğŸ˜ï¼Œä» react-testing-library å¯¼å…¥ã€‚ç„¶åä» render è¿”å›æœ‰ç”¨çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ä»¥ç”¨æ¥æµ‹è¯•æˆ‘ä»¬çš„ç»„ä»¶ã€‚ç»„ä»¶æ˜¯å®Œå…¨æ¸²æŸ“çš„(ä¸æ˜¯æµ…æ¸²æŸ“çš„),å› æ­¤ä¸€åˆ‡éƒ½å¯ä»¥äº¤äº’ã€‚

```
import React from 'react'
import { render, fireEvent } from 'react-testing-library'
import Counter from './Counter'

it("starts at 0 and it is incremented to 1", () => {
    // Render takes a component (props can be passed in as well
    // I am going to use getByTestId to access elements
    const { getByTestId } = render(<Counter />)

    // getByTestId will match elements by the attribute data-testid="count"
    // here I saved two elements in their respective variables
    const count = getByTestId('count')
    const plusButton = getByTestId('plus')

    // I can check properties on the element
    // I want to make sure the tag is showing the  count to be at 0 to begin
    expect(count.textContent).toBe('0')

    // fireEvent is a function that we imported from the library
    // it allows us to click on the button the way the user would.
    // I simply access the click function on it and pass a element for it to click
    fireEvent.click(plusButton)

    // Asserting that it now is now 1
    expect(count.textContent).toBe('1')
}) 
```

æˆ‘æµ‹è¯•çš„ç»„ä»¶å¦‚ä¸‹ã€‚é™¤äº†æ”¾ç½® data-testid å±æ€§ï¼Œæˆ‘æ²¡æœ‰æµ‹è¯•å®ç°ã€‚åœ¨æœ¬æ–‡çš„åé¢ï¼Œæˆ‘å°†å±•ç¤ºè®¿é—®å…ƒç´ çš„å…¶ä»–æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¸éœ€è¦å°† data-testid å±æ€§æ”¾åœ¨ã€‚

```
import React from 'react'

class Counter extends React.Component {
    state = {
        count: 0
    }

    increment = () => {
        this.setState(x => ({
            count: x.count + 1
        }))
    }

    render(){
        return (
            <div>
                <h1 data-testid="count">{this.state.count}</h1>
                <button data-testid="plus" onClick={this.increment}>+</button>
            </div>
        )
    }
} 
```

ä¸‹é¢æˆ‘ç”¨é’©å­é‡æ„äº†åŒä¸€ä¸ªç»„ä»¶ï¼Œä¸Šé¢çš„æµ‹è¯•æ²¡æœ‰å¤±è´¥ã€‚è¿™æ˜¯éå¸¸ä»¤äººæ»¡æ„çš„ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨å…¶ä»– react æµ‹è¯•å·¥å…·æ—¶å¯èƒ½å¾ˆéš¾å®ç°ã€‚

```
const Counter = () => {
    const [count, setCount] = React.useState(0)
    const increment = () => {
        setCount(count + 1)
    }

    return (
        <div>
            <h1 data-testid="count">{count}</h1>
            <button data-testid="plus" onClick={increment}>+</button>
        </div>
    )
} 
```

### [](#more-in-depth-example)æ›´æ·±å…¥çš„ä¾‹å­

ä¸‹é¢çš„ä¾‹å­æœ‰ä¸€äº›æˆ‘è¿˜æ²¡æœ‰å±•ç¤ºçš„æ–°ä¸œè¥¿ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨ getByPlaceholderText å’Œ getByLabelText æ¥å±•ç¤ºå¦‚ä½•åœ¨ä¸éœ€è¦æ”¾ç½® data-testid çš„æƒ…å†µä¸‹è®¿é—®å…ƒç´ ã€‚æˆ‘è¿˜ä½¿ç”¨ fireEvent.change æŒ‰ç…§ç”¨æˆ·çš„æ–¹å¼åœ¨è¾“å…¥ä¸­æ”¾ç½®ä¸€ä¸ªæ–°å€¼ã€‚

```
import React from 'react'
import { render, fireEvent } from 'react-testing-library'
import Problem from './Problem'

it("has two inputs that I can change to see if it works", () => {
    // Arrange
    const { getByTestId, getByPlaceholderText, getByLabelText } = render(<Problem total={30}/>)
    const checkResult = getByTestId('check')
    // The getByPlaceholderText work as you would expect, the input can be found
    // via the value of the PlaceholderText attribute
    const input_one = getByPlaceholderText('Place the first number here!')
    // The getByLabelText grabs the input by the label
    const input_two = getByLabelText('Number 2')
    const result = getByTestId('result')

    // Act
    fireEvent.change(input_one, { target: { value: 10 } })
    fireEvent.change(input_two, { target: { value: 20 } })
    fireEvent.click(checkResult)

    // Asserting that it was correct
    expect(result.textContent).toBe('Good')
}) 
```

ä¸‹é¢æ˜¯ç»„ä»¶ã€‚æˆ‘ç”¨é’©å­æ˜¯å› ä¸ºæˆ‘å–œæ¬¢é’©å­ï¼æŸ¥çœ‹[é’©å­æ–‡æ¡£](https://reactjs.org/docs/hooks-intro.html)ä»¥è·å¾—æ›´å¤šå…³äºä½¿ç”¨å®ƒä»¬çš„ä¿¡æ¯ã€‚

```
import React from 'react'

export default ({ total }) => {
    const [input1, setInput1] = React.useState(0)
    const [input2, setInput2] = React.useState(0)
    const [status, setStatus] = React.useState(false)

    const update1 = e => setInput1(Number(e.target.value))
    const update2 = e => setInput2(Number(e.target.value))

    const checkAnswer = () => setStatus(input1 + input2 === total)

    return(
        <div>
            <label>Number 1
                <input type="Number" 
                       value={input1} 
                       placeholder='Place the first number here!'
                       onChange={update1}/>
            </label>
            <h2>+</h2>
            <label>Number 2
                <input type="Number" 
                       value={input2}
                       onChange={update2}/>
            </label>
            <h2>=</h2>
            <h2>total</h2>
            <button data-testid="check" onClick={checkAnswer}>Check Answer</button>
            <h2 data-testid="result">{status ? 'Good' : 'Wrong'}</h2>
        </div>
    )
} 
```

å¦‚æœæ‚¨æœ‰å¤šä¸ªæµ‹è¯•ï¼Œä» react-testing-library å¯¼å…¥ä¸€ä¸ªåä¸º cleanup çš„å‡½æ•°æ˜¯å¾ˆé‡è¦çš„ã€‚è¿™å°†åˆ é™¤æµ‹è¯•ä¹‹é—´çš„ç»„ä»¶ï¼Œä¸ºä¸‹ä¸€æ¬¡æ¸²æŸ“åšå‡†å¤‡ã€‚

```
import { render, cleanup} from 'react-testing-library'

afterEach(cleanup) 
```

å¦‚æœæ‚¨åœ¨ react ç»„ä»¶ä¸­ä½¿ç”¨é’©å­ï¼Œè¯·æŸ¥é˜…æ–‡æ¡£ï¼Œäº†è§£ä½•æ—¶å¯èƒ½éœ€è¦ä¸€äº›ç‰¹æ®Šçš„è®¾ç½®(ç”±äº useEffect çš„å¼‚æ­¥ç‰¹æ€§)ã€‚

### [](#conclusion)ç»“è®º

æŸ¥çœ‹ [react-testing-library æ–‡æ¡£](https://github.com/kentcdodds/react-testing-library)äº†è§£æ›´å¤šä¿¡æ¯ã€‚æˆ‘å·²ç»å¼ è´´åœ¨ä¸‹é¢çš„é¡¹ç›®ï¼Œä½ å¯ä»¥æ‰¾åˆ°æˆ‘çš„ä¾‹å­ã€‚æˆ‘é¼“åŠ±æ¯ä¸ªäººåœ¨ä½ çš„ä¸‹ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ react-testing-libraryã€‚æ„Ÿè°¢æ‚¨æŠ½å‡ºæ—¶é—´é˜…è¯»ã€‚

## ![GitHub logo](../Images/a73f630113876d78cff79f59c2125b24.png)[ChrisWcs](https://github.com/ChrisWcs)/[RTLâ€”â€”ä¸¾ä¾‹](https://github.com/ChrisWcs/rtl-example)

### ååº”-æµ‹è¯•-åº“ç¤ºä¾‹

<article class="markdown-body entry-content container-lg" itemprop="text">

# è¿™ä¸ªé¡¹ç›®åŒ…å«ä½¿ç”¨ react-testing-library çš„æµ‹è¯•ç¤ºä¾‹

### ä½¿ç”¨`npm test`è¿è¡Œç¤ºä¾‹ã€‚

</article>

[View on GitHub](https://github.com/ChrisWcs/rtl-example)