# é€šçŸ¥ API ç®€ä»‹

> åŸæ–‡:[https://dev . to/ruhe ni/introduction-to-the-notification-API-4687](https://dev.to/ruheni/introduction-to-the-notification-api-4687)

é€šçŸ¥ API ä½¿ç½‘ç«™èƒ½å¤Ÿåœ¨ç”¨æˆ·æµè§ˆå™¨ä¹‹å¤–å‘é€é€šçŸ¥ï¼Œå¦‚ç³»ç»Ÿé€šçŸ¥ã€‚è¿™å…è®¸ç½‘ç«™æˆ– webapp åœ¨åå°å‘ç”¨æˆ·å‘é€ä¿¡æ¯ã€‚

æˆ‘ä»¬å°†æµè§ˆä¸€ä¸‹å¦‚ä½•è®¾ç½®å’Œå¼€å§‹ä½¿ç”¨è¿™ä¸ª API çš„åŸºç¡€çŸ¥è¯†ã€‚

è¿™ç¯‡æ–‡ç« æ˜¯å¯¹åˆå­¦è€…å‹å¥½çš„ï¼Œåªæœ‰åŸºæœ¬çš„ç¼–ç¨‹çŸ¥è¯†å°±è¶³å¤Ÿäº†ã€‚

# [](#step-one-checking-current-permission-status)ç¬¬ä¸€æ­¥:æ£€æŸ¥å½“å‰æƒé™çŠ¶æ€ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ Notification.permission åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸Šæ£€æŸ¥æƒé™çš„çŠ¶æ€ã€‚å®ƒæœ‰ä¸‰ä¸ªå¯èƒ½çš„å€¼:â€œé»˜è®¤â€ã€â€œæ‹’ç»â€å’Œâ€œæˆäºˆâ€ã€‚

```
Notification.permission 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#step-two-granting-permission)ç¬¬äºŒæ­¥:æˆäºˆæƒé™ã€‚

å¦‚æœç½‘ç«™æˆ– webapp æœªè¢«æˆäºˆå¼€å§‹æ˜¾ç¤ºé€šçŸ¥çš„æƒé™

```
Notification.requestPermission().then(function(res) {
  console.log(res);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#step-three-create-new-notification)ç¬¬ä¸‰æ­¥:æ–°å»ºé€šçŸ¥ã€‚

ä¸€æ—¦æˆäºˆç”¨æˆ·æƒé™ï¼Œæ‚¨å°±å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„é€šçŸ¥ï¼Œå¹¶å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ é€’åˆ°ä¸€ä¸ª`Notification`æ„é€ å‡½æ•°ä¸­ï¼Œå³

```
let notification = new Notification('Hello there'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“äº†å¦‚ä½•å‘ç”¨æˆ·è¯·æ±‚æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥ç¨å¾®æ¸…ç†ä¸€ä¸‹ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåä¸º`notifyMe()`çš„å‡½æ•°ï¼Œå®ƒå°†åŒ…å«æ£€æŸ¥æƒé™çš„ä»£ç ï¼Œå¹¶ä»ç½‘ç«™æˆ– web åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚

```
function notifyMe() {
    let img = 'https://img.icons8.com/color/48/000000/task.png';

    // check for browser support
    if (!('Notification' in window)) {
        alert('This browser does not support system notifications.');
    }
    // check whether notification permissions have already been granted
    else if (Notification.permission === 'granted') {
        // if ok, create notification
        let text = `Hey there, pick up groceries is now overdue`;

        let notification = new Notification('To Do list', {
            body: text,
            icon: img
        });
    }
    // otherwise, ask user for permission
    else if (
        Notification.permission === 'denied' ||
        Notification.permission === 'default'
    ) {
        Notification.requestPermission(permission => {
            // if user accepts, let's create notification
            if (permission === 'granted') {
                let notification = new Notification('To Do list', {
                    body: text,
                    icon: img
                });
            }
        });
    }
}

// call the function
notifyMe(); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œ`Notification`æ„é€ å‡½æ•°èƒ½å¤Ÿæ¥å—ç¬¬äºŒä¸ªå‚æ•°`options`ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å«ç»†èŠ‚çš„å¯¹è±¡ï¼Œæ¯”å¦‚åœ¨é€šçŸ¥æ­£æ–‡ä¸­ä½¿ç”¨çš„å›¾æ ‡å’Œæ–‡æœ¬ï¼Œä»¥å¢å¼ºå†…å®¹ã€‚

ä½¿ç”¨çš„å›¾åƒæ˜¯ä¸€ä¸ªå‰ªè´´æ¿æ¥è¡¨ç¤ºç»™å®šçš„ä»»åŠ¡ã€‚ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹

ä¸‹é¢æ˜¯ Github repo çš„é“¾æ¥ï¼ŒåŒ…å«æœ¬æ–‡ä¸­ä½¿ç”¨çš„ä»£ç :

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png) [é²èµ«å°¼](https://github.com/ruheni) / [æ²™ç›’](https://github.com/ruheni/sandbox)

### è¿™ä¸ªå­˜å‚¨åº“åŒ…å«ç”¨äºå­¦ä¹ å„ç§ç¼–ç¨‹æ¦‚å¿µçš„æ–‡ä»¶

<article class="markdown-body entry-content container-lg" itemprop="text">

# æ²™ç®±

è¿™ä¸ªåº“åŒ…å«ç”¨äºå­¦ä¹ æˆ‘æ­£åœ¨å­¦ä¹ çš„å„ç§ç¼–ç¨‹è¯­è¨€ä¸­çš„å„ç§ç¼–ç¨‹æ¦‚å¿µçš„æ–‡ä»¶

**é¡¹ç›®**

[**1ã€‚**é€šæŠ¥](https://github.com/ruheni/sandbox/tree/master/notification)

åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘æ¢ç´¢äº†ç”¨äºè¯·æ±‚ç”¨æˆ·è®¸å¯å¹¶ä» web åº”ç”¨ç¨‹åºæˆ–ç½‘ç«™å‘ç”¨æˆ·å‘é€é€šçŸ¥çš„`Notification`æµè§ˆå™¨ APIã€‚å®ƒä»¬åœ¨åå°å‘ç”¨æˆ·å‘é€é€šçŸ¥ã€‚ä¸ä½¿ç”¨å¤–éƒ¨ API å‘ç”¨æˆ·å‘é€é€šçŸ¥ã€‚

[**2ã€‚Web-Components**](https://github.com/ruheni/sandbox/tree/master/web-components)

æˆ‘æ¢ç´¢äº†å¦‚ä½•åœ¨ JavaScript ä¸­åˆ¶ä½œ`custom HTML elements`,å¦‚ä½•ä½¿ç”¨`Shadow DOM`,ä»¥åŠå¦‚ä½•ä½¿ç”¨ç±»æ¥å£°æ˜å…ƒç´ å¹¶å¯¼å‡ºå®ƒä»¬ä»¥å‘ˆç°åœ¨ HTML é¡µé¢ä¸Šã€‚`news-article.js`æ˜¯åŒ…å«åœ¨`index.js`æ–‡ä»¶ä¸­åˆ›å»ºå’Œä½¿ç”¨çš„`custom HTML element`çš„æ–‡ä»¶ï¼Œæœ€ç»ˆè§£æ JSON å¹¶åœ¨`index.html`ä¸Šå‘ˆç°å®ƒä»¬ã€‚

[**3ã€‚æµ‹è¯•**T3ã€‘](https://github.com/ruheni/sandbox/tree/master/testing)

`Mocha`ç”¨äºåœ¨ JavaScript ä¸­ç¼–å†™å’Œè¿è¡Œ`unit tests`ã€‚æˆ‘ç”¨å®ƒæ¥å­¦ä¹ å¦‚ä½•å†™æµ‹è¯•â€¦

</article>

[View on GitHub](https://github.com/ruheni/sandbox)

*è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æŠ€æœ¯æ–‡ç« ï¼Œå¦‚æœä½ å¯¹å¦‚ä½•æé«˜æˆ‘çš„å†™ä½œæœ‰ä»»ä½•å»ºè®®ï¼Œæˆ–è€…ä½ å¸Œæœ›æˆ‘å†™ä»€ä¹ˆæ ·çš„å†…å®¹ï¼Œè¯·éšæ—¶ç›´æ¥ç»™æˆ‘å‘æ¶ˆæ¯*ğŸ™‚ ğŸ™ƒ