# è½»æ¾æŠ“å–å•é¡µåº”ç”¨ç¨‹åºã€‚

> åŸæ–‡ï¼š<https://dev.to/scrapingbee/scraping-single-page-applications-with-ease-d8o>

å¤„ç†ä¸€ä¸ªä½¿ç”¨å¤§é‡ Javascript æ¥å‘ˆç°å†…å®¹çš„ç½‘ç«™å¯èƒ½ä¼šå¾ˆæ£˜æ‰‹ã€‚å¦‚ä»Šï¼Œè¶Šæ¥è¶Šå¤šçš„ç½‘ç«™ä½¿ç”¨ Angularï¼ŒReactï¼ŒVue.js è¿™æ ·çš„æ¡†æ¶ä½œä¸ºä»–ä»¬çš„å‰ç«¯ã€‚

è¿™äº›å‰ç«¯æ¡†æ¶å¤„ç†èµ·æ¥å¾ˆå¤æ‚ï¼Œå› ä¸ºç»å¸¸ä½¿ç”¨ HTML5 API çš„æœ€æ–°ç‰¹æ€§ã€‚

æ‰€ä»¥åŸºæœ¬ä¸Šä½ ä¼šé‡åˆ°çš„é—®é¢˜æ˜¯ï¼Œä½ çš„æ— å¤´æµè§ˆå™¨ä¼šä¸‹è½½ HTML ä»£ç ï¼Œå’Œ Javascript ä»£ç ï¼Œä½†ä¸èƒ½æ‰§è¡Œå®Œæ•´çš„ Javascript ä»£ç ï¼Œç½‘é¡µä¸ä¼šå®Œå…¨å‘ˆç°ã€‚

è¿™äº›é—®é¢˜æœ‰ä¸€äº›è§£å†³æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨æ›´å¥½çš„æ— å¤´æµè§ˆå™¨ã€‚ç¬¬äºŒä¸ªæ˜¯æ£€æŸ¥ Javascript å‰ç«¯å‘å‡ºçš„ API è°ƒç”¨å¹¶å†ç°å®ƒä»¬ã€‚

æ”¶é›†è¿™äº› spa å¯èƒ½å¾ˆæœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºé€šå¸¸æ¶‰åŠåˆ°å¤§é‡çš„ Ajax è°ƒç”¨å’Œ Websockets è¿æ¥ã€‚å¦‚æœæ€§èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œæ‚¨åº”è¯¥æ€»æ˜¯å°è¯•å†ç° Javascript ä»£ç ï¼Œè¿™æ„å‘³ç€ç”¨æµè§ˆå™¨æ£€æŸ¥å™¨æ‰‹åŠ¨æ£€æŸ¥æ‰€æœ‰ç½‘ç»œè°ƒç”¨ï¼Œå¹¶å¤åˆ¶åŒ…å«æœ‰è¶£æ•°æ®çš„ AJAX è°ƒç”¨ã€‚

æ‰€ä»¥å–å†³äºä½ æƒ³åšä»€ä¹ˆï¼Œæœ‰å‡ ç§æ–¹æ³•å¯ä»¥åˆ®è¿™äº›ç½‘ç«™ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨éœ€è¦æˆªå±ï¼Œæ‚¨å°†éœ€è¦ä¸€ä¸ªçœŸæ­£çš„æµè§ˆå™¨ï¼Œèƒ½å¤Ÿè§£é‡Šå’Œæ‰§è¡Œæ‰€æœ‰çš„ Javascript ä»£ç ï¼Œä»¥ä¾¿å‘ˆç°é¡µé¢ï¼Œè¿™å°±æ˜¯ä¸‹ä¸€éƒ¨åˆ†çš„å†…å®¹ã€‚

# æ— å¤´é“¬å¸¦èŸ’

PhantomJS æ˜¯è¿™ä¸ªé¢†åŸŸçš„é¢†å¯¼è€…ï¼Œå®ƒè¿‡å»(ç°åœ¨ä»ç„¶)å¤§é‡ç”¨äºæµè§ˆå™¨è‡ªåŠ¨åŒ–å’Œæµ‹è¯•ã€‚åœ¨å¬åˆ° Chrome å‘å¸ƒæ— å¤´æ¨¡å¼çš„æ¶ˆæ¯åï¼ŒPhantomJS ç»´æŠ¤è€…è¯´ä»–å°†ä¸å†æ‹…ä»»ç»´æŠ¤è€…ï¼Œå› ä¸ºæˆ‘å¼•ç”¨â€œGoogle Chrome æ¯” PhantomJS æ›´å¿«ã€æ›´ç¨³å®šã€‚â€...]â€œçœ‹èµ·æ¥æ— å¤´æ¨¡å¼çš„ Chrome æ­£åœ¨æˆä¸ºæµè§ˆå™¨è‡ªåŠ¨åŒ–å’Œå¤„ç†å¤§é‡ Javascript ç½‘ç«™çš„ä¸€ç§æ–¹å¼ã€‚

# å…ˆå†³æ¡ä»¶

æ‚¨éœ€è¦å®‰è£… selenium åŒ…:

```
pip install selenium 
```

Enter fullscreen mode Exit fullscreen mode

å½“ç„¶ï¼Œä½ éœ€è¦ä¸€ä¸ª Chrome æµè§ˆå™¨ï¼Œå¹¶ä¸”åœ¨ä½ çš„ç³»ç»Ÿä¸Šå®‰è£… Chromedriverã€‚

åœ¨ macOS ä¸Šï¼Œä½ å¯ä»¥ç®€å•åœ°ä½¿ç”¨ brew:

```
brew install chromedriver 
```

Enter fullscreen mode Exit fullscreen mode

# æˆªå›¾

æˆ‘ä»¬å°†ä½¿ç”¨ Chrome æˆªå–ä»»å¤©å ‚ä¸»é¡µçš„æˆªå›¾ï¼Œå…¶ä¸­ä½¿ç”¨äº†å¤§é‡çš„ Javascriptã€‚

```
> chrome.py

from selenium import webdriver
from selenium.webdriver.chrome.options import Options

options = Options()
options.headless = True
options.add_argument("--window-size=1920,1200")

driver = webdriver.Chrome(options=options, executable_path=r'/usr/local/bin/chromedriver')
driver.get("https://www.nintendo.com/")
driver.save_screenshot('screenshot.png')
driver.quit() 
```

Enter fullscreen mode Exit fullscreen mode

ä»£ç éå¸¸ç®€å•ï¼Œæˆ‘åªæ˜¯æ·»åŠ äº†ä¸€ä¸ªå‚æ•°-çª—å£å¤§å°ï¼Œå› ä¸ºé»˜è®¤å¤§å°å¤ªå°äº†ã€‚

ä½ ç°åœ¨åº”è¯¥æœ‰ä¸€ä¸ªä»»å¤©å ‚ä¸»é¡µçš„æ¼‚äº®æˆªå›¾äº†:

[![Nintendo Homepage Screenshot](img/30675f43abbab2e726207046a8d245ad.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--bf00LEFQ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/rpui3447ha74z56t6vkb.png)

# ç­‰å¾…é¡µé¢åŠ è½½

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸€ä¸ªé¡µé¢ä¸Šä¼šè§¦å‘å¤§é‡çš„ AJAX è°ƒç”¨ï¼Œæ‚¨å¿…é¡»ç­‰å¾…è¿™äº›è°ƒç”¨åŠ è½½æ‰èƒ½è·å¾—å®Œå…¨å‘ˆç°çš„é¡µé¢ã€‚

è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯å°† time.sleep()è®¾ç½®ä¸ºä»»æ„é•¿çš„æ—¶é—´ã€‚è¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯ï¼Œæ ¹æ®æ‚¨çš„ç­‰å¾…æ—¶é—´å’Œäº’è”ç½‘è¿æ¥é€Ÿåº¦ï¼Œæ‚¨è¦ä¹ˆç­‰å¾…çš„æ—¶é—´å¤ªé•¿ï¼Œè¦ä¹ˆç­‰å¾…çš„æ—¶é—´å¤ªå°‘ã€‚

å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ Selenium API ä¸­çš„ WebDriverWait å¯¹è±¡:

```
try:

 elem = WebDriverWait(driver, delay)
     .until(EC.presence_of_element_located((By.NAME, 'chart')))

 print("Page is ready!")

except TimeoutException:

 print("Timeout") 
```

Enter fullscreen mode Exit fullscreen mode

è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒå°†ç­‰å¾…å…ƒç´ åœ¨é¡µé¢ä¸Šå‘ˆç°æ‰€éœ€çš„ç¡®åˆ‡æ—¶é—´ã€‚

# ç»“è®º

å¦‚ä½ æ‰€è§ï¼Œåœ¨ Python ä¸­è®¾ç½®æ— å¤´æ¨¡å¼çš„ Chrome éå¸¸ç®€å•ã€‚æœ€å…·æŒ‘æˆ˜æ€§çš„éƒ¨åˆ†æ˜¯åœ¨ç”Ÿäº§ä¸­ç®¡ç†å®ƒã€‚å¦‚æœä½ æŠ“å–äº†å¾ˆå¤šä¸åŒçš„ç½‘ç«™ï¼Œèµ„æºçš„ä½¿ç”¨æ˜¯ä¸ç¨³å®šçš„ã€‚

è¿™æ„å‘³ç€ä¼šå‡ºç° CPU å³°å€¼å’Œå†…å­˜å³°å€¼ï¼Œå°±åƒæ™®é€šçš„ Chrome æµè§ˆå™¨ä¸€æ ·ã€‚æ¯•ç«Ÿï¼Œä½ çš„ Chrome å®ä¾‹å°†æ‰§è¡Œä¸å¯ä¿¡å’Œä¸å¯é¢„æµ‹çš„ç¬¬ä¸‰æ–¹ Javascript ä»£ç ï¼æ­¤å¤–è¿˜æœ‰åƒµå°¸è¿›ç¨‹çš„é—®é¢˜

è¿™æ˜¯æˆ‘å¼€å§‹ [ScrapingBee](https://https://www.scrapingbee.com) çš„åŸå› ä¹‹ä¸€ï¼Œè¿™æ ·å¼€å‘è€…å°±å¯ä»¥ä¸“æ³¨äºæå–ä»–ä»¬æƒ³è¦çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ç®¡ç†æ— å¤´æµè§ˆå™¨å’Œä»£ç†ï¼

è¿™æ˜¯æˆ‘å…³äºåˆ®æ“¦çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘å¸Œæœ›ä½ å–œæ¬¢ï¼

å¦‚æœä½ ç¡®å®è®©æˆ‘çŸ¥é“ï¼Œæˆ‘ä¼šå†™æ›´å¤šğŸ˜Š

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº ScrapingBee çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥ğŸ‘‰[æ­¤å¤„](https://dev.to/daolf/new-season-new-project-i-need-you-197l)