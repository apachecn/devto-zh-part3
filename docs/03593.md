# é€æ­¥è§£é‡Šçš„å­—ç¬¦ä¸²åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼

> åŸæ–‡:[https://dev . to/XO WAP/the-string-matching-regex-explained-step-by-step-4 lkp](https://dev.to/xowap/the-string-matching-regex-explained-step-by-step-4lkp)

æˆ‘å¾ˆç¡®å®šï¼Œå¦‚æœå †æ ˆæº¢å‡ºè°ƒæŸ¥é—®å¼€å‘äººå‘˜ä»–ä»¬æœ€å®³æ€•çš„æ˜¯ä»€ä¹ˆï¼Œç¬¬ä¸€åä¼šæ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚è™½ç„¶æœ‰äº›ç®€å•çš„é—®é¢˜åšèµ·æ¥å¹¶ä¸å¤æ‚ï¼Œä½†æœ‰ä¸€ä¸ªç‰¹åˆ«çš„é—®é¢˜æ˜¯æˆ‘åå¤šå¹´æ¥ä¸€ç›´åœ¨å›é¿çš„ï¼Œç›´åˆ°æˆ‘æœ€ç»ˆè¯•å›¾ç†è§£å®ƒ...åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²æ–‡å­—ï¼

å­—ç¬¦ä¸²æ–‡å­—æ˜¯å‘æ‚¨çš„ç¼–ç¨‹è¯­è¨€ä¼ è¾¾æ‚¨å¸Œæœ›ä½œä¸ºå­—ç¬¦ä¸²å¯¹è±¡åŠ è½½çš„å­—ç¬¦ä¸²çš„æ–¹å¼ã€‚åŸºæœ¬ä¸Š:

```
const foo = "bar"; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œçš„å­—ç¬¦ä¸²æ–‡å­—æ˜¯`"bar"`ã€‚

è™½ç„¶é€šå¸¸æ˜¯ç”±è¯­è¨€æ¥å¤„ç†ï¼Œä½†æ˜¯å¯èƒ½æœ‰å‡ ä¸ªåŸå› éœ€è¦æ‚¨è‡ªå·±æ¥è§£æè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæœ€æœ‰å¯èƒ½çš„æ˜¯å½“æ‚¨ç”¨ä¸€ç§è¯­è¨€åˆ†æå¦ä¸€ç§è¯­è¨€æ—¶ã€‚æˆ‘ä¸Šä¸€æ¬¡è¿™æ ·åšæ˜¯åœ¨ç¼–å†™å·¥å…·æ¥ä¿®è¡¥ WordPress SQL è½¬å‚¨æ—¶ã€‚

è¿™å¾ˆå®¹æ˜“åšåˆ°ï¼Œé™¤éä½ éœ€è¦å¤„ç†`"bar \" baz"`æˆ–`"bar\xa0!"`ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»è§£æå­—ç¬¦ä¸²ä¸åŒéƒ¨åˆ†çš„æ–¹æ³•ã€‚

> â€” **æ³¨** â€”
> 
> æœ¬æ–‡æ˜¯åœ¨è€ƒè™‘ JSON-ish å­—ç¬¦ä¸²çš„åŸºç¡€ä¸Šç¼–å†™çš„ï¼Œä½†æ˜¯å°†æ¢è®¨å„ç§è§£æé—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚å½“ç„¶ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªæƒå¨çš„æŒ‡å—ï¼Œå­˜åœ¨è®¸å¤šä¸åŒçš„é€‰æ‹©ï¼Œè¿™åªæ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚
> 
> æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•æ¥è‡ª JavaScriptã€‚
> 
> æœ¬æ–‡ä¸­çš„æ‰€æœ‰æ­£åˆ™è¡¨è¾¾å¼éƒ½é“¾æ¥åˆ° Regex101ï¼Œä»¥å¸®åŠ©æ‚¨è§£ç å’Œæµ‹è¯•è¡¨è¾¾å¼ã€‚ä¸è¦çŠ¹è±«ï¼Œç‚¹å‡»é“¾æ¥ï¼

## [](#simplest-case)æœ€ç®€å•çš„æƒ…å†µ

ç°åœ¨ï¼Œæˆ‘ä»¬åªæ˜¯å°è¯•è§£æä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ï¼Œæ²¡æœ‰ä»»ä½•èŠ±å“¨çš„ä¸œè¥¿ã€‚æˆ‘ä»¬å°†è€ƒè™‘ä¸‹é¢çš„æµ‹è¯•ç”¨ä¾‹:

```
"bar"
const foo = "bar";
foo("bar", "baz"); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘é¦–å…ˆæƒ³å†™çš„æ˜¯ [`/".*"/`](https://regex101.com/r/z0XTpj/1) ã€‚

[![](../Images/81ab92a6f0d562eaf378ba3594ef5c7b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--BqIl5Pp1--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/kwal5wcgg7u7t1dmeapg.png)

å¦‚æ‚¨æ‰€è§ï¼Œ`.`ä¹Ÿä¸`"`åŒ¹é…ï¼Œå¯¼è‡´åŒ¹é…ä¸€æ¬¡å®Œæˆ`"bar", "baz"`ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œä½ å¯ä»¥ç®€å•åœ°ä½¿ç”¨ä¸€ä¸ª`*?`(æ‡’æƒ°)é‡è¯ï¼Œè€Œä¸ä»…ä»…æ˜¯`*`ã€‚è®©æˆ‘ä»¬è¯•è¯• [`/".*?"/`](https://regex101.com/r/gpnMSD/1)

[![](../Images/ce9e597083487c8d235ecf6f9c038063.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--DD_Fc13q--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/7676xs9sn1vllvoty9zl.png)

å¥½å¤šäº†ï¼ä½†è¿˜ä¸å¤Ÿå¥½ï¼ŒåŸå› ä½ å°†åœ¨ä¸‹ä¸€éƒ¨åˆ†äº†è§£ã€‚æƒ³æƒ³æˆ‘ä»¬çš„çœŸå®æ„å›¾:å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å®šä¹‰ä»»ä½•è½¬ä¹‰æœºåˆ¶ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å¯ä»¥åŒ…å«é™¤äº†æ ‡å¿—å­—ç¬¦ä¸²ç»“æŸçš„ `"`ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦*ã€‚*

*ä»»ä½•å­—ç¬¦*éƒ½æ˜¯ç‚¹`.`ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨`[^]`è¯­æ³•åˆ¶ä½œé»‘åå•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`[^"]`å°†åŒ¹é…é™¤äº†`"`ä»¥å¤–çš„ä»»ä½•å­—ç¬¦ã€‚å› æ­¤[çš„æœ€ç»ˆè¡¨è¾¾å¼](https://regex101.com/r/tk7J0U/1)å°†æ˜¯:

```
/"[^"]*"/ 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ ä»ç„¶å¾—åˆ°è¿™ä¸ª:

[![](../Images/ce9e597083487c8d235ecf6f9c038063.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--DD_Fc13q--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/7676xs9sn1vllvoty9zl.png)

## [](#escaping-the-quote)é€ƒæŠ¥

æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥é¿å¼€å¼•å·ã€‚è¦ä¹ˆä½ åŠ å€å®ƒ`"say ""foo"""`ï¼Œè¦ä¹ˆä½ åæ–œæ å®ƒ`"say \"foo\""`ã€‚å®ƒå› è¯­è¨€è€Œå¼‚ã€‚å¤§å¤šæ•°è¯­è¨€é€‰æ‹©åæ–œæ ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°æ‰€æœ‰çš„ä¸œè¥¿éƒ½åœ¨é‚£é‡Œã€‚æˆ‘ä»¬ä¸¤ä¸ªéƒ½è¦ç ”ç©¶ã€‚

### [](#double)åŒç²¾åº¦

å¤„ç†å¼•å·è½¬ä¹‰æœ€ç®€å•çš„æ–¹æ³•å¯èƒ½æ˜¯å°†å®ƒä»¬åŠ å€ã€‚é‚£æ˜¯å› ä¸ºå¾ˆå®¹æ˜“å»æƒ³ã€‚åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œæ‚¨å°†å…è®¸:

*   éå¼•å·â€” `[^"]`
*   ä¸¤ä¸ªç›¸é‚»çš„å¼•å·â€” `""`

å½“æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œä½ å°±å¾—åˆ° [`/"([^"]|"")*"/`](https://regex101.com/r/pxzlIc/1) ã€‚

[![](../Images/d63f583c4dc9dc0478eb54e5f212ed3e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Mv5YgPKh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/7u95qga3w18vz8u8h2de.png)

ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œç¬¬ä¸€æ¬¡å°è¯•å°±æˆåŠŸäº†ï¼

### [](#backslash)åæ–œæ 

è®©æˆ‘ä»¬è¯•ç€åœ¨æµ‹è¯•çŸ­è¯­ä¸Šè¿è¡Œæˆ‘ä»¬ä¹‹å‰çš„ç®€å•è¡¨è¾¾å¼ã€‚

[![](../Images/d2d384e628a36c7c85e1af94dd4c520c.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--RTvdSstR--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/r8zoz94ukt3xn7hyaxyj.png)

å¦‚ä½ æ‰€è§ï¼Œå®ƒå¹¶ä¸å…³å¿ƒåæ–œæ ï¼Œå®ƒæ£€æµ‹ä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ä¸²ã€‚

è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹æˆ‘ä»¬å¸Œæœ›åœ¨ä¸¤ä¸ªå¼•å·ä¹‹é—´å…è®¸ä»€ä¹ˆæ ·çš„å†…å®¹:

*   â€œ*ä¸æ˜¯*è¯­å½•â€ï¼Œè‡³å°‘ä¸æ˜¯å…‰ç§ƒç§ƒçš„ã€‚å°±åƒä¸Šé¢ä¸€æ ·ã€‚`[^"]`
*   è½¬ä¹‰å¼•å·ï¼Œæ‰€ä»¥`\"`ã€‚å¦‚æœæŠŠå®ƒç¿»è¯‘æˆ regex è¯­æ³•ï¼Œå°±ä¼šå¾—åˆ°`\\"`ã€‚

è¿™é€šå¸¸æ˜¯é€šè¿‡å°†ä¸åŒçš„é€‰é¡¹æ”¾åœ¨ä¸€ä¸ªåŒ¹é…ç»„ä¸­æ¥å®Œæˆçš„ã€‚è®©æˆ‘ä»¬è¯•è¯• [`"([^"]|\\")*"`](https://regex101.com/r/esV34C/1) ã€‚

[![](../Images/42c9dfaa5b792e72a55e5ab1d5de337f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--SpvhE66R--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/k8aw0q4d18sqergbe1np.png)

å“¦ï¼Œä¸ï¼Œå®ƒåäº†ã€‚å› ä¸ºæ²¡é”™ï¼Œåæ–œæ ç¡®å®ç¬¦åˆ`[^"]`è§„èŒƒã€‚æ‰€ä»¥æˆ‘ä»¬å®é™…ä¸Šéœ€è¦åè¿‡æ¥å†™: [`/"(\\"|[^"])*"/`](https://regex101.com/r/mbPiac/1)

[![](../Images/3aff3e9fe4baaa2b43a99a5de4f56b51.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s---QnrhD4B--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/s15v36g5kxo4pens8tb7.png)

ç°åœ¨æˆ‘ä»¬æœ‰è¿›å±•äº†ã€‚ä½†æ˜¯ä¾èµ–é¡ºåºæœ‰ç‚¹çç¢ï¼Œä¹Ÿä¸å¤ªå®‰å…¨ã€‚è®©æˆ‘ä»¬ä¿®æ­£ä¸€ä¸‹æˆ‘ä»¬å…ˆå‰è¯´çš„:

*   æ—¢æ²¡æœ‰å¼•å·ï¼Œä¹Ÿæ²¡æœ‰åæ–œæ â€” `[^"\\]`
*   è½¬ä¹‰å¼•å·â€” `\\"`
*   åæ–œæ åè·Ÿé™¤å¼•å·ä¹‹å¤–çš„ä»»ä½•å†…å®¹â€” `\\[^"]`

è®©æˆ‘ä»¬è¯•è¯• [`/"([^"\\]|\\"|\\[^"])*"/`](https://regex101.com/r/Ykbf1L/2)

[![](../Images/554c4777ccd0fee5f1704e7e2f5f4319.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ZWydujwd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/4efk9tcs5di4re2xbrhg.png)

è¿™å¾ˆå¥½ï¼ä½†æ˜¯ç­‰ç­‰ï¼Œè¿™ç§è¡¨è¾¾æ˜¯ä¸æ˜¯æœ‰ç‚¹è ¢ï¼Ÿæˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹:

*   `[^"\\]`|`\\"`|`\\[^"]`â€”â€”è¿™ä¸‰ä¸ªä¸­çš„ä»»ä½•ä¸€ä¸ª
*   `[^"\\]` | `\\("|[^"])` â€”å°†`"`å’Œ`[^"]`ç»„åˆåœ¨ä¸€èµ·
*   `[^"\\]` | `\\.` â€”ç”±äº`"`å’Œ`[^"]`å°†ä¸€èµ·åŒ¹é…â€œå¼•ç”¨æˆ–éå¼•ç”¨â€ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å°†åŒ¹é…ä»»ä½•å­—ç¬¦ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥è¢«æ›¿æ¢ä¸º`.`

æˆ‘ä»¬çš„[æœ€ç»ˆè¡¨è¾¾](https://regex101.com/r/ln80b2/1)ç„¶åæ˜¯`"([^"\\]|\\.)*"/`ã€‚

æˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªå…¨åŠŸèƒ½çš„å­—ç¬¦ä¸²æå–æ­£åˆ™è¡¨è¾¾å¼ï¼

## [](#the-inside-syntax)é‡Œé¢çš„è¯­æ³•

æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„ä»£ç ä¿è¯è§£æä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå³ä½¿å…¶ä¸­æœ‰ä¸€äº›è½¬ä¹‰ç¬¦`"`ã€‚ç„¶è€Œï¼Œè¿™å¹¶ä¸èƒ½ä¿è¯å­—ç¬¦ä¸²ä¸­çš„å†…çš„*æœ‰æ„ä¹‰ã€‚å¤§å¤šæ•°å­—ç¬¦ä¸²è§£æå™¨ä¼šå¯»æ‰¾å®ƒä»¬è¯†åˆ«çš„æ¨¡å¼ï¼Œè€Œä¸å»ç¢°å…¶ä»–çš„æ¨¡å¼ã€‚å‡è®¾æˆ‘ä»¬åªå¤„ç†å¸¸è§„çš„`\n`ã€`\r`æˆ–`\t`:*

1 â€”æ–‡å­—

> `"say \"foo\"\nsay \"bar\!\""`

2-ä½¿ç”¨ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼å–æ¶ˆå¼•ç”¨

> `say \"foo\"\nsay \"bar\!\"`

3-æ›¿æ¢è½¬ä¹‰å­—ç¬¦

> `say "foo"`
> T1ã€‘

è¯·æ³¨æ„`\!`å¦‚ä½•ä¿æŒ`\!`ã€‚è¿™å°±æ˜¯ Python çš„è¡Œä¸ºã€‚å¦‚æœä½ åœ¨ JavaScript ä¸­è¿™ä¹ˆåšï¼Œå®ƒä¼šæŠŠå®ƒæ›¿æ¢æˆ`!`ã€‚è¿™å–å†³äºå®šä¹‰:

*   ä½ å¯ä»¥è¯´`\X`æ˜¯`X`é™¤éæ‰¾åˆ°ä¸€ä¸ªæ¨¡å¼(JavaScript å°±æ˜¯è¿™ä¹ˆåšçš„)
*   æˆ–è€…`\X`ä¸åŒ¹é…ä»»ä½•æ¨¡å¼ï¼Œæ‰€ä»¥å®ƒä¿æŒåŸæ ·(Python çš„é€»è¾‘)
*   Or `\X`ä¸åŒ¹é…ä»»ä½•æ¨¡å¼ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªè¯­æ³•é”™è¯¯(ä¾‹å¦‚ JSON ä¸­å‘ç”Ÿçš„æƒ…å†µ)

### [](#json-escape-characters)JSON è½¬ä¹‰å­—ç¬¦

æ‰€æœ‰è¯­è¨€éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—è½¬ä¹‰å­—ç¬¦ï¼Œæœ‰äº›å¾ˆé€šç”¨ï¼Œå¦‚`\0`æˆ–`\n`ï¼Œè€Œæœ‰äº›åªåœ¨æŸäº›æƒ…å†µä¸‹å­˜åœ¨ï¼Œç”šè‡³åœ¨ä¸åŒçš„è¯­è¨€ä¸­æœ‰ä¸åŒçš„å«ä¹‰ã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€æ–¹ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ‹…å¿ƒä¸€ä¸‹ [JSON æä¾›äº†ä»€ä¹ˆ](https://www.crockford.com/mckeeman.html)ã€‚

#### [](#single-characters)å•å­—ç¬¦

è®¸å¤šè½¬ä¹‰å­—ç¬¦æ¨¡å¼å®é™…ä¸Šåªæ˜¯ä¸€ä¸ªå­—ç¬¦ã€‚å°±åƒ`\n`ä¸€æ ·ï¼Œå®ƒåªæ˜¯åˆ°æ–°è¡Œçš„æ˜ å°„ã€‚å¯¹äºé‚£äº›ä½ åªéœ€è¦å­˜å‚¨æ˜ å°„å’Œæ£€æµ‹å®ƒã€‚åŒ¹é…å®ƒä»¬çš„æ­£åˆ™è¡¨è¾¾å¼æ˜¯ [`/\\(["\\\/bnrt])/`](https://regex101.com/r/QqzWNH/1) ï¼Œå®ƒå…è®¸æ‚¨æŸ¥çœ‹å“ªä¸ªå­—ç¬¦è¢«ç¬¬ä¸€ç»„æ•è·ã€‚

[![](../Images/6f0b323152be249817edd297bfe7c0d8.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--7DS6wkIo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/81m43dd0v7xrdu4jn062.png)

æ­£å¦‚æ‚¨å¯èƒ½çŸ¥é“çš„ï¼ŒJavaScript[string . replace()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace)å‡½æ•°å…è®¸å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºæ›¿æ¢ã€‚å®ƒå°†æ¥æ”¶åŒ¹é…çš„ç»„ä½œä¸ºå‚æ•°ï¼Œå…¶è¿”å›å€¼å°†è¢«ç”¨ä½œæ›¿æ¢ã€‚

æˆ‘ä»¬è¦ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ›¿æ¢è¿™äº›å­—ç¬¦ã€‚

```
function subSingle(string) {
  const re = /\\(["\\\/bnrt])/g;
  const map = {
    '"': '"',
    '\\': '\\',
    '/': '/',
    b: '\b',
    n: '\n',
    r: '\r',
    t: '\t',
  };
  return string.replace(re, (_, char) => map[char]);
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

#### [](#unicode)Unicode

JSON è¿˜å…è®¸æ‚¨é”®å…¥è½¬ä¹‰çš„ unicode å­—ç¬¦ï¼Œæ¯”å¦‚`\uf00f`ã€‚æ˜¯ä¸€ä¸ª`\u`åè·Ÿ 4 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ã€‚æ€»ä¹‹ [`/\\u([a-fA-F0-9]{4})/`](https://regex101.com/r/1Hzj9V/1) ã€‚

[![](../Images/9b9ee15b0a85591b0e69aad0358c616b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--JezZOfWC--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/t8l7v9eeo49fv9agz401.png)

è™½ç„¶æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå­—ç¬¦ä¸²ç¼–ç æˆ UTF-8 æˆ– UTF-16 æ ¼å¼ï¼Œç„¶åä»æ‚¨æ­£åœ¨ä½¿ç”¨çš„è¯­è¨€ä¸­è½¬æ¢æˆä¸€ä¸ªå†…éƒ¨å­—ç¬¦ä¸²å¯¹è±¡ï¼Œä½†æ˜¯æ ‡å‡†åº“ä¸­å¯èƒ½å·²ç»æœ‰ä¸€ä¸ªå‡½æ•°å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚åœ¨ JavaScript ä¸­æ˜¯ [String.fromCodePoint()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint) ï¼Œåœ¨ Python ä¸­æ˜¯å†…ç½®çš„ [chr()](https://docs.python.org/3/library/functions.html#chr) ï¼Œåœ¨ PHP ä¸­æ˜¯ç›¸å¯¹ç®€å•çš„ã€‚

åŒæ ·ï¼Œæˆ‘ä»¬å°†åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨ä¸€ä¸ªæ›¿æ¢å‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

```
function subUnicode(string) {
  const re = /\\u([a-fA-F0-9]{4})/g;
  return string.replace(re, (_, hexCodePoint) => (
    String.fromCodePoint(parseInt(hexCodePoint, 16))
  ));
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#full-json-string-parser)å…¨ JSON å­—ç¬¦ä¸²è§£æå™¨

æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†è§£æå­—ç¬¦ä¸²åŠå…¶ç»„æˆéƒ¨åˆ†çš„ä¸åŒæ–¹æ³•ï¼Œç°åœ¨è®©æˆ‘ä»¬å°†å…¶åº”ç”¨äºè§£æ JSON å­—ç¬¦ä¸²æ–‡å­—ã€‚

ä»£ç å°†åˆ†ä¸ºä¸¤éƒ¨åˆ†:

1.  åœ¨è¾“å…¥æ–‡æœ¬ä¸­æŸ¥æ‰¾ä¸åŒçš„å­—ç¬¦ä¸²
2.  æ›¿æ¢æå–çš„å­—ç¬¦ä¸²ä¸­çš„å¼•ç”¨å­—ç¬¦

è¿™å°†æ˜¯ä¸€ä¸ªç®€å•çš„ Vue åº”ç”¨ç¨‹åºï¼Œå®ƒæ¥å—æ¥è‡ª`textarea`çš„è¾“å…¥ï¼Œå¹¶è¾“å‡ºå®ƒåœ¨è¾“å…¥ä¸­å¯ä»¥æ‰¾åˆ°çš„æ‰€æœ‰å­—ç¬¦ä¸²çš„åˆ—è¡¨ã€‚

### [](#find-the-strings)æ‰¾åˆ°ç´å¼¦

JSON å­—ç¬¦ä¸²çš„ä¸€ä¸ªé‡è¦å˜åŒ–æ˜¯å®ƒä»¬ä¸å…è®¸æ§åˆ¶å­—ç¬¦ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šç¦æ­¢ä½¿ç”¨`\x00-\x19`èŒƒå›´ã€‚è¿™åŒ…æ‹¬æ¢è¡Œç¬¦(`\n`)ç­‰ç­‰ã€‚è®©æˆ‘ä»¬æŠŠæ‰¾å¼¦çš„è¡¨è¾¾ç¨å¾®æ‰­æ›²ä¸€ä¸‹ï¼Œå˜æˆ [`/"(([^\0-\x19"\\]|\\[^\0-\x19])*)"/`](https://regex101.com/r/m6JjKa/1) ã€‚å®ƒåŒ¹é…:

*   éæ§åˆ¶å­—ç¬¦(`\0-\x19`)ã€éå¼•å·(`"`)å’Œéåæ–œæ (`\\`)
*   æˆ–è€…åæ–œæ (`\\`)åè·Ÿéæ§åˆ¶å­—ç¬¦(`\0-\x19`)

è®©æˆ‘ä»¬æŠŠå®ƒè½¬æ¢æˆ JavaScript ä»£ç :

```
function findStrings(string) {
    const re = /"(([^\0-\x19"\\]|\\[^\0-\x19])*)"/g;
    const out = [];

    while ((m = re.exec(string)) !== null) {
        if (m.index === re.lastIndex) {
            re.lastIndex++;
        }

        out.push(m[1]);
    }

    return out;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯¥å‡½æ•°å°†ç®€å•åœ°æå–æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¹¶å°†å®ƒä»¬æ”¾å…¥ä¸€ä¸ªæ•°ç»„ä¸­ã€‚

### [](#substitute-the-characters)æ›¿æ¢å­—ç¬¦

ç°åœ¨æ˜¯æ›¿æ¢è½¬ä¹‰å­—ç¬¦çš„æ—¶å€™äº†ã€‚ä¹‹å‰æˆ‘ä»¬å·²ç»ç”¨äº†ä¸¤ä¸ªå‡½æ•°æ¥å®ç°ï¼Œä½†æ˜¯è¿™å¾ˆå±é™©ã€‚ä¸¾ä¾‹æ¥è¯´:

*   å­—ç¬¦ä¸²æ˜¯`"\\ud83e\\udd37"`
*   ä¸åŠ å¼•å·å°±å˜æˆäº†`\\ud83e\\udd37`
*   æ›¿æ¢å•ä¸ªå­—ç¬¦`\ud83e\udd37`
*   æ›¿æ¢ Unicode `ğŸ¤·`ï¼Œè€Œå®ƒåº”è¯¥æ˜¯`\ud83e\udd37`

å› æ­¤ï¼ŒUnicode å’Œå•ä¸ªå­—ç¬¦å¿…é¡»åŒæ—¶æ›¿æ¢ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ç®€å•åœ°å°†å‰é¢çš„ä¸¤ä¸ªè¡¨è¾¾å¼åˆå¹¶æˆ [`/\\(["\\\/bnrt]|u([a-fA-F0-9]{4}))/`](https://regex101.com/r/rfZ0OF/2) ã€‚

å®ƒåŒ¹é…ä¸€ä¸ªåæ–œæ `\\`ï¼Œåè·Ÿ:

*   `\/bnrt`äººç‰©ä¹‹ä¸€
*   ç±»ä¼¼äº`\uf00f`çš„ Unicode ç ä½

æˆ‘ä»¬ä¹Ÿåˆå¹¶ä¸€ä¸‹ JS ä»£ç :

```
function subEscapes(string) {
    const re = /\\(["\\\/bnrt]|u([a-fA-F0-9]{4}))/g;
    const map = {
        '"': '"',
        '\\': '\\',
        '/': '/',
        b: '\b',
        n: '\n',
        r: '\r',
        t: '\t',
    };

    return string.replace(re, (_, char, hexCodePoint) => {
        if (char[0] === 'u') {
            return String.fromCodePoint(parseInt(hexCodePoint, 16));
        } else {
            return map[char];
        }
    })
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨ä¼šæ³¨æ„åˆ°æˆ‘ä»¬æ˜¯å¦‚ä½•é€‰æ‹©ä¸éªŒè¯è½¬ä¹‰å­—ç¬¦çš„ã€‚äº‹å®ä¸Šï¼Œå¦‚ä¸Šæ‰€è¿°ï¼Œå¦‚æœä½ ç”¨ JSON å†™`\!`,ä½ ä¼šå¾—åˆ°ä¸€ä¸ªè¯­æ³•é”™è¯¯ã€‚ç„¶è€Œåœ¨è¿™é‡Œä½ åªä¼šå¾—åˆ°`\!`ã€‚è¿™æ˜¯ä¸ºäº†ç®€åŒ–ä»£ç ã€‚è¿™æ®µä»£ç å°†æ­£ç¡®è§£ææ‰€æœ‰æœ‰æ•ˆçš„ JSON å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æ— æ•ˆçš„ JSON å­—ç¬¦ä¸²ä»ç„¶ä¼šè¢«æ­£ç¡®è§£æã€‚

### [](#put-it-all-together)æŠŠè¿™ä¸€åˆ‡è”ç³»åœ¨ä¸€èµ·

ç°åœ¨å‰©ä¸‹è¦åšçš„å°±æ˜¯åˆ›å»ºä¸€äº›ä»£ç æ¥è§£æè¾“å…¥å¹¶å°†å…¶è½¬æ¢æˆè¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ Vue åº”ç”¨è½»æ¾åšåˆ°è¿™ä¸€ç‚¹ã€‚

```
const app = new Vue({
    el: '#app',
    data() {
        return {
            input: `const foo = "say \\"foo\\""`,
        };
    },
    computed: {
        output() {
            return findStrings(this.input).map(subEscapes);
        },
    },
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è§‚çœ‹å®ƒçš„å®é™…åº”ç”¨:

[https://jsfiddle.net/xowap/mfc3rxq9/62//embedded/result,js//dark](https://jsfiddle.net/xowap/mfc3rxq9/62//embedded/result,js//dark)

## [](#conclusion)ç»“è®º

ä»æœ€ç®€å•çš„å­—ç¬¦ä¸²åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼å¼€å§‹ï¼Œæˆ‘ä»¬å·²ç»å°†å®ƒå‘å±•æˆä¸ºä¸€ä¸ªæˆç†Ÿçš„ JSON å­—ç¬¦ä¸²è§£æå™¨ã€‚è™½ç„¶è¿‡ç¨‹ä¸­æœ‰è®¸å¤šé™·é˜±ï¼Œä½†æœ€ç»ˆçš„ä»£ç ç›¸å½“ç®€å•å’ŒçŸ­å°(å¤§çº¦ 40 è¡Œ)ã€‚è¿™é‡Œåº”ç”¨çš„æ–¹æ³•å…è®¸æ„å»ºä¸€ä¸ªå­—ç¬¦ä¸²è§£æå™¨ï¼Œä½†ä¹Ÿå¯ä»¥åº”ç”¨äºæ„å»ºä»»ä½•ç±»å‹çš„åŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„ä»£ç ï¼Œæˆ‘å¸Œæœ›æ‚¨èƒ½å¤Ÿå°†å®ƒåº”ç”¨åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼