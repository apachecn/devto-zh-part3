# ğŸš€ç”¨ AWS API ç½‘å…³å’Œ AWS Lambda æ„å»ºç”µæŠ¥æœºå™¨äºº

> åŸæ–‡:[https://dev . to/nqcm/-building-a-telegram-bot-with-AWS-API-gateway-and-AWS-lambda-27fg](https://dev.to/nqcm/-building-a-telegram-bot-with-aws-api-gateway-and-aws-lambda-27fg)

[![Telegram bot with AWS Lambda and AWS API Gateway](../Images/ac7c3f87f6a9efb2ab1aff555ceae841.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--9-9iaVoy--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-bot-with-aws-lambda.png)

åœ¨è¿‡å»çš„ä¸€å¹´é‡Œï¼Œæˆ‘åˆ¶é€ äº†å¾ˆå¤šæœºå™¨äººã€‚æˆ‘ä½¿ç”¨ Chatfuel å’Œ Flowxo ç­‰æœåŠ¡åˆ¶ä½œäº†æœºå™¨äººï¼Œæˆ‘ç”¨ Python å’Œ Nodejs ä»å¤´å¼€å§‹åˆ¶ä½œäº†æœºå™¨äººï¼Œæˆ‘è¿˜ä½¿ç”¨äº†åƒå¾®è½¯ Bot Framework è¿™æ ·çš„æ¡†æ¶ã€‚æˆ‘è¿˜ä¸ºæˆ‘çš„ä»å¤´ç¼–ç çš„æœºå™¨äººè¯•éªŒäº†ä¸åŒçš„éƒ¨ç½²é€‰é¡¹ï¼ŒåŒ…æ‹¬ VPSã€web æœåŠ¡å™¨å’Œæ— æœåŠ¡å™¨æ¶æ„ã€‚

åœ¨æ‰€æœ‰è¿™äº›é€‰é¡¹ä¸­ï¼Œæˆ‘ä¸æ–­å›åˆ°[æ— æœåŠ¡å™¨](https://en.wikipedia.org/wiki/Serverless_computing)éƒ¨ç½²ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œä½¿ç”¨æ— æœåŠ¡å™¨è®¡ç®—æ¶æ„ä¸ä»…éå¸¸ç»æµï¼Œè€Œä¸”ç»´æŠ¤æˆæœ¬ä¹Ÿéå¸¸ä½ã€‚ä½ æ ¹æœ¬ä¸ç”¨æ‹…å¿ƒç»´æŠ¤ä¸€ä¸ªæœåŠ¡å™¨ã€‚åªè¦å†™ä¸‹ä½ çš„ä»£ç ï¼Œä¸Šä¼ åˆ°äº‘ç«¯ï¼Œç„¶åä½ å°±å¯ä»¥æŠŠå®ƒå¿˜å¾—ä¸€å¹²äºŒå‡€äº†ã€‚

## [](#echo-telegram-bot-with-aws-api-gateway-and-aws-lambda)å¸¦æœ‰ AWS API ç½‘å…³å’Œ AWS Lambda çš„ Echo Telegram bot

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘å°†æ¼”ç¤ºä½¿ç”¨ AWS API Gateway å’Œ AWS Lambda åˆ¶ä½œä¸€ä¸ªç®€å•çš„æ— æœåŠ¡ç”µæŠ¥æœºå™¨äººï¼Œå®ƒå¯ä»¥å›åº”ç”¨æˆ·è¾“å…¥çš„æ‰€æœ‰å†…å®¹ã€‚ä½†æ˜¯é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€äº›æœåŠ¡ã€‚

### [](#what-is-api-gateway)ä»€ä¹ˆæ˜¯ API ç½‘å…³

Amazon API Gateway æ˜¯ä¸€ä¸ªå…¬å…±å¯ç”¨çš„ç«¯ç‚¹ï¼Œç”¨äºè¿è¡Œåœ¨ AWS Lambdaã€Amazon EC2 æˆ–å…¶ä»–å¯å…¬å¼€å¯»å€çš„ web æœåŠ¡ä¸Šçš„ä»£ç ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬ä»¥å®‰å…¨å’Œå¯æ‰©å±•çš„æ–¹å¼äº¤ä»˜ç§»åŠ¨å’Œ web åº”ç”¨ç¨‹åºåç«¯ã€‚

### [](#what-is-aws-lambda)ä»€ä¹ˆæ˜¯ AWS Lambda

AWS Lambda æ˜¯ä¸€é¡¹æœåŠ¡ï¼Œå®ƒè®©æˆ‘ä»¬åœ¨äº‘ä¸­åˆ›å»º[æ— çŠ¶æ€](https://en.wikipedia.org/wiki/Stateless_protocol)åŠŸèƒ½(æˆ–ä»£ç å—),å¯ä»¥é€šè¿‡å¤§é‡è§¦å‘å™¨è°ƒç”¨(æˆ–è¿è¡Œ)ã€‚é™¤äº† AWSï¼Œè¿˜æœ‰è®¸å¤šå…¶ä»–æœåŠ¡è®©æˆ‘ä»¬åˆ›å»ºäº‘åŠŸèƒ½ï¼Œæ¯”å¦‚[è°·æ­Œäº‘åŠŸèƒ½](https://cloud.google.com/functions/)å’Œ [Azure åŠŸèƒ½](https://cloud.google.com/functions/)ã€‚

æœºå™¨äººæˆ–èŠå¤©æœºå™¨äººæ˜¯è¿™ç§è®¡ç®—æœåŠ¡çš„ç†æƒ³å€™é€‰ï¼Œå› ä¸ºæœ¬è´¨ä¸ŠèŠå¤©æœºå™¨äººåªæ˜¯ä¸€æ®µé€šè¿‡ç”¨æˆ·äº¤äº’è§¦å‘çš„ä»£ç ã€‚è®¸å¤šæµè¡Œçš„èŠå¤©æœºå™¨äººåˆ¶ä½œå¹³å°å·²ç»åœ¨ä½¿ç”¨äº‘åŠŸèƒ½ä½œä¸ºå…¶æœåŠ¡çš„åŸºç¡€ã€‚

ä»‹ç»å®Œæ¯•ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼

### [](#registering-a-bot-on-telegram)åœ¨ç”µæŠ¥ä¸Šæ³¨å†Œä¸€ä¸ªæœºå™¨äºº

æŒ‰ç…§è¿™ä¸ªæŒ‡å—ï¼Œä½ éœ€è¦ä¸€ä¸ªç”µæŠ¥æœºå™¨äººã€‚åœ¨ Telegram ä¸­æ³¨å†Œä¸€ä¸ªæ–°çš„ bot çœŸçš„å¾ˆç®€å•ã€‚åªéœ€å‘ Telegram è‡ªå·±çš„ bot [BotFather](https://t.me/BotFather) å‘é€ä¸€ä¸ªâ€œ/newbotâ€å‘½ä»¤ï¼Œç„¶åæŒ‰ç…§æŒ‡ç¤ºæ“ä½œå³å¯ã€‚ä½ ä¼šæ”¶åˆ°ä¸€ä¸ªæœºå™¨äººä»¤ç‰Œï¼Œå¤åˆ¶è¿™ä¸ªä»¤ç‰Œï¼Œå¹¶æŠŠå®ƒæ”¾åœ¨æ‰‹è¾¹ã€‚

æ‚¨å¯ä»¥è‡ªå®šä¹‰æœºå™¨äººçš„æè¿°å’Œâ€œå…³äºâ€éƒ¨åˆ†ï¼Œä»¥åŠé€šè¿‡æœºå™¨äººçˆ¶äº²æ›´æ”¹æœºå™¨äººçš„ä¸ªäººèµ„æ–™å›¾ç‰‡ã€‚ä¸€æ—¦ä½ å¯¹ä½ çš„æœºå™¨äººçš„è®¾ç½®æ»¡æ„ï¼Œä½ å°±å¯ä»¥ç»§ç»­äº†ã€‚

Telegram bot çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œå½“ç”¨æˆ·å‘æˆ‘ä»¬çš„ bot å¸æˆ·å‘é€æ¶ˆæ¯æ—¶ï¼ŒTelegram ä¼šå°†è¯¥æ¶ˆæ¯å‘é€ç»™æˆ‘ä»¬çš„ä»£ç ã€‚æˆ‘ä»¬çš„ä»£ç å¤„ç†è¯¥æ¶ˆæ¯ï¼Œåœ¨å®Œæˆæ‰€æœ‰éœ€è¦åšçš„äº‹æƒ…åï¼Œå®ƒå‘ç”µæŠ¥æœåŠ¡å™¨å‘å›ä¸€æ¡æ¶ˆæ¯ï¼Œç„¶åè¯¥æ¶ˆæ¯è¢«å‘é€ç»™ç”¨æˆ·ã€‚

æˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ä» Telegram æœåŠ¡å™¨è·å¾—æ–°çš„æ›´æ–°ã€‚

1.  é•¿è½®è¯¢ï¼Œæˆ‘ä»¬çš„ä»£ç ä¸æ–­è¯¢é—®ç”µæŠ¥æœåŠ¡å™¨æ˜¯å¦æœ‰æ–°çš„æ›´æ–°ã€‚
2.  è®¾ç½® webhooksï¼Œå…¶ä¸­æˆ‘ä»¬è¦æ±‚ç”µæŠ¥æœåŠ¡å™¨é€šè¿‡ HTTP è¯·æ±‚å‘æˆ‘ä»¬å‘é€æ”¶åˆ°çš„ä»»ä½•æ–°æ¶ˆæ¯/æ›´æ–°ã€‚

è®¾ç½® webhooks æ˜¯æ¥æ”¶æ–°æ›´æ–°çš„æœ€èµ„æºå‹å¥½å’Œå¯ä¼¸ç¼©çš„æ–¹å¼ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å°†è¦åšçš„ã€‚ä½†ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®‰å…¨çš„ç½‘å€ï¼Œç”µæŠ¥æœåŠ¡å™¨å¯ä»¥æ¨é€æ‰€æœ‰æ›´æ–°ã€‚è¾“å…¥ AWS API ç½‘å…³ã€‚

### [](#creating-an-api-gateway)åˆ›å»º API ç½‘å…³

å¦‚æœä½ æ²¡æœ‰äºšé©¬é€Šè´¦æˆ·ï¼Œæ³¨å†Œä¸€ä¸ªã€‚ä½ éœ€è¦æä¾›ä½ çš„ä¿¡ç”¨å¡è¯¦ç»†ä¿¡æ¯ï¼Œä½†äºšé©¬é€Šæœ‰ä¸€ä¸ªéå¸¸å¥½çš„å…è´¹å±‚ï¼ŒæŒ‰ç…§è¿™ä¸ªæŒ‡å—åº”è¯¥ä¸ä¼šèŠ±è´¹ä½ ä»»ä½•ä¸œè¥¿ã€‚

ç™»å½•åˆ° [AWS æ§åˆ¶å°](https://aws.amazon.com)å¹¶ä»æœåŠ¡ä¸­æœç´¢ API ç½‘å…³ã€‚

ç‚¹å‡»â€œåˆ›å»º APIâ€

[![Create new API](../Images/5693635c26704b2c66374482cfeff0c4.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--mZ0yp3Sl--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-1.jpg)

ç»™ä½ çš„ API ä¸€ä¸ªåç§°å’Œæè¿°ï¼Œç„¶åç‚¹å‡»åˆ›å»º APIã€‚

[![Settings of the new API](../Images/07cc47272ffb475b09e88e8fe94996a9.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ILhHqlra--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-2.jpg)

åœ¨ä¸ºè¿™ä¸ª API å®šä¹‰ä»»ä½•èµ„æºä¹‹å‰ï¼Œè®©æˆ‘ä»¬é¦–å…ˆåˆ›å»ºæˆ‘ä»¬çš„ Lambda å‡½æ•°ã€‚

### [](#creating-a-lambda-function)åˆ›å»º lambda å‡½æ•°

ç™»å½•åˆ° [AWS æ§åˆ¶å°](https://aws.amazon.com)å¹¶ä»æœåŠ¡ä¸­é€‰æ‹© Lambdaã€‚ç‚¹å‡»â€œåˆ›å»ºåŠŸèƒ½â€ã€‚

[![Click Create Function](../Images/2b1d9c6f78f4ea3d096d6d2c9b954dd0.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--IuLryTie--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-3.jpg)

ç°åœ¨é€‰æ‹©â€œä»å¤´å¼€å§‹åˆ›ä½œâ€é€‰é¡¹ã€‚ä¸€æ—¦ä½ ä¸€ç›´éµå¾ªè¿™ä¸ªæŒ‡å—ï¼Œä½ å¯ä»¥å°è¯•æ¢ç´¢äºšé©¬é€Šæä¾›çš„ä¸åŒè“å›¾ã€‚

[![Choose author from scratch](../Images/b45401a236ef422f4835d7e279cb2953.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--2pEE88cA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-5.jpg)

ç»™ä½ çš„å‡½æ•°èµ·ä¸ªåå­—ï¼Œé€‰æ‹©ä½ æœ€å–œæ¬¢çš„è¿è¡Œæ—¶(åœ¨æœ¬æŒ‡å—ä¸­é€‰æ‹© Python3.6)ã€‚

[![Settings for Lambda function](../Images/448dddb29c89f7a8abf43feeaf6f938b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--NRQv3iQ4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-4.jpg)

æ¯ä¸ª Lambda å‡½æ•°éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„ IAM è§’è‰²(æ‰§è¡Œè§’è‰²)ã€‚åœ¨åˆ›å»º Lambda å‡½æ•°æ—¶æŒ‡å®š IAM è§’è‰²ã€‚æ‚¨æˆäºˆè¯¥è§’è‰²çš„æƒé™å†³å®šäº† AWS Lambda åœ¨æ‰¿æ‹…è¯¥è§’è‰²æ—¶å¯ä»¥åšä»€ä¹ˆã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äºç®¡ç†æƒé™[çš„å†…å®¹ã€‚](https://docs.aws.amazon.com/lambda/latest/dg/intro-permission-model.html#lambda-intro-execution-role)

å‡ºäºæœ¬æŒ‡å—çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†ä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©â€œä»æ¨¡æ¿åˆ›å»ºæ–°è§’è‰²â€ã€‚ä¸ºæ‚¨çš„è§’è‰²å‘½åï¼Œç„¶ååœ¨â€œç­–ç•¥æ¨¡æ¿â€ä¸‹æ‹‰åˆ—è¡¨ä¸­æœç´¢â€œåŸºæœ¬â€ã€‚é€‰æ‹©â€œåŸºæœ¬ Lambda @ Edge æƒé™â€ã€‚ç„¶åç‚¹å‡»â€œåˆ›å»ºåŠŸèƒ½â€ã€‚

[![Select lambda role](../Images/607542ae367eeb1ff1970e104367ff6d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--zRnQMCvS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-13.jpg)

è¿™å°†å¸¦ä½ åˆ°ä½ çš„åŠŸèƒ½ã€‚å‘ä¸‹æ»šåŠ¨ï¼Œç†Ÿæ‚‰ä¸åŒçš„é€‰é¡¹ã€‚æ‚¨éœ€è¦ç‰¹åˆ«æ³¨æ„å‡ ä¸ªé€‰é¡¹:

1.  ç¯å¢ƒå˜é‡-ä»£ç ä½¿ç”¨çš„ä»»ä½•ç¯å¢ƒå˜é‡éƒ½å¿…é¡»åœ¨è¿™é‡Œå£°æ˜ã€‚
2.  åŸºæœ¬è®¾ç½®ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æ›´æ”¹åˆ†é…çš„å†…å­˜å’Œè¶…æ—¶ã€‚è¯·æ³¨æ„ï¼Œæ›´æ”¹è¿™äº›è®¾ç½®å¯èƒ½ä¼šå½±å“æˆæœ¬ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œäº†è§£æ›´å¤šå…³äº Lambda å®šä»·çš„ä¿¡æ¯ã€‚

[![Basic settings for Lambda](../Images/b79ad1db15d317b620976edf3b7db4a1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--0q_nInm9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-6.jpg)

åœ¨æˆ‘ä»¬ç»™å‡½æ•°æ·»åŠ ä»»ä½•ä»£ç ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç»™å®ƒæ·»åŠ ä¸€ä¸ªè§¦å‘å™¨ã€‚æˆ‘ä»¬å¸Œæœ›æ¯æ¬¡æœ‰äººåœ¨ Telegram ä¸Šå‘æˆ‘ä»¬çš„æœºå™¨äººå‘é€æ¶ˆæ¯æ—¶ï¼ŒTelegram æœåŠ¡å™¨åº”è¯¥åœ¨æ‰˜ç®¡æˆ‘ä»¬çš„ä»£ç æ—¶å°†æ¶ˆæ¯æ¨é€åˆ°æˆ‘ä»¬çš„ URLã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ª HTTP GET/POST è¯·æ±‚æ¥è§¦å‘æˆ‘ä»¬çš„ä»£ç ï¼Œæˆ‘ä»¬å°†é€šè¿‡æˆ‘ä»¬çš„ API ç½‘å…³æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

æ‚¨ä¹Ÿå¯ä»¥ä» Lambda è‡ªå·±çš„é¡µé¢å‘ Lambda å‡½æ•°æ·»åŠ è§¦å‘å™¨ï¼Œä½†ç°åœ¨æˆ‘ä»¬å°†å‰å¾€ API ç½‘å…³é¡µé¢ï¼Œå°† Lambda å‡½æ•°ä¸ API è¿æ¥èµ·æ¥å¹¶é…ç½® APIã€‚

### [](#connecting-lambda-function-to-api-gateway)å°† Lambda å‡½æ•°è¿æ¥åˆ° API ç½‘å…³

ç™»å½•åˆ° [AWS æ§åˆ¶å°](https://aws.amazon.com)å¹¶ä»æœåŠ¡ä¸­æœç´¢ API ç½‘å…³ã€‚

é€‰æ‹©æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ APIã€‚æˆ‘ä»¬éœ€è¦ç»™è¿™ä¸ª API æ·»åŠ ä¸€äº›æ–¹æ³•ã€‚ä»ä¸‹æ‹‰â€œæ“ä½œâ€åˆ—è¡¨ä¸­é€‰æ‹©â€œåˆ›å»ºæ–¹æ³•â€

[![Select Create method](../Images/e7ed5b3774c96cdf1b5415c9d08ef68f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--9ZIVyoMJ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-7.jpg)

æ‚¨å°†çœ‹åˆ°å¦ä¸€ä¸ªä¸‹æ‹‰åˆ—è¡¨å‡ºç°åœ¨â€œ/â€ä¸‹ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ·»åŠ è¯¸å¦‚â€œGETâ€å’Œâ€œPOSTâ€ä¹‹ç±»çš„æ–¹æ³•ã€‚å› ä¸ºæˆ‘ä»¬æ­£åœ¨åˆ¶ä½œä¸€ä¸ªéå¸¸ç®€å•çš„æœºå™¨äººï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æƒ³è¦ä¸€å †ä¸åŒçš„æ–¹æ³•ã€‚å› æ­¤ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†åªé€‰æ‹©â€œä»»ä½•â€æ–¹æ³•ã€‚æ„æ€æ˜¯ä¸ç®¡å‘è¿™ä¸ª URL å‘é€ä»€ä¹ˆæ ·çš„è¯·æ±‚ï¼Œéƒ½ä¼šä¸€ç›´è§¦å‘ç›¸åŒçš„ä»£ç ã€‚

[![Select ANY method](../Images/74f778d41f3556d7a36e5d4e713e932b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--SVaGnMcN--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-8.jpg)

ç‚¹å‡»â€œANYâ€æ—è¾¹çš„å°å¤é€‰æ ‡è®°ï¼Œå®ƒä¼šå°†æ‚¨å¸¦åˆ°ä¸€ä¸ªæ–°çš„å±å¹•ï¼Œåœ¨è¿™é‡Œæ‚¨å¯ä»¥é€‰æ‹©ä¸€æ—¦è¯¥ç«¯ç‚¹æ¥æ”¶åˆ°ä»»ä½•ç±»å‹çš„è¯·æ±‚æ—¶è¦åšä»€ä¹ˆã€‚ä»è¿™é‡Œé€‰æ‹©â€œLambda Functionâ€ä½œä¸ºé›†æˆç±»å‹ï¼Œå¹¶ä»åˆ—è¡¨ä¸­é€‰æ‹© Lambda å‡½æ•°çš„åç§°ã€‚è¿˜è¦æ£€æŸ¥â€œä½¿ç”¨ Lambda ä»£ç†é›†æˆâ€é€‰é¡¹ï¼Œè¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿè®¿é—® Lambda å‡½æ•°ä¸­çš„è¯·æ±‚ç»†èŠ‚ã€‚

[![Configure your endpoint](../Images/26977eabb3160dcb5967e826729ca2f3.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--zYfPHsO2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-9.jpg)

å•å‡»ä¿å­˜ã€‚åœ¨ä¸‹ä¸€ä¸ªå±å¹•ä¸Šæµ‹è¯•æ‚¨çš„ APIï¼Œæ£€æŸ¥æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚

[![Test your API](../Images/a4373ddf7b16e56ff59965b070aea8a3.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Mhn8mO_M--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-10.jpg)

ç„¶åä»â€œæ“ä½œâ€åˆ—è¡¨ä¸­å•å‡»â€œéƒ¨ç½² APIâ€ã€‚

[![Select Deploy API](../Images/c0c5848a21cd16468d2d80c2384be67f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--k2yOuQhs--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-11.jpg)

é€‰æ‹©ä¸€ä¸ªè‰ºåï¼Œå¦‚â€œV1â€æˆ–â€œè´å¡”â€ä½œä¸ºè‰ºåã€‚ä¸€æ—¦éƒ¨ç½²äº† APIï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªè°ƒç”¨ URLã€‚å¦‚æœä½ ç‚¹å‡»è¿™ä¸ª URLï¼Œä½ åº”è¯¥å¾—åˆ°ä¸€ä¸ªç®€å•çš„ç½‘é¡µï¼Œä¸Šé¢å†™ç€â€œä½ å¥½ï¼Œæ¥è‡ª Lambdaï¼â€ã€‚è®°ä¸‹è¿™ä¸ªç½‘å€ã€‚

### [](#setting-webhooks)è®¾ç½® Webhooks

æ‰€ä»¥ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå®‰å…¨çš„ URLï¼Œå®ƒè¿æ¥åˆ°æˆ‘ä»¬åœ¨äº‘å‡½æ•°ä¸­çš„ä»£ç ã€‚é…·ï¼æˆ‘ä»¬å¯ä»¥è®© Telegram å°†æˆ‘ä»¬çš„æœºå™¨äººå°†æ¥æ”¶åˆ°çš„ä»»ä½•æ¶ˆæ¯å‘é€åˆ°è¿™ä¸ªåœ°å€ã€‚

è®¾ç½® webhook éå¸¸ç®€å•ï¼Œåªéœ€åœ¨æµè§ˆå™¨ä¸­é”®å…¥ä»¥ä¸‹å†…å®¹ï¼Œç„¶åæŒ‰å›è½¦é”®ã€‚(ç¡®ä¿æ›¿æ¢å ä½ç¬¦æ–‡æœ¬)

```
"https://api.telegram.org/bot<your-bot-token>/setWebHook?url=<your-API-invoke-URL>" 
```

ä½ å°†ä» Telegram æ”¶åˆ°ä¸€æ¡ç¡®è®¤æ¶ˆæ¯ï¼Œä»ç°åœ¨å¼€å§‹ï¼Œä»»ä½•å‘é€åˆ°ä½ çš„æœºå™¨äººçš„æ¶ˆæ¯éƒ½å°†è¢«æ¨é€åˆ°è¿™ä¸ª URLã€‚

### [](#adding-code-to-lambda-function)ç»™ Lambda å‡½æ•°æ·»åŠ ä»£ç 

ç»§ç»­ï¼Œè¯•ç€ä»ä½ è‡ªå·±çš„ç”µæŠ¥è´¦æˆ·å‘æœºå™¨äººå‘é€ä¸€æ¡æ¶ˆæ¯ã€‚

æ‰€ä»¥æ˜¾ç„¶ä»€ä¹ˆéƒ½æ²¡å‘ç”ŸğŸ¤”è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„ä»£ç è¿˜æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚ä½†æ˜¯å¦‚æœæ‚¨æƒ³ç¡®ä¿æ‚¨çš„å‡½æ•°æ˜¯é€šè¿‡æ¥æ”¶ webhook è§¦å‘çš„ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ£€æŸ¥ CloudWatch æ—¥å¿—æ¥å®ç°ã€‚é€‰æ‹© Lambda å‡½æ•°é¡µé¢ä¸Šçš„â€œMonitoringâ€é€‰é¡¹å¡ï¼Œç„¶åé€‰æ‹©â€œView logs in CloudWatchâ€ã€‚

[![logs in CloudWatch](../Images/3e1c396016e2ab106f1a274858a523b0.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--KA1YZmoa--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-12.jpg)

æˆ‘ä»¬å°†ç¼–å†™ä¸€äº›éå¸¸åŸºæœ¬çš„ä»£ç ï¼Œè¿™äº›ä»£ç å°†è¿”å›ç”¨æˆ·å‘é€çš„æ¶ˆæ¯ã€‚ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢ Lambda å‡½æ•°çš„å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­çš„ä»£ç :

```
import json
from botocore.vendored import requests

TELE_TOKEN='<YOUR-BOT-TOKEN>'
URL = "https://api.telegram.org/bot{}/".format(TELE_TOKEN)

def send_message(text, chat_id):
    final_text = "You said: " + text
    url = URL + "sendMessage?text={}&chat_id={}".format(final_text, chat_id)
    requests.get(url)

def lambda_handler(event, context):
    message = json.loads(event['body'])
    chat_id = message['message']['chat']['id']
    reply = message['message']['text']
    send_message(reply, chat_id)
    return {
        'statusCode': 200
    } 
```

å¦‚ä½ æ‰€è§ï¼Œè¿™æ˜¯ä¸€æ®µéå¸¸ç®€å•çš„ä»£ç ã€‚æˆ‘ä»¬åªæ˜¯ä»äº‹ä»¶å¯¹è±¡ä¸­æå–æ¶ˆæ¯å’ŒèŠå¤© idï¼Œå¹¶é€šè¿‡æˆ‘ä»¬çš„ä»¤ç‰Œåœ¨ HTTP GET è¯·æ±‚ä¸­å°†å®ƒä½œä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²å’ŒèŠå¤© id ä¸€èµ·å‘é€å›ç»™[https://api.telegram.org](https://api.telegram.org)ã€‚æˆ‘ä»¬è¿˜è¿”å›ä¸€ä¸ª JSON å¯¹è±¡ï¼Œå…¶â€œstatusCodeâ€ä¸ºâ€œ200 â€,è¿™æ ·ç”µæŠ¥æœåŠ¡å™¨å°±å¯ä»¥çŸ¥é“è¯·æ±‚è¢«æˆåŠŸæ¥æ”¶äº†ã€‚

ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äºä¸ç”µæŠ¥ API [äº¤äº’çš„å†…å®¹ã€‚](https://core.telegram.org/bots/api)

ç»§ç»­ç»™ä½ çš„æœºå™¨äººå‘é€ä¸€äº›æ¶ˆæ¯ï¼Œå®ƒåº”è¯¥ä¼šè¿”å›åŒæ ·çš„æ¶ˆæ¯ã€‚

[![Telegram bot](../Images/9cdd879daddb127364cd6d29d9f1001f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--x2hUC-Lv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.naveeraashraf.com/img/telegram-aws-14.jpg)

å½“ç„¶ï¼Œå¯¹äºç”Ÿäº§ botï¼Œæˆ‘ä»¬å°†åšä¸€äº›ä¸åŒçš„äº‹æƒ…ï¼Œä¾‹å¦‚æ·»åŠ  bot ä»¤ç‰Œä½œä¸ºç¯å¢ƒå˜é‡å’Œæ·»åŠ å®‰å…¨å±‚ã€‚ä½†æ˜¯è¿™è¶…å‡ºäº†æœ¬ç®€å•æ•™ç¨‹çš„èŒƒå›´ã€‚

### [](#conclusion)ç»“è®º

è¿™å°±æŠŠæˆ‘ä»¬å¸¦åˆ°äº†æœ¬æŒ‡å—çš„ç»“å°¾ã€‚æˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•ä¸º Telegram åˆ›å»ºä¸€ä¸ªç®€å•çš„ echo botï¼Œä½†æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•åœ¨äº‘ä¸­å®Œå…¨æ— æœåŠ¡å™¨åœ°æ‰˜ç®¡å®ƒã€‚

ä¼ ç»Ÿä¸Šï¼Œè¦è¿è¡Œè¿™ç§æœºå™¨äººï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä»£ç ï¼Œè€Œä¸æ˜¯ç®€å•çš„è„šæœ¬ï¼Œè€Œæ˜¯åœ¨åƒ Flask è¿™æ ·çš„å¾®æœåŠ¡æ¡†æ¶å†…ã€‚æˆ‘ä»¬éœ€è¦åƒ web æœåŠ¡å™¨è¿™æ ·çš„åŸºç¡€æ¶æ„æ¥æä¾›ä»£ç ï¼ŒSSL è¯ä¹¦æ¥ä¿è¯æˆ‘ä»¬çš„è¿æ¥å®‰å…¨ç­‰ç­‰ã€‚ä½†æ˜¯ç”±äºå¼ºå¤§çš„ Lambda å‡½æ•°å’Œ API ç½‘å…³ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡å˜å¾—ç®€å•å¤šäº†ã€‚

* * *

*å›¾ç‰‡æ¥æº* [ç”± Freepik](https://www.freepik.com/free-vector/chatbot-concept-background-with-happy-robot_2411604.htm) è®¾è®¡