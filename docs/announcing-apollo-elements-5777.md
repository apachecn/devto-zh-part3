# å®£å¸ƒé˜¿æ³¢ç½—å…ƒç´ 

> åŸæ–‡ï¼š<https://dev.to/bennypowers/announcing-apollo-elements-5777>

<sup><abbr title="×‘×¡×™×™×¢×ª× ×“×©××™×™×">×‘×¡×´×“</abbr></sup>

ä»Šå¤©æˆ‘å‘å¸ƒäº† 0.0.1 ç‰ˆæœ¬çš„`apollo-elements`ï¼Œè¿™æ˜¯ä¸€ä¸ªè½¯ä»¶åŒ…çš„é›†åˆï¼Œå®ƒä½¿å¾—åˆ›å»ºè¿æ¥åˆ° Apollo GraphQL <sup>[1](#note-1)</sup> çš„ web ç»„ä»¶å˜å¾—å®¹æ˜“ã€‚

## ![GitHub logo](img/75095a8afc1e0f207cda715962e75c8d.png) [é˜¿æ³¢ç½—â€”â€”å…ƒç´ ](https://github.com/apollo-elements) / [é˜¿æ³¢ç½—â€”â€”å…ƒç´ ](https://github.com/apollo-elements/apollo-elements)

### ğŸš€ğŸŒ›ä½¿ç”¨å‘å°„å¹³å°ğŸ‘©â€ğŸš€ğŸ‘¨â€ğŸš€

<article class="markdown-body entry-content container-lg" itemprop="text">[![Apollo Elements](img/98296aef6032a60e4484a5f0338a18fb.png)](https://github.com/apollo-elements/apollo-elements./docs/logo.svg)

# <g-emoji class="g-emoji" alias="rocket" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f680.png">ğŸš€</g-emoji>é˜¿æ³¢ç½—å…ƒç´ <g-emoji class="g-emoji" alias="woman_astronaut" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f469-1f680.png">ğŸ‘©â€ğŸš€</g-emoji>

**<g-emoji class="g-emoji" alias="new_moon" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f311.png">ğŸŒ‘</g-emoji>è‡ªå®šä¹‰å…ƒç´ ç¬¦åˆé˜¿æ³¢ç½— GraphQL <g-emoji class="g-emoji" alias="last_quarter_moon_with_face" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f31c.png">ğŸŒœ</g-emoji>**

**<g-emoji class="g-emoji" alias="woman_astronaut" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f469-1f680.png">ğŸ‘©â€ğŸš€</g-emoji>è¿™æ˜¯å¼€å‘è€…çš„ä¸€å°æ­¥ï¼Œç½‘ç»œå¹³å°çš„ä¸€å¤§æ­¥ï¼<g-emoji class="g-emoji" alias="man_astronaut" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f468-1f680.png">ğŸ‘¨â€ğŸš€</g-emoji>**

[![Made with open-wc](img/8ae42a4de893e8be8bccd50ad2c96df3.png)](https://open-wc.org)[![Contributions Welcome](img/415935da8031f15a94578a276d0ed929.png)](https://github.com/apollo-elements/apollo-elements/issues)[![ISC License](img/036d10059c9e5981815ab31bf27af9aa.png)](https://github.com/apollo-elements/apollo-elements/blob/master/LICENCE.md)[![Maintainability](img/65f38bb47f99e815a89683b34f4999e6.png)](https://codeclimate.com/github/apollo-elements/apollo-elements/maintainability)[![Test Coverage](img/1f92b15ccee14df8b5ac8c5555113c77.png)](https://codeclimate.com/github/apollo-elements/apollo-elements/test_coverage)[![Release](img/2228b9959298c5ccde79bcd2ff839416.png)](https://github.com/apollo-elements/apollo-elements/actions)

Apollo Elements æä¾›äº†åŸºäºå„ç§åº•å±‚ web ç»„ä»¶åˆ›ä½œåº“çš„åŒ…ã€‚ä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªé€‚åˆä½ çš„é¡¹ç›®ï¼Œä»¥ä¿æŒä½ çš„åº”ç”¨ç¨‹åºå°ã€‚

```
npm init @apollo-elements
```

Enter fullscreen mode Exit fullscreen mode

## <g-emoji class="g-emoji" alias="robot" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f916.png">ğŸ¤–</g-emoji>æ¼”ç¤º

*   [`#leeway`](https://leeway.apolloelements.dev) æ˜¯ä¸€ä¸ªèŠå¤© PWA çš„ä¾‹å­ï¼Œå®ƒä½¿ç”¨`lit-apollo`ä½¿ä½ æ›´å®¹æ˜“é¿å…åšå®é™…å·¥ä½œã€‚[æºåº“](https://github.com/apollo-elements/leeway)
*   [`LaunchCTL`](https://launchctl.apolloelements.dev) æ˜¯ä¸€ä¸ªç®€å•çš„ PWAï¼Œæ˜¾ç¤ºå…³äº [SpaceX](https://spacex.com) å‘å°„çš„ä¿¡æ¯ã€‚å®ƒä½¿ç”¨éå®˜æ–¹çš„ [spacex.land](https://spacex.land) GraphQL APIã€‚[æºåº“](https://github.com/apollo-elements/launchctl)

## <g-emoji class="g-emoji" alias="world_map" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f5fa.png">ğŸ—º</g-emoji>æŒ‡å—å’Œæ–‡æ¡£

å¦‚æœä½ åªæ˜¯æƒ³çœ‹ API æ–‡æ¡£ï¼Œå¯ä»¥åœ¨ [apolloelements.dev](https://apolloelements.dev) æŸ¥çœ‹æˆ‘ä»¬æ‰€æœ‰çš„åŒ…

*   [<g-emoji class="g-emoji" alias="avocado" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f951.png">ğŸ¥‘</g-emoji>æ ¸å¿ƒ](https://apolloelements.dev/api/core/)
*   [<g-emoji class="g-emoji" alias="bricks" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f9f1.png">ğŸ§±</g-emoji> ç»„ä»¶](https://apolloelements.dev/api/components/)
*   [<g-emoji class="g-emoji" alias="cocktail" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f378.png">ğŸ¸</g-emoji>æ··è¡€å„¿](https://apolloelements.dev/api/libraries/mixins/)
*   [<g-emoji class="g-emoji" alias="fire" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f525.png">ğŸ”¥</g-emoji>ç‚¹ç‡ƒ](https://apolloelements.dev/api/libraries/lit-apollo/)
*   [<g-emoji class="g-emoji" alias="checkered_flag" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f3c1.png">ğŸ</g-emoji>å¿«](https://apolloelements.dev/api/libraries/fast/)
*   [<g-emoji class="g-emoji" alias="ghost" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f47b.png">ğŸ‘»</g-emoji>é—¹é¬¼](https://apolloelements.dev/api/libraries/haunted/)
*   [<g-emoji class="g-emoji" alias="atom_symbol" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/269b.png">åŸå­</g-emoji>](https://apolloelements.dev/api/libraries/atomico/)
*   [<g-emoji class="g-emoji" alias="unicorn" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f984.png">ğŸ¦„</g-emoji>æ··è¡€å„¿](https://apolloelements.dev/api/libraries/hybrids/)
*   [<g-emoji class="g-emoji" alias="microscope" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f52c.png">ğŸ”¬</g-emoji>èƒ¶å­](https://apolloelements.dev/api/libraries/gluon/)
*   [<g-emoji class="g-emoji" alias="dna" fallback-src="https://github.githubassets.cimg/icons/emoji/unicode/1f9ec.png">ğŸ§¬</g-emoji> èšåˆç‰©](https://apolloelements.dev/api/libraries/polymer/)

## ç”¨äºä»»ä½•

â€¦</article>

[View on GitHub](https://github.com/apollo-elements/apollo-elements)

Apollo Elements å¤„ç† web ç»„ä»¶åº“(å¦‚`lit-element`æˆ–`hybrids`)å’Œ Apollo å®¢æˆ·ç«¯ä¹‹é—´çš„ç®¡é“ï¼Œå› æ­¤æ‚¨å¯ä»¥ä¸“æ³¨äºæ„å»ºæ‚¨çš„åº”ç”¨ç¨‹åºã€‚

å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰ web ç»„ä»¶ï¼Œè¯·å‚åŠ <abbr title="peek">ğŸ‘€</abbr>åœ¨æˆ‘çš„â€œè®©æˆ‘ä»¬æ„å»º Web ç»„ä»¶â€ç³»åˆ—æ–‡ç« ä¸­ï¼Œæ‚¨å°†äº†è§£åˆ°:

[![bennypowers](img/57370d6f6dab8d6651a3f138a1aaaa40.png)](/bennypowers) [## è®©æˆ‘ä»¬æ„å»º Web ç»„ä»¶ï¼ç¬¬ 1 éƒ¨åˆ†:æ ‡å‡†

### æœ¬å°¼ä¸ºğŸ‡®ğŸ‡±ğŸ‡¨ğŸ‡¦ä¾›ç”µ 9 æœˆ 18 æ—¥ 1810 åˆ†é’Ÿé˜…è¯»

#webcomponents #customelements #javascript #html](/bennypowers/lets-build-web-components-part-1-the-standards-3e85)

## è¿æ¥ç»„ä»¶

åœ¨åŸºäºç»„ä»¶çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥ä»ä¸€äº›å•ç‹¬çš„çŠ¶æ€å­˜å‚¨ä¸­è·å¾—å®ƒçš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åˆ›å»ºè¿æ¥åˆ° Redux æˆ– MobX å­˜å‚¨çš„ç»„ä»¶ï¼Œå¹¶è®¢é˜…å¯¹å…¶çŠ¶æ€æ‹¼å›¾çš„æ›´æ”¹ã€‚

GraphQL çµæ´»ä¸”å¯æ‰©å±•çš„è¯­æ³•éå¸¸é€‚åˆåŸºäºç»„ä»¶çš„è®¾è®¡ï¼Œè€Œ Apollo å¼ºå¤§çš„å®ç°è®©æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åœ¨ GraphQL æ•°æ®å’Œç»„ä»¶ä¹‹é—´å»ºç«‹è”ç³»ã€‚ä½¿ç”¨`apollo-link-state`ï¼Œä½ ç”šè‡³å¯ä»¥å®Œå…¨æ‘†è„±åƒ redux è¿™æ ·çš„å®¢æˆ·ç«¯çŠ¶æ€å®¹å™¨ï¼Œå¹¶ä¸”*ä» apollo ç¼“å­˜*ä¸­æŸ¥è¯¢ä½ çš„æ•´ä¸ªç»„ä»¶çŠ¶æ€ã€‚

```
query  UserProfilePage($userId:  ID)  {  session  @client  {  token  expiresAt  id  }  user(id:  $id)  {  name  avatar  friends  {  name  id  }  }  } 
```

Enter fullscreen mode Exit fullscreen mode

## æ˜¾ç¤ºä»£ç 

ç°åœ¨ï¼Œæœ‰äº† Apollo Elementsï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°å»ºç«‹å’Œè¿è¡Œè¿æ¥ç»„ä»¶ã€‚æ‚¨æä¾›äº†ä¸€ä¸ª GraphQL æ–‡æ¡£å’Œä¸€ä¸ªå¤„ç†æ¨¡æ¿çš„å®šåˆ¶å…ƒç´ ç±» [<sup>2</sup>](#note-2) ï¼Œä¸€åˆ‡å°±ç»ªã€‚

```
import { ApolloQuery, html } from '@apollo-elements/lit-apollo';

// A component that uses ApolloSubscription to update
// when users go on or offline.
import './user-online-status.js';
import './loading-spinner.js';

/**
 * `<user-profile-page>` Shows a user's profile, as well as a list
 * of their friends which display's each one's online status via a
 * GraphQL subscription.
 * @extends ApolloQuery
 */
class UserProfilePage extends ApolloQuery {
  render() {
    const { loading, data } = this;
    return (
      (loading || !data) ? html`<loading-spinner></loading-spinner>`
      !data.user ? : html`<login-form></login-form>`
    : html`
        <h1>Hello, ${data.user.name}</h1>
        <profile-image src="${data.user.avatar}"></profile-image>
        <h2>Who's Online?</h2>
        <dl>${data.user.friends.map(({id, name}) => html`
          <dt>${name}</dt>
          <dd><user-online-status id="${id}"></user-online-status></dd>
        `)}</dl>
      `
    );
  }

  updated() {
    // get the currently logged-in user's id from the `@client` query.
    const { id } = this.id;
    // setting variables updates the query.
    if (id) this.variables = { id };
  }
}

customElements.define('user-profile-page', UserProfilePage); 
```

Enter fullscreen mode Exit fullscreen mode

ä¸€æ—¦å°†å…ƒç´ æ·»åŠ åˆ°é¡µé¢ä¸­ï¼Œåªéœ€å°†å®ƒä»¬çš„`query`å±æ€§è®¾ç½®ä¸º GraphQL æ–‡æ¡£ï¼Œå°±å¤§åŠŸå‘Šæˆäº†ã€‚

### å†…åµŒå›¾å½¢ SQL è„šæœ¬

æ‚¨ç”šè‡³å¯ä»¥ä½¿ç”¨å†…è” GraphQL:
åœ¨ HTML ä¸­ä»¥å£°æ˜æ–¹å¼å®šä¹‰æ‚¨çš„æŸ¥è¯¢

```
<user-profile-page>
  <script type="application/graphql">
    query UserProfilePage($userId: ID) {
      session @client {
        token
        expiresAt
        id
      }

      user(id: $id) {
        name
        avatar
        friends {
          name
          id
        }
      }
    }
  </script>
</user-profile-page> 
```

Enter fullscreen mode Exit fullscreen mode

å¾ˆå¯çˆ±ï¼Œå¯¹å§ï¼Ÿ

## æ”¯æŒå¤šä¸ª Web ç»„ä»¶åº“

Apollo Elements æºäº`lit-apollo`ï¼Œä½†æ˜¯æˆ‘ä¸æ»¡è¶³äºæ”¯æŒå•ä¸€çš„ç»„ä»¶ç±»ã€‚ç‰ˆæœ¬ 0 å‘è´§ï¼Œæ”¹åæ¢å§“ï¼Œæ”¯æŒ[`lit-element`](https://dev.to/bennypowers/lets-build-web-components-part-5-litelement-906)[`GluonElement`](https://dev.to/bennypowers/lets-build-web-components-part-6-gluon-27ll)[`hybrids`](https://dev.to/bennypowers/lets-build-web-components-part-7-hybrids-187l)ã€‚å®ƒä¹Ÿæœ‰ä¸€äº›[èšåˆç‰©](https://dev.to/bennypowers/lets-build-web-components-part-4-polymer-library-4dk2)é£æ ¼çš„åŒå‘ç»‘å®šå…ƒç´ ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç”¨`{{data}}`è¯­æ³•åœ¨ä½ çš„æ¨¡æ¿ä¸­å…¬å¼€é˜¿æ³¢ç½—çŠ¶æ€ã€‚

ä½†æ˜¯è¿™é‡Œçš„ç›®æ ‡æ˜¯ç»™ä½ ï¼Œå¼€å‘è€…ï¼Œæ›´å¤šçš„é€‰æ‹©ã€‚å¦‚æœä»¥ä¸Šéƒ½ä¸æ˜¯ä½ è¦æ‰¾çš„ï¼ŒApollo Elements è¿˜æä¾›äº†[ç±»æ··åˆ](http://justinfagnani.com/2015/12/21/real-mixins-with-javascript-classes/)ï¼Œè®©ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ç±»ä¼¼é¦™è‰çš„ç»„ä»¶ç±»ï¼Œç”šè‡³æ˜¯è€å¼çš„`HTMLElement`ï¼Œå¦‚æœä½ çœŸçš„æƒ³è¦çš„è¯ã€‚

```
import { ApolloMutationMixin } from '@apollo-elements/mixins';
import gql from 'graphql-tag';

const mutation = gql`
  mutation SendMessage($message: String!) {
    sendMessage(message: $message) {
      message
      date
    }
  }
`;

const template = document.createElement('template');
template.innerHTML = `
  <style>
    :host([error]) #input {
      border: 1px solid red;
    }

    details {
      display: none;
    }

    :host([error]) details {
      display: block;
    }
  </style>
  <label>Message<input id="input"/></label>
  <details>
    <summary>Error!</summary>
    <span id="error"></span>
  </details>
`;

class ChatInput extends ApolloMutationMixin(HTMLElement) {
  get input() {
    return this.shadowRoot && this.shadowRoot.getElementById('input');
  }

  constructor() {
    super();
    this.mutation = mutation;
    this.onKeyup = this.onKeyup.bind(this);
    this.attachShadow({ mode: 'open' })
    this.shadowRoot.appendChild(template.content.cloneNode(true))
    this.input.addEventListener('keyup', this.onKeyup)
  }

  onKeyup({ key, target: { value: message } }) {
    if (key !== 'Enter') return;
    this.variables = { message };
    this.mutate();
  }

  // Override implementation of `onCompleted` if desired.
  // Alternatively, use a setter.
  onCompleted({ message, date }) {
    this.input.value = '';
  }

  // Override implementation of `onError` if desired.
  // Alternatively, use a setter.
  onError(error) {
    this.setAttribute('error', error);
    this.shadowRoot.getElementById('error').textContent =
      `Error when sending message: ${ error }`;
  }
} 
```

Enter fullscreen mode Exit fullscreen mode

æœªæ¥æ”¯æŒæ›´å¤š web ç»„ä»¶åº“å’Œæ¡†æ¶çš„è®¡åˆ’æ­£åœ¨è¿›è¡Œä¸­ï¼Œæ‰€ä»¥è¯·å…³æ³¨ç‰ˆæœ¬å›è´­ã€‚

æ‰€ä»¥ç»§ç»­å§â€”â€”å®‰è£…æœ€é€‚åˆæ‚¨çš„é¡¹ç›®çš„è½¯ä»¶åŒ…:

*   [`@apollo-elements/mixins`](https://npmjs.org/package/@apollo-elements/mixins) ä¸ºæ‚è‰²ç±»
*   [`@apollo-elements/lit-apollo`](https://npmjs.org/package/@apollo-elements/lit-apollo) ä¸º lit-element
*   [`@apollo-elements/hybrids`](https://npmjs.org/package/@apollo-elements/hybrids) ä¸ºæ‚ç§
*   [`@apollo-elements/gluon`](https://npmjs.org/package/@apollo-elements/gluon) ä¸ºèƒ¶å­
*   [`@apollo-elements/polymer`](https://npmjs.org/package/@apollo-elements/polymer) ä¸ºé«˜åˆ†å­å‹é€šçŸ¥å…ƒç´ 

## æ¼”ç¤º

æƒ³çœ‹çœ‹å®é™…æƒ…å†µå—ï¼Ÿæˆ‘æ„å»ºäº†ä¸€ä¸ªç®€å•çš„èŠå¤©åº”ç”¨ç¨‹åºæ¼”ç¤ºï¼Œå®ƒä½¿ç”¨ GraphQL è®¢é˜…ï¼Œå¹¶ä½¿ç”¨ lit-element å‘ˆç°å…¶ç»„ä»¶ã€‚

[`#leeway`](https://lit-apollo-subscriptions.herokuapp.com) æ˜¯ä¸€ä¸ªæ¸è¿›å¼çš„ç½‘ç»œåº”ç”¨ï¼Œå®ƒä½¿ç”¨`lit-apollo`è®©ä½ æ›´å®¹æ˜“é¿å…åšå®é™…çš„å·¥ä½œã€‚æŸ¥çœ‹[æºä»£ç æŠ¥å‘Š](https://gitlab.com/bennyp/demo-lit-apollo-subscriptions)ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨ Apollo å…ƒç´ æ„å»ºåº”ç”¨çš„ç¤ºä¾‹ã€‚æ¼”ç¤ºåŒ…æ‹¬:

*   <abbr title="server side rendering">SSR</abbr>
*   ä»£ç åˆ†å‰²
*   æ¿€è¿›çš„ç¼©å°ï¼ŒåŒ…æ‹¬`lit-html`æ¨¡æ¿æ–‡å­—
*   CSS ä¸­çš„ CSS(ä¾‹å¦‚`import shared from '../shared-styles.css';`)
*   GQL-in-GQL(ä¾‹å¦‚`import query from './my-component-query.graphql';`)
*   websocket ä¸Šçš„ GraphQL è®¢é˜…

[![Lighthouse Scores: 98 (performance), 100 (accessibility), 93 (best practises), 100 (SEO), 12/12 (PWA)](img/35868e336ac3560f91155dab95fbb474.png)](https://github.com/apollo-elements/apollo-elements/files/2825459/lit-apollo-subscriptions.herokuapp.com-20190203T132249.zip)

æ‰€ä»¥ä»Šå¤©å°±æ¥è¯•è¯•`apollo-elements`å§ï¼

##### è„šæ³¨

*   <small>é˜¿æ³¢ç½—å…ƒç´ æ˜¯æˆ‘è‡ªå·±ç»´æŠ¤çš„ä¸€ä¸ªç¤¾åŒºé¡¹ç›®ï¼Œå®ƒä¸éš¶å±äºæµæ˜Ÿã€‚</small>
*   <small>æˆ–è€…åœ¨æ··è¡€å„¿çš„æƒ…å†µä¸‹ï¼Œä½ éœ€è¦çš„åªæ˜¯ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ã€‚</small>