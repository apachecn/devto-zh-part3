# ç©¿è¶Š Ruby æ ‡å‡†åº“çš„æ€ªå¼‚è€Œå¥‡å¦™çš„æ—…ç¨‹

> åŸæ–‡:[https://dev . to/mctaylorpants/a-æ€ªå¼‚å¥‡å¦™ä¹‹æ—…-é€šè¿‡ rubys-standard-library-2ko1](https://dev.to/mctaylorpants/a-weird-and-wonderful-trip-through-rubys-standard-library-2ko1)

*[åŸæœ¬è´´åœ¨ä»‹è´¨ä¸Š](https://medium.com/@mctaylorpants/a-weird-and-wonderful-trip-through-rubys-standard-library-762ddcf7a908)*

[![keep ruby's standard library weird](../Images/e48ca5393996bb069ca1872ff839c924.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--zL-qZSRh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/hokc6yihnholomf4jirr.png)

ä½ ç°åœ¨å¯èƒ½å·²ç»å¬åˆ°è¿™ä¸ªæ¶ˆæ¯äº†- [Bundler å°†è¢«å¹¶å…¥ Ruby core](http://engineering.appfolio.com/appfolio-engineering/2018/11/26/bundler-is-built-into-ruby-260preview3) ï¼å¾ˆé«˜å…´çœ‹åˆ°åƒ Bundler è¿™æ ·å¯¹ Ruby ä½“éªŒå¦‚æ­¤é‡è¦çš„é¡¹ç›®ï¼Œæ­£åœ¨ä»¥ä¸€ç§æ·±å…¥çš„æ–¹å¼æˆä¸º Ruby çš„ä¸€éƒ¨åˆ†ã€‚

è¿™ä¹Ÿè®©æˆ‘æ€è€ƒ:é‡Œé¢è¿˜æœ‰ä»€ä¹ˆï¼Ÿæˆ‘ä½¿ç”¨ Ruby ä¸»è¦æ˜¯ä¸ºäº†ç¼–å†™ web åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯ Ruby ä½œä¸ºè„šæœ¬è¯­è¨€çš„ä¸°å¯Œå†å²æ„å‘³ç€æœ‰å¾ˆå¤šåŠŸèƒ½æˆ‘å¹¶ä¸æ˜¯æ¯å¤©éƒ½åœ¨ä½¿ç”¨ï¼Œå¯èƒ½è¿˜æœ‰å¾ˆå¤šæˆ‘ç”šè‡³ä¸çŸ¥é“å­˜åœ¨çš„åŠŸèƒ½ã€‚

æ‰€ä»¥ï¼Œæˆ‘å†³å®šä¸€æ¢ç©¶ç«Ÿã€‚æˆ‘èŠ±äº†ä¸€äº›æ—¶é—´æµè§ˆ[æ ‡å‡†åº“æ–‡æ¡£](https://ruby-doc.org/stdlib-2.5.3/)ï¼Œç•™æ„æˆ‘ä¸è®¤è¯†çš„ä¸œè¥¿ã€‚æˆ‘å‘ç°äº†ä¸€äº›éå¸¸å¥‡æ€ªå’Œå¥‡å¦™çš„ä¸œè¥¿ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€äº›æˆ‘æœ€å–œæ¬¢çš„ã€‚

å‡†å¤‡å¥½ä¸€äº›äººä¸ºçš„ä¾‹å­äº†å—ï¼Ÿæˆ‘ä»¬èµ°å§ï¼

# [](#shellwords)Shellwords

é¦–å…ˆ:Shellwords æ¨¡å—ã€‚å®ƒæä¾›äº†ä¸€äº›ä¸é”™çš„æ–¹æ³•ï¼Œä½¿å¾—åœ¨ Ruby ä¸­æ„å»ºå’Œè§£æ shell å‘½ä»¤å˜å¾—æ›´åŠ å®¹æ˜“ã€‚

ä¾‹å¦‚:å‡è®¾æ‚¨æœ‰ä¸€ä¸ªå¸¦æ’‡å·çš„æ–‡ä»¶åï¼Œæ‚¨æƒ³ä½¿ç”¨ cat æ¥è·å–æ–‡ä»¶çš„å†…å®¹ã€‚(æˆ‘ç¡®å®è¯´è¿‡è¿™äº›æ˜¯åšä½œçš„ï¼Œä¸æ˜¯å—ï¼ŸğŸ˜‰)

ä½ å¯ä»¥è¿™æ ·åš:

```
$> filename = "Alex's Notes.txt"
$> `cat #{filename}` 
```

ä½†æ˜¯ bash ä¸å–œæ¬¢æœªè½¬ä¹‰çš„å•å¼•å·ï¼Œæ‰€ä»¥æœ€ç»ˆä¼šå‡ºç°ä¸€ä¸ªé”™è¯¯:

```
sh: -c: line 0: unexpected EOF while looking for matching `''
sh: -c: line 1: syntax error: unexpected end of file
=> "" 
```

ä¸è¦å®³æ€•ï¼#è„±å£³åœ¨è¿™é‡Œï¼

```
$> `cat #{filename.shellescape}`
=> "Apostrophes in a filename? ğŸ¤”" 
```

ä¸‡å²ï¼Œä½ çš„é—®é¢˜è§£å†³äº†ï¼å°½ç®¡ä½ å¯èƒ½æƒ³å’Œé‚£ä¸ªæŠŠæ’‡å·æ”¾åœ¨ç¬¬ä¸€ä½çš„äººèŠèŠ...

# [](#english-for-when-you-want-less%C2%A0)è‹±æ–‡:å½“ä½ æƒ³è¦æ›´å°‘çš„ç¾å…ƒæ—¶ç”¨

çªå‡»æµ‹éªŒ:`$$`è¿”å›ä»€ä¹ˆï¼Ÿ

å¦‚æœä½ çš„å›ç­”æ˜¯â€œä¸ºä»€ä¹ˆï¼Œå½“ç„¶æ˜¯å½“å‰è¿›ç¨‹ IDï¼â€ï¼Œé‚£ä¹ˆæˆ‘æƒ³ä½ å¯ä»¥è·³è¿‡è¿™ä¸€èŠ‚ã€‚

å¯¹äºæˆ‘ä»¬å…¶ä»–äººæ¥è¯´ï¼ŒRuby çš„`$$`æ˜¯å¯¹ Perl çš„è‡´æ•¬ï¼Œå®ƒè¿”å›å½“å‰ç³»ç»Ÿè¿›ç¨‹çš„ IDã€‚ä½†æ˜¯è¿™ä¸æ˜¯å¯¹å¼€å‘è€…æœ€å‹å¥½çš„åå­—ï¼Œæ‰€ä»¥ Ruby çš„è‹±æ–‡æ¨¡å—æä¾›äº†ä¸€äº›æœ‰ç”¨çš„åˆ«å:`$PROCESS_ID`å’Œ`$PID`ã€‚

è¿™æ˜¯ä¸€ä»¶éå¸¸å°çš„äº‹æƒ…ï¼Œä½†æˆ‘è®¤ä¸ºè¿™æ˜¯ Matz æœ€åˆçš„ Ruby ç›®æ ‡çš„å®Œç¾ä¾‹å­ï¼Œå³åˆ›å»ºä¸€ç§é¦–å…ˆè¢«äººç±»ç†è§£ï¼Œç„¶åè¢«è®¡ç®—æœºç†è§£çš„è¯­è¨€ã€‚

è‹±è¯­æä¾›äº†ä¸€äº›åˆ«åã€‚å¦ä¸€ä¸ªæœ‰ç”¨çš„æ˜¯`$CHILD_STATUS`ï¼Œå®ƒå°†è¿”å›æœ€åä¸€ä¸ª shell å‘½ä»¤çš„é€€å‡ºä»£ç :

```
$> `exit 42`
=> ""

$> $CHILD_STATUS   # or $? for the purists
=> #<Process::Status: pid 25566 exit 42> 
```

# [](#prime)è´¨æ•°

å¦‚æœä½ éœ€è¦è´¨æ•°æ¨¡å—ï¼ŒRuby å¯ä»¥å‘Šè¯‰ä½ ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯è´¨æ•°:

```
$> 5.prime?
=> true 
```

å¥½å§ï¼Œé…·ã€‚

ä½†æ˜¯æ‚¨çŸ¥é“å—ï¼ŒRuby æœ‰ä¸æ­¢ä¸€ä¸ªï¼Œä¸æ˜¯ä¸¤ä¸ªï¼Œè€Œæ˜¯ä¸¤ä¸ªåŠ*å®ç°æ¥ç¡®å®šä¸€ä¸ªæ•°çš„ç´ æ€§ï¼Ÿ

é¦–å…ˆæ˜¯`TrialDivision`ï¼Œè¿™æ˜¯ä¸€ç§è›®åŠ›æ–¹æ³•ï¼Œå°†æœ‰é—®é¢˜çš„æ•°å­—é™¤ä»¥å…¶ä»–æ›´å°çš„æ•°å­—ï¼Œç›´åˆ°å¾—åˆ°ç¡®å®šçš„ç­”æ¡ˆã€‚

è¿˜æœ‰`EratosthenesSieve`ï¼Œä½ å¯èƒ½ä»å®ƒçš„åå­—å°±èƒ½çŸ¥é“ï¼Œå®ƒæ˜¯ 2000 å¤šå¹´å‰ç”±ä¸€ä½å¸Œè…Šæ•°å­¦å®¶å‘æ˜çš„ã€‚çœŸä¸æ•¢ç›¸ä¿¡

```
$> Prime::EratosthenesGenerator.new.take(10)
=> [2, 3, 5, 7, 11, 13, 17, 19, 23, 29]

$> Prime.take(10)   # uses Eratosthenes under the hood, by default
=> [2, 3, 5, 7, 11, 13, 17, 19, 23, 29] 
```

*æœ€åï¼Œä¹Ÿå¯èƒ½æ˜¯æœ€å°‘çš„â€”â€”è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåªæœ‰ä¸¤ä¸ªåŠâ€”â€”æˆ‘ä»¬æœ‰`Generator23`ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ä¾‹å­ï¼Œå› ä¸ºå®ƒå®é™…ä¸Šå¹¶ä¸äº§ç”Ÿè´¨æ•°ï¼Œè€Œæ˜¯äº§ç”Ÿä¸èƒ½è¢« 2 æˆ– 3 æ•´é™¤çš„æ•°ã€‚è¿™æ˜¯æ•°å­¦å®¶å‘æ˜çš„ä¸€ä¸ªèªæ˜çš„ä¼˜åŒ–æ–¹æ³•ï¼Œä½¿éªŒè¯ç´ æ•°æ›´åŠ èŠ‚çœå†…å­˜ã€‚å› æ­¤ï¼Œ`#prime?`ä½¿ç”¨è¿™ä¸ªç”Ÿæˆå™¨å’Œä¸€äº›é¢å¤–çš„è®¡ç®—æ¥æ£€æŸ¥ç´ æ€§ã€‚

# [](#abbrev)Abbrev

è¿™å¯èƒ½æ˜¯æˆ‘åœ¨æ´ç©´æ¢é™©ä¸­å‘ç°çš„æœ€æ€ªå¼‚ã€æœ€å¥‡å¦™çš„æ¨¡å—ã€‚æ ¹æ®æ–‡çŒ®è®°è½½ï¼Œ`Abbrev`:

> è®¡ç®—ç»™å®šå­—ç¬¦ä¸²é›†çš„å”¯ä¸€ç¼©å†™é›†ã€‚

æœ‰è¶£çš„...è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„ä½œç”¨:

```
$> require 'abbrev'
=> true

$> %w(ruby rules).abbrev
=> {
     "ruby"=>"ruby",
     "rub"=>"ruby",
     "rules"=>"rules",
     "rule"=>"rules",
     "rul"=>"rules"
   } 
```

ç»™`Abbrev`ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå®ƒä¼šç»™ä½ ä¸€ä¸ªæ•£åˆ—ï¼Œå…¶ä¸­é‚£äº›å•è¯å˜æˆäº†å€¼ï¼Œæ¯ä¸ªé”®éƒ½æ˜¯æ˜ç¡®å¼•ç”¨é‚£ä¸ªå•è¯çš„ä¸€ç§æ–¹å¼ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå› ä¸ºä¸¤ä¸ªå•è¯éƒ½ä»¥â€œruâ€å¼€å¤´ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦æŒ‡ä»£å…¶ä¸­ä¸€ä¸ªï¼Œæˆ‘ä»¬å¿…é¡»å˜å¾—æ›´å…·ä½“ã€‚

å¯ä»¥è¯´ï¼Œè¿™ä¸ªæ¨¡å—çš„ç”¨ä¾‹æ˜¯æœ‰é™çš„ï¼Œä½†å°½ç®¡å¦‚æ­¤ï¼Œå®ƒä»ç„¶æ˜¯ä¼˜é›…è€Œç²¾å½©çš„ã€‚æˆ‘å¾ˆå–œæ¬¢è¿™ç§æ•°æ®ç»“æ„:åˆ©ç”¨æ•£åˆ—çš„å”¯ä¸€é”®ï¼Œè®©å®ƒæŒ‡å‘åŸæ¥çš„å•è¯ï¼ŸğŸ‘ŒğŸ‘Œ

æˆ‘èƒ½æ‰¾åˆ°çš„`Abbrev`çš„å”¯ä¸€ç”¨æ³•æ˜¯åœ¨ [RDoc](https://docs.ruby-lang.org/en/2.1.0/RDoc/RI/Driver.html#method-i-expand_class) å’Œ[Ruby core](https://github.com/ruby/ruby/blob/trunk/tool/redmine-backporter.rb#L578)çš„ä¸€ä¸ªæ‚ä¸ƒæ‚å…«çš„è„šæœ¬ä¸­ï¼Œä½†æ˜¯æˆ‘æƒ³äººä»¬å¯ä»¥åœ¨éœ€è¦å‘½ä»¤è¡Œè‡ªåŠ¨å®Œæˆçš„äº‹æƒ…ä¸­å¾ˆå¥½åœ°ä½¿ç”¨å®ƒã€‚

æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥ç¼–å†™æ‚¨è‡ªå·±çš„æ˜ç¡®çš„æ˜µç§°ç”Ÿæˆå™¨ï¼

```
$> names = %w(Alex Amy Ayla Amanda)
$> names.abbrev.keys.select { |n| n.length > 2 }
=> ["Alex", "Ale", "Amy", "Ayla", "Ayl", "Amanda", "Amand", "Aman", "Ama"] 
```

ä»ç°åœ¨å¼€å§‹ï¼Œå«æˆ‘ Aleã€‚ğŸ»

# [](#last-but-not%C2%A0least)æœ€åï¼Œä½†å¹¶éæœ€ä¸é‡è¦...

æ‚¨å¯èƒ½å·²ç»åœ¨æŸä¸ªæ—¶å€™ä» Ruby ç¨‹åºå‘å‡ºäº† HTTP è¯·æ±‚ã€‚ä½ å¯èƒ½ç”¨è¿‡`Net::HTTP`(æˆ–è€…å¯èƒ½æ˜¯å¦ä¸€ä¸ªåœ¨å¼•æ“ç›–ä¸‹ä½¿ç”¨å®ƒçš„å®çŸ³)ã€‚

ä½†æ˜¯è®©æˆ‘é—®ä½ ä¸€ä¸ªé—®é¢˜â€”â€”ä½ æ›¾ç»å’Œ Ruby ä¸€èµ·æ£€æŸ¥è¿‡ä½ çš„ç”µå­é‚®ä»¶å—ï¼Ÿ

ğŸ¥ ğŸ¥ ğŸ¥

ä»‹ç»`Net::POP3`ï¼

æ²¡é”™ï¼Œä½ å¯ä»¥ä¸ç”¨ç¦»å¼€ IRB å°±å¯ä»¥æŸ¥çœ‹ä½ çš„ç”µå­é‚®ä»¶:

```
$> inbox = Net::POP3.new('pop.gmail.com')
=> #<Net::POP3 pop.gmail.com: open=false>

$> inbox.start('your-email-here@gmail.com', 'supersecret')
=> #<Net::POP3 pop.gmail.com: open=true>

$> inbox.each_mail { |m| puts m.pop.split("\n").grep(/Subject/) }
Subject: Hello IRB!

$> pop.finish
=> "+OK Farewell." 
```

[![i â¤ ruby](../Images/1b58348a8e9e443e4a20e29885c5c0fa.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--14HBEKAJ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/1z981ve69x30b7wq3w47.png)

# [](#conclusion)ç»“è®º

å¤šå¥½çš„æ—…ç¨‹å•Šï¼æˆ‘å¸Œæœ›æˆ‘å·²ç»ç”¨ä½ æ‰€çŸ¥é“å’Œå–œçˆ±çš„è¯­è¨€æ‰“å¼€äº†ä½ çš„æ€ç»´ï¼Œè®©ä½ æœ‰äº†ä¸€äº›æ–°çš„å¯èƒ½æ€§ã€‚æˆ‘ç¡®å®å­¦åˆ°äº†å¾ˆå¤šï¼ŒæŒ–æ˜ Ruby çš„è¿™äº›æ€ªå¼‚ã€å¸ƒæ»¡ç°å°˜çš„è§’è½åªä¼šè®©æˆ‘æ›´åŠ çƒ­çˆ±å®ƒã€‚â¤ï¸

æœ‰æ²¡æœ‰å‘ç°å…¶ä»–å¥½ç©çš„ Ruby æ¨¡å—ï¼Œæˆ–è€…èƒ½æƒ³åˆ°`Abbrev`çš„å¦ä¸€ç§ç”¨é€”ï¼Ÿè®©æˆ‘çŸ¥é“ï¼