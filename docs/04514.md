# å®‰è£…ç†Šæ™ºå¨Ÿä½œä¸º Mailchimp-2019 ç‰ˆæœ¬ 4 æ›´æ–°çš„æ›¿ä»£å“ï¼Œå®Œæ•´æŒ‡å—ï¼ŒåŒ…å«â€¦

> åŸæ–‡ï¼š<https://dev.to/lexjacobs/installing-sendy-as-a-replacement-for-mailchimp-2019-version-4-update-the-complete-guide-with-49oc>

### å®‰è£…ç†Šæ™ºå¨Ÿä½œä¸º Mailchimp-2019 ç‰ˆæœ¬ 4 æ›´æ–°çš„æ›¿ä»£å“ï¼Œå®Œæ•´æŒ‡å—ï¼Œè‡ªåŠ¨å¤‡ä»½åˆ° S3ï¼Œä»¥åŠ https é…ç½®

#### è¿™äº›ä¿¡æ¯æ˜¯ä»è®¸å¤šæ¥æºæ”¶é›†çš„ï¼Œæ˜¯æˆ‘æˆåŠŸå®‰è£…çš„å®Œæ•´è®°å½•ã€‚ä»è¿™é‡Œå¼€å§‹å¯ä»¥èŠ‚çœè‡ªå·±å¾ˆå¤šæ—¶é—´ã€‚

### æ‚¨æ­£åœ¨é˜…è¯»çš„å®‰è£…æŒ‡å—æ˜¯é’ˆå¯¹ç†Šæ™ºå¨Ÿç‰ˆæœ¬ 4 çš„ã€‚å®ƒåœ¨ç†Šæ™ºå¨Ÿç‰ˆæœ¬ 4.0.2 ä¸Šè¿›è¡Œäº†æµ‹è¯•ï¼Œä½¿ç”¨äº†æ•°å­—æµ·æ´‹ä¸Šå¯ç”¨çš„æœ€æ–°æœåŠ¡å™¨é…ç½®

ç¬¬ 3 ç‰ˆå®‰è£…æŒ‡å—[åœ¨æˆ‘ä¹‹å‰çš„æ–‡ç« ](https://dev.to/lexjacobs/installing-sendy-as-a-replacement-for-mailchimp2019-update-the-complete-guide-with-automated-3359)ä¸­æœ‰æ¦‚è¿°ã€‚é™¤äº†åœ¨ 3.1.2.3 ç‰ˆæœ¬ä¸Šæµ‹è¯•ä¹‹å¤–ï¼Œå®ƒå‡ ä¹ä¸æœ¬å®‰è£…æŒ‡å—ç›¸åŒ

### å˜é©çš„ä»‹ç»å’ŒåŠ¨æœº

æˆ‘åœ¨ Mailchimp ä¸Šæœ‰ä¸€ä¸ªæ–°éŸ³ä¹å‘å¸ƒé‚®ä»¶åˆ—è¡¨ï¼Œç”¨æ¥å‘é€ä¸ç»å¸¸æ›´æ–°çš„å†…å®¹ã€‚æˆ‘ä»æƒ¨ç—›çš„æ•™è®­ä¸­äº†è§£åˆ°ï¼Œå¦‚æœä¸€ä¸ªåŸºæœ¬å¸æˆ·ä¸¤å¹´æ²¡ç”¨ï¼Œå®ƒå°±ä¼šè¢«åˆ é™¤ï¼Œæ—§çš„ç”¨æˆ·åä¼šè¢«æ°¸ä¹…å±è”½ã€‚åˆšåˆšè’¸å‘äº†ã€‚åˆ é™¤å‰æ²¡æœ‰å‘é€é€šçŸ¥ï¼Œä¹Ÿæ²¡æœ‰ç®€å•çš„æ–¹æ³•æ¥è·å–å–æ¶ˆè®¢é˜…çš„æ•°æ®ã€‚Mailchimp çš„åˆè§„éƒ¨é—¨ç§°ï¼Œè¿™æ˜¯ä¸€é¡¹â€œå®‰å…¨æªæ–½â€ã€‚æˆ‘ä»ç„¶ä¿ç•™äº†åŸå§‹è®¢é˜…è€…é‚®ä»¶çš„å¤‡ä»½ï¼Œä½†æ²¡æœ‰è¿™äº›å¹´æ¥ä¹‹å‰å–æ¶ˆè®¢é˜…æˆ‘çš„åå•çš„é‡è¦è®°å½•ã€‚å› æ­¤ï¼Œè™½ç„¶æˆ‘å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨ Mailchimp æˆ–å¦ä¸€ä¸ªä¸»æœºé‡æ–°å¯¼å…¥æˆ‘çš„åˆ—è¡¨ï¼Œä½†å‘è¿‡å»å–æ¶ˆè®¢é˜…çš„äººå‘é€ç”µå­é‚®ä»¶ä¼šæœ‰â€œåƒåœ¾é‚®ä»¶å‘é€è€…é»‘åå•â€çš„é£é™©ã€‚

[![](img/7e31b26d2f6a571c42ecd2715d89408c.png)](https://cdn-images-1.medium.com/max/863/1*knqBax8wtKF8vVcupLhqGg.jpeg)

åœ¨ç»å†äº†å®¢æˆ·æœåŠ¡çš„é‡é‡å›°éš¾åï¼Œæˆ‘èƒ½å¤Ÿå¯¼å‡ºæˆ‘ä»¥å‰æ‰€æœ‰çš„ Mailchimp æ•°æ®ï¼Œä½†æˆ‘ç¡®ä¿¡æ‰¾åˆ°è¡Œä¸šå·¨å¤´çš„æ›¿ä»£äº§å“æ›´æœ‰æ„ä¹‰ï¼Œä¾‹å¦‚:Mailchimpã€Sparkpostã€ActiveCampaignã€AWeber æˆ– Emmaã€‚

å¹¸è¿çš„æ˜¯ï¼Œæˆ‘æœ€è¿‘æµè§ˆäº†éŸ¦æ–¯Â·åšæ–¯(Wes Bos)çš„ç½‘ç»œå¼€å‘åšå®¢æ–‡ç« ï¼Œæƒ³èµ·äº†å¼•äººæ³¨ç›®çš„æ ‡é¢˜â€œä» MailChimp åˆ°ç†Šæ™ºå¨Ÿâ€”â€”æˆ‘å¦‚ä½•åœ¨æˆ‘çš„ç”µå­é‚®ä»¶åˆ—è¡¨ä¸Šæ¯å¹´èŠ‚çœ 2400 ç¾å…ƒâ€ã€‚ç”±äºæˆ‘çš„ç”µå­é‚®ä»¶åˆ—è¡¨ç›¸å¯¹è¾ƒå°ï¼Œè¿™ç§å˜åŒ–ä¸æ˜¯ä¸ºäº†çœé’±ï¼Œè€Œæ˜¯ä¸ºäº†ä¿å­˜æˆ‘è‡ªå·±çš„åˆ—è¡¨ï¼Œä»¥é¿å…å¦ä¸€ä¸ªæ„å¤–çš„å¸æˆ·åˆ é™¤æˆ–å…¶ä»–ä¸æ— æ³•æ§åˆ¶æˆ‘è‡ªå·±çš„æ•°æ®ç›¸å…³çš„é—®é¢˜ã€‚éŸ¦æ–¯çš„æ–‡ç« è¯´æœæˆ‘å»çœ‹çœ‹ç†Šæ™ºå¨Ÿã€‚è¿™æ˜¯ä¸€ä¸ªè‡ªæ‰˜ç®¡é‚®ä»¶åˆ—è¡¨è½¯ä»¶è§£å†³æ–¹æ¡ˆã€‚ä½†æ˜¯ä»–çš„æ–‡ç« æ²¡æœ‰æè¿°å¦‚ä½•å®‰è£…å®ƒã€‚

è´­ä¹°åï¼Œé€šè¿‡äº§å“æ”¯æŒè®ºå›æ¢³ç†ï¼Œçœ‹èµ·æ¥ DigitalOcean æ˜¯ä¸€ä¸ªåŸºäºä»·æ ¼å’ŒåŠŸèƒ½çš„ä¸»æœºæ‰˜ç®¡çš„ä¼Ÿå¤§é€‰æ‹©ã€‚åœ¨é˜…è¯»å¤§é‡æ–‡æ¡£å’Œå †æ ˆæº¢å‡ºå¸–å­æ—¶ï¼Œ

> æˆ‘åœ¨å®‰è£…è¿‡ç¨‹ä¸­åšäº†è¯¦ç»†çš„ç¬”è®°ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥å®Œæ•´è¯¦ç»†åœ°è®°å½•ä¸‹è·å¾—ç†Šæ™ºå¨Ÿè¿è¡Œå®ä¾‹çš„æ­¥éª¤ã€‚

æˆ‘è¿˜å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨å…è´¹çš„ Certbot è¯ä¹¦æ¥ä¿æŠ¤ç†Šæ™ºå¨ŸæœåŠ¡å™¨ä¸ T2 HTTPS çš„æµé‡ï¼Œå¹¶ä»¥æ‚¨é€‰æ‹©çš„é¢‘ç‡è®¾ç½®è‡ªåŠ¨ mysql æ•°æ®åº“å¤‡ä»½åˆ° S3 çš„é¢‘ç‡ã€‚

### å¦‚ä½•â€”ä»è¿™é‡Œå¼€å§‹

*   [ç‚¹å‡»æ­¤å¤„](https://sendy.co/?ref=vvD4p)é˜…è¯»å¹¶å‘å¼€å‘å•†è´­ä¹°ç†Šæ™ºå¨Ÿã€‚
*   å¦‚æœæ‚¨è¿˜æ²¡æœ‰ DigitalOcean çš„å¸æˆ·ï¼Œ[é€šè¿‡æ­¤é“¾æ¥](https://m.do.co/c/c29fea8989aa)æ³¨å†Œå°†è·å¾— 100 ç¾å…ƒçš„å…è´¹ä¿¡ç”¨ç‚¹æ•°ï¼Œå¯ä½¿ç”¨ 60 å¤©ä»¥ä¸Šã€‚
*   ä½ éœ€è¦ä¸€ä¸ª AWS è´¦æˆ·ã€‚

æ—¢ç„¶ç†Šæ™ºå¨Ÿçš„å¼€å‘å•†è¯´â€œå¦‚æœä¸æˆåŠŸï¼Œæˆ‘ä»¬ä¼šé€€è¿˜ä½ â€ï¼Œä½ å¯ä»¥å°è¯•è¿™æ•´ä¸ªå®éªŒï¼Œæ²¡æœ‰è´¢åŠ¡é£é™©ã€‚æˆ‘ç”¨æ¯æœˆ 5 ç¾å…ƒçš„æ ‡å‡†æ¶²æ»´å»ºç«‹äº†æˆ‘çš„ç†Šæ™ºå¨Ÿè£…ç½®ã€‚å”¯ä¸€çš„å…¶ä»–è´¹ç”¨æ˜¯äºšé©¬é€Š SES ç”µå­é‚®ä»¶ï¼Œæ¯åƒå°ç”µå­é‚®ä»¶**0.10 ç¾å…ƒ**ï¼Œä»¥åŠä½ åœ¨ç†Šæ™ºå¨Ÿè´­ä¹°è½¯ä»¶çš„ä¸€æ¬¡æ€§è´¹ç”¨**ï¼Œåœ¨ä¸»è¦ç‰ˆæœ¬æ›´æ–°ä¹‹å‰æ²¡æœ‰é¢å¤–è´¹ç”¨ã€‚**

 **#### å‘Šè¯«

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å†ä¹Ÿä¸ä¼šç”¨â€œç®€å•â€è¿™ä¸ªè¯äº†ã€‚ä½†æ˜¯æˆ‘ç›¸ä¿¡éµå¾ªè¿™ä¸ªæŒ‡å—ä¼šè®©ä½ çš„å®‰è£…è¿‡ç¨‹å°½å¯èƒ½çš„ç®€å•ã€‚

æˆ‘å»ºè®®å…ˆæµè§ˆä¸€ä¸‹ï¼Œç„¶åæŒ‰ç…§æ˜¾ç¤ºçš„é¡ºåºæ‰§è¡Œæ­¥éª¤ã€‚ç¡®ä¿ä½ æœ‰å¤šä½™çš„å¤´å‘ä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚

> æˆ‘æŒ‰ç…§å¹¶éªŒè¯äº†æˆ‘åœ¨è¿™é‡Œè®°å½•çš„æ‰€æœ‰è¯´æ˜ï¼Œé‡æ–°å®‰è£…äº†ç†Šæ™ºå¨Ÿã€‚

å”¯ä¸€ä¸å˜çš„æ˜¯å˜åŒ–ï¼Œä½ å¯èƒ½ä¼šå‘ç°è‡ªå·±éœ€è¦ç»å†ä¸€äº›æ„æƒ³ä¸åˆ°çš„å›°éš¾ï¼Œå°±åƒæˆ‘åœ¨æœ€åˆçš„å®‰è£…è¿‡ç¨‹ä¸­æ‰€åšçš„é‚£æ ·ã€‚å¸Œæœ›æˆ‘è®°å½•çš„ä¸€åˆ‡å¯¹ä½ æ¥è¯´éƒ½æ˜¯æœ€æ–°çš„å’Œæœ‰ç”¨çš„ã€‚å¦‚æœä½ å‘ç°æœ‰ä»€ä¹ˆæ”¹å˜ï¼Œè¯·åœ¨è¯„è®ºä¸­æè¿°ï¼Œæˆ‘ä¼šç›¸åº”åœ°æ›´æ–°ã€‚

æˆ‘ç‰¹åˆ«ç¡®ä¿å®æ–½ä¸€ä¸ªç¬¦åˆç°ä»£æ ‡å‡†çš„è´¨é‡æŒ‡å—ï¼Œç¡®ä¿ä½¿ç”¨ä¸€äº›å†·ç¬‘è¯ï¼Œè‡³å°‘ä¸€ä¸ªç§‘å¹»ç”µå½±å‚è€ƒï¼Œå¶å°”æ’å…¥è¡¨æƒ…ç¬¦å·ã€‚ä½œä¸ºé¢å¤–çš„å¥–åŠ±ï¼Œæˆ‘åœ¨æ•´ä¸ªæŒ‡å—ä¸­ä½¿ç”¨äº†ç¤ºä¾‹åŸŸ[www.contoso.com](http://www.contoso.com)ã€‚æˆ‘è¿˜è®°å½•äº†å®é™…çš„å¯†é’¥/ç§˜å¯†ï¼Œä»¥åŠæˆ‘åœ¨è®¾ç½®æ—¶ä½¿ç”¨çš„ ip åœ°å€ï¼Œè¿™æ ·æ‚¨å°±ä¸ä¼šæœ‰é¢å¤–çš„å¿ƒç†è´Ÿæ‹…å»è¯•å›¾è§£æåƒã€‚

> æˆ‘ä»˜å‡ºäº†é¢å¤–çš„åŠªåŠ›æ¥æè¿°ä½ å¯èƒ½ä¼šé‡åˆ°çš„å„ç§åœºæ™¯ï¼ŒåŒæ—¶ä¹Ÿæè¿°äº†ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œè¿™æ ·å¦‚æœè‡ªä»æˆ‘è®°å½•äº†æˆ‘çš„è¿‡ç¨‹åæŸä¸ªæ­¥éª¤å‘ç”Ÿäº†å˜åŒ–ï¼Œä½ å°±èƒ½å¤Ÿåšå‡ºæ˜æ™ºçš„é€‰æ‹©ã€‚

**è¿™æ˜¯å®Œå…¨å¯è¡Œçš„**ï¼Œæ‰€ä»¥è¯·é˜…è¯»æœ¬æŒ‡å—ï¼Œçƒ­èº«ä½ çš„è°·æ­Œå°ç« ï¼Œ**æˆ‘ç¥ä½ å®‰è£…è¿‡ç¨‹é¡ºåˆ©ï¼**

æ¯éš”ä¸€æ®µæ—¶é—´æ·±å‘¼å¸ã€å–æ°´ã€å››å¤„èµ°èµ°å¯èƒ½ä¼šæœ‰å¸®åŠ©ã€‚

### æ–‡æ¡£çº¦å®š

åƒè¿™æ ·çš„å—ä¸­çš„æ–‡æœ¬è¡¨ç¤ºæ‚¨åº”è¯¥é”®å…¥çš„å†…å®¹æˆ–åœ¨æµè§ˆå™¨é¡µé¢æˆ–ç»ˆç«¯æ˜¾ç¤ºä¸Šå¯è§çš„å†…å®¹ã€‚

```
Text inside a box like this represents the terminal display

$ This represents your local terminal (after $)

# This represents the remote shell (after #) 
```

### èˆªè¡Œæ•°å­—æµ·æ´‹:åˆ›å»ºä½ çš„æ°´æ»´(åŸºäºäº‘çš„è™šæ‹Ÿæœº)

ç™»å½•åˆ°æ‚¨çš„æ–°å¸æˆ·ï¼Œå¹¶éªŒè¯æ‚¨æœ‰å…è´¹çš„ 100 ç¾å…ƒä¿¡ç”¨ã€‚å¦‚æœæ‚¨æ˜¯æ–°å®¢æˆ·ï¼Œä½†æ‚¨æ²¡æœ‰é€šè¿‡æ¨èé“¾æ¥æ³¨å†Œï¼Œè¯·å‘å®¢æˆ·æœåŠ¡å‘é€ä¸€å°å¸¦æœ‰æ¨èé“¾æ¥çš„ç”µå­é‚®ä»¶ã€‚æ ¹æ®æˆ‘çš„ç»éªŒï¼Œä»–ä»¬ä¼šä¿¡ä»»ä½ çš„ã€‚æˆ‘åœ¨æ‰¾åˆ°å…¶ä»–äººçš„æ¨èé“¾æ¥åå°±æ³¨å†Œäº†ï¼Œå½“æˆ‘æŠŠå®ƒç”¨ç”µå­é‚®ä»¶å‘ç»™ä»–ä»¬æ—¶ï¼Œä»–ä»¬ç»™äº†æˆ‘ç§¯åˆ†ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªæ¨èé“¾æ¥ï¼Œè¿™é‡Œæ˜¯æˆ‘çš„:[https://m.do.co/c/c29fea8989aa](https://m.do.co/c/c29fea8989aa)

åˆ›å»ºæ–°çš„â€œé¡¹ç›®â€

[![](img/d955bdc640699fba23da8e3569305a9e.png)](https://cdn-images-1.medium.com/max/1024/1*D9a35tqzZqEbhA4Zxzh-ng.png)

ä¸‹ä¸€ä¸ªçª—å£å°†è¯¢é—®æ‚¨:**å°†èµ„æºç§»åŠ¨åˆ°æ–°é¡¹ç›®ä¸­ï¼Ÿ**ç‚¹å‡»**æš‚æ—¶è·³è¿‡**

[![](img/512a853bfb36e82a3c78d7eb6d280999.png)](https://cdn-images-1.medium.com/max/1010/1*ynuytaca0iVyMD8A9WS4MQ.png)

æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä½ çš„ dropletï¼Œæˆ‘å°†åœ¨ä¸‹é¢è¯¦ç»†è¯´æ˜è®¾ç½®:

[![](img/ac384cefd4fcfdcd2439e4e6ff02d6a9.png)](https://cdn-images-1.medium.com/max/536/1*Q86jeTB8V1ybHZy9XqvsEw.png)

å•å‡»è“è‰²æŒ‰é’®æˆ–ç»¿è‰²ä¸‹æ‹‰èœå•

[![](img/c5746b8fad8479e96a2712df410f7d95.png)](https://cdn-images-1.medium.com/max/628/1*eGpMmA8BWfLV859fdjy03w.png) 

<figcaption>ç‚¹å‡»æ°´æ»´ç„¶åæŒ‰ç…§ä¸‹é¢çš„è¯´æ˜è¿›è¡Œè®¾ç½®</figcaption>

ä¸‹ä¸€ç»„é€‰é¡¹æ˜¯é€‰æ‹©å›¾åƒ**ã€‚**é€‰æ‹©å¸‚åœº

[![](img/84951e10faea287a22ca8242124bb946.png)](https://cdn-images-1.medium.com/max/1024/1*3VSjcXhWM8vk2xyBYWhMNQ.png) 

<figcaption>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬æ‰“ç®—åœ¨ Ubuntu ä¸Šå®‰è£…ä¸€ä¸ªé¢„è£…çš„ç¯æ ˆ</figcaption>

åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒLAMP Marketplace åº”ç”¨ç¨‹åºçš„ç‰ˆæœ¬æ˜¯ 18.04ã€‚ç¼–å·æ˜¯ Ubuntu çš„ç‰ˆæœ¬(linux å‘è¡Œç‰ˆçš„å‘³é“)ã€‚æ›´æ–°çš„ç‰ˆæœ¬(æ›´é«˜çš„æ•°å­—)ï¼Œå¦‚æœå¯ç”¨ï¼Œ*å¯èƒ½ä¼š*å‘ˆç°ç±»ä¼¼çš„å®‰è£…ä½“éªŒã€‚å¦‚æœä½ æœ‰ä¸€äº›ä½¿ç”¨å‘½ä»¤è¡Œçš„ç»éªŒï¼Œå¹¶ä¸”ä¸æ€•è°·æ­Œæœç´¢ï¼Œé‚£å°±ç»§ç»­å®‰è£…æ–°ç‰ˆæœ¬å§ã€‚

[![](img/cfbe38831ae07b4bef9e27004552035a.png)](https://cdn-images-1.medium.com/max/738/1*7k8tRHKAVv_5GjINRWPN9w.png) 

<figcaption>æ’°å†™æ—¶æœ€æ–°å‘å¸ƒ</figcaption>

[![](img/60f19159bf415141c63277aec21ce90f.png)](https://cdn-images-1.medium.com/max/1024/1*bLVE0BbvCK4_J8Kfo_hwsQ.png) 

<figcaption>é€‰æ‹©æ ‡å‡†è®¡åˆ’</figcaption>

[![](img/86e9e49cba93b0c73ffaedaa2843cb9b.png)](https://cdn-images-1.medium.com/max/104/1*Fbiab4msR040mKAqbDitGg.png) 

<figcaption>é€‰æ‹©å·¦ç®­å¤´æŸ¥çœ‹æ›´å°çš„æ¶²æ»´å°ºå¯¸</figcaption>

[![](img/976b079b3452d97619f53d6a80539e30.png)](https://cdn-images-1.medium.com/max/372/1*4IaZyR9JWf9fpywsIuFxTg.png)

é€‰æ‹©ä¸€ä¸ªå°ºå¯¸ã€‚å¯¹äºæˆ‘ç›®å‰å¾®ä¸è¶³é“çš„é‚®ä»¶åˆ—è¡¨ï¼Œæˆ‘å¯¹æ ‡å‡†è®¡åˆ’å’Œæœ€å°å°ºå¯¸çš„è™šæ‹Ÿæœºå¾ˆæœ‰ä¿¡å¿ƒï¼Œæˆ‘é€‰æ‹©äº† 5 ç¾å…ƒ/æœˆã€‚å°†æ¥ï¼Œæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„æ„æ„¿æ‰©å±• cpu/ramã€‚æ‚¨å¯ä»¥æ‰©å¤§ç£ç›˜å¤§å°ï¼Œä½†ä¸èƒ½å†æ¬¡ç¼©å°ã€‚

**æ·»åŠ å¤‡ä»½ï¼Ÿ**æˆ‘é€‰æ‹©ä¸è¿™æ ·åšï¼Œå› ä¸ºæ‚¨å¯ä»¥åˆ¶ä½œå’Œå­˜å‚¨æ‰‹åŠ¨å¿«ç…§ã€‚ä½†æ˜¯ï¼Œåœ¨ä¸€ä¸ªæ¯æœˆ 5 ç¾å…ƒçš„å®¹å™¨ä¸Šè‡ªåŠ¨å¤‡ä»½åªä¼šèŠ±è´¹æ‚¨æ¯æœˆ 1 ç¾å…ƒï¼Œå› æ­¤æ‚¨å¯ä»¥é€‰æ‹©è¿™æ ·åšï¼Œä»¥ä¾¿ä¸å¿…è®°ä½åˆ¶ä½œå¿«ç…§ã€‚

**æ·»åŠ å—å­˜å‚¨ï¼Ÿ**æœ¬æ•™ç¨‹ä¸éœ€è¦

**é€‰æ‹©ä¸€ä¸ªæ•°æ®ä¸­å¿ƒåŒºåŸŸã€‚**æˆ‘é€‰æ‹©äº†çº½çº¦ã€‚æ ¹æ®æ‚¨å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼Œæ‚¨å¯èƒ½æœ‰åœ¨ç‰¹å®šåŒºåŸŸæ‰˜ç®¡æ•°æ®çš„æ³•å¾‹ä¹‰åŠ¡ï¼Œå› æ­¤è¯·åšå‡ºç›¸åº”çš„é€‰æ‹©ã€‚

[![](img/b368363316306c09adf33be5fbfdca28.png)](https://cdn-images-1.medium.com/max/704/1*Dqt8lg6sfrdtGHuNCqx8Gg.png)

**é€‰æ‹©é™„åŠ é€‰é¡¹ï¼Ÿ**æˆ‘æ²¡æœ‰å‹¾é€‰æ‰€æœ‰è¿™äº›é€‰é¡¹

æ·»åŠ æ‚¨çš„ SSH å¯†é’¥ã€‚æˆ‘æ²¡æœ‰è¿™æ ·åšï¼Œå› æ­¤å½“æˆ‘é€šè¿‡ SSH ç™»å½•æ—¶ä½¿ç”¨å¯†ç ã€‚åˆå§‹ root å¯†ç é€šè¿‡ç”µå­é‚®ä»¶å‘é€ã€‚æœ¬æ•™ç¨‹è®¨è®ºä½¿ç”¨å¯†ç ï¼Œæ‰€ä»¥ç°åœ¨è·³è¿‡è¿™ä¸€æ­¥ã€‚SSH å¯†é’¥å…è®¸æ‚¨ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œè€Œæ— éœ€ä½¿ç”¨å¯†ç è¿›è¡Œèº«ä»½éªŒè¯ã€‚

**å®Œæˆå¹¶åˆ›å»º**ã€‚ç¡®ä¿æ‚¨åªéƒ¨ç½²äº† 1 ä¸ª dropletï¼Œå¹¶å°†å…¶é‡å‘½åä¸º sane(å¦‚ä¸‹é¢æˆ‘çš„ä¾‹å­ä¸­çš„ sendy-droplet)ï¼Œå¹¶ç¡®ä¿å®ƒåœ¨æ‚¨æ–°åˆ›å»ºçš„â€œé¡¹ç›®â€ä¸­(å®ƒå°†æ˜¯ï¼Œé™¤éæ‚¨å·²ç»æœ‰å¤šä¸ªâ€œé¡¹ç›®â€)

[![](img/80f1edc2472bf87785a6426cd9dea8b0.png)](https://cdn-images-1.medium.com/max/1024/1*jSBpKlGDqx6tY-534KCtvg.png)

ç‚¹å‡»â€œåˆ›å»ºâ€æŒ‰é’®ã€‚ç„¶åä½ å°†è¢«é‡å®šå‘åˆ°ä½ çš„â€œé¡¹ç›®â€é¡µé¢ï¼Œå¹¶çœ‹åˆ°ä¸€ä¸ªä½ çš„ droplet åˆ›å»ºè¿›åº¦çš„çŠ¶æ€æ ã€‚éœ€è¦å‡ åˆ†é’Ÿã€‚

[![](img/f307f50f9a34bbffa5b36b6e6d9d087a.png)](https://cdn-images-1.medium.com/max/1024/1*Wy6kD5gCQd68DcSdaG9m3w.png)

æˆåŠŸåˆ›å»ºåï¼Œæ‚¨çš„ç™»å½•è¯¦ç»†ä¿¡æ¯å’Œå¯†ç å·²é€šè¿‡ç”µå­é‚®ä»¶å‘é€ç»™æ‚¨ã€‚

[![](img/f879fbc515d1e7e1fb0939d03436b5ce.png)](https://cdn-images-1.medium.com/max/1024/1*EPhslJl3aKANZwfRPe-Z9w.png)

æ­å–œä½ ï¼Œä½ çš„æ–°åˆ›é€ æ­£åœ¨äº‘ä¸­è¿è¡Œã€‚ç°åœ¨ï¼Œé€šè¿‡åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ ip åœ°å€æ¥æ‰§è¡Œå¥å…¨æ€§æ£€æŸ¥ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹å†…å®¹:

[![](img/794117148fb262b2447d8b51ef4c7c48.png)](https://cdn-images-1.medium.com/max/1024/1*bWamT-2YYLby1oJgLO6N3g.png)

â€œå¿«é€Ÿâ€å¯åŠ¨æŒ‡å—æŒ‰é’®[æŒ‡å‘æ•°å­—æµ·æ´‹ç½‘ç«™ä¸Šçš„è¿™ä¸ªæ–‡æ¡£](https://www.digitalocean.com/docs/one-clicks/lamp/#start)ï¼Œå®ƒè¯¦ç»†è¯´æ˜äº†æ‚¨çš„ä¸€é”®å®‰è£…åŒ…å«å“ªäº›è½¯ä»¶ï¼Œä»¥åŠä¸€äº›é…ç½®ä¿¡æ¯ã€‚

#### è®©æˆ‘ä»¬ç™»å½•æ–°çš„ droplet å¹¶è¿›è¡Œè®¾ç½®ï¼

æ‚¨å°†éœ€è¦åˆšåˆšä» DigitalOcean æ”¶åˆ°çš„ç”µå­é‚®ä»¶ï¼Œå…¶ä¸­åŒ…å«æ‚¨çš„ droplet çš„ root å¯†ç ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ **ssh** (å®‰å…¨å¤–å£³)ç™»å½•ã€‚

```
$ ssh root@157.230.133.78 
```

è¿æ¥å®ƒçš„å°†ä¼šæ˜¯ä»¥ä¸‹é€‚å½“çš„åæ‰§ä¿¡æ¯

```
The authenticity of host '157.230.133.78 (157.230.133.78)' can't be established.
ECDSA key fingerprint is SHA256:0U9apoBN+7h1ajk2+KZoYQiL35X4Zjp+9MQLC71mX7y.
Are you sure you want to continue connecting (yes/no)? 
```

æ‚¨ç¡®å®æƒ³ç»§ç»­è¿æ¥ï¼Œæ‰€ä»¥é”®å…¥ yesï¼Œç„¶åæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹å†…å®¹:

```
Warning: Permanently added '157.230.133.78' (ECDSA) to the list of known hosts.

root@157.230.133.78's password: 
```

å½“æ‚¨é”®å…¥æˆ–ç²˜è´´å¯†ç æ—¶ï¼Œç»ˆç«¯ä¸ä¼šæ˜¾ç¤ºæ‚¨è¾“å…¥çš„å­—ç¬¦ã€‚è¾“å…¥å¯†ç ï¼Œç„¶åæŒ‰å›è½¦é”®ï¼Œæ‚¨åº”è¯¥ç™»å½•å¹¶çœ‹åˆ°ä¸€äº›æ ·æ¿æ–‡æœ¬ï¼Œæè¿°æ‚¨çš„æœåŠ¡å™¨çš„ä¸€äº›é»˜è®¤é…ç½®ã€‚

ç³»ç»Ÿä¼šç«‹å³æç¤ºæ‚¨é‡ç½® root å¯†ç ã€‚é¦–å…ˆè¾“å…¥æ‚¨åˆšåˆšä½¿ç”¨çš„å½“å‰å¯†ç ã€‚ç„¶åè¾“å…¥ä¸€ä¸ªæ–°çš„å®‰å…¨å¯†ç ï¼Œä½ ç«‹å³è®°å½•åœ¨æŸä¸ªå®‰å…¨çš„åœ°æ–¹ã€‚ä½ éœ€è¦é©¬ä¸Šå†æ¬¡è¾“å…¥ä½ çš„æ–°å¯†ç æ¥ç¡®è®¤ï¼Œç„¶åä½ å°†ç™»å½•åˆ°ä½ çš„ dropletï¼Œä¸€ä¸ª Linux Ubuntu è™šæ‹Ÿæœºã€‚æ­£å¸¸çš„ pwd ls cd mkdir etc ç»ˆç«¯å‘½ä»¤å¦‚æ‚¨æ‰€é¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚

#### æ›´æ–°å¯ç”¨è½¯ä»¶åˆ—è¡¨

```
# apt-get update 
```

å°†æ›´æ–°å¯ç”¨è½¯ä»¶åŒ…åŠå…¶ç‰ˆæœ¬çš„åˆ—è¡¨ï¼Œä½†ä¸å®‰è£…æˆ–å‡çº§ä»»ä½•è½¯ä»¶åŒ…ã€‚å®ƒå°†åˆ›å»ºå¦‚ä¸‹æ‰€ç¤ºçš„è¾“å‡º:

```
Get:1 [http://security.ubuntu.com/ubuntu](http://security.ubuntu.com/ubuntu) bionic-security InRelease [83.2 kB]
Hit:2 [http://ppa.launchpad.net/certbot/certbot/ubuntu](http://ppa.launchpad.net/certbot/certbot/ubuntu) bionic InRelease

\*\*\*[Lots more stuff â€¦]\*\*\*

Get:37 http://mirrors.digitalocean.com/ubuntu bionic-backports/main Translation-en [448 B]
Get:38 http://mirrors.digitalocean.com/ubuntu bionic-backports/universe amd64 Packages [3468 B]
Fetched 14.0 MB in 5s (3035 kB/s)
Reading package lists... Done 
```

#### å‡çº§å¯ç”¨åŒ…

# apt-get å‡çº§

æ¥å—ç¡®è®¤æ¶ˆæ¯ï¼Œæ‚¨å°†è¢«æ›´æ–°åˆ°æ‰€æœ‰å·²å®‰è£…è½¯ä»¶åŒ…çš„æœ€æ–°ç‰ˆæœ¬ã€‚

#### å®‰è£…ä¸€äº›ç†Šæ™ºå¨Ÿéœ€è¦çš„æ–°è½¯ä»¶

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å‡ ä¸ªè½¯ä»¶åŒ…ï¼Œå®ƒä»¬ä¸å±äºé»˜è®¤çš„ä¸€é”®å¼å®‰è£…ï¼Œä½†æ˜¯ç†Šæ™ºå¨Ÿéœ€è¦ã€‚ç¬¬ä¸€ä¸ªæ˜¯ php-curl

#### ç¡®å®šä½ éœ€è¦å“ªä¸€ä¸ªç‰ˆæœ¬çš„ curl

```
php --version 
```

å°†è¿”å›ä¸€ç³»åˆ—è¾“å‡ºï¼ŒåŒ…æ‹¬å®‰è£…åœ¨æœåŠ¡å™¨ä¸Šçš„(major.minor.patch)ç‰ˆæœ¬ã€‚åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸‹ä¸€ä¸ªå‘½ä»¤ä¸­ä½¿ç”¨ 7.2.10ï¼Œä½†æ˜¯æˆ‘ä»¬åªéœ€è¦[major.minor]æ•°å­—ã€‚

```
# apt-get install php7.2-curl 
```

å¦‚æœä¸ç¡®å®šè¦å®‰è£…å“ªä¸ªç‰ˆæœ¬ï¼Œè¯·é”®å…¥# apt-get install php7ã€‚ç„¶åæŒ‰å‡ æ¬¡ tab é”®ï¼Œå°±å¯ä»¥çœ‹åˆ°æ‚¨æ­£åœ¨ä½¿ç”¨çš„ php ä¸»è¦ç‰ˆæœ¬çš„å„ç§è½¯ä»¶åŒ…çš„è‡ªåŠ¨å®Œæˆã€‚æˆ‘çš„æ˜¯ç”¨# apt-get install php7.2-curl è‡ªåŠ¨å®Œæˆçš„ï¼Œç„¶åæˆ‘ç‚¹å‡» enter å®‰è£…ï¼Œä¹Ÿæ¥å—äº†å¯èƒ½å¼¹å‡ºçš„ç¡®è®¤å¯¹è¯æ¡†ã€‚

ä¸‹é¢æ˜¯è¦å®‰è£…çš„ä¸‹ä¸€ä¸ª:

```
# apt-get install php-xml 
```

æ¥å—å¯èƒ½å¼¹å‡ºçš„ç¡®è®¤å¯¹è¯æ¡†ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é‡æ–°å¯åŠ¨ droplet çš„ web æœåŠ¡å™¨:

```
# systemctl restart apache2 
```

#### æ¥ä¸‹æ¥ï¼Œåˆ›å»ºæ–°çš„è™šæ‹Ÿä¸»æœºæ–‡ä»¶

> è™šæ‹Ÿä¸»æœºæ–‡ä»¶æ˜¯æŒ‡å®šæˆ‘ä»¬çš„è™šæ‹Ÿä¸»æœºçš„å®é™…é…ç½®çš„æ–‡ä»¶ï¼Œå¹¶æŒ‡ç¤º Apache web æœåŠ¡å™¨å°†å¦‚ä½•å“åº”å„ç§åŸŸè¯·æ±‚ã€‚

æˆ‘ä»¬éœ€è¦è®¾ç½®æœåŠ¡å™¨æ¥å“åº”æ‚¨åœ¨ä¸æ‚¨çš„åŸŸåæ³¨å†Œå•†åˆ›å»º DNS è®°å½•æ—¶å°†è¦åˆ†é…ç»™å®ƒçš„åŸŸåã€‚ç¤ºä¾‹:å¦‚æœæ‚¨è¿è¡Œç½‘ç«™[www.contoso.comï¼Œ](http://www.contoso.com,)å¹¶ä¸”æ‚¨è®¡åˆ’åœ¨ Sendy.contoso.com å®‰è£…ç†Šæ™ºå¨Ÿï¼Œé‚£ä¹ˆæ‚¨éœ€è¦åœ¨ droplet ä¸Šé…ç½® apache web æœåŠ¡å™¨ï¼Œä»¥ä¾¿åœ¨æ‚¨è®¿é—® sendy åŸŸæ—¶æä¾›é€‚å½“çš„æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶ä½äº/var/www/

#### ä¸ºè¦æœåŠ¡çš„æ–‡ä»¶åˆ›å»ºç›®å½•ç»“æ„

```
# mkdir -p /var/www/contoso.com/public\_html 
```

#### åˆ›å»ºæ–°çš„è™šæ‹Ÿä¸»æœºæ–‡ä»¶

è¿™äº›æ–‡ä»¶å‘Šè¯‰ Apache web æœåŠ¡å™¨å¦‚ä½•å“åº” web è¯·æ±‚ã€‚æˆ‘ä»¬å°†å¤åˆ¶å¹¶é…ç½®é»˜è®¤çš„ä¸»æœºæ–‡ä»¶(åä¸º 000-default.conf)ã€‚ä»¥ä¸‹ shell å‘½ä»¤æ˜¯ä¸€è¡Œ

```
# cp /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/contoso.com.conf 
```

ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨ nano æˆ– vim ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶ã€‚å¦‚æœæ‚¨ä»æœªä½¿ç”¨è¿‡ vimï¼Œæˆ‘ç°åœ¨ä¹Ÿä¸ä¼šå¼€å§‹ã€‚Nano ç›¸å½“ç”¨æˆ·å‹å¥½ï¼Œå“åº”ç®­å¤´é”®ç§»åŠ¨åœ¨å±å¹•ä¸Šç§»åŠ¨å…‰æ ‡ï¼Œå°±åƒä¸€ä¸ªç†Ÿæ‚‰çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚**ç¼–è¾‘å®Œæˆåï¼ŒæŒ‰** **æ§åˆ¶é”®å’Œ** **x é”®ä¸€èµ·ä¿å­˜æ–‡ä»¶å¹¶è¿”å›ç»ˆç«¯ã€‚**

```
# nano /etc/apache2/sites-available/contoso.com.conf 
```

å‡ºç°çš„æ–‡ä»¶åº”è¯¥ä»¥

```
<VirtualHost \*:80> 
```

ç»“å°¾æ˜¯

```
</VirtualHost> 
```

ä¸è¦å¤ªæ‹…å¿ƒä¸­é—´æœ‰ä»€ä¹ˆã€‚å®ƒå¯èƒ½ä¸æ‚¨åœ¨ä¸‹é¢çœ‹åˆ°çš„ç•¥æœ‰ä¸åŒã€‚

å…¶ä»–ä¸€åˆ‡éƒ½ä¿æŒåŸæ ·ã€‚æˆ‘ä»¬å°†åœ¨æ ‡ç­¾åæ·»åŠ ä¸€æ¡æŒ‡ä»¤(é…ç½®ä»£ç è¡Œ):

```
ServerName sendy.contoso.com 
```

å¹¶ä¿®æ”¹ä¸¤æ¡æŒ‡ä»¤(é…ç½®ä»£ç è¡Œ)ã€‚é¦–å…ˆï¼Œå°†æ–‡æ¡£æ ¹æŒ‡ä»¤æ”¹ä¸º:

```
DocumentRoot /var/www/contoso.com/public\_html 
```

ç„¶åä»å¦‚ä¸‹æ‰€ç¤ºçš„è¡Œä¸­åˆ é™¤å•è¯â€œIndexes â€:

```
Options Indexes FollowSymLinks 
```

å› æ­¤ï¼Œç¼–è¾‘åå®ƒçœ‹èµ·æ¥åƒè¿™æ ·:

```
Options FollowSymLinks 
```

ç„¶åè¿˜å°†æ ‡è®°å†…çš„æ–‡æœ¬ä¿®æ”¹ä¸º:

```
<Directory /var/www/contoso.com/public\_html/> 
```

æœ€ç»ˆç»“æœåº”è¯¥ç±»ä¼¼äºä¸‹é¢çš„å†…å®¹ã€‚ä¸è¦æ‹…å¿ƒæ‰€æœ‰å…¶ä»–è¡Œå®Œå…¨åŒ¹é…:

```
<VirtualHost \*:80>
        ServerName sendy.contoso.com
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/contoso.com/public\_html

        <Directory /var/www/contoso.com/public\_html/>
            Options FollowSymLinks
            AllowOverride All
            Require all granted
        </Directory>

        ErrorLog ${APACHE\_LOG\_DIR}/error.log
        CustomLog ${APACHE\_LOG\_DIR}/access.log combined

        <IfModule mod\_dir.c>
            DirectoryIndex index.php index.pl index.cgi index.html index.xhtml index.htm
        </IfModule>

</VirtualHost> 
```

è¿™æ˜¯æˆ‘çš„æ ·å­ï¼Œä½†æˆ‘æ­£åœ¨å®‰è£…ç†Šæ™ºå¨Ÿä½œä¸ºæˆ‘çš„ä¸ªäººç½‘ç«™åŸŸçš„å­åŸŸã€‚å¦‚æœæ‚¨è®¡åˆ’å°†ç†Šæ™ºå¨Ÿä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡å™¨è¿è¡Œ(ç±»ä¼¼äº [www.contoso.com)ï¼Œ](http://www.contoso.com)ï¼Œ)ï¼Œé‚£ä¹ˆæ‚¨çš„æœ€ç»ˆç»“æœåº”è¯¥æ˜¯:(æ³¨æ„é¢å¤–çš„æŒ‡ä»¤ ServerAlias)

```
################# WHEN NOT INSTALLING AS A SUBDOMAIN

<VirtualHost \*:80>
        ServerName contoso.com
        ServerAlias www.contoso.com
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/contoso.com/public\_html

        <Directory /var/www/contoso.com/public\_html/>
            Options FollowSymLinks
            AllowOverride All
            Require all granted
        </Directory>

        ErrorLog ${APACHE\_LOG\_DIR}/error.log
        CustomLog ${APACHE\_LOG\_DIR}/access.log combined

        <IfModule mod\_dir.c>
            DirectoryIndex index.php index.pl index.cgi index.html index.xhtml index.htm
        </IfModule>

</VirtualHost> 
```

å¦‚æœä½ ç”¨ nano ç¼–è¾‘äº†ï¼Œå½“ä½ ç”¨ control + x å†™å¹¶é€€å‡ºæ—¶ï¼Œä½ ä¼šç¡®è®¤ä¿å­˜ä¿®æ”¹è¿‡çš„ç¼“å†²åŒºå—ï¼Ÿç”¨ Y ç„¶åå†å›è½¦æ¥å—è¦å†™çš„æ–‡ä»¶åã€‚

#### æ¿€æ´»è™šæ‹Ÿä¸»æœºæ–‡ä»¶(å¹¶åœç”¨é»˜è®¤ä¸»æœºæ–‡ä»¶)

```
# a2ensite contoso.com.conf 
```

è¿™å°†æ˜¾ç¤ºä¸€äº›ç¡®è®¤æ¶ˆæ¯ï¼ŒåŒ…æ‹¬å…³äºé‡å¯ apache çš„é€šçŸ¥ã€‚æˆ‘ä»¬ä¸€ä¼šå„¿å°±å»åšã€‚

é¦–å…ˆï¼Œæ‚¨éœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœç”¨é»˜è®¤è™šæ‹Ÿä¸»æœºæ–‡ä»¶:

```
# a2dissite 000-default.conf 
```

è¿™ä¹Ÿå°†æ˜¾ç¤ºä¸€äº›ç¡®è®¤æ¶ˆæ¯ã€‚

æ­£å¦‚ç¡®è®¤æ¶ˆæ¯æ‰€è¿°ï¼Œç°åœ¨æ˜¯æ—¶å€™é‡æ–°åŠ è½½ Apache æœåŠ¡å™¨ä»¥å¯ç”¨æ–°çš„ Apache é…ç½®äº†ã€‚

#### é‡æ–°åŠ è½½ Apache æœåŠ¡å™¨

```
# systemctl reload apache2 
```

è¿™åªä¼šé‡æ–°åŠ è½½ Apache web æœåŠ¡å™¨ï¼Œæ‚¨åº”è¯¥ä¿æŒç™»å½•åˆ° shellã€‚

å¦‚æœæ‚¨ç°åœ¨è®¿é—®è¯¥ ip åœ°å€ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹å†…å®¹:

[![](img/10e9efa68484cf4e90ebd330cfc0df6e.png)](https://cdn-images-1.medium.com/max/852/1*0hyK-SBJ57KhFMVwE5io3A.png)

è¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚è¿™æ˜¯ä»æ ‡è®°å†…çš„ Options æŒ‡ä»¤ä¸­åˆ é™¤ç´¢å¼•çš„ç»“æœã€‚

**å¦‚æœæ‚¨çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:**â€¦

[![](img/8a69ccdba20a53f8b9ea2e45cc603771.png)](https://cdn-images-1.medium.com/max/676/1*4AApNkI--SlfhmnN8u5T1w.png)

â€¦ç„¶åé€‰é¡¹æŒ‡ä»¤æ²¡æœ‰æ­£ç¡®æ›´æ–°ã€‚æ£€æŸ¥ä¸Šé¢çš„è¯­æ³•ã€‚æ›´æ­£ä¹‹åï¼Œç”¨# systemctl reload apache2 é‡æ–°å¯åŠ¨ Apache

> å½“æ‚¨é‡æ–°åŠ è½½æµè§ˆå™¨æ—¶ï¼Œå®ƒåº”è¯¥ä¼šæ˜¾ç¤ºæ­£ç¡®çš„ç¦æ­¢æ¶ˆæ¯ã€‚è¿™å°†é˜²æ­¢å…¬ä¼—åœ¨ä½ å®‰è£…ç†Šæ™ºå¨Ÿåçª¥è§†ä½ çš„/uploads æ–‡ä»¶å¤¹ã€‚

#### å…³äº HTTPS äº¤é€šçš„ç‚¹æ»´

ç”±äºä¸€é”®å¼ droplet é¢„é…ç½®äº† Certbotï¼Œå› æ­¤åªéœ€å‡ ä¸ªå‘½ä»¤å°±å¯ä»¥é€šè¿‡ SSL ä¿æŠ¤æ‚¨çš„æœåŠ¡å™¨ç½‘ç»œæµé‡ã€‚ç„¶è€Œï¼Œ**åœ¨æˆ‘ä»¬ä¸ºæœåŠ¡å™¨ç”Ÿæˆè¯ä¹¦ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®åˆ°æœåŠ¡å™¨çš„ DNS è·¯ç”±ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬ä¸ºæ­£ç¡®çš„åŸŸç”Ÿæˆè¯ä¹¦ã€‚**è¯¦ç»†çš„ HTTPS è¯´æ˜å°†åœ¨åé¢ï¼Œé¦–å…ˆæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä¸ºæ‚¨çš„ droplet é…ç½®æ­£ç¡®çš„ DNS è®°å½•ã€‚

### DNS è·¯ç”±

ç™»å½•æ‚¨çš„åŸŸåæ³¨å†Œå•†ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€äº›æŒ‡å‘æ‚¨çš„æ–°æœåŠ¡å™¨çš„è®°å½•ã€‚

åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œå¯¹äºè¿™ä¸ªç¤ºä¾‹æœåŠ¡å™¨ï¼Œæˆ‘å°†ä¸ºæˆ‘çš„åŸŸå contoso.com çš„ DNS è®°å½•æ·»åŠ ä¸€ä¸ªæ–°è®°å½•ã€‚æˆ‘ä¼šåˆ›é€ ä¸€ä¸ª A è®°å½•ã€‚A åç§°è®°å½•åº”è¯¥æ˜¯:sendyï¼Œå€¼æ˜¯:157.230.133.78

æˆ‘åˆšåˆšç”¨æˆ‘çš„æ³¨å†Œå‘˜æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‡ åˆ†é’Ÿåæˆ‘çš„å­åŸŸè§£æåˆ°äº†æœåŠ¡å™¨ï¼Œæˆ‘çœ‹åˆ°äº†å’Œç›´æ¥è®¿é—® ip åœ°å€æ—¶ä¸€æ ·çš„å›¾åƒã€‚

å¦‚æœæ‚¨è®¡åˆ’å®‰è£…ä¸å¸¦å­åŸŸçš„ç‹¬ç«‹æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæ‚¨çš„â€œAâ€è®°å½•çš„åç§°å°†æ˜¯ wwwï¼Œå¹¶ä¸”æ‚¨å°†ä¸ºè£¸æ ¹åŸŸ(æœ¬ä¾‹ä¸­ä¸º contoso.com)åˆ›å»ºç¬¬äºŒä¸ªâ€œAâ€è®°å½•ã€‚ä¸åŒçš„æ³¨å†Œå•†æœ‰ä¸åŒçš„è¯­æ³•ï¼Œå¯èƒ½æ˜¯â€œ@â€ï¼Œæˆ–è€…æœ‰æ—¶åªæ˜¯ä¸€ä¸ªç©ºç™½å­—æ®µã€‚è¿™ä¸¤ä¸ªâ€œAâ€è®°å½•çš„å€¼å°±æ˜¯æ‚¨çš„ droplet çš„ ip åœ°å€ã€‚

ç†æƒ³æƒ…å†µä¸‹ï¼Œä¼ æ’­æ‚¨çš„ DNS æ›´æ”¹åªéœ€å‡ åˆ†é’Ÿã€‚æ„Ÿåˆ°ä¸è€çƒ¦æˆ–æ€€ç–‘å®ƒæ˜¯å¦æœ‰æ•ˆï¼Ÿçœ‹çœ‹è¿™ä¸ª(å¹¶ç”¨ä½ è‡ªå·±çš„åŸŸåæ›´æ–°):

```
[https://www.whatsmydns.net/#A/sendy.contoso.com](https://www.whatsmydns.net/#A/sendy.contoso.com) 
```

è¿™æ˜¯ä¸€ä¸ªéå¸¸é…·çš„èµ„æºï¼Œå®ƒå‘æ‚¨å±•ç¤ºäº† DNS ä¼ æ’­çš„çŠ¶æ€ã€‚æˆ‘çš„æ”¹å˜è®©å®ƒåœ¨å‡ åˆ†é’Ÿå†…ç¯æ¸¸äº†ä¸–ç•Œã€‚

### ç”¨è¯ä¹¦æœºå™¨äººå¯ç”¨ HTTPS SSP è¯ä¹¦å®‰è£…

ä½œä¸ºä¸€é”®å¼å®‰è£…çš„ä¸€éƒ¨åˆ†ï¼Œå·²ç»å®‰è£…äº†ä¸€ä¸ªåä¸º Certbot çš„è‡ªåŠ¨ SSL è¯ä¹¦ç”Ÿæˆå™¨ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»æ­£ç¡®è®¾ç½®äº†è™šæ‹Ÿä¸»æœºæ–‡ä»¶ï¼Œå¹¶ä¸”æ­£ç¡®é…ç½®äº† DNS è®°å½•ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œå®ƒäº†ã€‚

å¯¹äºæˆ‘çš„ç¤ºä¾‹æœåŠ¡å™¨ï¼Œæˆ‘åªéœ€è¦ä¸º sendy å­åŸŸç”Ÿæˆä¸€ä¸ªè¯ä¹¦ï¼Œä¸‹é¢æ˜¯æˆ‘å°†è¿è¡Œçš„å†…å®¹:

```
# certbot --apache -d sendy.contoso.com 
```

å¦‚æœæ‚¨æ˜¯ä¸ºç‹¬ç«‹çš„ç†Šæ™ºå¨Ÿå®‰è£…è¿è¡Œå®ƒï¼Œæ‚¨å°†å¦‚ä¸‹è¿è¡Œå®ƒ(å¯¹äº www å­åŸŸå’Œæ ¹åŸŸ):

```
# certbot --apache -d contoso.com -d [www.contoso.com](http://www.contoso.com) 
```

è¿è¡Œè¯¥å‘½ä»¤åï¼Œå°†ä¼šè¯¢é—®æ‚¨

```
Enter email address (used for urgent renewal and security notices) (Enter 'c' to cancel): 
```

æˆ‘ä¸ªäººè®¤ä¸ºè¾“å…¥ä¸€ä¸ªæ‚¨å®é™…æ£€æŸ¥çš„ç”µå­é‚®ä»¶åœ°å€æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ä¸»æ„ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥åœ¨è‡ªåŠ¨ SSL è¯ä¹¦æ›´æ–°è¿‡ç¨‹ä¸èµ·ä½œç”¨çš„æƒ…å†µä¸‹æ¥æ”¶é€šçŸ¥ã€‚å¦‚æœæ‚¨çš„è¯ä¹¦è¿‡æœŸï¼Œæµè§ˆä»¥å‰çš„å®‰å…¨ç«™ç‚¹å°†ä¸ä¼šæ˜¾ç¤ºæ‚¨çš„ç«™ç‚¹ï¼Œè€Œæ˜¯æ˜¾ç¤ºâ€œæ‚¨çš„è¿æ¥ä¸æ˜¯ç§äººçš„â€è­¦å‘Šé¡µé¢ã€‚

å¦‚æœæ‚¨é€‰æ‹©åœ¨æ²¡æœ‰ç”µå­é‚®ä»¶åœ°å€çš„æƒ…å†µä¸‹ç”Ÿæˆæ‚¨çš„è¯ä¹¦ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åœ¨æç¤ºç¬¦ä¸‹æŒ‰ c é”®åç»™å‡ºçš„å‘½ä»¤æ¥å®Œæˆã€‚

åœ¨è¿™ä¸€æ­¥ä¹‹åï¼Œæ‚¨å°†è·å¾—æœåŠ¡æ¡æ¬¾é“¾æ¥ï¼Œå¹¶è¦æ±‚æ‚¨åŒæ„ã€‚å¦‚æœæ‚¨åŒæ„ï¼Œå°†ä¼šè¯¢é—®æ‚¨æ˜¯å¦è¦ä¸ EFF å…±äº«æ‚¨çš„ç”µå­é‚®ä»¶åœ°å€ã€‚

å›ç­”è¿™ä¸ªé—®é¢˜åï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸²ä¸è¯•å›¾è®¿é—®æ‚¨çš„åŸŸçš„å®‰è£…ç¨‹åºç›¸å…³çš„è¾“å‡ºã€‚å¦‚æœæ‚¨çš„ DNS ä¼ æ’­å°šæœªå®Œæˆï¼Œæˆ–è€…æ‚¨è¾“å…¥ DNS è®°å½•çš„æ–¹å¼æœ‰é”™è¯¯ï¼Œæ­¤æ­¥éª¤å°†å¤±è´¥ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¾“å‡ºåº”è¯¥æ˜¯è¿™æ ·çš„:

```
root@sendy-droplet:~# certbot --apache -d sendy.contoso.com
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator apache, Installer apache
Obtaining a new certificate
Performing the following challenges:
http-01 challenge for sendy.contoso.com
Enabled Apache rewrite module
Waiting for verification...
Cleaning up challenges
Created an SSL vhost at /etc/apache2/sites-available/contoso.com-le-ssl.conf
Enabled Apache socache\_shmcb module
Enabled Apache ssl module
Deploying Certificate to VirtualHost /etc/apache2/sites-available/contoso.com-le-ssl.conf
Enabling available site: /etc/apache2/sites-available/contoso.com-le-ssl.conf

Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
1: No redirect - Make no further changes to the webserver configuration.
2: Redirect - Make all requests redirect to secure HTTPS access. Choose this for
new sites, or if you're confident your site works on HTTPS. You can undo this
change by editing your web server's configuration.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Select the appropriate number [1-2] then [enter] (press 'c' to cancel): 
```

æ­¤æ—¶ï¼Œç³»ç»Ÿä¼šè¯¢é—®æ‚¨æ˜¯å¦ä¹Ÿå¸Œæœ›å…è®¸ HTTP æµé‡åˆ°è¾¾æ‚¨çš„æœåŠ¡å™¨ï¼Œæˆ–è€…å°†å…¶é‡å®šå‘åˆ° HTTPSã€‚æˆ‘é€‰æ‹©äº† 2ï¼Œå¹¶è®©å®‰è£…ç¨‹åºåˆ›å»ºä¸€ä¸ªä» HTTP åˆ° HTTPS çš„é‡å®šå‘ã€‚å½“éœ€è¦é…ç½®ç†Šæ™ºå¨Ÿæ—¶ï¼Œæ‚¨å¯ä»¥æŒ‡å®šæ˜¯ä½¿ç”¨ HTTP è¿˜æ˜¯ HTTPSã€‚æ‚¨çš„ç†Šæ™ºå¨Ÿé…ç½®æ–‡ä»¶å¿…é¡»æŒ‡å®šå…¶ä¸­ä¸€ä¸ªã€‚

ä»¥ä¸‹æ˜¯å‰©ä½™çš„è¾“å‡º:

```
Enabled Apache rewrite module
Redirecting vhost in /etc/apache2/sites-enabled/contoso.com.conf to ssl vhost in /etc/apache2/sites-available/contoso.com-le-ssl.conf

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Congratulations! You have successfully enabled
https://sendy.contoso.com

You should test your configuration at:
https://www.ssllabs.com/ssltest/analyze.html?d=sendy.contoso.com
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/sendy.contoso.com/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/sendy.contoso.com/privkey.pem
   Your cert will expire on 2019-04-12\. To obtain a new or tweaked
   version of this certificate in the future, simply run certbot again
   with the "certonly" option. To non-interactively renew \*all\* of
   your certificates, run "certbot renew"
 - If you like Certbot, please consider supporting our work by:

Donating to ISRG / Let's Encrypt: [https://letsencrypt.org/donate](https://letsencrypt.org/donate)
   Donating to EFF: [https://eff.org/donate-le](https://eff.org/donate-le) 
```

å¦‚æœæ‚¨æƒ³å¯¹è¿™ç§å·¥ä½œæ–¹å¼æ„Ÿåˆ°æ›´åŠ å®‰å…¨ï¼Œè¯·ç»§ç»­å¹¶è·Ÿéšæµ‹è¯•ç«™ç‚¹çš„é“¾æ¥ï¼Œè¯¥é“¾æ¥æ˜¯åœ¨æ‚¨åº”è¯¥åœ¨:çŸ­è¯­ä¹‹åè¾“å‡ºçš„ã€‚å¯¹äºè¿™ä¸ªç½‘ç«™å°†:[https://www.ssllabs.com/ssltest/analyze.html?d=sendy.contoso.com](https://www.ssllabs.com/ssltest/analyze.html?d=sendy.contoso.com)

ç°åœ¨ï¼Œç”¨æµè§ˆå™¨åˆ·æ–°æˆ–å¯¼èˆªåˆ°æ‚¨çš„æœåŠ¡å™¨ url(è½¬åˆ°æ‚¨çš„ç«™ç‚¹ï¼Œå¦‚[https://www.contoso.comï¼Œ](https://www.contoso.com,)ä¸æ˜¯ ip åœ°å€)ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°:

[![](img/b611d0dbe23f5766bccba2032095a98a.png)](https://cdn-images-1.medium.com/max/172/1*8yQbWEAzfX2amtg6hxofwQ.png)T3ã€‘ğŸ’¥

æ‚¨çš„å®‰å…¨æœåŠ¡å™¨å·²å¯åŠ¨å¹¶è¿è¡Œï¼

è®©æˆ‘ä»¬æ¥çœ‹çœ‹ ssl ç«™ç‚¹çš„é…ç½®ã€‚conf æ–‡ä»¶ï¼Œå¹¶ç¡®ä¿å®ƒæ­£ç¡®åœ°å¤åˆ¶äº†åŸå§‹é ssl ç‰ˆæœ¬ä¸­çš„æŒ‡ä»¤ã€‚

```
# nano /etc/apache2/sites-available/contoso.com-le-ssl.conf 
```

åº”è¯¥ä¼šå¼¹å‡ºä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„é¡µé¢ã€‚æŸ¥çœ‹ ServerName / DocumentRoot å’Œ Directory æŒ‡ä»¤çœ‹èµ·æ¥æ˜¯å¦ç›¸ä¼¼ã€‚å¦å¤–ï¼ŒOptions ç›®å½•æ²¡æœ‰ Indexes å…³é”®å­—ã€‚å¦‚æœè¿™ä¸ªã€‚æ²¡æœ‰ä» http ç‰ˆæœ¬æ­£ç¡®å¤åˆ¶ conf æ–‡ä»¶ï¼Œæ‚¨å½“å‰å¤„äº nano ç¼–è¾‘å™¨ä¸­ï¼Œç°åœ¨å¯ä»¥è¿›è¡Œå¿…è¦çš„æ›´æ”¹ã€‚ç”¨ ctrl + x é€€å‡ºç¼–è¾‘å™¨ï¼Œæ‚¨å°†è¿”å›åˆ° ssh ç»ˆç«¯ã€‚

```
<IfModule mod\_ssl.c>
<VirtualHost \*:443>
        ServerName sendy.contoso.com
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/contoso.com/public\_html

        <Directory /var/www/contoso.com/public\_html/>
            Options FollowSymLinks
            AllowOverride All
            Require all granted
        </Directory>

        ErrorLog ${APACHE\_LOG\_DIR}/error.log
        CustomLog ${APACHE\_LOG\_DIR}/access.log combined

        <IfModule mod\_dir.c>
            DirectoryIndex index.php index.pl index.cgi index.html index.xhtml index.htm
        </IfModule>

SSLCertificateFile /etc/letsencrypt/live/sendy.contoso.com/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/sendy.contoso.com/privkey.pem
Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
</IfModule> 
```

æ¥ä¸‹æ¥æ˜¯ mysql æ•°æ®åº“çš„åˆå§‹åŒ–ï¼Œç„¶åå°†ç†Šæ™ºå¨Ÿä¸Šä¼ åˆ°ä½ çš„æœåŠ¡å™¨ã€‚

### å®‰è£…æ‚¨çš„ Mysql æ•°æ®åº“

æƒŠå–œâ€¦å·²ç»è£…å¥½äº†ã€‚æ¬¢è¿å†æ¬¡äº«å—ä¸€é”®å®‰è£…çš„å¿«ä¹ã€‚æˆ‘ä»¬åªéœ€è¦åˆ›å»ºç†Šæ™ºå¨Ÿæ•°æ®åº“ï¼Œä¸€ä¸ªæ•°æ®åº“ç”¨æˆ·/å¯†ç ï¼Œå¹¶æˆäºˆæ–°æ•°æ®åº“ç”¨æˆ·ä½¿ç”¨ç†Šæ™ºå¨Ÿæ•°æ®åº“çš„ç‰¹æƒã€‚

ä½¿ç”¨# mysql ç™»å½•åˆ° mysqlï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:

```
Welcome to the MySQL monitor. Commands end with ; or \g.
Your MySQL connection id is 2
Server version: 5.7.26-0ubuntu0.18.04.1 (Ubuntu)

Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> 
```

å¹¶åˆ›å»ºæ‚¨çš„ç†Šæ™ºå¨Ÿæ•°æ®åº“(ä¸è¦å¿˜è®°ï¼›åœ¨æœ«å°¾)

```
mysql> create database sendy; 
```

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°:

```
Query OK, 1 row affected (0.00 sec) 
```

ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå¸¦å¯†ç çš„æ•°æ®åº“ç”¨æˆ·ï¼Œå¹¶æˆäºˆä»–ä»¬ä½¿ç”¨ç†Šæ™ºå¨Ÿæ•°æ®åº“çš„æƒé™(è¿˜è®°å¾—ï¼›):

æƒ³å‡ºä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶å°†å…¶è®°å½•åœ¨å®‰å…¨çš„åœ°æ–¹ã€‚ä½ å¾ˆå¿«åˆä¼šéœ€è¦å®ƒçš„ã€‚

```
mysql> CREATE USER 'sendy\_db\_admin'@'localhost' IDENTIFIED BY '2zrQYe5NC8z2sw87TpC4SWDK'; 
```

å®ƒåº”è¯¥å“åº”:

```
Query OK, 0 rows affected (0.00 sec) 
```

ç°åœ¨æˆ‘ä»¬æˆäºˆä»–ä»¬ç‰¹æƒ(è®°ä½ï¼›ç»“å°¾):

```
mysql> GRANT ALL PRIVILEGES ON \*.\* TO 'sendy\_db\_admin'@'localhost'; 
```

åŒæ ·ï¼Œå®ƒåº”è¯¥å“åº”:

```
Query OK, 0 rows affected (0.00 sec) 
```

æˆ‘ä»¬çš„å·¥ä½œå·²ç»å®Œæˆäº†ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é€€å‡º mysql å‘½ä»¤è¡Œç•Œé¢

```
mysql> exit; 
```

ç»ˆç«¯ä¼šè¯´å†è§ã€‚ç°åœ¨ï¼Œæ‚¨åˆå›åˆ°äº† droplet ä¸­æç¤º root ç”¨æˆ·çš„åœ°æ–¹ã€‚

ç°åœ¨å·²ç»æœ‰äº†æ•°æ®åº“åã€æˆæƒç”¨æˆ·å’Œå¯†ç ï¼Œå¯ä»¥è®¾ç½®ç†Šæ™ºå¨Ÿé…ç½®æ–‡ä»¶äº†ã€‚

### è®¾ç½®æ‚¨çš„ç†Šæ™ºå¨Ÿé…ç½®æ–‡ä»¶

å‡è®¾æ‚¨å·²ç»è´­ä¹°å¹¶ä¸‹è½½äº†ç†Šæ™ºå¨Ÿï¼Œè§£å‹æ–‡ä»¶å¹¶åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­ç¼–è¾‘/includes/config.phpã€‚

è¿™æ˜¯æˆ‘ä»¬è¦ä¿®æ”¹çš„éƒ¨åˆ†:

```
/\* Set the URL to your Sendy installation (without the trailing slash) \*/

define('APP\_PATH', 'http://your\_sendy\_installation\_url');

 /\* MySQL database connection credentials (please place values between the apostrophes) \*/

$dbHost = ''; //MySQL Hostname
 $dbUser = ''; //MySQL Username
 $dbPass = ''; //MySQL Password
 $dbName = ''; //MySQL Database Name 
```

æœ¬æ•™ç¨‹ä¸­å®‰è£…çš„ç›¸å…³å€¼ä¸º:

```
/\* Set the URL to your Sendy installation (without the trailing slash) \*/

define('APP\_PATH', 'https://sendy.contoso.com');

 /\* MySQL database connection credentials (please place values between the apostrophes) \*/

$dbHost = 'localhost'; //MySQL Hostname
$dbUser = 'sendy\_db\_admin'; //MySQL Username
$dbPass = '2zrQYe5NC8z2sw87TpC4SWDK'; //MySQL Password
$dbName = 'sendy'; //MySQL Database Name 
```

ä¸ç®¡å…¶ä»–å€¼å¦‚ä½•ï¼Œâ€œlocalhostâ€éƒ½å°†æ˜¯ä¸»æœºåã€‚è¾“å…¥æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥ä¸­åˆšåˆšåˆ›å»ºçš„æ•°æ®åº“ç”¨æˆ·çš„ç”¨æˆ·å/å¯†ç ã€‚å¹¶è¾“å…¥æ‚¨åœ¨ä¸Šä¸€æ­¥ä¸­è¾“å…¥çš„æ•°æ®åº“åç§°ï¼Œåœ¨æ¼”ç¤ºä¸­æ˜¯â€œsendyâ€ã€‚

æ³¨æ„:ç”±äºæˆ‘ä»¬å®‰è£…äº† SSL è¯ä¹¦ï¼Œå› æ­¤â€œAPP_PATHâ€å€¼å·²è¢«è®¾ç½®ä¸º httpsï¼Œå¹¶ä¸”åœ¨ã€‚com

> å½“ä½ è´­ä¹°ç†Šæ™ºå¨Ÿçš„æ—¶å€™ï¼Œä½ æ˜¯å¦è¿›å…¥äº†ä¸€ä¸ªä¸åŒäºä½ å°†è¦ä½¿ç”¨çš„åŸŸåï¼Ÿæ²¡é—®é¢˜ï¼Œåªéœ€åœ¨æ‚¨çš„è´­ä¹°ç¡®è®¤ç”µå­é‚®ä»¶ä¸­å‘é€ç»™æ‚¨çš„â€œ**æ›´æ”¹æ‚¨çš„è®¸å¯åŸŸåâ€**é“¾æ¥ä¸­æ›´æ–°æ‚¨çš„åŸŸåå³å¯ã€‚æˆ‘è¿™æ ·åšè¿‡å‡ æ¬¡ï¼Œæ›´æ–°å¾ˆå¿«ã€‚

ç°åœ¨æ˜¯æ—¶å€™æŠŠç†Šæ™ºå¨Ÿä¸Šä¼ åˆ°ä½ çš„æœåŠ¡å™¨äº†ã€‚

### ä¸Šä¼ ç†Šæ™ºå¨Ÿåˆ°ä½ çš„æœåŠ¡å™¨

æ‚¨å¯ä»¥ä½¿ç”¨ sftp æˆ– rsyncã€‚Sftp å¯èƒ½æ›´ç›´è§‚ï¼Œæ–‡æ¡£ç›¸å¯¹ç®€å•ï¼Œæ‰€ä»¥æˆ‘å°†å±•ç¤º rsync çš„å‘½ä»¤ã€‚ä¸‹é¢çš„å‘½ä»¤å°†ä»ä¸€ä¸ªæ–°çš„ç»ˆç«¯çª—å£å‘å‡ºï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ä¸€ç›´ä½¿ç”¨çš„ ssh shellã€‚è¯¥å‘½ä»¤åº”è¯¥ä½œä¸ºä¸€è¡Œè¾“å…¥ã€‚ahrvz æ ‡å¿—è¡¨ç¤ºâ€œå½’æ¡£/äººç±»å¯è¯»/é€’å½’/è¯¦ç»†/å‹ç¼©â€ã€‚ç¬¬ä¸€ä¸ªæ–‡ä»¶å¤¹è·¯å¾„æ˜¯æ‚¨çš„æœ¬åœ°ç†Šæ™ºå¨Ÿæ–‡ä»¶å¤¹(è®°å¾—åŒ…æ‹¬å°¾éš/)ï¼Œç¬¬äºŒä¸ªä½ç½®æ˜¯æ‚¨çš„ droplet ä¸­çš„ DocumentRoot web content æ–‡ä»¶å¤¹ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨ä¹‹å‰ç¼–è¾‘çš„è™šæ‹Ÿä¸»æœºæ–‡ä»¶ä¸­æŒ‡å®šçš„ã€‚å‘å‡ºä»¥ä¸‹å‘½ä»¤åï¼Œç³»ç»Ÿä¼šæç¤ºæ‚¨æä¾› droplet root å¯†ç :

**é‡è¦æç¤º:ä»¥ä¸‹å‘½ä»¤å¿…é¡»åœ¨æ–°çš„ç»ˆç«¯çª—å£ä¸­è¾“å…¥ï¼Œè€Œä¸æ˜¯åœ¨æˆ‘ä»¬ä¸€ç›´ç”¨æ¥å‘æœåŠ¡å™¨å‘å‡ºå‘½ä»¤çš„ SSH shell ä¸­è¾“å…¥ï¼Œ(ç”±å‘½ä»¤å¼€å¤´çš„** **$æŒ‡å®š)**

```
$ rsync -ahrvz -e ssh /path/to/your/sendy/folder/ root@157.230.133.78:/var/www/contoso.com/public\_html/ 
```

éšåå°†è¿›è¡Œç¡®è®¤ï¼Œå¦‚:

```
root@157.230.133.78's password: 
```

åœ¨æ‚¨æˆåŠŸè¾“å…¥ root å¯†ç åï¼Œæ‚¨å°†ä¼šçœ‹åˆ°ä¸€ä¸ªå·¨å¤§çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«äº†å°†è¦ä¼ è¾“åˆ°æœåŠ¡å™¨çš„æ‰€æœ‰å†…å®¹ã€‚æ–‡ä»¶çš„åˆ—å‡ºé¡ºåºå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†åº”è¯¥ä»¥ç±»ä¼¼å¦‚ä¸‹çš„é¡ºåºå¼€å§‹:

```
root@157.230.133.78's password:
building file list ... done
./
.htaccess
\_compatibility.php
\_install.php
app.php
autoresponders-create.php
autoresponders-edit.php
autoresponders-emails.php 
```

ä»¥è¿™æ ·çš„è¯ç»“å°¾:

```
locale/en\_US/
locale/en\_US/LC\_MESSAGES/
locale/en\_US/LC\_MESSAGES/default.mo
locale/en\_US/LC\_MESSAGES/default.po
uploads/

sent 5.62M bytes received 18.78K bytes 1.00M bytes/sec
total size is 13.41M speedup is 2.38

$ 
```

**é‡è¦æç¤º:ç°åœ¨æˆ‘ä»¬å°†å†æ¬¡å‘æœåŠ¡å™¨å‘å‡º SSH shell å‘½ä»¤**

ä¸Šä¼ åï¼Œæ‚¨éœ€è¦ç¡®ä¿ä¸Šä¼ æ–‡ä»¶å¤¹çš„æƒé™æ­£ç¡®è®¾ç½®ä¸º 0777ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°

```
# chmod 0777 /var/www/contoso.com/public\_html/uploads/ 
```

ã€‚ä½ å¯ä»¥æ£€æŸ¥è¿™æ˜¯å¦æœ‰æ•ˆ

```
# ls -al /var/www/contoso.com/public\_html/uploads/ 
```

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹

```
total 8
drwxrwxrwx 2 501 staff 4096 Jan 12 00:25 .
drwxr-xr-x 10 501 staff 4096 Jan 12 04:31 .. 
```

é‡è¦çš„æƒé™ä½æ˜¯ä¸ä½äºåŒä¸€è¡Œçš„ drwxrwxrwxã€‚

å¦ä¸€è¡Œä¸çˆ¶æ–‡ä»¶å¤¹çš„æƒé™ç›¸å…³ã€‚

å¦‚æœåˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡éƒ½æŒ‰è®¡åˆ’è¿›è¡Œï¼Œå½“æ‚¨é‡æ–°åŠ è½½æŒ‡å‘æ–°æœåŠ¡å™¨çš„æµè§ˆå™¨æ—¶ï¼Œæ‚¨åº”è¯¥è¢«é‡å®šå‘åˆ°/_install.phpã€‚

å¦‚æœä½ çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼Œä½ æ­£èµ°åœ¨å¹¸ç¦çš„é“è·¯ä¸Š:

[![](img/c7599dbbdc667286a4db769683c72107.png)](https://cdn-images-1.medium.com/max/1024/1*awTDewELFa5RTx1Byemuig.png)T3ã€‘ğŸ’¥

å¦‚æœæ²¡æœ‰ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒã€‚æ‚¨ä¹Ÿå¯èƒ½ä¼šçœ‹åˆ°å¦‚ä¸‹å†…å®¹:

[![](img/79120ef4a2c7b36d9a0c0bac3d0aa4e7.png)](https://cdn-images-1.medium.com/max/1024/1*Ube6hCFODiaYytYoKu8K6Q.png)

ä¸ç”¨æ‹…å¿ƒï¼Œä¸ç®¡ç¼ºä»€ä¹ˆï¼Œéƒ½å¾ˆå®¹æ˜“æ”¹æ­£ã€‚æŒ‰ç…§è¯´æ˜ï¼Œæˆ‘ä»¬å¯¼èˆªåˆ°:/_compatibility.phpï¼Ÿi=1ï¼Œçœ‹çœ‹éœ€è¦å®‰è£…ä»€ä¹ˆã€‚ä½ çš„ç»“æœå¯èƒ½ç•¥æœ‰ä¸åŒï¼Œä½†å¦‚æœä½ ä»ä¸€å¼€å§‹å°±éµå¾ªè¿™ä¸ªæŒ‡å—ï¼Œå¯èƒ½ä¸ä¼šå¤ªå¤šã€‚

[![](img/ffb72e39283fc3e80eea5aa0a0dfaa06.png)](https://cdn-images-1.medium.com/max/818/1*Qkr327UIbw64Y5aPPpgoaQ.png)T3ã€‘ğŸ¤”

æ— è®ºé—æ¼äº†ä»€ä¹ˆï¼Œé€šè¿‡åœ¨æœç´¢æ¡†ä¸­è¾“å…¥é”™è¯¯æ¥æœç´¢æ”¯æŒè®ºå›:sendy.co/forum/ï¼Œæ‰¾å‡ºå¦‚ä½•è¡¥æ•‘å®ƒã€‚

åœ¨æœå¯»å®Œä»»ä½•å¯èƒ½çš„å‰©ä½™è½¯ä»¶åŒ…åï¼Œæ‚¨çš„æœåŠ¡å™¨å…¼å®¹æ€§æ¸…å•åº”è¯¥éƒ½æ˜¯ç»¿è‰²çš„ï¼Œå¾—åˆ†ä¸º 10/10ï¼Œå¯¼èˆªåˆ°æ‚¨çš„ç†Šæ™ºå¨Ÿ url åº”è¯¥ä¼šæ˜¾ç¤ºæ‚¨çš„ç™»å½•é¡µé¢â€¦

â€¦æˆ–è€…å¯èƒ½æ˜¯è¿™æ ·:

[![](img/866c0dd4f6a45786459d33f9aecdc96d.png)](https://cdn-images-1.medium.com/max/698/1*21Ax0plWOoaGJ-8xbuMWtg.png)T3ã€‘ğŸ˜¶

å¦‚æœè¿™æ˜¯æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæ‚¨éœ€è¦ç¡®ä¿æ‚¨åœ¨/includes/config.php ä¸­ä½œä¸º APP_PATH å˜é‡è¾“å…¥çš„åŸŸä¸æ‚¨å½“å‰ä½¿ç”¨æµè§ˆå™¨æŒ‡å‘çš„åŸŸç›¸åŒ¹é…ï¼Œå¹¶ä¸”æ˜¯æ‚¨åœ¨è´­ä¹°äº§å“æ—¶è¾“å…¥çš„åŸŸã€‚åŸŸçš„æ”¹å˜å¯ä»¥å¾ˆå®¹æ˜“åœ°å®Œæˆã€‚**è¯¥è¡¨æ ¼çš„é“¾æ¥åœ¨æ‚¨è´­ä¹°è½¯ä»¶**æ—¶æ”¶åˆ°çš„ç”µå­é‚®ä»¶ä¸­ã€‚åœ¨è¡¨å•ä¸­ï¼Œè¾“å…¥æ‚¨çš„è®¸å¯è¯å¯†é’¥ï¼Œå¹¶åœ¨â€œå°†åŸŸæ›´æ”¹ä¸ºâ€å­—æ®µä¸­è¾“å…¥æ›´æ–°çš„åŸŸã€‚å½“æ‚¨è¿›å…¥åŸŸæ—¶ï¼Œä¸éœ€è¦åœ¨å®ƒå‰é¢åŠ ä¸Š http(s )(è§ä¸‹æ–‡)ã€‚ç„¶è€Œï¼Œåœ¨ç†Šæ™ºå¨Ÿé…ç½®æ–‡ä»¶ä¸­å®šä¹‰ APP_PATHvariable æ—¶ï¼Œæ‚¨ç¡®å®éœ€è¦ http(s)://preambleã€‚

æˆ‘éœ€è¦åœ¨è¯¥è¡¨å•ä¸­è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼Œä»¥ä¾¿ç†Šæ™ºå¨Ÿèƒ½å¤Ÿä½¿ç”¨æ­¤å¤„çš„ç¤ºä¾‹:

[![](img/132a440048d62673da3dd9a0fd56294f.png)](https://cdn-images-1.medium.com/max/1024/1*vDgurnwxzJteeBkjnbqd0A.png)

å¯¹äºç†Šæ™ºå¨Ÿå…¶ä½™çš„è®¾ç½®ï¼Œæˆ‘æŠŠä½ ç•™ç»™å®˜æ–¹å…¥é—¨æ–‡æ¡£çš„å¾—åŠ›åŠ©æ‰‹ã€‚ä½ å¯ä»¥ä»ç¬¬äº”æ­¥å¼€å§‹ã€‚å…³äºå¦‚ä½•æ­£ç¡®è®¾ç½®æ‚¨çš„ Amazon Web Services IAM å‡­æ®ï¼Œä»¥åŠå¦‚ä½•æé«˜æ‚¨çš„ SES å‘é€é™é¢ï¼Œæœ‰ä¸€äº›éå¸¸é‡è¦çš„ä¿¡æ¯ã€‚å¯¹äºä¸€ä¸ªæ–°å¸æˆ·æ¥è¯´ï¼Œè¿™é€šå¸¸éœ€è¦*è‡³å°‘* 2 å¤©ï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨æ­£åœ¨æµè§ˆæœ¬æ–‡æ¡£å¹¶è®¡åˆ’åœ¨ä¸ä¹…çš„å°†æ¥å®‰è£…è¯¥è½¯ä»¶:

> æˆ‘å»ºè®®ä½ ç°åœ¨å°±å¤„ç†è¿™ä¸ªéƒ¨åˆ†ï¼Œè¿™æ ·å½“ä½ å‡†å¤‡å¥½å®‰è£…çš„æ—¶å€™ï¼Œä½ å°±ä¸éœ€è¦ç­‰å¾… AWS æ‰¹å‡†ä½ å¢åŠ çš„å‘é€é™åˆ¶ã€‚

æˆ‘å°†åˆ†äº«çš„ä¸€ä¸ªç›¸å…³æç¤ºæ˜¯ï¼Œå½“æ‚¨ç¬¬ä¸€æ¬¡ç™»å½•æ‚¨çš„ç†Šæ™ºå¨Ÿä»ªè¡¨ç›˜æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šçœ‹åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œ**å³ä½¿æ‚¨å·²ç»æé«˜äº† SES é™é¢**:

[![](img/eab6ef67b83b5ae20e2fe56381a42c2f.png)](https://cdn-images-1.medium.com/max/302/1*4ZkuvzQ6-zi9dH0lixfiIg.png)

å¦‚æœæ‚¨çŸ¥é“æ‚¨ä¸å†å¤„äºâ€œæ²™ç›’æ¨¡å¼â€ï¼Œè§£å†³æ–¹æ³•æ˜¯è¿›å…¥/settings å¹¶ç¡®ä¿è®¾ç½®æ­£ç¡®:

[![](img/7af6089d5fb72134e9aef7ecf8d2f040.png)](https://cdn-images-1.medium.com/max/580/1*HTm1NqUS7cj5x58JvAp7dA.png) 

<figcaption>æ’°å†™æœ¬æ–‡æ—¶ 3 ä¸ªå¯ç”¨åœ°åŒºé€‰æ‹©</figcaption>

é‚£è¿˜å‰©ä¸‹ä»€ä¹ˆï¼Ÿ**è®©æˆ‘ä»¬è®¾ç½®æ•°æ®åº“çš„è‡ªåŠ¨å¤‡ä»½ï¼Œå¹¶å°†å¤‡ä»½è‡ªåŠ¨ä¼ è¾“åˆ° AWS S3 å®¹å™¨ä¸­ï¼**

### äº‹æƒ…ä¸é¡ºåˆ©ã€‚é€šè¿‡è®¾ç½®è‡ªåŠ¨å¤‡ä»½å’Œè‡ªåŠ¨äº‘å­˜å‚¨è¿™äº›å¤‡ä»½ï¼Œä¿æŠ¤æ‚¨å®è´µçš„é‚®ä»¶åˆ—è¡¨æ•°æ®ã€‚

#### è®¾ç½®è‡ªåŠ¨ Mysql è½¬å‚¨

åœ¨è®¾ç½®è°ƒåº¦ç¨‹åºä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä¸ºå¤‡ä»½å’Œå¤‡ä»½è„šæœ¬åˆ›å»ºä¸€ä¸ªå­˜å‚¨ç›®å½•ã€‚è¯¥å‘½ä»¤:

```
# mkdir /srv/db\_bak/ 
```

å°†åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬å°†æŠŠæ•°æ®åº“å¤‡ä»½è½¬å‚¨åˆ°å…¶ä¸­ã€‚

è®©æˆ‘ä»¬å†æ¬¡ä½¿ç”¨ nano ç¼–è¾‘å™¨åˆ›å»ºå®é™…çš„å¤‡ä»½è„šæœ¬:

```
# nano /srv/dump\_script.sh 
```

å°†ä¸‹é¢çš„ä»£ç ç²˜è´´åˆ°ç¼–è¾‘å™¨ä¸­ï¼ŒæŒ‰ Escï¼Œç„¶åæŒ‰$å°†ä»£ç è¡Œè‡ªåŠ¨æ¢è¡Œï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ä¸€æ¬¡çœ‹åˆ°å±å¹•ä¸Šçš„æ‰€æœ‰å†…å®¹ã€‚å¯¹äºç¬¬ä¸€ä¸ªå—ï¼Œæ‚¨å°†æ›¿æ¢å…ˆå‰åˆ›å»ºçš„æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç ã€‚ç¬¬äºŒè¡Œå°† uploads æ–‡ä»¶å¤¹å¤åˆ¶åˆ°å¤‡ä»½ç›®å½•ä¸­ã€‚æœ€å¥½æœ‰ä¸€ä¸ªå¤‡ä»½ï¼Œå› ä¸ºä½ åœ¨åˆ›å»ºæ´»åŠ¨æ—¶é€šè¿‡ç†Šæ™ºå¨Ÿä¸Šä¼ çš„ä»»ä½•é™„ä»¶æˆ–å›¾åƒéƒ½å°†å­˜å‚¨åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œä½ å‘å‡ºçš„ç”µå­é‚®ä»¶å°†ä»ä½ çš„ droplet ä¸­æä¾›ã€‚å¦‚æœä½ è¦å‘é€å¤§é‡çš„ç”µå­é‚®ä»¶æ´»åŠ¨ï¼Œä½ å¯èƒ½ä¼šæƒ³é€šè¿‡ CDN æˆ– S3 æ¡¶é“¾æ¥åˆ°å›¾ç‰‡å’Œä¸Šä¼ ï¼Œè€Œä¸ä¼šç»™ä½ çš„æœåŠ¡å™¨å¸¦æ¥ä¸å¿…è¦çš„å‹åŠ›ã€‚

```
/usr/bin/mysqldump -u'sendy\_db\_admin' -p'2zrQYe5NC8z2sw87TpC4SWDK' sendy > /srv/db\_bak/$(
date +%F)\_sendy\_backup.sql

cp -r /var/www/contoso.com/public\_html/uploads/ /srv/db\_bak/ 
```

ç°åœ¨æŒ‰ control + x é€€å‡ºï¼Œå¹¶ç¡®è®¤ä½ è¦ä¿å­˜çš„ä¿®æ”¹ï¼Œå¹¶ç¡®è®¤æ–‡ä»¶åã€‚ç°åœ¨æ¥é…ç½®è°ƒåº¦ç¨‹åºã€‚

[![](img/3c75ac40f3d6e5400cc31bbc261b742f.png)](https://cdn-images-1.medium.com/max/572/1*5hZGqnUmGduzmkN0wISlTQ.png) 

<figcaption>ä¸â€¦â€¦å…‹æœ—</figcaption>

æœ‰ä¸€ä¸ªå¥‡å¦™çš„å®ç”¨ç¨‹åºå­˜åœ¨äºç±» Unix ä¸–ç•Œä¸­ï¼ŒåŒ…æ‹¬æ‚¨çš„ dropletï¼Œç§°ä¸º Cronã€‚æˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥åˆ›å»ºä¸¤ä¸ªèŒåŠ¡ã€‚å…¶ä¸­ä¸€ä¸ªä¼šå®šæœŸç»™ä½ çš„æ•°æ®åº“æ‹å¿«ç…§ã€‚å¦ä¸€ä¸ªå°†å®šæœŸå°†è¿™äº›å¿«ç…§è½¬ç§»åˆ°å®‰å…¨çš„äº‘å­˜å‚¨æ¡¶ä¸­ã€‚æˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•å°†è¿™äº›å¤‡ä»½è½¬ç§»åˆ° AWS S3 å­˜å‚¨æ¡¶ã€‚

æœ€åˆï¼Œæ‚¨çš„è®¡ç®—æœºä¸Šæ²¡æœ‰ç”¨äº cron è°ƒåº¦å®ç”¨ç¨‹åºçš„ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼Œç§°ä¸º crontabã€‚ä¸‹é¢æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ª:

```
# crontab -e 
```

æ¥ä¸‹æ¥å¯èƒ½æ˜¯:

```
no crontab for root - using an empty one

Select an editor. To change later, run 'select-editor'.
  1\. /bin/nano <---- easiest
  2\. /usr/bin/vim.basic
  3\. /usr/bin/vim.tiny
  4\. /bin/ed

Choose 1-4 [1]: 
```

é™¤éæ‚¨å·²ç»çŸ¥é“åŸºæœ¬çš„ vim å‘½ä»¤ï¼Œå¦åˆ™è¯·æŒ‰ 1 é”®é€‰æ‹©é»˜è®¤çš„ nano ç¼–è¾‘å™¨ï¼Œç„¶åæŒ‰ enter é”®ã€‚ä½ å°†ä¼šçœ‹åˆ°è¿™ä¸ªå±å¹•ï¼Œå®ƒæ˜¾ç¤ºäº†é»˜è®¤çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶è¢«â€œæœ‰ç”¨çš„â€æ ·æ¿æ–‡ä»¶å®Œå…¨æ³¨é‡Šæ‰äº†

```
# Edit this file to introduce tasks to be run by cron.
#
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
#
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use '\*' in these fields (for 'any').#
# Notice that tasks will be started based on the cron's system
# daemon's notion of time and timezones.
#
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
#
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 \* \* 1 tar -zcf /var/backups/home.tgz /home/
#
# For more information see the manual pages of crontab(5) and cron(8)
#
# m h dom mon dow command 
```

è®©æˆ‘ä»¬åˆ é™¤æ ·æ¿æ–‡ä»¶ï¼Œç”¨ä»¥ä¸‹å†…å®¹æ›¿æ¢å®ƒ:

```
# backing up to /srv/db\_bak/
# every day at 8:12 utc, dump database
12 8 \* \* \* . /srv/dump\_script.sh > /dev/null 2>&1 
```

Crontable è°ƒåº¦è¯­æ³•çš„å¯è¯»æ€§å¹¶ä¸å¥½ã€‚å¦‚æœä½ æƒ³äº†è§£è¿™äº›æ¨¡ç³Šç¬¦å·çš„æ›´å¤šç»†èŠ‚ï¼Œè¯·è®¿é—®è¿™ä¸ªç½‘ç«™ã€‚[https://crontab.guru/#12_8_*_*_*](https://crontab.guru/#12_8_*_*_*)

[![](img/deca11cd775fb2e5ed6bbfaef4ba0690.png)](https://cdn-images-1.medium.com/max/764/1*YzWjIvM9rA5appqDEAckbA.png)T3ã€‘ç‚¹å‡»å¸¦ä¸‹åˆ’çº¿çš„â€œä¸‹ä¸€æ­¥â€å±•å¼€æ˜¾ç¤º

è¿™å°†åœ¨æ¯å¤© 08:12 UTC è¿è¡Œæˆ‘ä»¬çš„æ•°æ®åº“å¤‡ä»½è„šæœ¬ï¼Œæ­¤æ—¶ç¾å›½è¥¿æµ·å²¸åˆšåˆšè¿‡åˆå¤œã€‚æˆ‘é€‰æ‹©é‚£ä¸ªæ—¶é—´æ˜¯å› ä¸ºä¸å¤ªå¯èƒ½ä¼šæœ‰å¾ˆå¤šäººåœ¨é‚£ä¸ªæ—¶é—´ä»¥è®¿é—®æ•°æ®åº“çš„æ–¹å¼ä¸æˆ‘çš„ç«™ç‚¹è¿›è¡Œäº¤äº’ï¼Œæˆ‘å¸Œæœ›å®ƒä¸è¦æ­£å¥½åœ¨ 5 åˆ†é’Ÿçš„é—´éš”ï¼Œå› ä¸ºé‚£æ˜¯å…¶ä»–è„šæœ¬è¿è¡Œçš„æ—¶é—´ã€‚ä¹Ÿè®¸æ²¡æœ‰å¿…è¦è¿™æ ·å®‰æ’ï¼Œä½†æˆ‘å°±æ˜¯è¿™ä¹ˆæƒ³çš„ã€‚

æ‚¨å¯ä»¥éšæ„å°†æ—¶é—´é—´éš”è®¾ç½®ä¸ºæ¯”æ¯å¤©æ›´é¢‘ç¹ï¼Œå› ä¸ºåªè¦ç³»ç»Ÿæ—¥æœŸçš„å½“å‰æ—¥æœŸç›¸åŒï¼Œå®ƒå°±ä¼šè¦†ç›–ä»¥å‰çš„æ–‡ä»¶ã€‚å®ƒä¼šå°†æ–‡ä»¶åä¿å­˜ä¸ºâ€¦

```
db\_bak/2019â€“05â€“03\_sendy\_backup.sql 
```

â€¦éšç€æ—¥æœŸçš„å˜åŒ–è‡ªåŠ¨æ›´æ–°æ–‡ä»¶å‰ç¼€ã€‚

æˆ‘çŒœä½ å¯èƒ½æƒ³çœ‹åˆ°è¿™å®é™…å·¥ä½œï¼Œè€Œä¸æ˜¯ç­‰å¾…ä¸€å¤©ã€‚å¦‚æœä½ æƒ³ä¸´æ—¶æ›´æ–° cron è°ƒåº¦é—´éš”**çœ‹çœ‹æ˜¯å¦æœ‰æ•ˆï¼Œå°†ç¬¬ä¸‰è¡Œçš„ç¬¬ä¸€éƒ¨åˆ†æ”¹ä¸º*/2 * * * *ï¼Œå®ƒå°†æ¯ä¸¤åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ã€‚ä¹Ÿåˆ«å¿˜äº†ã€‚åœ¨æœ€åä¸€ä¸ª*ä¹‹åã€‚å¦åˆ™ï¼Œè½¬å‚¨è„šæœ¬å°†æ— æ³•è¿è¡Œã€‚å½“ä½ ä¿å­˜æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šè¦æ±‚ä½ ç¡®è®¤ä¿å­˜ï¼Œç„¶åç¡®è®¤æ–‡ä»¶åã€‚ç¡®è®¤å®ƒå‘æ‚¨æ˜¾ç¤ºçš„ä¸´æ—¶æ–‡ä»¶åï¼Œåœ¨æ‚¨æ¥å—ä¹‹åï¼Œå®ƒå°†å®‰è£…ä¸€ä¸ªæ–°çš„ crontabï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ crontab -e å†æ¬¡è®¿é—®å®ƒè¿›è¡Œç¼–è¾‘å’Œæ›´æ–°ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ crontab -l éšæ—¶æ£€æŸ¥æ‚¨çš„ crontabã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ select-editor æ›´æ”¹æ‚¨é¦–é€‰çš„ crontab ç¼–è¾‘å™¨ã€‚**

å¦‚æœä» cron è„šæœ¬çš„æœ«å°¾åˆ é™¤>/dev/null 2>&1 éƒ¨åˆ†ï¼Œé‚£ä¹ˆä½œä¸šçš„è¾“å‡ºå°†åœ¨æ¯æ¬¡è¿è¡Œæ—¶ç”Ÿæˆä¸€æ¡ç³»ç»Ÿé‚®ä»¶æ¶ˆæ¯ã€‚å¯ä»¥ç”¨ cat /var/mail/root æ£€æŸ¥ï¼Œç”¨ rm /var/mail/root åˆ é™¤é‚®ä»¶æ¶ˆæ¯ã€‚

ç”±äºåœ¨è®¾ç½®ç†Šæ™ºå¨Ÿåï¼Œæ‚¨å°†å¾ˆå¿«å›åˆ° Crontab æ–‡ä»¶ä¸­ï¼Œå› æ­¤æˆ‘å°†ä¸ºæ‚¨èŠ‚çœä¸€äº›æ—¶é—´ï¼Œå¹¶ä¸ºæ‚¨æä¾›å°†è¦è®¾ç½®çš„ cron ä½œä¸šçš„ä»£ç ï¼Œä»¥ä¾¿å®‰æ’æ´»åŠ¨ã€æ¿€æ´»è‡ªåŠ¨å“åº”ç¨‹åºä»¥åŠå¯¼å…¥é¢å‘è®¢é˜…çš„ csv æ–‡ä»¶ã€‚ç°åœ¨å¯ä»¥éšæ„è¾“å…¥ï¼Œæˆ–è€…ç­‰åˆ°æ‚¨å¼€å§‹é…ç½®ç†Šæ™ºå¨Ÿä»ªè¡¨æ¿æ—¶å†è¾“å…¥ã€‚

```
# Five minute cron job to send scheduled campaigns
\*/5 \* \* \* \* php /var/www/contoso.com/public\_html/scheduled.php > /dev/null 2>&1

# One minute interval job for importing csv
\*/1 \* \* \* \* php /var/www/contoso.com/public\_html/import-csv.php > /dev/null 2>&1

# One minute interval job for activating auto responders
\*/1 \* \* \* \* php /var/www/contoso.com/public\_html/autoresponders.php > /dev/null 2>&1 
```

è‡ªåŠ¨åŒ–ä»»åŠ¡çš„ç¬¬ 1 éƒ¨åˆ†å®Œæˆäº†ï¼ä¸‹ä¸€æ­¥æ˜¯è®©è¿™ä¸€åˆ‡è‡ªåŠ¨è½¬ç§»åˆ°ä½ çš„ S3 æ¡¶ã€‚

#### è®¾ç½® Mysql å¤‡ä»½åˆ° S3 å­˜å‚¨æ¡¶çš„è‡ªåŠ¨ä¼ è¾“

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»º AWS S3 å­˜å‚¨æ¡¶ï¼Œæˆ‘ä»¬å°†æŠŠä¼ è¾“æ•°æ®å‘é€åˆ°è¿™ä¸ªå­˜å‚¨æ¡¶ä¸­ã€‚ä» S3 æ§åˆ¶å°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å­˜å‚¨æ¡¶ã€‚åŒºåŸŸæ˜¯ä»»æ„çš„ï¼Œé™¤éæ‚¨æœ‰åœ¨ç‰¹å®šåŒºåŸŸæ‰˜ç®¡æ•°æ®çš„ç‰¹å®šéœ€æ±‚ã€‚

[![](img/77a333cd26e69ac1f01e8f949025923f.png)](https://cdn-images-1.medium.com/max/308/1*XyIHLGHhOmF4_RcEmelwNA.png)

[![](img/39408dccfda3c85cc5785cc83575b579.png)](https://cdn-images-1.medium.com/max/428/1*jjVBZS3KEduXbxhOS3Gmrg.png) 

<figcaption>åç§°å’Œåœ°åŒºè®¾ç½®</figcaption>

ç„¶åå•å‡»ä¸‹ä¸€æ­¥

[![](img/881663596513dcdfeeae93e94c971833.png)](https://cdn-images-1.medium.com/max/160/1*fSrH0qyEPr6JUuQoZGm0Ag.png)

æˆ‘ä¸éœ€è¦åœ¨â€œé…ç½®é€‰é¡¹â€é¢æ¿ä¸­åšä»»ä½•æ›´æ”¹ã€‚

[![](img/f4e0b1aaceb4ab6b1bb48922f64a1483.png)](https://cdn-images-1.medium.com/max/197/1*BkukwiDOdcll9Sr5BNkdEA.png) 

<figcaption>å†ç‚¹å‡»ä¸‹ä¸€æ­¥</figcaption>

ä½†æ˜¯æ‚¨éœ€è¦é€‚å½“åœ°â€œè®¾ç½®æƒé™â€,ä»¥ä¾¿èƒ½å¤Ÿä¸Šä¼ åˆ° bucket

[![](img/0d6b34779c0e8a081c1db3e88eaf3395.png)](https://cdn-images-1.medium.com/max/169/1*rEDWhKmLq_NceOjKObx8gQ.png)

[![](img/bbeab5f583243f17f5990d07e27efddb.png)](https://cdn-images-1.medium.com/max/1024/1*iG3zDtqgqvW0azDZZOqEWA.png) 

<figcaption>å–æ¶ˆé€‰ä¸­æ‰€æœ‰è¿™äº›é€‰é¡¹</figcaption>

[![](img/96d8393bbb610405b7c1a7983f1f4217.png)](https://cdn-images-1.medium.com/max/114/1*MeH7hagH2EUtdv2agpuXVg.png)

æŸ¥çœ‹æ‚¨çš„é€‰é¡¹ï¼Œç„¶åæŒ‰:

[![](img/9640f7b1207c22f321d96affb79426f1.png)](https://cdn-images-1.medium.com/max/276/1*W-eW52bG5Tw6bdPi_aTt9Q.png)

[![](img/fd5329b25e6fe29f7ff5b86f53df9a48.png)](https://cdn-images-1.medium.com/max/1024/1*FYtEgjGL237xW_HJ_Cq7DQ.png)

ç„¶åé€‰æ‹©ä½ çš„æ¡¶ï¼Œé€‰æ‹©**æƒé™**ï¼Œè®¾ç½®å¦‚ä¸‹**è®¿é—®æ§åˆ¶åˆ—è¡¨:**

[![](img/bd4d810ef5aa624ed2142dcefd445d77.png)](https://cdn-images-1.medium.com/max/996/1*YayL7V4CJJkDOtocQFiD7A.png)

[![](img/57e16ec8d783a8a21436af5579300f79.png)](https://cdn-images-1.medium.com/max/340/1*NshnRDFD-YLVWMfUrBmxwQ.png)

[![](img/0615c7c5a5c9af1172ac4531402766bf.png)](https://cdn-images-1.medium.com/max/717/1*DqJllc3TsdICu1UHZJcHCw.png)

[![](img/f85ae72ce4e7ca7d4cb1fb9f966d9a08.png)](https://cdn-images-1.medium.com/max/520/1*ycP7kkYcZgMoCJgiRPilYw.png)

[![](img/c6bda519d3c118ff3bd16bc84bfbf4ac.png)](https://cdn-images-1.medium.com/max/1024/1*pSbdilPmxpMi-L9aXXwgnQ.png) 

<figcaption>ã€å†™å¯¹è±¡ã€‘ä¸ºæ‰€æœ‰äººå¯ç”¨</figcaption>

ç„¶åé€‰æ‹©â€œæ¦‚è¿°â€é€‰é¡¹å¡å¹¶åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹

[![](img/a63c1935c46c05dee65d9b92996c636e.png)](https://cdn-images-1.medium.com/max/1013/1*YeVeq86o1ASEx-U04y_sOg.png)

[![](img/7d72f3c96f10b824d1efe05aff44feab.png)](https://cdn-images-1.medium.com/max/160/1*xDgu2olMNPud0aC-KPHZ5g.png)

[![](img/74ecab7f969bc2c464837ae280ee17a2.png)](https://cdn-images-1.medium.com/max/1024/1*2iEvsIE7RjRi7Yd1h7cJwQ.png)

å°†å­˜å‚¨æ¡¶å’Œæ–‡ä»¶å¤¹åç§°æ”¾åœ¨æ‰‹è¾¹ï¼Œæ‚¨å¾ˆå¿«å°±ä¼šç”¨åˆ°å®ƒä»¬ã€‚

è¿™å°±æ˜¯è®¾ç½®é“²æ–—çš„å…¨éƒ¨å†…å®¹ã€‚ç°åœ¨åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶ç»™ä»–ä»¬é€‚å½“çš„æƒé™åœ¨æ‚¨çš„å­˜å‚¨æ¡¶ä¸­å­˜å‚¨ä¸œè¥¿ã€‚

#### åœ¨ IAM ä¸­è®¾ç½® AWS ç”¨æˆ·ï¼Œå¹¶æˆäºˆä»–ä»¬è®¿é—®æ‚¨çš„å­˜å‚¨æ¡¶çš„æƒé™

[![](img/006d9a859e05c9a74761f4ba0ce1c9ce.png)](https://cdn-images-1.medium.com/max/438/1*IwspZylIJst2zVHs6XT4UQ.png)

å‰å¾€ AWS IAM[https://console.aws.amazon.com/iam](https://console.aws.amazon.com/iam/)/æ§åˆ¶å°ï¼Œç‚¹å‡»å·¦ä¾§çš„ç”¨æˆ·é€‰é¡¹å¡ã€‚ç‚¹å‡»æ·»åŠ ç”¨æˆ·ï¼Œå¹¶ç»™ä»–ä»¬ä¸€ä¸ªåˆç†çš„åç§°å’Œç¼–ç¨‹è®¿é—®ã€‚ç„¶åå•å‡»ä¸‹ä¸€æ­¥:æƒé™ã€‚

[![](img/4c4cd1fc5c9a151bedb872732f460d7a.png)](https://cdn-images-1.medium.com/max/109/1*vDoRHMhiY19FIiTjdoQAHg.png)

[![](img/e753ee6e03b0eeed097a4bf1782a22a6.png)](https://cdn-images-1.medium.com/max/1024/1*3kjHx9aUjWjbLj-Eos2Bxw.png)

[![](img/ea3f25681b0dc5a9b992a57ac33b83ba.png)](https://cdn-images-1.medium.com/max/196/1*IKH48fBirgqktYDrI1oeZw.png)

ç›´æ¥é€‰æ‹©é™„åŠ çš„ç°æœ‰ç­–ç•¥

[![](img/924dd80d3e38298cefe0764b64fc8740.png)](https://cdn-images-1.medium.com/max/804/1*fKMBZUPCtYrgyyBZxXs54Q.png)

åœ¨æœç´¢æ¡†ä¸­è¾“å…¥:s3ReadOnlyï¼Œå¹¶ç»™ç”¨æˆ· AmazonS3ReadOnlyAccess

[![](img/e24aa8e0c6bd0f0c4c860a43501c4eb9.png)](https://cdn-images-1.medium.com/max/840/1*pOu54eDfbu9NtJgzCb05oA.png)

ç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥:æ ‡ç­¾ã€‚æˆ‘æ²¡æœ‰åœ¨è¿™é‡Œè¾“å…¥ä»»ä½•å†…å®¹ã€‚æ¥ä¸‹æ¥ï¼Œå•å‡»â€œä¸‹ä¸€æ­¥:å®¡æŸ¥â€,å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå•å‡»â€œåˆ›å»ºç”¨æˆ·â€

[![](img/d2fa4acf4d67ea16804bba7561d16154.png)](https://cdn-images-1.medium.com/max/127/1*btdKVLeHM8XdSBjtIo3IJg.png)

[![](img/bedf9205e367075fa4de5732763f848d.png)](https://cdn-images-1.medium.com/max/147/1*Is-OA-HnhgwZEHBJnhOrNw.png)

[![](img/e29404bcdd85080e84248e235eb9cae7.png)](https://cdn-images-1.medium.com/max/475/1*47ma5tdOVF99JX8GrjWeNA.png)

[![](img/c47c8fd81de209fca464bb02ecc6368f.png)](https://cdn-images-1.medium.com/max/133/1*D03p3vYFHxxCchQ9BLtdFg.png)

è®°ä¸‹è®¿é—®å¯†é’¥ Id å’Œç§˜å¯†è®¿é—®å¯†é’¥å€¼ã€‚æ‚¨å¾ˆå¿«å°±ä¼šéœ€è¦è¿™äº›å€¼ï¼Œè¿™æ˜¯æ‚¨å¯ä»¥è®¿é—®ç§˜å¯†è®¿é—®å¯†é’¥çš„å”¯ä¸€æ—¶é—´ï¼Œå› æ­¤å¦‚æœæ‚¨ä»¥åéœ€è¦è¯¥å€¼ï¼Œæ‚¨å¿…é¡»ä¸ºè¯¥ç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ–°çš„å¯†é’¥ã€‚

[![](img/c532a3b3c8ab01fcf1dd1df7d93a6a86.png)](https://cdn-images-1.medium.com/max/902/1*VyDUok3zSRHN_SjAPN-d0g.png)

å‘ç»ˆç‚¹å†²åˆºï¼

#### åœ¨æ‚¨çš„ Droplet ä¸Šå®‰è£… AWS S3 å®ç”¨ç¨‹åºï¼Œä»¥å¤„ç†æ‚¨çš„æ•°æ®åº“å¤‡ä»½åˆ° S3 å­˜å‚¨æ¡¶çš„ä¼ è¾“

å›åˆ°æ‚¨çš„æ ¹ SSH ç»ˆç«¯è¿æ¥ï¼Œå®‰è£… S3 å®ç”¨ç¨‹åº:

```
# apt-get install s3cmd 
```

æ¥å—å®‰è£…ç¡®è®¤ï¼Œç„¶åæ‚¨å°†å®‰è£…è¿™äº›å·¥å…·ã€‚ç°åœ¨æ‚¨éœ€è¦è¾“å…¥æ‚¨çš„å‡­è¯ã€‚

```
# s3cmd --configure 
```

ä¼šå¼¹å‡ºä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„å¯¹è¯:

```
Enter new values or accept defaults in brackets with Enter.
Refer to user manual for detailed description of all options.

Access key and Secret key are your identifiers for Amazon S3\. Leave them empty for using the env variables.
Access Key: 
```

æ‚¨å°†è¾“å…¥æ‚¨çš„è®¿é—®å¯†é’¥å’Œç§˜å¯†å¯†é’¥ï¼Œå¯¹äºå…¶ä½™çš„å€¼ï¼Œåªéœ€å•å‡» enter æ¥å—ç¼ºçœå€¼ï¼Œé™¤éæ‚¨æƒ³æ˜ç¡®åœ°è®¾ç½®ä¸€äº›å†…å®¹ã€‚åœ¨è¿‡ç¨‹çš„æœ€åï¼Œç¡®ä¿å½“å®ƒæµ‹è¯•ä½ çš„å‡­è¯æ—¶ï¼Œå®ƒé€šè¿‡ï¼Œç„¶ååŒæ„ä¿å­˜è®¾ç½®ã€‚

äº‹æƒ…å¤§æ¦‚ä¼šæ˜¯è¿™æ ·çš„:

```
Default Region [US]:

Use "s3.amazonaws.com" for S3 Endpoint and not modify it to the target Amazon S3.
S3 Endpoint [s3.amazonaws.com]:

Use "%(bucket)s.s3.amazonaws.com" to the target Amazon S3\. "%(bucket)s" and "%(location)s" vars can be used
if the target S3 system supports dns based buckets.
DNS-style bucket+hostname:port template for accessing a bucket [%(bucket)s.s3.amazonaws.com]:

Encryption password is used to protect your files from reading
by unauthorized persons while in transfer to S3
Encryption password:
Path to GPG program [/usr/bin/gpg]:

When using secure HTTPS protocol all communication with Amazon S3
servers is protected from 3rd party eavesdropping. This method is
slower than plain HTTP, and can only be proxied with Python 2.7 or newer
Use HTTPS protocol [Yes]:

On some networks all internet access must go through a HTTP proxy.
Try setting it here if you can't connect to S3 directly
HTTP Proxy server name:

New settings:
  Access Key: AKIAJ3O4AL4VMLGBEPAQ
  Secret Key: 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
  Default Region: US
  S3 Endpoint: s3.amazonaws.com
  DNS-style bucket+hostname:port template for accessing a bucket: %(bucket)s.s3.amazonaws.com
  Encryption password:
  Path to GPG program: /usr/bin/gpg
  Use HTTPS protocol: True
  HTTP Proxy server name:
  HTTP Proxy server port: 0

Test access with supplied credentials? [Y/n]
Please wait, attempting to list all buckets...
Success. Your access key and secret key worked fine :-)

Now verifying that encryption works...
Not configured. Never mind.

Save settings? [y/N] 
```

ä¿å­˜è®¾ç½®ï¼Œè¿™æ ·å°±å®Œæˆäº†ã€‚

å‡è®¾æ‚¨åœ¨é‚£ä¸ªæ–‡ä»¶å¤¹ä¸­æœ‰ä¸€ä¸ª db å¤‡ä»½ï¼Œé‚£ä¹ˆæ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æµ‹è¯•å®ƒã€‚å¦‚æœä½ è¿˜æ²¡æœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå…ˆè¿™æ ·åš:

# echo 'åªæ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶'> /srv/db_bak/testFile.txt ç„¶å:

```
s3cmd sync /srv/db\_bak/ s3://contoso-sendy-backups/sql-dumps/ 
```

è¿™åº”è¯¥ä¼šäº§ç”Ÿå¦‚ä¸‹æ‰€ç¤ºçš„è¾“å‡º:

```
root@sendy-droplet:/srv# s3cmd sync /srv/db\_bak/ s3://contoso-sendy-backups/sql-dumps/
WARNING: Empty object name on S3 found, ignoring.
upload: '/srv/db\_bak/2019-01-12\_sendy\_backup.sql' -> 's3://contoso-sendy-backups/sql-dumps/2019-01-12\_sendy\_backup.sql' [1 of 1]
 7945 of 7945 100% in 0s 85.26 kB/s done
Done. Uploaded 7945 bytes in 1.0 seconds, 7.76 kB/s.
root@sendy-droplet:/srv# 
```

ç°åœ¨æ£€æŸ¥æˆ‘çš„ S3 æ¡¶ï¼Œæˆ‘çœ‹åˆ°è¯¥æ–‡ä»¶å¤¹çš„å†…å®¹ä¼ è¾“æˆåŠŸ

[![](img/3fdc869485a24126a4dcd3536704546c.png)](https://cdn-images-1.medium.com/max/1024/1*5xU_uKKipomxWncc4vQ1mA.png)

å¥½å§â€¦è®©æˆ‘ä»¬æŠŠè¿™å½“æˆ Cron çš„å·¥ä½œï¼

ç”¨ crontab -e å°†å®ƒæ·»åŠ åˆ°æ‚¨çš„ crontab ä¸­

```
#every day at 9:12 utc, synchronize .sql dumps with s3 bucket
12 9 \* \* \* s3cmd sync /srv/db\_bak/ s3://contoso-sendy-backups/sql-dumps/ > /dev/null 2>&1 
```

è¿™å°†åœ¨æ¯å¤© 9:12 UTC å°†æ•°æ®åº“è½¬å‚¨å‘é€åˆ° S3ã€‚åŒæ ·ï¼Œæ‚¨å¯èƒ½å¸Œæœ›é€šè¿‡å°†æ—¶é—´é—´éš”è®¾ç½®å¾—æ›´ä½æ¥æµ‹è¯•è¿™ä¸€ç‚¹(åœ¨ä¸Šé¢çš„ç¬¬ä¸€ä¸ª Cron éƒ¨åˆ†ä¸­æœ‰è¯¦ç»†æè¿°)ï¼Œä¸è¦å¿˜è®°å°†å…¶è®¾ç½®å›æ¥ã€‚æˆ‘è®¤ä¸ºæ¯æ—¥å¤–éƒ¨äº‘å¤‡ä»½æ˜¯ä¸€ä¸ªåˆç†çš„é»˜è®¤è®¾ç½®ã€‚æ‚¨çš„éœ€æ±‚å¯èƒ½ä¸åŒã€‚

### ä»ä¿å­˜çš„å¤‡ä»½ä¸­æ¢å¤æ•°æ®åº“

é‚£ä¹ˆï¼Œå¦‚æœå‘ç”Ÿæ•°æ®åº“ç¾éš¾ï¼Œæ‚¨ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿå¦‚æœæ‚¨å¦‚ä¸Šæ‰€è¿°è®¾ç½®äº† S3 è‡ªåŠ¨å¤‡ä»½ï¼Œæ‚¨å°±æœ‰äº†ä¸€ä¸ªå¤‡ä»½ï¼

å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¢å¤æ•°æ®åº“:

*   ç™»å½•æ‚¨çš„ S3 æ§åˆ¶å°
*   é€‰æ‹©è¦æ¢å¤çš„å¤‡ä»½

[![](img/352fdc03d38feea80cf6e9694a8eaf79.png)](https://cdn-images-1.medium.com/max/318/1*f-SrhKJFVZ0egLpn5kit0Q.png)

*   å½“æ‚¨ä¸‹è½½è¯¥æ–‡ä»¶æ—¶ï¼Œå®ƒå¯èƒ½ä¼šè¢«ä¸‹è½½ä¸º. txt æ–‡ä»¶ã€‚åªéœ€å°†æ–‡ä»¶æ‰©å±•åé‡å‘½åä¸ºã€‚ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€
*   ä»å‘½ä»¤è¡Œå°†å¤‡ä»½å‘é€åˆ°æ‚¨çš„ dropletï¼Œä½¿ç”¨(è¿™éƒ½æ˜¯ä¸€è¡Œ):

```
$ rsync -ahrvz -e ssh /path/to/your/sql/backup/2019-01-14\_full\_sendy.sql root@157.230.133.78:/srv/db\_bak/backup\_to\_restore.sql 
```

ç°åœ¨ï¼Œç™»å½•åˆ°æ‚¨çš„ dropletï¼Œç„¶åç™»å½•åˆ° mysqlï¼Œåˆ é™¤ç°æœ‰çš„æŸåçš„æ•°æ®åº“ã€‚*** *è¿™å°†ä¸å¯é€†è½¬åœ°ç ´åå½“å‰æ•°æ®åº“**** å› æ­¤ï¼Œè¯·ç¡®ä¿ä»…åœ¨æ•°æ®åº“å·²ç»æŸåå¹¶ä¸”éœ€è¦ä»æ‚¨çš„æŸä¸ªå¤‡ä»½ä¸­æ¢å¤æ—¶æ‰æ‰§è¡Œæ­¤æ“ä½œã€‚

```
# mysql 
```

ç„¶å(**è¿™æ˜¯ç ´åæ€§éƒ¨åˆ†**):

```
mysql> drop database sendy; 
```

ç„¶åé‡æ–°åˆ›å»º sendy æ•°æ®åº“

```
mysql> create database sendy; 
```

ç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é€€å‡ºæˆ‘çš„ sql:

```
mysql> exit; 
```

å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»è¿œç¨‹ shell æ‰§è¡Œæ•°æ®åº“æ¢å¤:

```
# mysql sendy < /srv/db\_bak/backup\_to\_restore.sql 
```

ç„¶ååœ¨ä½ çš„æµè§ˆå™¨ä¸­åˆ·æ–°ç†Šæ™ºå¨Ÿï¼Œä½ åº”è¯¥å›åˆ°ä½ åœ¨æ•°æ®åº“æŸåä¹‹å‰å¼€å§‹çš„åœ°æ–¹ã€‚

### è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ°´æ»´çš„å¿«ç…§

æœ‰ä¸€ä¸ªâ€œæ’¤é”€â€ç‚¹å¾ˆå¥½ã€‚DigitalOcean ä½¿æ‚¨èƒ½å¤Ÿåœ¨ä»»ä½•æ—¶é—´ç‚¹åˆ›å»ºè™šæ‹ŸæœåŠ¡å™¨çš„å¿«ç…§ã€‚å¦‚æœæ‚¨éœ€è¦æ¢å¤è™šæ‹ŸæœåŠ¡å™¨ï¼Œè¿™å°†æ˜¯åˆ›å»ºå¿«ç…§çš„å¥½æ—¶æœºã€‚å¦‚æœæ‚¨è¿™æ ·åšäº†ï¼Œæ‚¨åªéœ€è¦å°†æ‚¨çš„æ•°æ®åº“é‡æ–°å¯¼å…¥åˆ°æ‚¨çš„ S3 å­˜å‚¨æ¡¶ä¸­æœ€æ–°ä¿å­˜çš„ç‰ˆæœ¬ï¼Œæ‚¨å°±å¯ä»¥é‡æ–°å¼€å§‹å·¥ä½œäº†ã€‚

è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å…³é—­ shell ä¸­çš„ droplet:

```
# shutdown 
```

è¿™å°†ä¸ºæ‚¨æä¾›ç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„è¾“å‡º:

```
Shutdown scheduled for Tue 2019-01-15 04:49:54 UTC, use 'shutdown -c' to cancel. 
```

æ‚¨çš„æœåŠ¡å™¨ç°åœ¨æ­£åœ¨æ‰§è¡Œå…³æœºè„šæœ¬ï¼Œè¿™æ¯”ç¡¬å…³æœºè¦å¥½ã€‚ç°åœ¨å¯¼èˆªåˆ°[https://cloud.digitalocean.com/droplets](https://cloud.digitalocean.com/droplets)å¹¶é€‰æ‹©ä½ çš„ç†Šæ™ºå¨Ÿæ°´æ»´ã€‚æ‚¨åº”è¯¥ä¼šçœ‹åˆ°å®ƒå½“å‰å¤„äºå…³é—­çŠ¶æ€ã€‚

[![](img/6708cbb36bdb10a3458c08a9a837a708.png)](https://cdn-images-1.medium.com/max/106/1*yj4ZwLEYrsIGEtfwOj9vvA.png)

[![](img/3e81984bc70a1812050d71dd6d01f4f3.png)](https://cdn-images-1.medium.com/max/116/1*N2H8RMKbQygr8BLb8olgIA.png)

å•å‡»â€œSnapshotsâ€é€‰é¡¹å¡ï¼Œä¸ºæ‚¨çš„å¿«ç…§å–ä¸€ä¸ªåˆç†çš„åç§°ã€‚ç„¶åå•å‡»æ‹æ‘„å¿«ç…§ï¼Œè¿™å°†éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚

[![](img/4bb3c86c6e79251feabc20a17fffa4d3.png)](https://cdn-images-1.medium.com/max/909/1*kmEnP_uDVq1f5H0eje455g.png)

å°±æœ¬æ–‡å‘è¡¨æ—¶çš„æŠ¥ä»·è€Œè¨€ï¼Œå­˜å‚¨ä¸€ä¸ªå¿«ç…§æ¯æœˆå¤§çº¦éœ€è¦ 0.10 ç¾å…ƒã€‚

å¿«ç…§å®Œæˆåï¼Œå›åˆ°ç”µæºèœå•ï¼Œé‡æ–°æ‰“å¼€ dropletã€‚åœ¨å°è¯•é‡æ–°åŠ è½½ä¹‹å‰ï¼Œç»™å®ƒå‡ åˆ†é’Ÿæ—¶é—´å®Œå…¨é‡æ–°å¯åŠ¨ï¼Œå¦åˆ™æ‚¨å¯èƒ½ä¼šçœ‹åˆ°ä¸è¿æ¥åˆ°æœåŠ¡å™¨æˆ–æ•°æ®åº“ç›¸å…³çš„é”™è¯¯ã€‚

æ‚¨å¯ä»¥åƒè¿™æ ·éšæ—¶æ‹æ‘„å¿«ç…§ï¼Œä½†æ˜¯å½“ç„¶è¦æ³¨æ„å½“æ‚¨å…³é—­å®ƒæ—¶æ˜¯å¦æœ‰æ­£åœ¨è¿è¡Œçš„ä½œä¸šã€‚

[![](img/58de90e0fe065594206df79ccc566d78.png)](https://cdn-images-1.medium.com/max/605/1*2CUtloFHlWA61O2ngW1m5Q.png)

***æ­å–œä½ ï¼Œå°±æ˜¯è¿™æ ·ï¼*T3ã€‘**

### è¯·è¯„è®ºä¸€ä¸‹è¿›è¡Œçš„å¦‚ä½•ï¼æˆ‘å¾ˆæƒ³å¬å¬ä½ çš„è¿‡ç¨‹å¦‚ä½•ï¼Œä»¥åŠè¿™ä¸ªæŒ‡å—æ˜¯å¦å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚

> æˆ‘å¸Œæœ›è¿™ä¸ªæŒ‡å—èƒ½ä¸ºä½ çœå»å¾ˆå¤šæˆ‘åœ¨è®¾ç½®æ—¶é‡åˆ°çš„éº»çƒ¦ã€‚æˆ‘å¾ˆé«˜å…´çŸ¥é“å®ƒå¯èƒ½å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœä½ æƒ³è¯´è°¢è°¢ï¼Œè¯·ç•™ä¸‹è¯„è®ºï¼Œ[å’Œ/æˆ–è¯·éšæ„ç»™æˆ‘ä¹°å•¤é…’ï¼](https://paypal.me/alexjacobs)ğŸ»å¹²æ¯ï¼**