# é¢è¯•é—®é¢˜:å®ç°ä¸€ä¸ªè¿›åº¦æ¡

> åŸæ–‡:[https://dev . to/Healey codes/interview-question-implement-a-progress-bar-4j7h](https://dev.to/healeycodes/interview-question-implement-a-progress-bar-4j7h)

æˆ‘çœ‹åˆ°è¿™ä¸ªé—®é¢˜åœ¨ç¤¾äº¤åª’ä½“ä¸Šæµä¼ ã€‚[æ˜¾ç„¶](https://www.reddit.com/r/javascript/comments/3rb88w/ten_questions_ive_been_asked_most_more_than_once/cwmn60t/)ã€[é¡¶çº§å…¬å¸](https://www.glassdoor.com/Interview/-1-Implement-a-loading-bar-that-animates-from-0-to-100-in-3-seconds-2-Start-loading-bar-animation-upon-a-button-cli-QTN_1393903.htm)éƒ½åœ¨ç”¨å®ƒæ¥ç­›é€‰å‰ç«¯å·¥ç¨‹å¸ˆã€‚æˆ‘çš„æœªå©šå¦»å¾ˆå¿«å°±è¦ç”³è¯·å·¥ä½œäº†ï¼Œæˆ‘è®©å¥¹è¯•ä¸€è¯•ã€‚å¥¹å‡ ä¹å®Œæˆäº†æœ€åä¸€ä¸ªé˜¶æ®µ(åšäº†ä¸€ç‚¹ç ”ç©¶),ä½†æ˜¯ä¸€ä¸ªæ£˜æ‰‹çš„é€’å½’é”™è¯¯æŠŠå¥¹ç»Šå€’äº†ã€‚æˆ‘å†™äº†è¿™ç¯‡æ–‡ç« æ¥å¸®åŠ©å¥¹ã€‚å¦‚æœä½ é¢ä¸´ç±»ä¼¼çš„ä¸»é¢˜é—®é¢˜ï¼Œå¸Œæœ›ä½ ä¼šå‘ç°è¿™å¾ˆæœ‰ç”¨ï¼

æœ‰ä¸€äº›å˜åŒ–ï¼Œä½†è¿™ä¸ªé—®é¢˜é€šå¸¸æ˜¯åˆ†é˜¶æ®µé—®çš„ï¼Œè¶Šæ¥è¶Šéš¾ã€‚

#### [](#1-implement-a-loading-bar-that-animates-from-0-to-100-in-3-seconds)1ã€‚å®ç°ä¸€ä¸ªåŠ è½½æ ï¼Œåœ¨ 3 ç§’é’Ÿå†…ä» 0 åˆ° 100%æ˜¾ç¤ºåŠ¨ç”»

è¿™å®Œå…¨å¯ä»¥ç”¨ CSS æ¥å®Œæˆã€‚å¦‚æœæœ‰äº›äº‹æƒ…å¯ä»¥å®Œå…¨ç”¨ CSS æ¥å®Œæˆï¼Œæˆ‘å€¾å‘äºé€‰æ‹© CSSã€‚æˆ‘çš„ç†ç”±æ˜¯ï¼Œé‡æ„çº¯ CSS çš„ä¸œè¥¿æ¯”è¯•å›¾æ‰©å±•ä¸€ä¸ªå¿«é€Ÿçš„ JavaScript é»‘å®¢æ›´å®¹æ˜“ã€‚CSS å…·æœ‰å¾ˆå¼ºçš„å£°æ˜æ€§ï¼Œå¾ˆå®¹æ˜“é˜…è¯»å’Œç†è§£å…¶å†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚

å¯¹äºä¸€ä¸ªåªæœ‰ CSS çš„è¿›åº¦æ¡ï¼Œæˆ‘å°†ä½¿ç”¨ä¸¤ä¸ª divâ€”â€”ä¸€ä¸ªå®¹å™¨å’Œè¿›åº¦æ¡â€”â€”å’Œ`keyframes`ã€‚è¿™é‡Œé‡è¦çš„ä¸€è¡Œæ˜¯`animation: 1s linear fill;`ã€‚æœ‰å¾ˆå¤šè¯è¦è¯´ã€‚æˆ‘ä»¬è¦ç”¨ä»€ä¹ˆ`transition-timing-function`â€”â€”`ease`ã€`linear`ã€a `cubic-bezier`ï¼Ÿ

è‡³å°‘ï¼Œè¿™ä¸ªå¿«é€Ÿå›ç­”è¡¨æ˜ä½ çŸ¥é“ä»€ä¹ˆ`keyframes`å¹¶ä¸”ä½ å¯ä»¥åœ¨åŸºç¡€æ°´å¹³ä¸Šä½¿ç”¨å®ƒã€‚

```
<div class="container">
  <div class="progress-bar"></div>
</div> 
```

```
.container {
  width: 300px;
  height: 50px;
  background-color: #D3D3D3;
}

.progress-bar {
  width: 100%;
  height: 50px;
  background-color: #90EE90;
  animation: 3s linear fill;
}

@keyframes fill {
    0% {
        width: 0%;
    }
    100% {
        width: 100%;
    }
} 
```

[https://codepen.io/healeycodes/embed/pmKQzM?height=600&default-tab=result&embed-version=2](https://codepen.io/healeycodes/embed/pmKQzM?height=600&default-tab=result&embed-version=2)

#### [](#2-start-loading-bar-animation-upon-a-button-click)2ã€‚å•å‡»æŒ‰é’®æ—¶å¼€å§‹åŠ è½½æ¡å½¢åŠ¨ç”»

ç°åœ¨æˆ‘ä»¬æ­£åœ¨è¿›å…¥ JavaScript é¢†åŸŸã€‚æˆ‘ä¸€ç›´è®¤ä¸º`transition`éå¸¸æ£’ï¼Œæ‰€ä»¥æˆ‘å°†ä½¿ç”¨ JavaScript ä¸º`progress-bar`å…ƒç´ æ·»åŠ ä¸€ä¸ªç±»ã€‚å®ƒä½¿ä½ èƒ½å¤Ÿâ€œå®šä¹‰ä¸€ä¸ªå…ƒç´ çš„ä¸¤ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬æ¢â€ [(MDN)](https://developer.mozilla.org/en-US/docs/Web/CSS/transition) ã€‚

æˆ‘ç¡®ä¿ç¼“å­˜å¯¹åŠ è½½æ çš„å¼•ç”¨ã€‚æˆ‘åœ¨æ™ºèƒ½ç”µè§†ä¸Šåšäº†å¾ˆå¤šå·¥ä½œï¼Œç¼“å­˜æ˜¯æˆ‘ä»¬ç”¨æ¥ä¿æŒä¸€åˆ‡æµç•…çš„è®¸å¤šæŠ€å·§ä¹‹ä¸€ã€‚HTML å…ƒç´ æœ‰ [Element#classList](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList) ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ä¸ç±»äº¤äº’çš„ APIã€‚ç”¨èµ·æ¥å¾ˆå®‰å…¨ã€‚æ‚¨å¯ä»¥æ·»åŠ å¤šä¸ªç±»ï¼Œå®ƒåªä¼šæ·»åŠ ä¸€ä¸ªå®ä¾‹ï¼Œæ‚¨ä¹Ÿå¯ä»¥åˆ é™¤ä¸å­˜åœ¨çš„ç±»ï¼Œè€Œä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚

[classList#toggle](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList#Methods) ç‰¹åˆ«æœ‰ç”¨ã€‚"å½“åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶:åˆ‡æ¢ç±»å€¼ï¼›å³ï¼Œå¦‚æœè¯¥ç±»å­˜åœ¨ï¼Œåˆ™åˆ é™¤å®ƒå¹¶è¿”å› falseï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ å®ƒå¹¶è¿”å› true" [(MDN)](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList#Methods) ã€‚

```
<div class="container">
  <div class="progress-bar"></div>
</div>
<button onclick="loadBar()">Load</button> 
```

```
.container {
  width: 300px;
  height: 50px;
  background-color: #D3D3D3;
}

.progress-bar {
  width: 0%;
  height: 50px;
  background-color: #90EE90;
  transition: width 3s linear;
}

.load {
  width: 100%;
} 
```

```
const bar = document.querySelector('.progress-bar');

function loadBar () {
  bar.classList.add('load');
} 
```

[https://codepen.io/healeycodes/embed/MdXzqb?height=600&default-tab=result&embed-version=2](https://codepen.io/healeycodes/embed/MdXzqb?height=600&default-tab=result&embed-version=2)

#### [](#3-queue-multiple-loading-bars-if-the-button-is-clicked-more-than-once-loading-bar-n-starts-animating-with-loading-bar-n1-is-done-animating)3ã€‚å¦‚æœæŒ‰é’®è¢«ç‚¹å‡»å¤šæ¬¡ï¼Œå°†å¤šä¸ªè£…è½½æ æ’é˜Ÿã€‚è£…è½½æ  N å¼€å§‹åŠ¨ç”»ï¼Œè£…è½½æ  N-1 å®ŒæˆåŠ¨ç”»ã€‚

è¿™é‡Œå˜å¾—æ›´æœ‰è¶£äº†ã€‚æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥é€šè¿‡åˆ é™¤å’Œæ·»åŠ ç±»æ¥è¿­ä»£æˆ‘ä»¬ä¹‹å‰çš„è§£å†³æ–¹æ¡ˆï¼Œä½†è¿™æ„Ÿè§‰å¾ˆç³Ÿç³•ã€‚æˆ‘è®¤ä¸ºç›®çš„æ˜¯è®©ä½ åœ¨è¿™é‡Œä½¿ç”¨æ›´å¤šçš„ JavaScriptã€‚æŠ€æœ¯é¢è¯•é—®é¢˜å…¶å®æ²¡æœ‰ç»ˆç‚¹ã€‚æ€»æ˜¯æœ‰é™åˆ¶ã€æ‰©å±•å’Œå‡è®¾å¯ä»¥æŠ›å‡ºã€‚åœ¨ç»§ç»­é˜…è¯»ä¹‹å‰ï¼Œæˆ‘æƒ³çœ‹çœ‹ä½ æœ‰ä»€ä¹ˆæƒ³æ³•ğŸ‘€ã€‚

è¿™é‡Œæœ‰å‡ ä¸ªé™·é˜±ã€‚ä½ å¿…é¡»ç¡®ä¿æ‰€ç”¨çš„æ—¶é—´æ­£å¥½æ˜¯ä¸‰ç§’ï¼Œè€Œä¸æ˜¯å¤šä¸€ç§’æˆ–å°‘ä¸€ç§’ã€‚ä¸€åªæ‰è™±çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Ÿæˆ‘æƒ³è¿™å–å†³äºä½ çš„é…’å§æœ‰å¤šå®½ã€‚æ¯æ¬¡ä¸Šæ¶¨ 1%ä¼¼ä¹æ˜¯ä¸€ä¸ªæœ€ä½³æ—¶æœºã€‚æ³¨æ„:ç®¡ç†è‡ªå·±çš„çŠ¶æ€æ¯”ä¾èµ– DOM æ›´å¥½ã€‚

ç¼“å­˜åœ¨è¿™é‡Œéå¸¸é‡è¦ã€‚æ‚¨ä¸å¸Œæœ›ä¸€ç§’é’Ÿå†…éå† DOM 33 æ¬¡æ¥æŸ¥æ‰¾ä¸€ä¸ªå…ƒç´ ã€‚å¹²å‡€çš„ä»£ç å¯èƒ½éœ€è¦ä¸¤ä¸ªå‡½æ•°ã€‚æˆ‘ä½¿ç”¨äº†ä¸€ä¸ªå…¨å±€æ ‡å¿—æ¥è·Ÿè¸ªè¿›åº¦æ¡æ˜¯å¦åœ¨è¿è¡Œã€‚æˆ‘ä»¬æƒ³æ·»åŠ ä¸€ä¸ªåˆ°é˜Ÿåˆ—ä¸­ï¼Œä½†æˆ‘ä»¬ä¸å¸Œæœ›ä¸¤ä¸ªåŒæ—¶è¿›è¡Œï¼Œå¦åˆ™æˆ‘ä»¬çš„é…’å§å°†åŠ è½½ä¸¤å€çš„é€Ÿåº¦ï¼

```
<div class="container">
  <div class="progress-bar"></div>
</div>
<div>Queued bars: <span class="queued">0</span></div>
<button onclick="loadBar()">Load</button> 
```

```
.container {
  width: 300px;
  height: 50px;
  background-color: #D3D3D3;
}

.progress-bar {
  width: 0%;
  height: 50px;
  background-color: #90EE90;
} 
```

```
const bar = document.querySelector('.progress-bar');
const queued = document.querySelector('.queued');

let loader = false;
let width = 0;
let count = 0;

function loadBar() {
  queued.innerText = ++count;
  if (loader === false) {
    bar.style.width = 0;
    tick();
  }
}

function tick() {
  loader = true;
  if (++width > 100) {
    queued.innerText = --count;
    width = 0;
    if (count < 1) {
      loader = false;
      return;
    }
  }
  bar.style.width = `${width}%`;
  setTimeout(tick, 30);
} 
```

[https://codepen.io/healeycodes/embed/ZNRVBa?height=600&default-tab=result&embed-version=2](https://codepen.io/healeycodes/embed/ZNRVBa?height=600&default-tab=result&embed-version=2)

#### [](#4-do-the-same-thing-but-without-timers)4ã€‚åšåŒæ ·çš„äº‹æƒ…ï¼Œä½†æ²¡æœ‰è®¡æ—¶å™¨ï¼

å¥½å§ï¼Œä»–ä»¬åœ¨é‡‡è®¿ä¸­å¹¶æ²¡æœ‰çœŸæ­£é—®è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æœ‰äººåœ¨ DEV çš„è¯„è®ºä¸­æåˆ°äº†`requestAnimationFrame`,æˆ‘è®¤ä¸ºåœ¨æ¨¡ä»¿ä¹‹å‰çš„ç­”æ¡ˆçš„åŒæ—¶ç”¨å®ƒæ¥æ„å»ºä¸€ä¸ªä¾‹å­ä¼šå¾ˆæœ‰è¶£ã€‚

å¦‚æœä¸éœ€è¦æ’é˜Ÿè£…è½½é…’å§ï¼Œé€»è¾‘ä¼šçŸ­å¾—å¤šã€‚æˆ‘æœ€ç»ˆå†³å®šä½¿ç”¨ä¸¤ä¸ªè€¦åˆçš„å‡½æ•°ã€‚æœ€è¿‘ï¼Œæˆ‘çœ‹åˆ°æœ‰äººè¯´ä»»ä½•ä¸€ä¸ª`else`çš„å®ä¾‹éƒ½æ˜¯é‡æ„çš„æœºä¼šã€‚æˆ‘ä¸€ç›´åœ¨æ€è€ƒè¿™ä¸ªé—®é¢˜ï¼Œè™½ç„¶æ²¡æœ‰ä¸€æ¡è§„åˆ™æ˜¯æ­£ç¡®çš„ï¼Œä½†å®ƒæœ€è¿‘ä¸€ç›´åœ¨å½±å“æˆ‘å¦‚ä½•å¡‘é€ å‡½æ•°ã€‚çœ‹çœ‹è¿™ä¸ªã€‚

```
<div class="container">
  <div class="progress-bar"></div>
</div>
<div>Queued bars: <span class="queued">0</span></div>
<button onclick="loadBar(1)">Load</button> 
```

```
.container {
  width: 300px;
  height: 50px;
  background-color: #D3D3D3;
}

.progress-bar {
  width: 0%;
  height: 50px;
  background-color: #90EE90;
} 
```

```
const bar = document.querySelector('.progress-bar');
const queued = document.querySelector('.queued');

let loading = false;
let count = 0;

function tick (timestamp, dist, duration) {
  const runtime = timestamp - starttime;
  let progress = runtime / duration;
  progress = Math.min(progress, 1);
  bar.style.width = `${dist * progress}%`;
  if (runtime > duration) {
    loading = false;
    count--;
    loadBar(0);
    return;
  }
  requestAnimationFrame (function(timestamp) {
      tick(timestamp, dist, duration)
  });
}

function loadBar (increment) {
  count += increment;
  queued.innerText = count;
  if (loading === true || count < 1) { return; }
  bar.style.width = 0;
  loading = true;
  requestAnimationFrame (function(timestamp) {
    starttime = timestamp;
    tick(timestamp, 100, 3000);
  });
} 
```

[https://codepen.io/healeycodes/embed/EzpJNo?height=600&default-tab=result&embed-version=2](https://codepen.io/healeycodes/embed/EzpJNo?height=600&default-tab=result&embed-version=2)

### [](#end-notes)ç»“æŸæ³¨é‡Š

å¦‚æœä½ æ•´ç¯‡æ–‡ç« éƒ½åœ¨å¯¹æˆ‘å¤§å–Šå¤§å«ï¼Œé‚£å°±æ˜¯é«˜åˆ†ã€‚æ˜¯çš„ï¼Œè¿™ä¸ª[å…ƒç´ ](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/progress)ä» HTML5 å¼€å§‹å°±å­˜åœ¨äº†ã€‚æ‚¨å¯ä»¥é€šè¿‡è®¾ç½®ä¸¤ä¸ªå±æ€§`max`å’Œ`value`æ¥ç®¡ç†å®ƒã€‚CSS Tricks æœ‰ä¸€ç¯‡[æ–‡ç« ](https://css-tricks.com/html5-progress-element/)ä»‹ç»å¦‚ä½•å¯¹å…¶è¿›è¡Œæ ·å¼åŒ–å’ŒåŠ¨ç”»åŒ–ã€‚å®ƒä»¬è¿˜æ¶µç›–äº†ä¸åŒçš„çŠ¶æ€ï¼Œç¡®å®šçš„å’Œä¸ç¡®å®šçš„â€”â€”åè€…æ„å‘³ç€â€œæœªçŸ¥çš„è¿›å±•â€ã€‚è¿™äº›çŠ¶æ€å¾ˆæ£’ï¼Œå› ä¸ºå®ƒä»¬ç»™äº†æˆ‘ä»¬ä¸€ç§ä¸ç”¨æˆ·äº¤æµçš„æ–¹å¼ã€‚

è¿™ä¸ªé¢è¯•é—®é¢˜ä¸æ˜¯å…³äºå®Œç¾çš„ç­”æ¡ˆï¼Œè€Œæ˜¯å…³äºä½ å¦‚ä½•åœ¨é¢è¯•è¿‡ç¨‹ä¸­è¡¨è¾¾ä½ çš„æƒ³æ³•ï¼Œä»¥åŠä½ æå‡ºçš„é—®é¢˜ã€‚æ˜¯å¦ä¹Ÿåº”è¯¥æœ‰ç™¾åˆ†æ¯”çš„æ•°å­—è¡¨ç¤ºï¼Ÿè¿™æ˜¯åœ¨ä½åŠŸè€—è®¾å¤‡ä¸Šè¿è¡Œå—ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œä¸è¦ä»¥ç™¾åˆ†ä¹‹ä¸€çš„å¢é‡ä¸Šå‡ã€‚ä¹Ÿè®¸äº”ä¸ªæˆ–åä¸ªæ›´å¥½ã€‚

æˆ‘è®¤ä¸ºä¸€ä¸ªå¥½çš„æ‰©å±•å¯èƒ½æ˜¯è¦æ±‚å—è®¿è€…æ„å»ºä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£æ¥æ”¶æè¿°è¿›åº¦çŠ¶æ€çš„ WebSocket æ¶ˆæ¯å¹¶å°†å…¶ä¼ è¾¾ç»™ç”¨æˆ·ã€‚

å¦‚ä½•çœ‹å¾…è¿™ä¸ªé¢è¯•é—®é¢˜ï¼Ÿå¯¹ä½ æ¥è¯´ï¼Œå®ƒæ˜¯å¦åœ¨è§£å†³é—®é¢˜å’Œæµè§ˆå™¨çŸ¥è¯†çš„åå­—è·¯å£ç›¸é‡ï¼Ÿ

* * *

åŠ å…¥æˆ‘çš„å…³äºç¼–ç¨‹å’Œä¸ªäººæˆé•¿çš„[æ—¶äº‹é€šè®¯](https://buttondown.email/healeycodes)çš„ 150 å¤šäººæ³¨å†Œï¼

æˆ‘å‘å…³äºç§‘æŠ€çš„å¾®åšã€‚