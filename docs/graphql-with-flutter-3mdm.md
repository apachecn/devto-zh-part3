# æœ‰é¢¤åŠ¨çš„å›¾

> åŸæ–‡ï¼š<https://dev.to/nitishk72/graphql-with-flutter-3mdm>

GraphQL æ˜¯ä¸€ç§æŸ¥è¯¢è¯­è¨€ï¼Œæˆ‘ä»¬ç”¨å®ƒå‘ GraphQL æœåŠ¡å™¨å‘é€æŸ¥è¯¢ã€‚æœåŠ¡å™¨åœ¨è¿è¡Œæ—¶æ‰§è¡ŒæŸ¥è¯¢ï¼Œç”¨ç°æœ‰æ•°æ®å®Œæˆè¿™äº›æŸ¥è¯¢ã€‚

è®©æˆ‘ç”¨æ›´ç®€å•çš„è¯è®©ä½ æ˜ç™½è¿™ä¸€ç‚¹ã€‚æˆ‘æƒ³ä½ çŸ¥é“ SQL(ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€)ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªç”¨æˆ·è¡¨ï¼Œå…¶ä¸­åŒ…å«ä»–ä»¬çš„å§“åã€å¹´é¾„ã€ç”µå­é‚®ä»¶ã€ç”µè¯ç­‰ä¿¡æ¯ã€‚ç°åœ¨ï¼Œæ‚¨æƒ³è·å–ç”¨æˆ·çš„å§“åå’Œç”µå­é‚®ä»¶ï¼Œç„¶åç¼–å†™ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ‚¨å°†è·å¾—è¯¥ä¿¡æ¯ã€‚(é€‰æ‹©å§“åï¼Œå‘ç”¨æˆ·å‘é€ç”µå­é‚®ä»¶)ã€‚

ä½ ä¸ä¼šå¾—åˆ°ç”¨æˆ·çš„å¹´é¾„å’Œç”µè¯ï¼Œå› ä¸ºä½ æ²¡æœ‰è¦æ±‚è¿™äº›ä¿¡æ¯ã€‚è¿™äº›éƒ½æ˜¯æœåŠ¡å™¨ç«¯(åç«¯)çš„äº‹æƒ…ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªå‰ç«¯å¼€å‘äººå‘˜ï¼Œä½ å·²ç»åšäº† 20 é¡µï¼Œä½ éœ€è¦ç”¨æˆ·ä¿¡æ¯ã€‚ä½ ä¼šé—®åç«¯å¼€å‘äººå‘˜ï¼Œæˆ‘æƒ³åœ¨ä¸åŒçš„é¡µé¢ä¸Šçš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘éœ€è¦ä¸€ä¸ª APIã€‚åç«¯å¼€å‘äººå‘˜å°†ä½¿ API ä¼šç»™ä½ ä¸€ä¸ªç«¯ç‚¹ã€‚

>åœ¨ 6 é¡µä¸Šä½ åªéœ€è¦ç”¨æˆ·å

>åœ¨ 10 é¡µä¸Šä½ éœ€è¦ç”¨æˆ·å

>åœ¨ 4 é¡µä¸Šä½ éœ€è¦ç”¨æˆ·åé‚®ç®±å’Œç”µè¯ã€‚

å› æ­¤ï¼Œåç«¯å¼€å‘äººå‘˜å¯ä»¥é‡‡ç”¨ä¸¤ç§æ–¹æ³•ã€‚

1.  ä»–å°†ä½¿ç”¨ä¸åŒçš„æ•°æ®åˆ›å»º 3 ä¸ªä¸åŒçš„ç«¯ç‚¹ã€‚
2.  ä»–å¯ä»¥ç”¨æ‰€æœ‰çš„ä¿¡æ¯åšä¸€ä¸ªé€šç”¨çš„ APIã€‚

è¿™ä¸¤ç§æ–¹æ³•çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ

1.  æˆ‘ä»¬æœ‰å¤šä¸ªç«¯ç‚¹ã€‚å¦‚æœæœ‰ä¸€å¤©æˆ‘ä»¬ä¼šå¿˜è®°ç”¨æˆ·çš„å§“åå’Œå¹´é¾„ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å»ºç«‹å¦ä¸€ä¸ªç«¯ç‚¹ã€‚
2.  æˆ‘ä»¬æ²¡æœ‰å¤šä¸ªç«¯ç‚¹**ä½†æ˜¯**æˆ‘ä»¬æ­£åœ¨è·å–æ•°æ®ï¼Œåœ¨æ¯ä¸€é¡µä¸Šæˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·çš„æ‰‹æœºä»ç„¶åœ¨è·å–æ•°æ®ã€‚

ä½ å¯èƒ½è®¤ä¸ºè¿‡åº¦æŠ“å–æ²¡æœ‰ä»€ä¹ˆä¸å¥½ï¼Œå› ä¸ºé¢å¤–çš„æ•°æ®ä¸ä¼šå ç”¨æˆ‘ä»¬çš„å¸¦å®½ã€‚ä½ åœ¨è¿™é‡Œå¯èƒ½æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºä½ æ˜¯åœ¨ä½å°ºåº¦ä¸Šæ€è€ƒã€‚ä½ æ²¡è§è¿‡å¤§å‹ APIã€‚

> æˆ‘çŸ¥é“ä½ æ¥è¿™é‡Œæ˜¯ä¸ºäº†çœ‹è¿™åœºæ··ä¹±

ä½†æ˜¯æœ€åä¸€ä¸ªå…³äº GraphQL çš„æ¼”ç¤º,æˆ‘ä»¬å°†è½¬ç§»åˆ° Flutter éƒ¨åˆ†

<figure>[![](img/415d4116f5070f384d8c99f4c06ef8ad.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--lYN38z2O--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/640/1%2AOdnn356RBy_nlu27CptELw.gif) 

<figcaption>Demo æ¥è‡ª GraphQL å®˜ç½‘</figcaption>

</figure>

ä¸åŒçš„æŠ€æœ¯æœ‰ä¸åŒçš„ GraphQL å®ç°ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šå®ç° GraphQLï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨ GraphQL Query ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æ‰€ä»¥åœ¨ä¸€ç¬é—´ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®ç° GraphQL æœåŠ¡å™¨ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ª[ç°æˆçš„ GraphQL æœåŠ¡å™¨](https://countries.trevorblades.com/)ï¼Œæˆ‘ä»¬å°†ä»é‚£é‡Œè·å–æ•°æ®ã€‚

[å›¾å½¢ SQL æ¸¸ä¹åœº](https://countries.trevorblades.com/)

[https://www.youtube.com/embed/Re7FPa3wzN0](https://www.youtube.com/embed/Re7FPa3wzN0)

è®©æˆ‘ä»¬æ¥çœ‹çœ‹ Flutter ç¼–ç éƒ¨åˆ†ï¼Œå¹¶äº†è§£å®ƒåˆ°åº•æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

Graphql Flutter is 1.x.x ç›®å‰åœ¨ **flutter dev é¢‘é“æœ‰å”®ã€‚**å¦‚æœä½ ä¸çŸ¥é“è¿™ä¸ªå¼€å‘é¢‘é“æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå¦‚ä½•è¿æ¥åˆ°å¼€å‘é¢‘é“ï¼Œè¯·ä¸è¦æ‹…å¿ƒï¼Œæˆ‘ä¼šå‘Šè¯‰ä½ ã€‚

é¢¤æŒ¯æœ‰ 4 ä¸ªé€šé“ï¼Œå…¶ä¸­é¢¤æŒ¯(æµ‹è¯•ï¼Œå¼€å‘ï¼Œä¸»ç¨³å®š)ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½åœ¨ç¨³å®šé€šé“ä¸Šï¼Œä»¥ä¾¿ä½¿ç”¨ GraphQL (1.x.x)ã€‚æˆ‘ä»¬éœ€è¦æ¢ä¸ªé¢‘é“ã€‚

**æ€ä¹ˆæ¢é¢‘é“ï¼Ÿ**

```
$ flutter channel dev 
```

ç°åœ¨ä½ éœ€è¦æ£€æŸ¥é€šé“ï¼Œè¿™å°†ä¸‹è½½ä¸€äº› Dart never ç‰ˆæœ¬ï¼Œé¢¤æŒ¯å¼€å‘é€šé“ä¾èµ–äºå®ƒã€‚ä½ åªéœ€è¦æ£€æŸ¥é¢‘é“ï¼Œæ–‡ä»¶å°±ä¼šè‡ªåŠ¨ä¸‹è½½ã€‚

```
$ flutter channel 
```

### æ—‹èˆä»è¿™é‡Œå¼€å§‹

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸º graph QL([graph QL _ flutter](https://github.com/zino-app/graphql-flutter#readme))
æ·»åŠ ä¾èµ–å…³ç³»

```
name: flutter_graphql_demo
description: A new Flutter application.
version: 1.0.0+1

environment:
  sdk: ">=2.1.0  <3.0.0"

dependencies:
  flutter:
    sdk: flutter
  cupertino_icons: ^0.1.2
  graphql_flutter: ^1.0.0+4 
```

ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹ä¸ºé¢¤æŒ¯ç¼–å†™ä»£ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª GraphQL å®¢æˆ·ç«¯ï¼Œè¯¥å®¢æˆ·ç«¯å°†ä¸ GraphQL æœåŠ¡å™¨é€šä¿¡ï¼Œæˆ‘ä»¬åªæ˜¯é€šçŸ¥å®¢æˆ·ç«¯æœ‰å…³ GraphQL æŸ¥è¯¢çš„ä¿¡æ¯ã€‚

> è®©æˆ‘ä»¬æ¥è®¾ç½® GraphQL å®¢æˆ·ç«¯

```
import 'package:flutter/material.dart';
import 'package:graphql_flutter/graphql_flutter.dart';

void main() {
  runApp(MaterialApp(title: "GQL App",home: MyApp()));
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final HttpLink httpLink = HttpLink(uri: "https://countries.trevorblades.com/");

    final ValueNotifier<GraphQLClient> client = ValueNotifier<GraphQLClient>(
      GraphQLClient(
        link: httpLink as Link,
        cache: OptimisticCache(
          dataIdFromObject: typenameDataIdFromObject,
        ),
      ),
    );

    return GraphQLProvider(
      child: HomePage(),
      client: client,
    );
  }
} 
```

æˆ‘å°†è°ˆåˆ°ä¸ GraphQL ç›¸å…³çš„æ¯ä¸€ç‚¹ã€‚

è¦ä½¿ç”¨å®¢æˆ·ç«¯ï¼Œé¦–å…ˆéœ€è¦ç”¨é“¾æ¥å’Œç¼“å­˜è¿›è¡Œåˆå§‹åŒ–ã€‚å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ HttpLink ä½œä¸ºæˆ‘ä»¬çš„é“¾æ¥ï¼Œä½¿ç”¨ Optimisticache ä½œä¸ºæˆ‘ä»¬çš„ç¼“å­˜ã€‚

åœ¨ç¬¬ 15 è¡Œä½ å¯ä»¥çœ‹åˆ°é“¾æ¥ã€‚Link ç”¨äºé€šè¿‡æ‰€éœ€çš„å¤´(å¦‚æœæœ‰)æŒ‡å‘ GraphQL æœåŠ¡å™¨çš„ç«¯ç‚¹ã€‚æ ‡å¤´ç”¨äºå¯¹å®¢æˆ·ç«¯è¿›è¡Œèº«ä»½éªŒè¯ã€‚

æ¯å½“æœ‰ä»»ä½•å€¼æ”¹å˜æ—¶ï¼Œå€¼é€šçŸ¥å™¨å°±é€šçŸ¥å®ƒä»¬çš„ç›‘å¬å™¨

æˆ‘ä»¬ç”¨ GraphQLProvider åŒ…è£…åº”ç”¨ç¨‹åºçš„å®Œæ•´é¡µé¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å‘ GraphQL æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè€Œæ— éœ€æŒ‡å®šç«¯ç‚¹å’Œå¤´ã€‚è¿™æ„å‘³ç€ä»æˆ‘ä»¬çš„é¡µé¢å†…éƒ¨ï¼Œæˆ‘ä»¬åªéœ€è¦å‘Šè¯‰æŸ¥è¯¢å’Œ GraphQL æä¾›è€…å°†ä¸ºæˆ‘ä»¬åšæ‰€æœ‰çš„ä»»åŠ¡ã€‚è¿™å°±æ˜¯å®ƒè¢«ç§°ä¸ºå®¢æˆ·ç«¯åº“çš„åŸå› ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬å°† GraphQL å®¢æˆ·ç«¯åˆ†ç¦»åˆ°ä¸€ä¸ªä¸åŒçš„æ— çŠ¶æ€å®¢æˆ·ç«¯ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨è¿™é‡Œç¼–å†™ä»»ä½• UI ä»£ç ï¼Œå› ä¸ºæˆ‘æƒ³å°†å®ƒä»¬åˆ†å¼€(GraphQL å®¢æˆ·ç«¯å’Œ Flutter UI)ã€‚

è¿™æ˜¯æˆ‘ä»¬å°†å‘é€ä»¥è·å– GraphQL æœåŠ¡å™¨å¹¶æ˜¾ç¤ºå›½å®¶åˆ—è¡¨çš„æŸ¥è¯¢ã€‚æ‚¨å¯ä»¥å°è¯•å°†è¿™ä¸ªæŸ¥è¯¢å¤åˆ¶å¹¶ç²˜è´´åˆ°è¿™ä¸ª [GraphQL æœåŠ¡å™¨](https://countries.trevorblades.com/)ä¸Šã€‚

```
query {
 countries {
 name
 }
} 
```

> è®©æˆ‘ä»¬æ¶ˆè´¹å›¾è¡¨å®¢æˆ·ç«¯çš„å“åº”

ç°åœ¨æˆ‘ä»¬è¦ä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåˆ¶ä½œ UI

```
class HomePage extends StatelessWidget {
  String query = r"""
                      query GetCountries{
                          countries {
                            name
                          }
                      }
                  """;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text("GraphlQL Client"),
      ),
      body: Query(
        options: QueryOptions(document: query),
        builder: (
          QueryResult result, {VoidCallback refetch}) {
          if (result.loading) {
            return Center(child: CircularProgressIndicator());
          }
          if (result.data == null) {
            return Center(child : Text("No Data Found !"));
          }
          return ListView.builder(
            itemBuilder: (BuildContext context, int index) {
              return ListTile(
                title: Text(result.data['countries'][index]['name'])
              );
            },
            itemCount: result.data['countries'].length,
          );
        },
      ),
    );
  }
} 
```

è¿™æ˜¯æˆ‘ä»¬ UI çš„ä»£ç ï¼Œè®©æˆ‘ä»¬æ¥ç†è§£è¿™æ®µä»£ç ä¸­çš„ GraphQL éƒ¨åˆ†ã€‚

æˆ‘ä»¬ä½¿ç”¨æ’ä»¶å®šä¹‰çš„ **Query()** å°éƒ¨ä»¶ã€‚å®ƒä¸æ˜¯æœ¬æœºå°éƒ¨ä»¶ã€‚**æŸ¥è¯¢**åœ¨è¿™é‡Œæœ‰ä¸¤ä¸ªå­—æ®µ

1.  é€‰é¡¹:é€‰é¡¹è¦æ±‚æŸ¥è¯¢ã€‚æˆ‘ä»¬è¦å‘æœåŠ¡å™¨å‘é€ä»€ä¹ˆæ ·çš„æŸ¥è¯¢ï¼Œå¦‚æœä½ æƒ³å°†ä¸€äº›å˜é‡å’ŒæŸ¥è¯¢ä¸€èµ·å‘é€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»ä»é€‰é¡¹ä¸­ä¼ é€’ã€‚
2.  å»ºç­‘å•†:å»ºç­‘å•†å’Œå…¶ä»–å»ºç­‘å•†ä¸€æ ·ï¼Œåœ¨ä¸€ç‰‡æ··ä¹±ä¸­ã€‚æ„å»ºå™¨æ ¹æ®æ•°æ®æ›´æ”¹å…¶çŠ¶æ€ã€‚(ä½ å¯ä»¥æŠŠè¿™ä¸ª builder æ¯”ä½œ FutureBuilderã€‚

é¦–å…ˆï¼Œå®ƒå°†å‘æœåŠ¡å™¨å‘é€æŸ¥è¯¢ï¼Œå¹¶è¿›å…¥åŠ è½½çŠ¶æ€ã€‚ä½ å¯ä»¥çœ‹åˆ°åŠ è½½æ—¶æˆ‘ä»¬æ­£åœ¨æ˜¾ç¤ºå¾ªç¯è¿›åº¦æ ()ã€‚ä¸€æ—¦æŸ¥è¯¢çš„æ‰§è¡Œå’ŒåŠ è½½çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå®ƒå°†è¿›å…¥å®ŒæˆçŠ¶æ€ã€‚

åœ¨å®ŒæˆçŠ¶æ€ä¸‹ï¼Œå®ƒè¦ä¹ˆæœ‰é”™è¯¯ï¼Œè¦ä¹ˆæœ‰æ•°æ®ã€‚å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæˆ‘ä»¬å°†æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯,**æœªæ‰¾åˆ°æ•°æ®ï¼ã€‚**

result.data =æ‚¨åœ¨ GraphQL æ“åœºä¸Šçœ‹åˆ°çš„æ•°æ®ã€‚

[![](img/95fe59f80abebe27bdc61b6fffef2f44.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--9QvnuRqf--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1024/1%2A9z9_TcJwFPraSKpIpmzrdQ.png)

å¦‚æœæˆ‘ä»¬å¾—åˆ°äº†æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç»™å‡ºäº†ç­”æ¡ˆã€‚å“åº”å’Œ JSON å“åº”ä¸€æ ·ï¼Œä½ åªéœ€è¦æŠŠå›½å®¶ä»å“åº”ä¸­å–å‡ºæ¥ï¼Œå¹¶æ˜¾ç¤ºåœ¨ä½ çš„ UI ä¸­ã€‚æˆ‘æƒ³ä½ çŸ¥é“è¿™ä»¶äº‹ã€‚

[nitishk 72/flutter _ graph QL _ demo](https://github.com/nitishk72/flutter_graphql_demo)

æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ å–œæ¬¢ï¼Œè¯·é¼“æŒã€‚å¦‚æœä½ æœ‰ä»€ä¹ˆè¦è¯´çš„ï¼Œé‚£å°±å‘è¡¨è¯„è®ºå§ï¼Œä¸è¦å¤ªé™Œç”Ÿã€‚

[å°¼æä»€Â·åº“é©¬å°”Â·singhğŸ‡®ğŸ‡³(@å°¼æä»€å…‹ 72_) |æ¨ç‰¹](https://twitter.com/nitishk72_)

* * *