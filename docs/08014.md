# 5 åˆ†é’Ÿå†…ç”¨èŠ‚ç‚¹å’Œ Express ä¼‘æ¯ API

> åŸæ–‡:[https://dev . to/lennythedev/quick-rest-API-with-node-and-express-in-5-minutes-336j](https://dev.to/lennythedev/quick-rest-api-with-node-and-express-in-5-minutes-336j)

*Node+Express ç³»åˆ—ç¬¬äºŒéƒ¨åˆ†*

ç°åœ¨æˆ‘ä»¬æœ‰äº†æ¥è‡ª[ç¬¬ä¸€éƒ¨åˆ†](https://dev.to/lenmorld/quick-server-with-node-and-express-in-5-minutes-17m7)
çš„ç¬¬ä¸€ä¸ª Node + Express æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¼‘æ¯ä¸€ä¸‹äº†ï¼

å®‰æ¯å§ğŸ›ŒğŸ˜´ï¼Ÿï¼Ÿï¼Ÿ
ä¸æ˜¯å…¶ä»–ï¼Œè€Œæ˜¯ **REST** (è¡¨è¿°æ€§çŠ¶æ€è½¬ç§»)ï¼Œå®ƒåŸºæœ¬ä¸Šæ˜¯é€šè¿‡ HTTP æ–¹æ³•å‘å®¢æˆ·ç«¯æä¾›ä¸€ä¸ª APIã€‚

[![rest_api](../Images/7ae116f180eab033fd2203b75aa12cde.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--GKk-_wE5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://memegenerator.net/img/instances/400x/66287620/rest-api-rest-api-everywhere.jpg)

**å‰§é€è­¦æŠ¥**ğŸ˜±ğŸ˜œ
æˆ‘ä»¬å¯ä»¥å°† CRUD è¿™æ ·çš„åŸºæœ¬æ“ä½œæ˜ å°„åˆ°æŸäº› HTTP æ–¹æ³•ã€‚
å¦‚æœä½ ä¸å–œæ¬¢å‰§é€æˆ–è€…çœ‹è¡¨æ ¼ä¼šè®©ä½ å›°æƒ‘ï¼Œè¯·è·³è¿‡ğŸ˜µã€‚

| CRUD æ“ä½œ | HTTP æ–¹æ³• | ç»Ÿä¸€èµ„æºå®šä½å™¨ | URL params | è¯·æ±‚æ­£æ–‡ | ä¾‹å­ |
| --- | --- | --- | --- | --- | --- |
| åˆ›é€  | é‚®æ”¿ | `/items` |  | `body: {...}` | `POST /items body: {...}` |
| çº¢è‰²çš„ | å¾—åˆ° | `/items/:id` | `:id`(é¡¹ç›® id) |  | `GET /items/123` |
| äº²çˆ±çš„å¤§å®¶ | å¾—åˆ° | `/items` |  |  | `GET /items` |
| æ›´æ–° | æ”¾ | `/items/:id` | `:id`(é¡¹ç›® id) | `body: {...}` | `PUT /items/123 body:{...}` |
| åˆ é™¤ | åˆ é™¤ | `/items/:id` | `:id`(é¡¹ç›® id) |  | `DELETE /items/123` |

è¯·æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§çš„æ–¹å¼ï¼Œä½†æ˜¯æ‚¨ä¹Ÿå¯ä»¥å®ç°ï¼Œæ¯”å¦‚è¯´ POST for UPDATE å’Œ DELETEã€‚æŸ¥çœ‹ä¼‘æ¯ä¸­çš„[å¹‚ç­‰æ€§](https://restfulapi.net/idempotent-rest-apis/)ä»¥äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

## [](#lets-get-started)æˆ‘ä»¬å¼€å§‹å§ï¼

### [](#sample-data)æ ·æœ¬æ•°æ®

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›æ ·æœ¬æ•°æ®ã€‚è®©æˆ‘ä»¬ç”¨ä¸€äº›ç”µå½±ğŸï¸åœ¨ IMDB çš„å‰ 250 åä¸­ï¼Œå› ä¸ºæˆ‘çš„ç”µå½±é€‰æ‹©å¯èƒ½ä¸å¯é ğŸ¤ª

åˆ›å»º`data.js`æ–‡ä»¶ã€‚è¯·éšæ„æ·»åŠ é¡¹ç›®å’Œé¡¹ç›®ç»†èŠ‚ã€‚

```
// data.js
module.exports = [
    { "id": "tt0110357", "name": "The Lion King", "genre": "animation"},
    { "id": "tt0068646", "name": "The Godfather", "genre": "crime"},
    { "id": "tt0468569", "name": "The Dark Knight", "genre": "action"},
]; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

> å‘å…¶ä»–æ–‡ä»¶å…¬å¼€è¯¥æ•°ç»„

åœ¨æˆ‘ä»¬çš„`server.js`æ–‡ä»¶
ä¸­å¯¼å…¥æ–‡ä»¶

```
// server.js
let data = require('./data');
...

// our API routes go here 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#get)å¾—åˆ°

è·å–æ‰€æœ‰ç‰©å“
*è·å–/ç‰©å“*

```
server.get("/items", (req, res) => {
   res.json(data);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è·å–ä¸€ä¸ªç”±`:id`
*æ ‡è¯†çš„é¡¹ç›® GET /items/:id*

æˆ‘ä»¬ä½¿ç”¨`Array.find`è·å–ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ¡ç›®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œ
åˆ™æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯ã€‚

æ³¨æ„ï¼Œé¡¹ç›® id æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`tt0110357`ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨`===`è¿›è¡Œæ¯”è¾ƒã€‚
å¦‚æœä½ ä½¿ç”¨ä¸€ä¸ªæ•´æ•° idï¼Œä½ å¿…é¡»åœ¨æ¯”è¾ƒå‰è§£æã€‚

```
server.get("/items/:id", (req, res) => {
   const itemId = req.params.id;
   const item = data.find(_item => _item.id === itemId);

   if (item) {
      res.json(item);
   } else {
      res.json({ message: `item ${itemId} doesn't exist`})
   }
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
$ curl http://localhost:4000/items
[{"id":"tt0110357","name":"The Lion King","genre":"animation"},{"id":"tt0068646","name":"The Godfather","genre":"crime"},{"id":"tt0468569","name":"The Dark Knight","genre":"action"}]

$ curl http://localhost:4000/items/tt0110357
{"id":"tt0110357","name":"The Lion King","genre":"animation"}

$ curl http://localhost:4000/items/blahblah
{"message":"item blahblah doesn't exist"} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#post)å²—ä½

ä¸ºäº†åœ¨ POST æ¶ˆæ¯ä¸­ç¼–ç å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¸»ä½“ï¼Œæˆ‘ä»¬éœ€è¦`body-parser`ä¸­é—´ä»¶ã€‚
è¿™å…è®¸æˆ‘ä»¬åœ¨è·¯ç”±å¤„ç†å™¨
ä¸­ä½¿ç”¨`req.body`

```
npm install body-parser 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åæˆ‘ä»¬è¿›å£ä½¿ç”¨ã€‚æˆ‘ä»¬ç°åœ¨åªæ¥å— JSON ç¼–ç çš„ä¸»ä½“ã€‚

```
// server.js

const body_parser = require('body-parser');

// parse JSON (application/json content-type)
server.use(body_parser.json()); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¼ è´´ä¸€ä¸ªé¡¹ç›®
*å¼ è´´/é¡¹ç›®*

è¿™é‡Œï¼Œæˆ‘ä»¬ä»`req.body`è·å–æ•´ä¸ªé¡¹ç›®ï¼Œå› ä¸ºå®ƒä¸æˆ‘ä»¬çš„æ•°æ®
ç›¸åŒ¹é…ï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼Œä¹Ÿå¯ä»¥åªè·å–ï¼Œä¾‹å¦‚`req.body.name`

```
// server.js

...
server.post("/items", (req, res) => {
   const item = req.body;
   console.log('Adding new item: ', item);

   // add new item to array
   data.push(item)

   // return updated list
   res.json(data);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
$ curl -X POST -H "Content-Type: application/json" --data '{"id": "tt0109830", "name": "Forrest Gump", "genre": "drama"}' http://localhost:4000/items

[..., {"id":"tt0109830","name":"Forrest Gump","genre":"drama"}] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#put)æ”¾

è¦æ›´æ–°ä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å¸Œæœ›å®¢æˆ·ç«¯åœ¨ URL å‚æ•°(`req.params.id` )
ä¸­ä¼ é€’é¡¹ç›® idï¼Œå¹¶åœ¨ä¸»ä½“(`req.body`)ä¸­ä¼ é€’æ›´æ–°çš„å¯¹è±¡

è¿™é‡Œæˆ‘ä»¬ç®€å•åœ°ä½¿ç”¨`forEach`æ›¿æ¢æ—§çš„ï¼Œä½†æ˜¯æ‚¨å¯ä»¥åº”ç”¨æ‚¨è‡ªå·±çš„
ç®—æ³•æ¥æ›¿æ¢å¯¹è±¡æ•°ç»„ä¸­çš„ä¸€ä¸ªå¯¹è±¡æˆ–ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ã€‚

```
 // update an item
server.put("/items/:id", (req, res) => {
   const itemId = req.params.id;
   const item = req.body;
   console.log("Editing item: ", itemId, " to be ", item);

   const updatedListItems = [];
   // loop through list to find and replace one item
   data.forEach(oldItem => {
      if (oldItem.id === itemId) {
         updatedListItems.push(item);
      } else {
         updatedListItems.push(oldItem);
      }
   });

   // replace old list with new one
   data = updatedListItems;

   res.json(data);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å‡è®¾ä½ çœŸçš„è®¤ä¸ºã€Šé»‘æš—éª‘å£«ã€‹æ˜¯ä¸€éƒ¨å‰§ğŸ˜¢ä¸æ˜¯è¡ŒåŠ¨ï¼Œ...

```
$ curl -X PUT -H "Content-Type: application/json" --data '{"id": "tt0468569", "name": "The Dark Knight", "genre": "drama"}' http://localhost:4000/items/tt0468569

...{"id":"tt0468569","name":"The Dark Knight","genre":"drama"}... 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![batman_drama](../Images/f43082fcd9d48cf1bd1eaf789a6cbfc1.png)T2ã€‘](https://i.giphy.com/media/otP85UTRethni/giphy.gif)

## [](#delete)åˆ é™¤

æœ€åï¼Œå¯¹äºåˆ é™¤ï¼Œæˆ‘ä»¬åªéœ€è¦æ¥è‡ªå®¢æˆ·ç«¯çš„`id` URL å‚æ•°ã€‚
æˆ‘ä»¬è¿‡æ»¤æ•°ç»„ï¼Œæ’é™¤è¦åˆ é™¤çš„é¡¹ç›®ã€‚

```
// delete item from list
server.delete("/items/:id", (req, res) => {
   const itemId = req.params.id;

   console.log("Delete item with id: ", itemId);

   // filter list copy, by excluding item to delete
   const filtered_list = data.filter(item => item.id !== itemId);

   // replace old list with new one
   data = filtered_list;

   res.json(data);
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
$ curl -X DELETE http://localhost:4000/items/tt0468569

[{"id":"tt0110357","name":"The Lion King","genre":"animation"},{"id":"tt0068646","name":"The Godfather","genre":"crime"}] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#complete-code-in-this-link)å®Œæˆæœ¬ç¯èŠ‚çš„ä»£ç 

[å¸¦èŠ‚ç‚¹+ Express çš„å¿«é€Ÿä¼‘æ¯ API](https://github.com/lenmorld/devto_posts/tree/master/quick_node_express)

[![hackerman](../Images/155bdef101a6516089d9d0a37b05be1b.png)T2ã€‘](https://i.giphy.com/media/gGuOldphm6vzW/source.gif)

## [](#okay-that-was-nice-but-what-can-i-do-with-this-)â€œå¥½çš„ï¼Œå¾ˆå¥½ã€‚ä½†æ˜¯æˆ‘èƒ½ç”¨è¿™ä¸ªåšä»€ä¹ˆå‘¢ï¼Ÿâ€

å†æ·»åŠ ä¸€äº› CRUD è·¯å¾„ï¼Œæ‚¨å°±æœ‰äº†ä¸€ä¸ªå¾ˆå¥½çš„é¢å‘å®¢æˆ·çš„ REST APIï¼

ä½†æ˜¯ï¼Œæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œå½“æœåŠ¡å™¨é‡æ–°å¯åŠ¨æ—¶ï¼Œè¿™äº›æ›´æ”¹è¿˜æ²¡æœ‰æŒä¹…åŒ–ã€‚ğŸ˜±

æˆ‘ä»¬å°†åœ¨å…³äºæ–‡ä»¶è¯»/å†™å’Œ MongoDB çš„åç»­æ–‡ç« ä¸­è®¨è®ºè¿™ä¸€ç‚¹ã€‚æ•¬è¯·å…³æ³¨ã€‚

## [](#next-up)æ¥ä¸‹æ¥:

## æ–‡ç« ä¸å†å¯ç”¨

è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘æ­£åœ¨æ’°å†™çš„ Node+Express ç³»åˆ—æ–‡ç« çš„ä¸€éƒ¨åˆ†ã€‚

ä¸æ­¤åŒæ—¶ï¼Œå¦‚æœæ‚¨å¯¹ Node+Express è¿˜ä¸æ»¡æ„ğŸ¤“ï¼Œ
æŸ¥çœ‹æˆ‘çš„èŠ‚ç‚¹ç ”è®¨ä¼š(Gihub repo å’Œå¹»ç¯ç‰‡):

## ![GitHub logo](../Images/a73f630113876d78cff79f59c2125b24.png)/[èŠ‚ç‚¹ _ è½¦é—´](https://github.com/lenmorld/node_workshop)

### ä½¿ç”¨ Nodeã€Express å’Œ MongoDB ä¸ºæ‚¨çš„ä¸‹ä¸€ä¸ª web åº”ç”¨ç¨‹åºæ„å»ºæœåŠ¡å™¨å’Œ API

<article class="markdown-body entry-content container-lg" itemprop="text">

# èŠ‚ç‚¹è½¦é—´

> ä¸ºæ‚¨çš„ä¸‹ä¸€ä¸ª web åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ª server + REST APIï¼

åœ¨æœ¬æ¬¡ç ”è®¨ä¼šä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæ¦‚å¿µå¹¶é€šè¿‡æ´»åŠ¨å°†å®ƒä»¬ä»˜è¯¸å®è·µï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯å…³äº web æœåŠ¡å™¨çš„ã€‚è¿™é‡Œçš„ä»£ç å’Œæ¦‚å¿µå°†æ˜¯æ‚¨ä¸‹ä¸€ä¸ª web é¡¹ç›®çš„è‰¯å¥½åŸºç¡€ã€‚ä¸»é¢˜åŒ…æ‹¬ä½†ä¸é™äº:

*   ä½¿ç”¨ Node å’Œ Express æ„å»º web æœåŠ¡å™¨å’Œ REST API
*   äº†è§£è·¯ç”±ã€è¯·æ±‚å’Œå“åº”
*   ç”¨ HTTP æ–¹æ³•å®ç° CRUD
*   ä½¿ç”¨æ¨¡æ¿æ„å»ºæœåŠ¡å™¨æ¸²æŸ“çš„ç½‘ç«™
*   è¿æ¥åˆ°äº‘ NoSQL æ•°æ®åº“:MongoDB Atlas DB
*   ä½¿ç”¨ä¼šè¯ã€cookies å’Œä»¤ç‰Œè¿›è¡Œç”¨æˆ·èº«ä»½éªŒè¯
*   ä½¿ç”¨å¤–éƒ¨ APIï¼Œå¦‚ Github Jobsã€Giphyã€Spotify

## ä»¥å‰çš„äº‹ä»¶

*   [èŠ‚ç‚¹ç ”è®¨ä¼š-2020 å¹´ 8 æœˆ 27 æ—¥](https://www.facebook.com/events/1125391177830448/)

    *   [æ¬ é‚®](https://dev.to/lennythedev/node-workshop-free-online-workshop-by-scs-concordia-3dc5)
*   [èŠ‚ç‚¹ç ”è®¨ä¼š-2020 å¹´ 7 æœˆ 16 æ—¥](https://www.facebook.com/events/751112552346326/)

    *   [æ¬ é‚®](https://dev.to/lennythedev/node-workshop-part-2-free-online-workshop-by-scs-concordia-4e37)

# ææ–™

é¢„è§ˆå¹»ç¯ç‰‡: [Google Drive æ–‡æ¡£](https://drive.google.com/file/d/11-HTDPgCY-ZNEIqddwQbn_4PDCa14C2R/view?usp=sharing)

ç´ æ:[è§‚å¿µé“¾æ¥](https://www.notion.so/lennythedev/Node-workshop-Homepage-56f2822d63e549b286c76102e6ea6b28)

# å¯†ç 

### å‚åŠ ç ”è®¨ä¼š:

```
$ git checkout dev
$ node server.js 
```

### åˆ°æœ€æ–°å¼€å‘

```
$ git checkout master

$
```

â€¦</article>

[View on GitHub](https://github.com/lenmorld/node_workshop)

Here we discussed:

*   ä½¿ç”¨èŠ‚ç‚¹å’Œ Express
*   è·¯ç”±ã€è¯·æ±‚å’Œå“åº”
*   æ„å»º REST API
*   æœåŠ¡å™¨å‘ˆç°çš„æ¨¡æ¿
*   è¿æ¥åˆ° NoSQL (mongo)æ•°æ®åº“
*   ä½¿ç”¨å¤–éƒ¨ APIï¼Œå¦‚ Spotify
*   è¿˜æœ‰æ›´å¤šï¼

* * *

å‘çƒå¿«ä¹ï¼

ç°åœ¨ï¼Œæ˜¯æ—¶å€™å¥½å¥½ä¼‘æ¯ä¸€ä¸‹äº†ã€‚
åˆ«å¿˜äº†å¤šä¹°äº›ï¼ğŸ›ŒğŸ˜´

[![sleep](../Images/f3102d35c45b5368f6deb8e48ae3c624.png)T2ã€‘](https://i.giphy.com/media/6Umkh0GwRYhfG/giphy.gif)