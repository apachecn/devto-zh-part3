# è°ƒè¯• Kotlin æœ¬åœ°ç¼–è¯‘å™¨

> åŸæ–‡:[https://dev . to/touch lab/debugging-kot Lin-native-s-compiler-3 AFB](https://dev.to/touchlab/debugging-kotlin-native-s-compiler-3afb)

ä¸ºäº†åœ¨ Kotlin native ä¸­å°†[æ³›å‹æ·»åŠ åˆ°å¤´æ–‡ä»¶è¾“å‡º](https://github.com/JetBrains/kotlin-native/pull/2850)ä¸­ï¼Œæˆ‘ä¸å¾—ä¸ä½¿ç”¨è°ƒè¯•å™¨å¯¹ Kotlin Native ç¼–è¯‘å™¨è¿›è¡Œé€†å‘å·¥ç¨‹ğŸ‘ã€‚å°†è°ƒè¯•å™¨é™„åŠ åˆ° Konan ç¼–è¯‘å™¨éœ€è¦å‡ ä¸ªæ­¥éª¤ï¼Œä½†æ˜¯ç›¸å¯¹ç®€å•ã€‚

# [](#step-1-build-kotlin-native)ç¬¬ä¸€æ­¥:æ„å»ºç§‘ç‰¹æ—åŸç”Ÿ

æ‚¨éœ€è¦[å…‹éš† KN](https://github.com/JetBrains/kotlin-native/) å¹¶ç¡®ä¿åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ‚¨æƒ³è¦ä½¿ç”¨çš„ç‰ˆæœ¬çš„åˆ†æ”¯ã€‚æ­£å¦‚æ–‡æ¡£æ‰€è¿°ï¼Œè¿™è‡³å°‘éœ€è¦ä¸€ä¸ªå°æ—¶ï¼Œæ ¹æ®æˆ‘çš„ç»éªŒï¼Œè¿™æ˜¯ä¹è§‚çš„ï¼Œä½†å®ƒé€šå¸¸æ˜¯ä¸€ä¸ªæ— æ•…éšœçš„æ„å»ºã€‚æ•£æ•£æ­¥/å°ç¡ä¸€ä¼šå„¿ã€‚

# [](#step-2-create-sample-project)ç¬¬äºŒæ­¥:åˆ›å»ºæ ·æœ¬é¡¹ç›®

å½“æ‚¨é‡åˆ°ç¼–è¯‘é—®é¢˜æ—¶ï¼Œå¯èƒ½æ˜¯åœ¨ä¸€ä¸ªæ›´å¤§çš„åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡ä¸­ã€‚è™½ç„¶æ‚¨å¯ä»¥ç›´æ¥å¯¹æ­¤è¿›è¡Œè°ƒè¯•ï¼Œä½†æˆ‘å»ºè®®æ‚¨åˆ¶ä½œä¸€ä¸ªæœ€å°çš„æ ·æœ¬æ¥å¤„ç†ç›¸åŒçš„é—®é¢˜ã€‚è¿™ä¼šèŠ‚çœä½ çš„æ—¶é—´ã€‚

# [](#step-3-config-sample-project)ç¬¬ä¸‰æ­¥:é…ç½®æ ·æœ¬é¡¹ç›®

æ‚¨éœ€è¦å°†ç¤ºä¾‹é¡¹ç›®æŒ‡å‘æ‚¨çš„æœ¬åœ° Konan æ„å»ºï¼Œå¹¶å‘Šè¯‰ç¼–è¯‘å™¨æ‚¨æƒ³è¦é™„åŠ ä¸€ä¸ªè°ƒè¯•å™¨ã€‚å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ° gradle.properties ä¸­:

org . jetbrains . Kotlin . Native . home =[Koltin Native Clone Dir]/dist
org . jetbrains . Kotlin . Native . JVM args =-agent lib:jdwp = transport = dt _ socketï¼Œserver=yï¼Œsuspend=yï¼Œaddress=5006
ç”¨æ‚¨åœ¨å…¶ä¸­æ„å»º KN çš„ä»»ä½•ç›®å½•æ›¿æ¢[Kotlin Native Clone Dir]ã€‚è¿™å°†å‘Šè¯‰ kotlin æ’ä»¶ä½¿ç”¨å®ƒè€Œä¸æ˜¯å¸¸è§„çš„ç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶ã€‚ç¬¬äºŒè¡Œè®© konan ç¼–è¯‘å™¨ç­‰å¾…è¿œç¨‹è°ƒè¯•å™¨è¿æ¥ã€‚

# [](#step-4-config-remote-debugger-the-easy-part)ç¬¬å››æ­¥:é…ç½®è¿œç¨‹è°ƒè¯•å™¨(ç®€å•çš„éƒ¨åˆ†)

åœ¨ Intellij ä¸­æ‰“å¼€ Kotlin åŸç”Ÿ repo(è¿™æ˜¯ä¸€ä¸ª gradle é¡¹ç›®)ã€‚æ‰“å¼€åï¼Œåˆ›å»ºä¸€ä¸ªè¿œç¨‹è°ƒè¯•å™¨é…ç½®ã€‚

### [](#edit-configurations)ç¼–è¾‘é…ç½®

[![](../Images/d5dce22c0e7e85632213fd2243612b76.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--w9pxdhAP--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/0nw6fsrp32wx3x4mf60w.png)

### [](#add-remote)æ·»åŠ â€˜è¿œç¨‹â€™

[![](../Images/38b4e2aeac4ef8cabfa730975d7b9b77.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Q4Hmr4Cp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/4in5xtodlsh7dzxl71hk.png)

### [](#set-port-to-5006)è®¾ç½®ç«¯å£ä¸º 5006

[![](../Images/e80596ae0e5a4ee2c7fe661a361132b2.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--CGYorVv5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/7vkervncynj5pupwnu3u.png)

å¦‚æœæ‚¨å›å¤´çœ‹ç¬¬ 3 æ­¥ï¼Œæˆ‘ä»¬å°†ç«¯å£è®¾ç½®ä¸º 5006

org . jetbrains . kotlin . native . JVM args =-agent lib:jdwp = transport = dt _ socketï¼Œserver=yï¼Œsuspend=yï¼Œaddress=5006
ç¡®ä¿åœ¨æ‚¨çš„è¿œç¨‹é…ç½®ä¸­è¿›è¡Œäº†è®¾ç½®ã€‚

# [](#step-5-profit)ç¬¬äº”æ­¥:ç›ˆåˆ©

ç°åœ¨å›åˆ°æ‚¨çš„æµ‹è¯•é¡¹ç›®å¹¶æ„å»ºå®ƒã€‚æˆ‘é€šå¸¸åœ¨å‘½ä»¤è¡Œä¸Šç”¨ã€‚/gradlew buildã€‚æ‚¨å°†æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼Œå‘Šè¯‰æ‚¨é™„åŠ ä¸€ä¸ªè°ƒè¯•å™¨ã€‚

[![](../Images/89838b5fd880e6d50ab35b0b2b65c9f5.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--4PhS5_eT--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/4s2q18g9fuxosxp90xfm.png)

å›åˆ° Kotlin Native Intellij é¡¹ç›®å¹¶è¿è¡Œè¿œç¨‹é…ç½®ã€‚å®ƒä¼šè¿æ¥å¹¶è®©ç¼–è¯‘å™¨è¿è¡Œã€‚

åœ¨æˆ‘çš„æµ‹è¯•ä¸­ï¼Œæˆ‘å®é™…ä¸Šéœ€è¦è°ƒè¯•ä¸€ä¸ªä¸åŒçš„ä»»åŠ¡ï¼Œæ‰€ä»¥æˆ‘éœ€è¦è¿æ¥è°ƒè¯•å™¨ä¸¤æ¬¡ã€‚æˆ‘ä¼šåœ¨ç¤ºä¾‹é¡¹ç›®ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹â€¦

[![](../Images/6da81f3cda81e9d9386779e7bf4aeafd.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--JoNPr02Q--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/0zr8ezwvgeuxa5anlrra.png)

æ‰€ä»¥ï¼Œè™½ç„¶æœ‰ç‚¹ç¬¨é‡ï¼Œåªæ˜¯å†æ¬¡é™„ä¸Šã€‚

å¦å¤–ï¼Œä¸è¦å¿˜è®°åœ¨ç¼–è¯‘å™¨ä»£ç ä¸­æ·»åŠ æ–­ç‚¹ï¼Œè¿™æ‰æ˜¯é‡ç‚¹ã€‚

åœ¨è§†é¢‘ä¸­ä¸€èµ·è¿è¡Œæµ‹è¯•åº”ç”¨å’Œè°ƒè¯•å™¨(æŠ±æ­‰æ˜¯éŸ³é¢‘ã€‚å¦‚æœæœ‰å…´è¶£ï¼Œæˆ‘ä¼šç”¨çœŸæ­£çš„éº¦å…‹é£é‡åš)

[è°ƒè¯•è§†é¢‘](https://www.youtube.com/watch?v=6W00Ngx0ESw)

* * *

ğŸ‘åœ¨ TDD é¢†åŸŸæœ‰ä¸€äº›åè°ƒè¯•å™¨çš„æƒ…ç»ªï¼Œä½†æ˜¯è°ƒè¯•å™¨æ˜¯ä¸å¥½çš„å®è·µçš„æƒ³æ³•å®Œå…¨å¿½ç•¥äº†å‘ç°ç”¨ä¾‹ï¼Œè¿™æ˜¯å·¨å¤§çš„ã€‚è¿™æ˜¯ä¸€ä¸ªæå¥½çš„ä¾‹å­ã€‚æˆ‘çœŸçš„å¾ˆåæ„Ÿâ€œçœŸæ­£çš„å¼€å‘è€…ä¸ç”¨è°ƒè¯•å™¨â€è¿™ç§æ€åº¦ã€‚åªæ˜¯åœ¨è¿™é‡Œå’†å“®ä¸€ä¸‹ã€‚æ— è®ºå¦‚ä½•â€¦