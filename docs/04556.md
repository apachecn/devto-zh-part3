# React å¿«é€Ÿç¿»è¯‘è®¾ç½®

> åŸæ–‡:[https://dev . to/damcosset/quick-translation-setup-with-react-3l7n](https://dev.to/damcosset/quick-translation-setup-with-react-3l7n)

# [](#introduction)ç®€ä»‹

ä½œä¸ºæˆ‘çš„ InvoiceMaker åº”ç”¨ç¨‹åºå¼€å‘çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘æƒ³è¦ä¸€ä¸ªæ³•è¯­ç‰ˆæœ¬çš„è½¯ä»¶ã€‚åœ¨ React åº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰å¾ˆå¤šåº“/æ¡†æ¶å¯ä»¥ç”¨æ¥å¤„ç†ç¿»è¯‘ã€‚æˆ‘æƒ³æˆ‘çœŸçš„ä¸éœ€è¦æ·»åŠ æ›´å¤šçš„åŒ…æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å¯ä»¥è‡ªå·±ç¼–å†™ä¸€äº›ç®€å•çš„ä»£ç ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™é‡Œï¼

## [](#what-i-wanted)æˆ‘æƒ³è¦ä»€ä¹ˆ

æˆ‘æƒ³è¦éå¸¸ç®€å•çš„ä¸œè¥¿ã€‚æˆ‘ä¼šçœ‹çœ‹ç”¨æˆ·çš„æµè§ˆå™¨è¯­è¨€ã€‚å¦‚æœè¯­è¨€æ˜¯æ³•è¯­( *fr-FR* æˆ– *fr* )ï¼Œæˆ‘ä¼šå°†åº”ç”¨ç¨‹åºçš„è¯­è¨€è®¾ç½®ä¸ºæ³•è¯­ã€‚å¦åˆ™ï¼Œå®ƒä¼šæ˜¯è‹±æ–‡çš„ã€‚

æˆ‘çŸ¥é“æ³•å›½æœ‰ä¸åŒçš„é£å‘³ï¼Œä½†ç°åœ¨ï¼Œå¤„ç†æ¥è‡ªæ³•å›½çš„æ³•è¯­æ­£æ˜¯æˆ‘æ‰€éœ€è¦çš„ã€‚

## [](#how)å¦‚ä½•ï¼Ÿ

é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª react åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬ä¸éœ€è¦å¤ªå¤šï¼Œæˆ‘å°†ç®€å•åœ°å±•ç¤ºå¦‚ä½•å¼€å§‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨*åˆ›å»º-ååº”-åº”ç”¨*:

è¿è¡Œ:`create-react-app translations-setup`

ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥æ–°åˆ›å»ºçš„ç›®å½•å¹¶è¿è¡Œ`npm start`ã€‚

### [](#get-the-current-language)è·å–å½“å‰è¯­è¨€

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ç”¨æˆ·çš„æµè§ˆå™¨ä½¿ç”¨çš„æ˜¯å“ªç§è¯­è¨€ã€‚ä¿®æ”¹ *App.js* æ·»åŠ å¦‚ä¸‹ä»£ç :

```
import React from 'react'
import logo from './logo.svg'
import './App.css'
let frenchCodes = ['fr-FR', 'fr-fr', 'fr']
let language = navigator.language || navigator.userLanguage
if (!frenchCodes.includes(language)) {
    language = 'en-US'
}
// App component below... 
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„è¯­è¨€ã€‚æˆ‘ä»¬åœ¨*çª—å£.å¯¼èˆªå™¨*å¯¹è±¡ä¸Šä½¿ç”¨*è¯­è¨€*å±æ€§ã€‚

æˆ‘å·²ç»æŠŠæ³•å›½ä»£ç æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œäº†ã€‚æœ‰äº›å¯¼èˆªå™¨å¯èƒ½ä¼šä»¥å°å†™å½¢å¼è¿”å›(æˆ‘ç›¸ä¿¡æœ‰äº›ç‰ˆæœ¬çš„ Safari ä¼šè¿™æ ·åš)ã€‚

ç„¶åï¼Œå¦‚æœè¯­è¨€æ²¡æœ‰åŒ…å«åœ¨æ•°ç»„ä¸­ï¼Œæˆ‘çŸ¥é“è¿™ä¸æ˜¯ç”¨æˆ·çš„æµè§ˆå™¨æ²¡æœ‰æ³•è¯­ã€‚å› æ­¤ï¼Œæˆ‘å°†è¯­è¨€è®¾ç½®ä¸ºç¾å›½è‹±è¯­ã€‚

### [](#json-files-for-translations)JSON æ–‡ä»¶è¿›è¡Œç¿»è¯‘

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå­˜å‚¨ç¿»è¯‘çš„æ–‡ä»¶ã€‚åœ¨ *src* æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º *i18n* çš„æ–‡ä»¶å¤¹ã€‚åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ›å»ºä¸¤ä¸ª JSON æ–‡ä»¶ï¼Œ *en-US.json* å’Œ *fr-FR.json* ï¼Œä»¥åŠä¸€ä¸ªåä¸º *index.js* çš„ js æ–‡ä»¶ã€‚

JSON æ–‡ä»¶å°†ä¿å­˜å„è‡ªè¯­è¨€çš„ç¿»è¯‘:

*   fr-FR.json

```
{  "appTitle":  "Modifiez src/App.js et sauvegarder pour recharger.",  "appLink":  "Apprenez React",  "newPageTitle":  "Nouvelle Page",  "english":  "Anglais",  "french":  "FranÃ§ais"  } 
```

*   en-US.json

```
{  "appTitle":  "Edit src/App.js and save to reload.",  "appLink":  "Learn React",  "newPageTitle":  "New Page",  "english":  "English",  "french":  "French"  } 
```

é”®åå®Œå…¨æ˜¯ä»»æ„çš„ã€‚æ‚¨å¯ä»¥éšæ„ç§°å‘¼å®ƒä»¬ï¼Œåªè¦å®ƒä»¬å¯¹æ‚¨æœ‰æ„ä¹‰ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘ä»¬å°†åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„ã€‚

æœ€åï¼Œæˆ‘ä»¬å°†æŠŠç¿»è¯‘æ–‡ä»¶å¯¼å…¥ä¸€ä¸ªç‹¬ç‰¹çš„ *index.js* æ–‡ä»¶:

```
import fr_FR from './fr-FR.json'
import en_US from './en-US.json'
const translations = {
    'fr-FR': fr_FR,
    'en-US': en_US
}

export default translations 
```

å¤ªå¥½äº†ï¼Œæˆ‘ä»¬çš„ç¿»è¯‘ç°åœ¨å¯ä»¥ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è·å¾—ã€‚

### [](#context)ä¸Šä¸‹æ–‡

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬éœ€è¦åœ¨åº”ç”¨ç¨‹åºçš„æ‰€æœ‰éƒ¨åˆ†è®¿é—®å½“å‰è¯­è¨€ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨*ä¸Šä¸‹æ–‡*ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„ä¸Šä¸‹æ–‡ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„ *LanguageContext.js* æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç å¤åˆ¶åˆ°é‡Œé¢:

```
import React from 'react'

const LanguageContext = React.createContext()

export default LanguageContext 
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠ App ç»„ä»¶åŒ…è£…åœ¨ä¸Šä¸‹æ–‡æä¾›è€…ä¸­ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªçŠ¶æ€æ¥ä¿å­˜æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„è¯­è¨€ã€‚è¯¥çŠ¶æ€å°†è¢«ä¼ é€’ç»™ä¸Šä¸‹æ–‡æä¾›è€…ï¼Œä»¥ä¾¿åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚æˆ‘è¿˜å°†æ·»åŠ ä¸¤ä¸ªæŒ‰é’®æ¥è½»æ¾åœ°æ›´æ”¹åº”ç”¨ç¨‹åºçš„å½“å‰è¯­è¨€ã€‚ä½ çš„ *App.js* æ–‡ä»¶åº”è¯¥æ˜¯è¿™æ ·çš„:

```
import React, { useState } from 'react'
import logo from './logo.svg'
import './App.css'
import NewComponent from './NewComponent'
import translations from './i18n/'
import LanguageContext from './LanguageContext'
let frenchCodes = ['fr-FR', 'fr-fr', 'fr']
let language = navigator.language || navigator.userLanguage
if (!frenchCodes.includes(language)) {
    language = 'en-US'
}

function App() {
    const [lng, setLng] = useState(language)
    return (
        <LanguageContext.Provider value={lng}>
            <div className='App'>
                <header className='App-header'>
                    <img src={logo} className='App-logo' alt='logo' />
                    <p>{translations[lng]['appTitle']}</p>
                    <a
                        className='App-link'
                        href='https://reactjs.org'
                        target='_blank'
                        rel='noopener noreferrer'>
                        {translations[lng]['appLink']}
                    </a>
                    <NewComponent />
                    <button onClick={() => setLng('fr-FR')}>
                        {translations[lng]['french']}
                    </button>
                    <button onClick={() => setLng('en-US')}>
                        {translations[lng]['english']}
                    </button>
                </header>
            </div>
        </LanguageContext.Provider>
    )
}

export default App 
```

ä¸ºäº†åœ¨è¿™é‡Œä½¿ç”¨æˆ‘ä»¬çš„ç¿»è¯‘ï¼Œæˆ‘ä»¬ä» *i18n/index.js* å¯¼å…¥ç¿»è¯‘ã€‚ç„¶åï¼Œä¸ºäº†è·å¾—å½“å‰è¯­è¨€ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† *lng* å˜é‡ï¼Œå­˜å‚¨åœ¨ state ä¸­ï¼Œå¹¶åœ¨æˆ‘ä»¬çš„ä¸Šä¸‹æ–‡ä¸­ç”¨ä½œå€¼ã€‚æ‰€ä»¥ï¼Œ`translations[lng]`ä¼šç»™æˆ‘ä»¬å½“å‰è¯­è¨€çš„ç¿»è¯‘ã€‚ç„¶åï¼Œæˆ‘ä»¬æ·»åŠ æˆ‘ä»¬å¸Œæœ›è·å¾—é€‚å½“å€¼çš„é”®ã€‚

ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°åœ¨æˆ‘ä»¬çš„*åº”ç”¨*ä¸­æœ‰ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚æˆ‘å·²ç»æ·»åŠ äº† *NewComponent* ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶ä½¿ç”¨ useContext é’©å­æ¥è·å¾—æ­£ç¡®çš„ç¿»è¯‘:

```
import React, { useContext } from 'react'
import LanguageContext from './LanguageContext'
import translations from './i18n'

const NewComponent = function() {
    const lng = useContext(LanguageContext)
    return (
        <div>
            <h1>{translations[lng]['newPageTitle']}</h1>
        </div>
    )
}

export default NewComponent 
```

æ‚¨éœ€è¦å¯¼å…¥ LanguageContext å’Œç¿»è¯‘æ–‡ä»¶ã€‚é€šè¿‡ä¸º useContext æä¾› LanguageContextï¼Œæ‚¨å°†èƒ½å¤Ÿåœ¨åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨å½“å‰è¯­è¨€ã€‚

åœ¨é‚£é‡Œä½ æœ‰ä¸€ä¸ªç®€å•å¿«æ·çš„æ–¹æ³•æ¥å¤„ç†ç¿»è¯‘ï¼Œè€Œä¸éœ€è¦æ·»åŠ ä»»ä½•æ–°çš„åŒ…æˆ–è€…åº“åˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚ğŸ˜‰

ä½ å¯ä»¥åœ¨ Github ä¸Šæ‰¾åˆ°ä»£ç ã€‚

æ‰¾ç‚¹ä¹å­