# å¦‚ä½•åœ¨ Swift ä¸­è¿›è¡Œ TDDï¼Œåˆ†æ­¥æŒ‡å—

> åŸæ–‡:[https://dev . to/moka gio/how-to-TDD-in-swift-a-step-by-step-guide-8jg](https://dev.to/mokagio/how-to-tdd-in-swift-a-step-by-step-guide-8jg)

è¿™æ˜¯æˆ‘çš„åšå®¢[mokacoding.com](https://www.mokacoding.com/blog/step-by-step-tdd-in-swift-part-1/)çš„ä¸€ç¯‡äº¤å‰æ–‡ç« ã€‚

æœ‰ä¸€ç§ç¼–å†™è½¯ä»¶çš„æ–¹æ³•å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘é”™è¯¯å’Œæ„å¤–è¡Œä¸ºçš„å‘ç”Ÿã€‚ä»¥è¿™ç§æ–¹å¼å¼€å‘è¿˜ä¼šäº§ç”Ÿæ˜“äºæ›´æ”¹çš„å°ç»„ä»¶ã€‚

è¿™ç§ç¼–å†™è½¯ä»¶çš„æ–¹å¼æ˜¯æµ‹è¯•é©±åŠ¨å¼€å‘ã€‚è¿™ç¯‡æ–‡ç« å±•ç¤ºäº†å¦‚ä½•å®è·µ TDDï¼Œä»¥åŠå®ƒå¦‚ä½•å¸¦æ¥æ„‰å¿«è€Œæœ‰æ•ˆç¼–ç ä½“éªŒã€‚

* * *

ä½ æœ€å–œæ¬¢çš„æŠ«è¨åº—çš„è€æ¿ Giuseppe é›‡ä½£ä½ ä¸ºä»–çš„å…¬å¸å¼€å‘ iOS åº”ç”¨ç¨‹åºã€‚åƒèªæ˜çš„å¼€å‘è€…ä¸€æ ·ï¼Œä½ é¼“åŠ± Giuseppe ä»å°å¤„ç€æ‰‹ï¼Œå¿«é€Ÿè¿­ä»£ã€‚ä½ ä»¬ä¸¤ä¸ªåŒæ„ä»ä»–çš„é¡¾å®¢çš„æ•°å­—èœå•å¼€å§‹ï¼Œæ¥è¡¡é‡å®ƒçš„æ¥å—åº¦ã€‚

å¿«é€Ÿå¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒæ—¶ç¡®ä¿å®ƒçš„è¡Œä¸ºç¬¦åˆé¢„æœŸçš„ä¸€ä¸ªæ–¹æ³•æ˜¯å°†å®ƒçš„ä¸šåŠ¡é€»è¾‘ä»è¾“å…¥å’Œè¾“å‡ºå¦‚ä½•å‘é€ç»™ç”¨æˆ·çš„ç»†èŠ‚ä¸­åˆ†ç¦»å‡ºæ¥ã€‚é²å‹ƒå”å”åœ¨[çš„æ¼”è®²](https://www.youtube.com/watch?v=HhNIttd87xs)å’Œä»–çš„ä¹¦[æ¸…æ´å»ºç­‘](https://geni.us/dM1KXD8)ä¸­é˜è¿°äº†è¿™ä¸ªæƒ³æ³•ã€‚

æˆ‘ä»¬åº”è¯¥å°† iOS è§†ä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„äº¤ä»˜å±‚(T2 ),å°½å¯èƒ½å°‘åœ°å°†ä¸šåŠ¡é€»è¾‘å®ç°æ”¾åœ¨è¿™ä¸€å±‚ã€‚æƒ³è±¡ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª CLI åº”ç”¨ç¨‹åºï¼Œç„¶åå‡è£… iOS æ˜¯å®ƒçš„ GUI åŒ…è£…å™¨ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œä»»ä½•ä¸šåŠ¡é€»è¾‘éƒ½ä¸åº”è¯¥`import UIKit`ã€‚

å½“ TDDing æ˜¯"**æˆ‘èƒ½åšçš„æœ€å°æœ€ç®€å•çš„äº‹æƒ…æ˜¯ä»€ä¹ˆï¼Ÿ**â€ã€‚å¼€å§‹å¼€å‘è¿™ä¸ªåº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬èƒ½åšçš„æœ€å°çš„ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Ÿæœ±å¡ä½©çš„èœå•æœ‰ä¸‰ä¸ªéƒ¨åˆ†:æŠ«è¨ã€é¥®æ–™å’Œç”œç‚¹ã€‚è®©æˆ‘ä»¬ä»ä¸€ä¸ªåªæ˜¾ç¤ºæ¯”è¨é¥¼çš„èœå•åº”ç”¨ç¨‹åºå¼€å§‹ã€‚

åªæœ‰æŠ«è¨çš„è¿™ä¸ªç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºæ˜¯æˆ‘ä»¬çš„[è¡Œèµ°éª¨æ¶](http://wiki.c2.com/?WalkingSkeleton)ï¼Œä¸€ä¸ªåªæœ‰æœ€ä½é™åº¦åŠŸèƒ½çš„åº”ç”¨ç¨‹åºï¼Œä»¥ç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½ç²˜åœ¨ä¸€èµ·ï¼Œç«¯åˆ°ç«¯åœ°å·¥ä½œã€‚

å› ä¸ºæˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘çš„æ ¸å¿ƒæ˜¯å°† Giuseppe çš„èœå•è½¬æ¢æˆå¯ä»¥æ˜¾ç¤ºçš„æ ¼å¼ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä»å®ƒçš„ä¸€ä¸ªç»„ä»¶å¼€å§‹ï¼Œè®©æˆ‘ä»¬ç§°å®ƒä¸º`MenuDataSource`ã€‚

**åœ¨è¿›è¡Œ TDD æ—¶ï¼Œæˆ‘ä»¬æ€»æ˜¯ä»æµ‹è¯•**å¼€å§‹ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä¸º`MenuDataSource`åˆ›å»ºä¸€ä¸ªã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è‹¹æœçš„ [`XCTest` famework](https://developer.apple.com/documentation/xctest) ï¼Œä½†è¿™å¹¶ä¸æ˜¯åœ¨ Swift ä¸­ç¼–å†™æµ‹è¯•çš„å”¯ä¸€é€‰æ‹©ã€‚

```
@testable import Giuseppes
import XCTest

class MenuDataSourceTests: XCTestCase {
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬çš„æµ‹è¯•åº”è¯¥æè¿°å¹¶éªŒè¯æˆ‘ä»¬æƒ³è¦çš„`MenuDataSource`çš„**è¡Œä¸º**ã€‚æˆ‘ä»¬å†³å®šæˆ‘ä»¬çš„è¡Œèµ°éª¨æ¶å°†åªæœ‰æ¯”è¨é¥¼ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç¡®ä¿`MenuDataSource`åªä¸ºèœå•æä¾›ä¸€ä¸ªéƒ¨åˆ†ã€‚

ä¸ºäº†æµ‹è¯•è¿™ç§è¡Œä¸ºï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ª`MenuDataSource`çš„å®ä¾‹ã€‚

```
@testable import Giuseppes
import XCTest

class MenuDataSourceTests: XCTestCase {

    func testHasOneSection() {
        let dataSource = MenuDataSource()
        // ğŸ”´ Use of unresolved identifier 'MenuDataSource';
        // did you mean 'MenuDataSourceTests'?
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä»£ç æ²¡æœ‰ç¼–è¯‘ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰å®šä¹‰`MenuDataSource`ã€‚åœ¨ TDD ä¸­ï¼Œç¼–è¯‘å¤±è´¥è¢«è®¤ä¸ºæ˜¯æµ‹è¯•å¤±è´¥ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ˜¯**ç¼–å†™å°½å¯èƒ½ç®€å•çš„ä»£ç æ¥ä½¿æµ‹è¯•é€šè¿‡**ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹è¿™æ„å‘³ç€ç¼–è¯‘ã€‚

ä¸ºäº†ç¼–è¯‘æµ‹è¯•ï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰`MenuDataSource`ã€‚

```
struct MenuDataSource { } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ³¨æ„ï¼Œåœ¨è¿™ä¸ª`MenuDataSource`ä¸­æ²¡æœ‰å±æ€§æˆ–`init`å‚æ•°ã€‚è¿™æ„å‘³ç€å°½å¯èƒ½ç¼–å†™æœ€ç®€å•çš„ä»£ç ï¼Œåªè¦ä»£ç è¶³å¤Ÿé€šè¿‡æµ‹è¯•å³å¯ã€‚æˆ‘ä»¬å°†åªåœ¨æˆ‘ä»¬éœ€è¦å®ƒä»¬æ¥é€šè¿‡æµ‹è¯•æ—¶æ‰ç»™ç±»å‹æ·»åŠ å±æ€§ã€‚

æ—¢ç„¶æµ‹è¯•å·²ç»ç¼–è¯‘å¥½äº†ï¼Œè®©æˆ‘ä»¬ç»§ç»­æ–­è¨€`MenuDataSource`åœ¨è¢«è¦æ±‚åˆ†æ®µæ—¶çš„è¡Œä¸ºã€‚

```
func testHasOneSection() {
    let dataSource = MenuDataSource()
    XCTAssertEqual(dataSource.numberOfSections, 1)
    // ğŸ”´ Value of type 'MenuDataSource' has no member 'numberOfSections'
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç”±äºç¼–è¯‘é”™è¯¯ï¼Œæˆ‘ä»¬å†æ¬¡æµ‹è¯•å¤±è´¥ã€‚æˆ‘ä»¬èƒ½å†™çš„æœ€ç®€å•çš„ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿ

```
struct MenuDataSource {

    let numberOfSections = 1
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å†æ¬¡æ³¨æ„ï¼Œè¿™é‡Œæ²¡æœ‰é€»è¾‘ï¼Œåªæœ‰ä¸€ä¸ªç¡¬ç¼–ç çš„å€¼ã€‚è¿™è¶³ä»¥è®©æˆ‘ä»¬çš„æµ‹è¯•ç¼–è¯‘é€šè¿‡ï¼Œæˆ‘ä»¬å¯¹æ­¤å¾ˆæ»¡æ„ã€‚

```
@testable import Giuseppes
import XCTest

class MenuDataSourceTests: XCTestCase {

    func testHasOneSection() {
        let dataSource = MenuDataSource()
        XCTAssertEqual(dataSource.numberOfSections, 1)  // âœ…
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸€å¥è­¦å‘Šã€‚ä½ ä¸åº”è¯¥ç›¸ä¿¡ä¸€ä¸ªä½ æ²¡è§è¿‡å¤±è´¥çš„æµ‹è¯•ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ç”±äºç¼–è¯‘é”™è¯¯è€Œå¯¼è‡´çš„æµ‹è¯•å¤±è´¥ï¼Œä½†æ˜¯æµ‹è¯•å®é™…è¡Œä¸ºå‘¢ï¼Ÿå°†`MenuDataSource`ä¸­çš„ç¡¬ç¼–ç  1 æ”¹ä¸ºå¦ä¸€ä¸ªå€¼ï¼Œå¹¶éªŒè¯æµ‹è¯•æ˜¯å¦å¤±è´¥ï¼Œè¿™ä¸ä¼šæœ‰ä»€ä¹ˆåå¤„ã€‚

æˆ‘ä»¬ç»ˆäºæœ‰ä¸€ä¸ªé€šè¿‡æµ‹è¯•ï¼Œè®©æˆ‘ä»¬æ‰¿è¯º:`Implement MenuDataSource returning number of sections`ã€‚

ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬æ·»åŠ ä¸€ç§æ–¹æ³•æ¥è·å–ä¸€ä¸ªéƒ¨åˆ†ä¸­çš„è¡Œæ•°ã€‚

```
func testRowsInSection() {
    let dataSource = MenuDataSource()
    XCTAssertEqual(dataSource.numberOfRows(inSection: 0), ???)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç­‰ç­‰ï¼Œä¸€ä¸ªéƒ¨åˆ†åº”è¯¥æœ‰å¤šå°‘è¡Œï¼Ÿå¦‚æœæˆ‘ä»¬çš„éƒ¨åˆ†æ­£åœ¨æ˜¾ç¤ºæ¯”è¨é¥¼ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥æœ‰ä¸è¦æ˜¾ç¤ºçš„æ¯”è¨é¥¼ä¸€æ ·å¤šçš„è¡Œã€‚æˆ‘ä»¬å¦‚ä½•æµ‹è¯•è¿™ç§è¡Œä¸ºï¼Ÿæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥æ§åˆ¶è¿™ä¸ªè¾“å…¥å‚æ•°ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥åœ¨`init`æ—¶é—´å‘`MenuDataSource`ä¼ é€’è¦æ˜¾ç¤ºçš„æŠ«è¨æ•°ç»„ã€‚

**ä¸ºæˆ‘ä»¬æƒ³è¦çš„è¡Œä¸ºç¼–å†™æµ‹è¯•çš„è¡Œä¸ºæ­ç¤ºäº†æˆ‘ä»¬è½¯ä»¶çš„è®¾è®¡ç»†èŠ‚**ã€‚æˆ‘ä»¬æ²¡æœ‰é¢„å…ˆå†³å®š`MenuDataSource`åº”è¯¥ç”¨ä¸€ä¸ª`Array<Pizza>`åˆå§‹åŒ–ï¼Œæˆ‘ä»¬è®©å¯¹å®ƒçš„éœ€æ±‚[ä»æµ‹è¯•ä¸­æµ®ç°](https://en.wikipedia.org/wiki/Emergent_Design)ã€‚

åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å°†æµ‹è¯•å¸¦å…¥ä¸€ä¸ªæˆåŠŸçš„çŠ¶æ€ã€‚æˆ‘ä»¬åªèƒ½è¯´è¡Œæ•°åº”è¯¥æ€»æ˜¯ 3ã€‚

```
func testRowsInSection() {
    let dataSource = MenuDataSource()
    XCTAssertEqual(dataSource.numberOfRows(inSection: 0), 3)
    // ğŸ”´ Value of type 'MenuDataSource' has no member 'numberOfRows';
    // did you mean numberOfSections'?
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æµ‹è¯•é€šè¿‡çš„æœ€ç®€å•çš„æ–¹æ³•æ˜¯å°†ç»“æœç¡¬ç¼–ç ä¸º 3ã€‚

```
func numberOfRows(inSection section: Int) -> Int {
    return 3
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
func testRowsInSection() {
    let dataSource = MenuDataSource()
    XCTAssertEqual(dataSource.numberOfRows(inSection: 0), 3)  // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬æäº¤è¿™ä¸ªä¸­é—´æ­¥éª¤ã€‚`Implement dummy number of rows in section`ã€‚

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç»¿è‰²æµ‹è¯•ï¼Œè®©æˆ‘ä»¬å¼€å§‹ç”¨ä¸€ç»„æ¯”è¨é¥¼åˆå§‹åŒ–`MenuDataSource`ã€‚æˆ‘ä»¬èƒ½å†™çš„æœ€å°‘çš„ä»£ç é‡æ˜¯å¤šå°‘ï¼Ÿæˆ‘ä»¬æ€»æ˜¯ä»æµ‹è¯•å¼€å§‹:

```
func testHasOneSection() {
    let dataSource = MenuDataSource(pizzas: [Pizza()])
    // ğŸ”´ Use of unresolved identifier 'Pizza'
    XCTAssertEqual(dataSource.numberOfSections, 1)
}

func testRowsInSection() {
    let dataSource = MenuDataSource(pizzas: [Pizza(), Pizza(), Pizza()])
    // ğŸ”´ Use of unresolved identifier 'Pizza'
    XCTAssertEqual(dataSource.numberOfRows(inSection: 0), 3)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç¼–è¯‘å™¨ç°åœ¨æç¤ºæˆ‘ä»¬ä¸‹ä¸€æ­¥ï¼Œå®šä¹‰`Pizza`ã€‚

```
struct Pizza { } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å‘`Pizza`æ·»åŠ å±æ€§å¾ˆæœ‰è¯±æƒ‘åŠ›ï¼Œæ¯”å¦‚å®ƒçš„åå­—ã€ä»·æ ¼å’Œæˆåˆ†ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦è¿™äº›ä»£ç æ¥é€šè¿‡æµ‹è¯•ã€‚æˆ‘ä»¬è¯•å›¾è§£å†³çš„é—®é¢˜ä¸æ˜¯å†™ä¸€ä¸ªå…¨é¢çš„`Pizza`ï¼Œè€Œæ˜¯ç¡®ä¿æˆ‘ä»¬å¯ä»¥é€šè¿‡`Pizza` s æ¥æ˜¾ç¤ºç»™`MenuDataSource`ã€‚ **TDD å°±æ˜¯è§£å†³ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å°é—®é¢˜ã€‚**

å¦‚æœæˆ‘ä»¬å†æ¬¡å°è¯•è¿è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªæ–°çš„é”™è¯¯:

```
func testHasOneSection() {
    let dataSource = MenuDataSource(pizzas: [Pizza()])
    // ğŸ”´ Argument passed to call that takes no arguments
    XCTAssertEqual(dataSource.numberOfSections, 1)
}

func testRowsInSection() {
    let dataSource = MenuDataSource(pizzas: [Pizza(), Pizza(), Pizza()])
    // ğŸ”´ Argument passed to call that takes no arguments
    XCTAssertEqual(dataSource.numberOfRows(inSection: 0), 3)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬å°†æ–°çš„`Pizza`çš„æ•°ç»„ä½œä¸ºå‚æ•°ä¼ é€’ç»™`MenuDataSource`çš„`init`æ–¹æ³•ã€‚

```
struct MenuDataSource {

    let pizzas: [Pizza]
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
func testHasOneSection() {
    let dataSource = MenuDataSource(pizzas: [Pizza()])
    XCTAssertEqual(dataSource.numberOfSections, 1)  // âœ…
}

func testRowsInSection() {
    let dataSource = MenuDataSource(pizzas: [Pizza(), Pizza(), Pizza()])
    XCTAssertEqual(dataSource.numberOfRows(inSection: 0), 3)  // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨æµ‹è¯•åˆé€šè¿‡äº†ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æäº¤ï¼Œå³ä½¿æˆ‘ä»¬è¿˜æ²¡æœ‰å®ç°è¯»å–`Pizza`çš„é€»è¾‘ã€‚`Pass [Pizza] to MenuDataSource init`ã€‚

æäº¤é€šå¸¸ä¼šä½¿ TDD æ›´å®¹æ˜“ã€‚æˆ‘ä»¬ä¸€æ¬¡ç§»åŠ¨ä¸€ç‚¹ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬æœ€ç»ˆå‘ç°ä¸€äº›ä¸å·¥ä½œçš„ä¸œè¥¿ï¼Œæˆ‘ä»¬åªéœ€è¦å®¡æŸ¥å¾ˆå°‘çš„ä»£ç ã€‚æ‚¨ç”šè‡³å¯ä»¥æ”¾å¼ƒé‚£äº›æœªåˆ†çº§çš„æ›´æ”¹ï¼Œä»å¤´å¼€å§‹ã€‚ä¸è¦æ‹…å¿ƒ Git å†å²ä¼šå˜é•¿ï¼Œæäº¤å­˜å‚¨èµ·æ¥å¾ˆä¾¿å®œã€‚å¦‚æœä½ æƒ³åœ¨ä½ çš„ä¿®æ”¹è¢«åˆå¹¶ä¹‹å‰æœ‰ä¸€ä¸ªæ›´ç´§å‡‘çš„å†å²ï¼Œä½ æ€»æ˜¯å¯ä»¥[åšä¸€ä¸ªäº¤äº’å¼çš„é‡ç½®](https://thoughtbot.com/blog/git-interactive-rebase-squash-amend-rewriting-history)å¹¶æ•´ç†å®ƒã€‚

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ç¼–å†™æœ€ç®€å•çš„ä»£ç ï¼Œè®©`MenuDataSource`æ ¹æ®ç»™å®šçš„`[Pizza]`è¿”å›ä¸€äº›è¡Œã€‚

```
// MenuDataSource.swift
func numberOfRows(inSection section: Int) -> Int {
    return pizzas.count
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æµ‹è¯•ä»ç„¶æ˜¯ç»¿è‰²çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ›´æ”¹æ˜¯è¡Œä¸ºçš„æœ‰æ•ˆå®ç°ã€‚æˆ‘ä»¬æ¥æäº¤è¿™ä¸ªå°æ”¹åŠ¨:`Return number of menu rows based on input [Pizza]`ã€‚

æˆ‘ä»¬çš„ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ç»§ç»­å®ç°ä¸‹ä¸€ä¸ªè¡Œä¸ºä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦‚ä½•æµ‹è¯•`numberOfRows(inSection:)`çš„ã€‚æˆ‘ä»¬è€ƒè™‘è¿‡å®ƒæ‰€æœ‰å¯èƒ½çš„è¡Œä¸ºå—ï¼Ÿè¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®ƒçš„è¾“å…¥å‚æ•°ï¼Œè¯¥æ–¹æ³•æ˜¯å¦åº”è¯¥ä¸ºæ¯ä¸ªè¾“å…¥è¿”å›ç›¸åŒçš„è¾“å‡ºï¼Ÿå¦‚æœæä¾›çš„`section`ç´¢å¼•ä¸èœå•ä¸­çš„ä»»ä½•éƒ¨åˆ†éƒ½ä¸åŒ¹é…â€”â€”ç›®å‰åªæœ‰ä¸€ä¸ªâ€”â€”è¯¥æ€ä¹ˆåŠï¼Ÿå‡è®¾è¿™ä¸ªæ–¹æ³•å«åšâ€œè¡Œæ•°â€ï¼Œé‚£ä¹ˆåˆç†çš„åšæ³•æ˜¯è¿”å› 0ã€‚è®©æˆ‘ä»¬ä¸ºè¿™ä¸ªåœºæ™¯ç¼–å†™ä¸€ä¸ªæµ‹è¯•ã€‚

```
func testRowsInOutOfBoundsSectionIsZero() {
    let dataSource = MenuDataSource(pizzas: [Pizza(), Pizza(), Pizza()])
    XCTAssertEqual(dataSource.numberOfRows(inSection: 1), 0)
    // âŒ XCTAssertEqual failed: ("3") is not equal to ("0")
    XCTAssertEqual(dataSource.numberOfRows(inSection: -1), 0)
    // âŒ XCTAssertEqual failed: ("3") is not equal to ("0")
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æµ‹è¯•å¤±è´¥äº†ï¼Œä½ å¯¹æ­¤å¹¶ä¸æƒŠè®¶ï¼Œæ˜¯å—ï¼Ÿå½“å‰ç‰ˆæœ¬çš„`numberOfRows(inSection:)`æ€»æ˜¯è¿”å›æ¯”è¨é¥¼çš„æ•°é‡ã€‚è®©æˆ‘ä»¬å†™å°½å¯èƒ½å°‘çš„ä»£ç æ¥é€šè¿‡æµ‹è¯•ã€‚

```
func numberOfRows(inSection section: Int) -> Int {
    guard section == 0 else { return 0 }
    return pizzas.count
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
func testRowsInOutOfBoundsSectionIsZero() {
    let dataSource = MenuDataSource(pizzas: [Pizza(), Pizza(), Pizza()])
    XCTAssertEqual(dataSource.numberOfRows(inSection: 1), 0)  // âœ…
    XCTAssertEqual(dataSource.numberOfRows(inSection: -1), 0) // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬åšå‡ºäº†æ”¹å˜ï¼Œæµ‹è¯•ä¹Ÿé€šè¿‡äº†ï¼Œæ˜¯æ—¶å€™æäº¤äº†ã€‚

ä¸‹ä¸€æ­¥ï¼Œè®©`MenuDataSource`è¿”å›ç»™å®šéƒ¨åˆ†å’Œè¡Œè¦æ˜¾ç¤ºçš„å†…å®¹ã€‚è®©è¿”å›å€¼æˆä¸ºä¸€ä¸ªç‹¬ç‰¹çš„ç±»å‹æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º`MenuItem`ã€‚è¿™æ¯”è¿”å›ä¸€ä¸ª`Pizza`æ›´å¥½çš„åŸå› æ˜¯å®ƒå¼•å…¥äº†æ•°æ®åŸŸ(æ¯”è¨é¥¼)å’Œ UI åŸŸ(èœå•é¡¹)ä¹‹é—´çš„åˆ†ç¦»ã€‚è¿™ç§åˆ†ç¦»å…è®¸æˆ‘ä»¬åœ¨ä¸å½±å“å¦ä¸€ä¸ªåŸŸçš„æƒ…å†µä¸‹æ”¹å˜å…¶ä¸­ä¸€ä¸ªåŸŸï¼Œåªæ”¹å˜åœ¨ä¸¤ä¸ªåŸŸä¹‹é—´è½¬æ¢çš„ä»£ç ã€‚

ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•éªŒè¯æ–¹æ³•è¿”å›çš„`MenuItem`æ˜¯æˆ‘ä»¬æœŸæœ›çš„é‚£ä¸ªå‘¢ï¼Ÿæˆ–è€…è¯´ï¼Œæˆ‘ä»¬èƒ½åšçš„æœ€ç®€å•çš„äº‹æƒ…æ˜¯ä»€ä¹ˆæ¥éªŒè¯æ–¹æ³•è¿”å›çš„`MenuItem`æ˜¯é¢„æœŸçš„é‚£ä¸ªï¼Ÿä½¿ç”¨ pizza åç§°ä¼¼ä¹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå¦‚æœä¸€ä¸ª pizza è¢«å‘½åä¸ºâ€œMargheritaâ€ï¼Œé‚£ä¹ˆ`MenuItem`ä¹Ÿåº”è¯¥æœ‰`title`â€œMargheritaâ€ã€‚

```
func testItemForRowAndSection() {
    let dataSource = MenuDataSource(pizzas: [Pizza(), Pizza(), Pizza()])
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0).title, "Margherita") 
    // ğŸ”´ Value of type 'MenuDataSource' has no member 'item'
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†é€šè¿‡æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™çš„æœ€ç®€å•çš„ä»£ç æ˜¯è®©`MenuItem`å’Œ`title`æ€»æ˜¯â€œMargheritaâ€ã€‚

```
// in MenuItemDataSource.swift
func item(forRow row: Int, inSection section: Int) -> MenuItem {
   return MenuItem()
}

// in MenuItem.swift
struct MenuItem {

    let title = "Margherita"
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
func testItemForRowAndSection() {
    let dataSource = MenuDataSource(pizzas: [Pizza(), Pizza()])
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0).title, "Margherita")  // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬æœ‰ä¸€ä¸ªç»¿è‰²æµ‹è¯•ï¼Œå®ƒä¸å¯å¦è®¤åœ°æ˜¯ä¸å®Œæ•´çš„ï¼Œä½†ä»ç„¶è¶³å¤Ÿæˆ‘ä»¬æœ‰ä¸€ä¸ªåšå®çš„åŸºç¡€æ¥å»ºç«‹ã€‚æ¥çŠ¯å§:`Implement dummy item(forRow:, inSection:) in MenuDataSource`ã€‚

æˆ‘ä»¬çš„æµ‹è¯•è¿˜æ²¡æœ‰æµ‹è¯•â€œå¦‚æœä¸€ä¸ªæ¯”è¨é¥¼è¢«å‘½åä¸ºâ€˜ç›æ ¼ä¸½å¡”â€™â€çš„è¡Œä¸ºã€‚ä¸ºäº†æ”¹è¿›æˆ‘ä»¬çš„æµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•ç»™å®ƒèµ·ä¸åŒçš„åå­—ã€‚æ˜¯æ—¶å€™ç”¨ä¸€ä¸ª`name`å±æ€§æ¥æ‰©å±•`Pizza`çš„å®šä¹‰äº†ã€‚

åœ¨å¯¹`Pizza` `init`åŠå…¶æ¶ˆè´¹è€…è¿›è¡Œæ›´æ”¹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä½¿æ›´æ”¹å˜å¾—å®¹æ˜“äº›ã€‚ç”¨è‚¯ç‰¹Â·è´å…‹çš„è¯è¯´ï¼Œâ€œè®©æ”¹å˜å˜å¾—å®¹æ˜“ï¼Œè­¦å‘Šè¿™å¯èƒ½å¾ˆéš¾ï¼Œç„¶åè®©æ”¹å˜å˜å¾—å®¹æ˜“â€ã€‚

ä½¿æ”¹å˜æ›´å®¹æ˜“çš„ä¸€ä¸ªæ–¹æ³•æ˜¯å‡å°‘ä»£ç ä¸­ç›´æ¥åˆå§‹åŒ–`Pizza`çš„åœ°æ–¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[å¤¹å…·å»¶ä¼¸](https://www.mokacoding.com/blog/streamlining-tests-setup-with-fixtures-in-swift/)æ¥å®Œæˆã€‚

```
@testable import Giuseppes

extension Pizza {

    static func fixture() -> Pizza {
        return Pizza()
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªæ‰©å±•ç°åœ¨ä¸åšä»»ä½•äº‹æƒ…ï¼Œä½†æ˜¯å®ƒä¼šä½¿æ”¹å˜`Pizza`çš„`init`å˜å¾—æ›´å®¹æ˜“ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦æ›´æ–° fixtureï¼Œè€Œä¸æ˜¯æ‰€æœ‰çš„æµ‹è¯•ã€‚

```
func testHasOneSection() {
    let dataSource = MenuDataSource(pizzas: [.fixture()])
    XCTAssertEqual(dataSource.numberOfSections, 1) // âœ…
}

func testRowsInSection() {
    let dataSource = MenuDataSource(pizzas: [.fixture(), .fixture(), .fixture()])
    XCTAssertEqual(dataSource.numberOfRows(inSection: 0), 3) // âœ…
}

func testRowsInOutOfBoundsSectionIsZero() {
    let dataSource = MenuDataSource(pizzas: [.fixture(), .fixture(), .fixture()])
    XCTAssertEqual(dataSource.numberOfRows(inSection: 1), 0) // âœ…
    XCTAssertEqual(dataSource.numberOfRows(inSection: -1), 0) // âœ…
}

func testItemForRowAndSection() {
    let dataSource = MenuDataSource(pizzas: [.fixture(), .fixture()])
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0).title, "Margherita") // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æäº¤æ—¶é—´ã€‚

æ—¢ç„¶æˆ‘ä»¬å·²ç»ä½¿æ”¹å˜å˜å¾—å®¹æ˜“äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬è¿›è¡Œç®€å•çš„æ”¹å˜ã€‚ä¸€å¦‚æ—¢å¾€ï¼Œæˆ‘ä»¬ä»æµ‹è¯•å¼€å§‹ã€‚

```
func testItemForRowAndSection() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
        // ğŸ”´ Argument passed to call that takes no arguments
    )
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0).title, "Margherita")
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æµ‹è¯•æ²¡æœ‰ç¼–è¯‘ï¼Œå› ä¸º`Pizza`å’Œå®ƒçš„ fixture æ²¡æœ‰`name`ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å¤¹å…·æ˜¯å¦‚ä½•ä½¿æ›´æ”¹æµ‹è¯•å˜å¾—æ›´åŠ å®¹æ˜“çš„ã€‚é€šè¿‡é»˜è®¤`name`å‚æ•°ï¼Œæˆ‘ä»¬ä½¿å¾—æ‰€æœ‰è°ƒç”¨`.fixture()`çš„æµ‹è¯•éƒ½ä¸éœ€è¦æ›´æ–°ï¼Œé™¤éæˆ‘ä»¬æƒ³é€šè¿‡ä¼ é€’ä¸€ä¸ªè‡ªå®šä¹‰å‚æ•°æ¥æµ‹è¯•ç›´æ¥ä¾èµ–äºè¯¥å€¼çš„è¡Œä¸ºã€‚

```
// Pizza.swift
struct Pizza {

    let name: String
}

// Pizza+Fixture.swift
extension Pizza {

    static func fixture(name: String = "Margherita") -> Pizza {
        return Pizza(name: name)
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
func testHasOneSection() {
    let dataSource = MenuDataSource(pizzas: [.fixture()])
    XCTAssertEqual(dataSource.numberOfSections, 1) // âœ…
}

func testRowsInSection() {
    let dataSource = MenuDataSource(pizzas: [.fixture(), .fixture(), .fixture()])
    XCTAssertEqual(dataSource.numberOfRows(inSection: 0), 3) // âœ…
}

func testRowsInOutOfBoundsSectionIsZero() {
    let dataSource = MenuDataSource(pizzas: [.fixture(), .fixture(), .fixture()])
    XCTAssertEqual(dataSource.numberOfRows(inSection: 1), 0) // âœ…
    XCTAssertEqual(dataSource.numberOfRows(inSection: -1), 0) // âœ…
}

func testItemForRowAndSection() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
    )
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0).title, "Margherita") // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ çŸ¥é“æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆå—ï¼Ÿæäº¤:`Add name property to Pizza`ã€‚

è¿™ä¸€æ¬¡ï¼Œè®©æˆ‘ä»¬æ·»åŠ å¦ä¸€ä¸ªæµ‹è¯•æ¥è¯æ˜æˆ‘ä»¬ç°åœ¨æ‹¥æœ‰çš„ä»£ç æ˜¯ä¸æ­£ç¡®çš„ï¼Œè€Œä¸æ˜¯ç›´æ¥æ›¿æ¢è™šæ‹Ÿå®ç°ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºä¸‰è§’æµ‹é‡(å³ä½¿æˆ‘ä»¬åªä½¿ç”¨äº†ä¸¤ä¸ªæ–­è¨€)ã€‚

```
func testItemForRowAndSection() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
    )
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0).title, "Margherita") // âœ…
    XCTAssertEqual(dataSource.item(forRow: 1, inSection: 0).title, "Capricciosa")
    // âŒ XCTAssertEqual failed: ("Margherita") is not equal to ("Capricciosa")
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬å†™ä¸€ä¸ªåˆé€‚çš„å®ç°:

```
// MenuDataSource.swift
func item(forRow row: Int, inSection section: Int) -> MenuItem {
   return MenuItem(pizza: pizzas[row])
}

// MenuItem.swift
struct MenuItem {

    let title: String
}

extension MenuItem {

    init(pizza: Pizza) {
        self.init(title: pizza.name)
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
func testItemForRowAndSection() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
    )
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0).title, "Margherita") // âœ…
    XCTAssertEqual(dataSource.item(forRow: 1, inSection: 0).title, "Capricciosa") // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æäº¤`Provide actual implementation for item(forRow:, inSection:)`

å°±åƒæˆ‘ä»¬å¯¹`numbe of rows`æ‰€åšçš„é‚£æ ·ï¼Œæˆ‘ä»¬åº”è¯¥é—®è‡ªå·±æ˜¯å¦å·²ç»æ¶µç›–äº†æ‰€æœ‰å¯èƒ½çš„è¾“å…¥ç±»å‹çš„è¡Œä¸ºã€‚å¦‚æœæˆ‘ä»¬ç»™å‡ºä¸€ä¸ªä¸åŒ¹é…çš„èŠ‚ç´¢å¼•ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¸€æ’æ€ä¹ˆæ ·ï¼Ÿå¦‚æœè¡Œå’ŒèŠ‚å¯¹ä¸æ”¯æŒæ•°æ®ä¸åŒ¹é…ï¼Œé‚£ä¹ˆè¿”å›â€œnothingâ€ä¼¼ä¹æ˜¯åˆé€‚çš„ã€‚Swift æ¼‚äº®çš„`Optional`å‹æ˜¯æè¿°è¿™ç§åœºæ™¯çš„æœ€ä½³å·¥å…·ã€‚

```
func testItemForOutOfBoundsRowAndSectionIsNil() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
    )
    XCTAssertNil(dataSource.item(forRow: 2, inSection: 0))
    XCTAssertNil(dataSource.item(forRow: 0, inSection: 1))
    XCTAssertNil(dataSource.item(forRow: 2, inSection: 1))
    XCTAssertNil(dataSource.item(forRow: -1, inSection: -1))
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![screenshot of tests crashing](../Images/812fb7565b6fdf4cd21eb8997e874c4f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--qF2bPVlh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://s3.amazonaws.com/mokacoding/2019-02-07-tdd-28.png)

ç°åœ¨è¿è¡Œæµ‹è¯•ä¼šå¯¼è‡´å´©æºƒï¼Œæ¯•ç«Ÿæˆ‘ä»¬è®¿é—®çš„æ˜¯ä¸€ä¸ªè¶Šç•Œæ•°ç»„ã€‚æˆ‘ä»¬èƒ½ä¿®ç†å®ƒçš„æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ

```
func item(forRow row: Int, inSection section: Int) -> MenuItem? {
    guard row >= 0, pizzas.count > row else { return .none }
    return MenuItem(pizza: pizzas[row])
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
func testItemForRowAndSection() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
    )
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0).title, "Margherita")
    // ğŸ”´ Value of optional type 'MenuItem?' must be unwrapped to refer to member 'title'
    // of wrapped base type 'MenuItem'
    XCTAssertEqual(dataSource.item(forRow: 1, inSection: 0).title, "Capricciosa")
    // ğŸ”´ Value of optional type 'MenuItem?' must be unwrapped to refer to member 'title'
    // of wrapped base type 'MenuItem'
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯·æ³¨æ„ï¼Œ`item(forRow:, inSection:)`çš„ç±»å‹ç­¾åä»`-> MenuItem`åˆ°`-> MenuItem?`çš„å˜åŒ–ç ´åäº†æµ‹è¯•ã€‚æˆ‘ä»¬éœ€è¦æ›´æ–°å¯¹æ–¹æ³•çš„å…¶ä»–è°ƒç”¨ï¼Œä»¥è€ƒè™‘æ–°çš„å¯é€‰æ€§ã€‚

```
func testItemForRowAndSection() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
    )
    XCTAssertEqual(dataSource.item(forRow: 0, inSection: 0)?.title, "Margherita") // âœ…
    XCTAssertEqual(dataSource.item(forRow: 1, inSection: 0)?.title, "Capricciosa") // âœ…
}

func testItemForOutOfBoundsRowAndSectionIsNil() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
    )
    XCTAssertNil(dataSource.item(forRow: 2, inSection: 0)) // âœ…
    XCTAssertNil(dataSource.item(forRow: 0, inSection: 1))
    // âŒ XCTAssertNil failed: "MenuItem(title: "Margherita")"
    XCTAssertNil(dataSource.item(forRow: 2, inSection: 1)) // âœ…
    XCTAssertNil(dataSource.item(forRow: -1, inSection: -1)) // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ²¡æœ‰å´©æºƒï¼Œä½†æ˜¯å‡ºç•Œéƒ¨åˆ†çš„æµ‹è¯•ä»ç„¶å¤±è´¥ã€‚è¿™æ˜¯å› ä¸ºåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åªæ£€æŸ¥äº†è¡Œã€‚è®©æˆ‘ä»¬å…¨é¢æ£€æŸ¥ä¸€ä¸‹ã€‚

```
func item(forRow row: Int, inSection section: Int) -> MenuItem? {
    guard section == 0 else { return .none }
    guard row >= 0, pizzas.count > row else { return .none }

    return MenuItem(pizza: pizzas[row])
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
func testItemForOutOfBoundsRowAndSectionIsNil() {
    let dataSource = MenuDataSource(
        pizzas: [.fixture(name: "Margherita"), .fixture(name: "Capricciosa")]
    )
    XCTAssertNil(dataSource.item(forRow: 2, inSection: 0)) // âœ…
    XCTAssertNil(dataSource.item(forRow: 0, inSection: 1)) // âœ…
    XCTAssertNil(dataSource.item(forRow: 2, inSection: 1)) // âœ…
    XCTAssertNil(dataSource.item(forRow: -1, inSection: -1)) // âœ…
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‰€æœ‰çš„è€ƒéªŒéƒ½è¿‡å»äº†ï¼Œå¿«ä¹çš„æ—¥å­ã€‚æäº¤:`Address out of range behaviour of item(forRow:, inSection:)`ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬çš„æŠ«è¨èœå•æœ‰äº†ä¸€ä¸ªåŠŸèƒ½æ­£å¸¸çš„æ•°æ®æºã€‚ğŸ‰ã€‚ä¸‹ä¸€æ­¥æ˜¯å°†å®ƒè¾“å…¥è§†å›¾æ§åˆ¶å™¨ï¼Œä»¥ä¾¿å‘ç”¨æˆ·æ˜¾ç¤ºè¯¥ä¿¡æ¯ã€‚æˆ‘ä»¬å½“ç„¶ä¹Ÿå¯ä»¥ç”¨æµ‹è¯•æ¥é©±åŠ¨è¿™ä¸ªå®ç°ï¼Œä½†æ˜¯è¿™è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚

ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨`MenuDataSource`æ¥æ”¯æŒä¸€ä¸ª`UITableView`ã€‚

```
extension MenuViewController: UITableViewDataSource {

    func numberOfSections(in tableView: UITableView) -> Int {
        return menuDataSource.numberOfSections
    }

    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return menuDataSource.numberOfRows(inSection: section)
    }

    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        let cell = tableView.dequeueReusableCell(withIdentifier: cellIdentifier, for: indexPath)
        guard let item = menuDataSource.item(forRow: indexPath.row, inSection: indexPath.section) else {
            return cell
        }

        cell.textLabel?.text = item.title

        return cell
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#its-too-slow)â€œå¤ªæ…¢äº†â€

æˆ‘ä»å¼€å‘äººå‘˜å’Œç®¡ç†äººå‘˜é‚£é‡Œå¾—åˆ°çš„ä¸€ä¸ªæ™®éè§‚å¯Ÿæ˜¯ TDDing éœ€è¦æ›´é•¿çš„æ—¶é—´ã€‚â€œå¦‚æœæ²¡æœ‰æµ‹è¯•ï¼Œæˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶é—´ä¼šå°‘å¾—å¤šã€‚â€å½“ç„¶ï¼Œä¼šæœ‰çš„ã€‚ä½†æ˜¯æ„å»ºä¸€ä¸ªè½¯ä»¶äº§å“ä¸ä»…ä»…æ˜¯å†™ä»£ç çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¡®ä¿ä»£ç çš„è¡Œä¸ºç¬¦åˆé¢„æœŸï¼Œå¹¶ä¸”èƒ½å¤Ÿè½»æ¾åœ°ä¿®æ”¹ä»£ç ã€‚

æœ€é‡è¦çš„æ˜¯ï¼Œå½“ä½ åªæœ‰ä¸€ä¸ªå±å¹•æ—¶ï¼Œè¿™å¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹å¤§æå°ç”¨ï¼Œä½†å¤§å¤šæ•°åº”ç”¨ç¨‹åºå¹¶ä¸åªæœ‰ä¸€ä¸ªå±å¹•æˆ–ä¸€ä¸ªåŠŸèƒ½ï¼Œä¸æ˜¯å—ï¼Ÿä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸ºèœå•ä¸­çš„æ¯ä¸ªé¡¹ç›®æ·»åŠ ä¸€ä¸ªè¯¦ç»†çš„å±å¹•ï¼Œä»¥éªŒè¯è¯¥å±å¹•çš„è¡Œä¸ºï¼Œæˆ‘ä»¬å°†å¿…é¡»å§‹ç»ˆå¯¼èˆªåˆ°å®ƒã€‚å¦‚æœæµ‹è¯•æ¶µç›–äº†å¤§éƒ¨åˆ†è¡Œä¸ºï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°é€šè¿‡è¿è¡Œæµ‹è¯•æ¥éªŒè¯å®ƒï¼Œå¹¶ä¸”åªåœ¨éœ€è¦éªŒè¯ UI ç»†èŠ‚æ—¶æ‰å¯åŠ¨å’Œæµè§ˆåº”ç”¨ç¨‹åºï¼Œä»è€ŒèŠ‚çœå¤§é‡æ—¶é—´ã€‚

å½“ç”¨æµ‹è¯•é©±åŠ¨ä½ çš„å®ç°æ—¶ï¼Œä½ åœ¨ç¼–å†™é˜¶æ®µè¦æ…¢ä¸€ç‚¹ï¼Œä»¥ä¾¿åœ¨å¼€å‘è¿‡ç¨‹çš„æ‰€æœ‰å…¶ä»–æ­¥éª¤ä¸­å¿«ä¸€ç‚¹ã€‚åŒæ ·é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œå½“ä½ è·å¾—æ›´å¤šæ—¶é—´çš„ TDD æ—¶ï¼Œä½ ä¼šåšå¾—æ›´å¿«ã€‚æµ‹è¯•é©±åŠ¨ä»£ç åº“çš„æˆç†Ÿä¹Ÿæœ‰åŠ©äºæ›´å¿«åœ°ç¼–å†™æµ‹è¯•ï¼Œå› ä¸ºæ‚¨å·²ç»æœ‰äº†å¾ˆå¤šåŸºç¡€è®¾æ–½ã€‚

## [](#recap)é‡è¿°

æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¦‚ä½•ç¼–å†™æµ‹è¯•é©±åŠ¨çš„è½¯ä»¶ã€‚è¿‡ç¨‹å¾ˆç®€å•:

*   ä¸ºæ‚¨å¸Œæœ›æ‹¥æœ‰çš„ä»£ç ç¼–å†™ä¸€ä¸ªæµ‹è¯•ï¼Œå®ƒä¼šå¤±è´¥ï¼Œå› ä¸ºä»£ç è¿˜æ²¡æœ‰å‡ºç°ã€‚
*   ä½¿ç”¨å¤±è´¥çš„æµ‹è¯•ä½œä¸ºåé¦ˆæ¥å®ç°è¶³å¤Ÿçš„ä»£ç ä»¥ä½¿æµ‹è¯•é€šè¿‡ã€‚
*   ä¸€æ—¦ä½ é€šè¿‡äº†æµ‹è¯•ï¼Œè®©åº•å±‚ä»£ç å˜å¾—æ›´å¥½ã€‚

æ¢å¥è¯è¯´:çº¢è‰²ã€ç»¿è‰²ã€æäº¤ã€é‡æ„ã€æäº¤ã€‚

è¿™ç§ç®€å•æ€§æ˜¯å®ƒå¼ºå¤§çš„åŸå› ã€‚ç¼–å†™è¶³å¤Ÿå¤šçš„æµ‹è¯•ä»£ç æ¥è·å¾—å¤±è´¥ï¼Œç„¶åè¶³å¤Ÿå¤šçš„ä»£ç æ¥ä½¿å®ƒé€šè¿‡æ„å‘³ç€ä½ æ€»æ˜¯åœ¨è§£å†³å°é—®é¢˜ã€‚è¿™ç§æŒç»­å¿«é€Ÿçš„åé¦ˆå¾ªç¯å°±æ˜¯ä¸€ä¸ª[æµé‡](https://geni.us/StUP)è¯±å¯¼è¿‡ç¨‹ã€‚å°±åƒè¿åŠ¨å‘˜å’Œå–œå‰§æ¼”å‘˜éƒ½çŸ¥é“çš„é‚£æ ·ï¼Œä½ çš„åé¦ˆå¾ªç¯è¶Šå¿«ï¼Œä½ è¿›æ­¥çš„å°±è¶Šå¿«ã€‚

**TDD ä¸ä»…ä»…æ˜¯ä¸€ç§å†™ä»£ç çš„æ–¹å¼ï¼Œæ›´æ˜¯ä¸€ç§å•†ä¸šç†å¿µ**ã€‚è¿™æ˜¯ä¸€ç§ä»¥å°çš„å¢é‡æ­¥éª¤æ„å»ºäº§å“ï¼ŒåŒæ—¶ä¸æ–­è·å¾—åé¦ˆçš„æ–¹æ³•ï¼Œä»å•ä¸ªåŠŸèƒ½çš„å¾®è§‚å±‚é¢ï¼Œåˆ°ä¸‹ä¸€ç‰ˆæœ¬è¿­ä»£çš„å®è§‚å±‚é¢ã€‚

* * *

ğŸ‘‰ğŸ“¬å¦‚æœä½ å–œæ¬¢é˜…è¯»æ­¤æ–‡[,è¯·ç‚¹å‡»è¿™é‡Œ](http://eepurl.com/dEr0DH),åœ¨ä½ çš„æ”¶ä»¶ç®±é‡Œæ”¶åˆ°ç±»ä¼¼è¿™æ ·çš„æ–°å¸–å­ã€‚