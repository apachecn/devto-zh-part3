# ç¼–å†™æ›´å¿«çš„ JavaScript

> åŸæ–‡:[https://dev.to/yashints/write-faster-javascript-18f7](https://dev.to/yashints/write-faster-javascript-18f7)

å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ç¼–å†™çš„ä»£ç éƒ½æ˜¯ä»äº’è”ç½‘ä¸Šå¤åˆ¶ç²˜è´´è¿‡æ¥çš„ã€‚å¦‚ä»Šï¼ŒStackOverflow æ˜¯å¯»æ‰¾å„ç§é—®é¢˜è§£å†³æ–¹æ¡ˆçš„ä¸»è¦æ¥æºã€‚ä½†æ˜¯ï¼Œåœ¨æ²¡æœ‰çœŸæ­£äº†è§£å¹•åå‘ç”Ÿäº†ä»€ä¹ˆçš„æƒ…å†µä¸‹ï¼Œç›²ç›®åœ°å¤åˆ¶ç²˜è´´ä»£ç å¯ä»¥å—ï¼Ÿ

# [](#a-bit-of-context)ä¸€ç‚¹è„‰ç»œ

å½“æˆ‘è¯´ **StackOverflow** ä¸åº”è¯¥ç›²ç›®ä½¿ç”¨æ—¶ï¼Œä¸è¦è¯¯ä¼šæˆ‘çš„æ„æ€ã€‚å¯¹äºä¸–ç•Œå„åœ°å¼€å‘äººå‘˜é¢ä¸´çš„å¤§å¤šæ•°æ—¥å¸¸é—®é¢˜å’Œ bugï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¿¡æ¯æ¥æºã€‚åªæ˜¯æˆ‘ä»¬åº”è¯¥æ›´ä¸»åŠ¨ä¸€ç‚¹ï¼Œåœ¨æ‰€æœ‰å¯è¡Œçš„é€‰æ‹©ä¸­åšå‡ºæœ€ä½³é€‰æ‹©ã€‚

è®©æˆ‘ç»™ä½ çœ‹ä¸€äº›ä¾‹å­ï¼Œä¸€æ®µä»£ç å¯ä»¥ç”¨å¤šç§æ–¹å¼ç¼–å†™ï¼Œæœ€æ˜æ˜¾çš„é€‰æ‹©ä¸ä¸€å®šæ˜¯æœ€å¥½çš„ã€‚

## [](#chaining-array-loop-chaining)é“¾æ¥æ•°ç»„å¾ªç¯é“¾æ¥

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«åç§°å’Œå¹´é¾„å±æ€§çš„`200,000`å¯¹è±¡çš„æ•°ç»„ã€‚æˆ‘ä»¬æƒ³è¦æ‰€æœ‰ 22 å²ä»¥ä¸‹çš„äººçš„åå­—(å‡è®¾æˆ‘ä»¬æœ‰ä»–ä»¬ä¸­çš„`100,000`)ã€‚è¿™æ˜¯å¤§å¤šæ•°äººå¯èƒ½ä½¿ç”¨çš„è§£å†³æ–¹æ¡ˆ:

```
const under22People = originalList
  .filter(x => x.age < 22)
  .map(x => x.name) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è‡ªä»`ES5`å’Œ`ES6`è¢«å¼•å…¥åï¼Œä¸€ç»„å¾ˆå¥½çš„æ•°ç»„æ–¹æ³•å‡ºç°äº†ã€‚`ES6s`æ›´å¹²å‡€çš„è¯­æ³•ä½¿å¾—ä¸ºäº†äº§ç”Ÿæˆ‘ä»¬æƒ³è¦çš„ç»“æœè€Œé“¾æ¥æ–¹æ³•å˜å¾—æ›´å®¹æ˜“ã€‚é—®é¢˜åœ¨äºæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿™äº›å¥½æ–¹æ³•ï¼Œå´æ²¡æœ‰æ„è¯†åˆ°å®ƒä»¬æ˜¯å¦‚ä½•æ‰§è¡Œçš„ã€‚

ä¹ä¸€çœ‹ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ä»£ç ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä»”ç»†è§‚å¯Ÿï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¾ªç¯ï¼Œå®ƒåœ¨è¿‡æ»¤æ—¶è¿è¡Œäº†`200,000`æ¬¡ï¼Œåœ¨é€‰æ‹©åå­—æ—¶åˆè¿è¡Œäº†`100,000`æ¬¡ã€‚

åœ¨è¿™é‡Œæˆ‘ä»¬åªéœ€è¦å¾ªç¯ä¸€æ¬¡è¿™äº›é¡¹ç›®ã€‚é‚£ä¹ˆè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•é‡å†™è¿™æ®µä»£ç :

```
const under22People = []
originalList.forEach(({ age, name }) => {
  age >= 18 && under22People.push(name)
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨è¿™æ®µä»£ç åªè¿è¡Œäº†`200,000`æ¬¡ã€‚å®ƒçœ‹èµ·æ¥ä¸å¦‚é“¾å¼æ–¹æ³•å¥½ï¼Œä½†æ˜¯å®ƒç¡®å®æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚

æ‚¨ç”šè‡³å¯ä»¥ä½¿ç”¨`reduce`æ–¹æ³•æ¥åšåŒæ ·çš„äº‹æƒ…:

```
const under22People = originalList.reduce(
  (acc, { age, name }) => {
    return age >= 18 ? [...ac, name] : acc
  },
  []
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®ƒçœ‹èµ·æ¥çš„ç¡®å¯è¯»æ€§å·®äº†å¾ˆå¤šï¼Œä½†å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œå®ƒåšäº†å®Œå…¨ç›¸åŒçš„å·¥ä½œã€‚

## [](#abusing-arrow-functions)æ»¥ç”¨ç®­å¤´åŠŸèƒ½

å½“ä½ å†™`JavaScript`çš„æ—¶å€™ï¼Œä½ å¯ä»¥é—®è‡ªå·±ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜:ä½ æ˜¯å¦çŸ¥é“ä¼ ç»Ÿå‡½æ•°å’Œç®­å¤´å‡½æ•°(åˆåèƒ–å‡½æ•°)ä¹‹é—´çš„åŒºåˆ«ã€‚

ä» MDN Web æ–‡æ¡£:

> ç®­å¤´å‡½æ•°è¡¨è¾¾å¼åœ¨è¯­æ³•ä¸Šæ˜¯å¸¸è§„å‡½æ•°è¡¨è¾¾å¼çš„ç´§å‡‘æ›¿ä»£ï¼Œå°½ç®¡å®ƒæ²¡æœ‰ç»‘å®šåˆ°`this`ã€`arguments`ã€`super`æˆ–`new.target`å…³é”®å­—ã€‚ç®­å¤´å‡½æ•°è¡¨è¾¾å¼ä¸é€‚åˆç”¨ä½œæ–¹æ³•ï¼Œä¹Ÿä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚

åœ¨ä½ é—®ä¹‹å‰ï¼Œä¸ï¼Œå®ƒä»¬ä¸æ˜¯ JavaScript ä¸­ç±»ä¼¼äº`C#`çš„åŒ¿åå‡½æ•°ã€‚ä½†æ˜¯ç°åœ¨ä½ å”¯ä¸€éœ€è¦å…³å¿ƒçš„æ˜¯ä»–ä»¬æ²¡æœ‰èŒƒå›´ã€‚

ä»–ä»¬çš„è®¸å¤šç”¨ä¾‹ä¹‹ä¸€å°±æ˜¯åœ¨è¯¾å ‚ä¸Šä½¿ç”¨å®ƒä»¬ã€‚è€ƒè™‘åœ¨`React`ä¸­ä½ ä¸å†éœ€è¦æ‰‹åŠ¨ç»‘å®šä½ çš„å‡½æ•°ï¼Œæ¯”å¦‚:

```
this.handleClick = this.handleClick.bind(this) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œä½ åº”è¯¥è¿™æ ·å†™ä½ çš„ç±»:

```
class MyComponent extends Component {
  handleClick = () => {
    // ...
  }

  render() {
    // ...
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨å¯èƒ½çŸ¥é“ï¼Œé€šå¸¸çš„åŠŸèƒ½åœ¨åŸå‹ä¸­å®šä¹‰ï¼Œå¹¶å°†åœ¨æ‰€æœ‰å®ä¾‹ä¸­å…±äº«ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ª`N`ç»„ä»¶çš„åˆ—è¡¨ï¼Œè¿™äº›ç»„ä»¶å°†å…±äº«ç›¸åŒçš„æ–¹æ³•ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬çš„ç»„ä»¶è¢«ç‚¹å‡»ï¼Œæˆ‘ä»¬ä»ç„¶è°ƒç”¨æˆ‘ä»¬çš„æ–¹æ³•`N`æ¬¡ï¼Œä½†æ˜¯å®ƒå°†è°ƒç”¨ç›¸åŒçš„åŸå‹ã€‚ç”±äºæˆ‘ä»¬åœ¨åŸå‹ä¸­å¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•ï¼Œ`JavaScript`å¼•æ“å¯ä»¥ä¼˜åŒ–å®ƒã€‚

å¦ä¸€æ–¹é¢ï¼Œå¯¹äºç±»å±æ€§ä¸­çš„ç®­å¤´å‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨åˆ›å»º`N`ç»„ä»¶ï¼Œè¿™äº›`N`ç»„ä»¶ä¹Ÿå°†åˆ›å»º`N`å‡½æ•°ã€‚é€šè¿‡æŸ¥çœ‹ transpiled ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ç±»å±æ€§æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çš„ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬ç‚¹å‡»`N`ç»„ä»¶ï¼Œå°†ä¼šè°ƒç”¨`N`ä¸åŒçš„åŠŸèƒ½ã€‚

æ‰€ä»¥ä¸‹æ¬¡ä½ å†™æ–°çš„é—ªäº®çš„`React`ç»„ä»¶æ—¶è€ƒè™‘è¿™ç§æ–¹æ³•ã€‚

## [](#nested-functions-vs-iifes)åµŒå¥—å‡½æ•° VS IIFEs

å°†ä¸€ä¸ªå‡½æ•°åµŒå¥—åœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­ä¼¼ä¹æ˜¯å°†ä¸€äº›é€»è¾‘ä¸å¤–ç•Œéš”ç¦»çš„å¥½ä¸»æ„ã€‚è€ƒè™‘ä»¥ä¸‹ä»£ç :

```
function doSomething(arg1, arg2) {
  function nestedHelper(arg) {
    return process(arg)
  }

  return nestedHelper(arg1) + nestedHelper(arg2)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šè¿°ä»£ç çš„é—®é¢˜åœ¨äºï¼Œæ¯æ¬¡è°ƒç”¨`doSomething`æ—¶ï¼Œ`nestedHeler`éƒ½ä¼šè¢«é‡æ–°åˆ›å»ºã€‚ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª`IIFE`(ç«‹å³è°ƒç”¨å‡½æ•°):

```
const result = (function() {
  function privateHelper(arg) {
    var result = process(arg)
    return result
  }

  return function(arg1, arg2) {
    return (
      privateHelper(arg1) + privateHelper(arg2)
    )
  }
})() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“æ‰§è¡Œè¿™æ®µä»£ç æ—¶ï¼ŒåµŒå¥—æ–¹æ³•å°†åªåˆ›å»ºä¸€æ¬¡ğŸ¤·â€â™‚ï¸.

# å°½å¯èƒ½ä½¿ç”¨é›†åˆè€Œä¸æ˜¯æ•°ç»„

ä¸€ä¸ª`array`å’Œä¸€ä¸ª`Set`ä¹‹é—´æœ€æ˜æ˜¾çš„åŒºåˆ«æ˜¯`array`æ˜¯ä¸€ä¸ª*ç´¢å¼•çš„*é›†åˆï¼Œè€Œ`Set`æ˜¯åŸºäºé”®çš„ã€‚

é‚£ä¹ˆä¸ºä»€ä¹ˆä½ åº”è¯¥ä½¿ç”¨`Set`ï¼Ÿ

### [](#searching-for-an-item)æœç´¢ä¸€ä¸ªé¡¹ç›®

ä½¿ç”¨`indexOf()`æˆ–`includes()`æ¥æ£€æŸ¥ä¸€ä¸ªæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé¡¹ç›®æ˜¯å¾ˆæ…¢çš„ã€‚åœ¨`Set`ä½ å¯ä»¥ç”¨`has()` :
æ‰¾åˆ°ä¸€ä¸ªéå¸¸ç®€å•çš„é¡¹ç›®

```
const mySet = new Set([1, 1, 2])

console.log(mySet.has(2)) // true 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#deleting-an-item)åˆ é™¤ä¸€ä¸ªé¡¹ç›®

åœ¨`Set`ä¸­ï¼Œæ‚¨å¯ä»¥æ ¹æ®é¡¹ç›®çš„å€¼åˆ é™¤é¡¹ç›®ã€‚åœ¨æ•°ç»„ä¸­ï¼Œç­‰æ•ˆçš„æ˜¯åŸºäºå…ƒç´ çš„`index`ä½¿ç”¨`splice()`ã€‚å¦‚å‰æ‰€è¿°ï¼Œä¾èµ–æŒ‡æ•°æ˜¯ç¼“æ…¢çš„ã€‚

```
const mySet = new Set([1, 2, 3, 4, 5])

mySet.delete(1) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#insert-an-item)æ’å…¥ä¸€ä¸ªé¡¹ç›®

ä½¿ç”¨`push()`æˆ–`unshift()`å°†é¡¹ç›®æ·»åŠ åˆ°`Set`æ¯”æ·»åŠ åˆ°æ•°ç»„è¦å¿«å¾—å¤šã€‚

```
const mySet = new Set([1, 2])

mySet.add(3) // Successfully added 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#storing-nan)å‚¨å­˜æ¥ 

æ‚¨ä¸èƒ½ä½¿ç”¨`indexOf()`æ¥æŸ¥æ‰¾å€¼`NaN`ï¼Œè€Œ`Set`èƒ½å¤Ÿå­˜å‚¨è¿™ä¸ªå€¼ã€‚

### [](#removing-duplicates)åˆ é™¤é‡å¤é¡¹

å¯¹è±¡åªå­˜å‚¨å”¯ä¸€çš„å€¼ã€‚å¦‚æœæ‚¨å¸Œæœ›é¿å…å­˜å‚¨é‡å¤é¡¹ï¼Œè¿™ä¸æ•°ç»„ç›¸æ¯”æ˜¯ä¸€ä¸ªæ˜¾è‘—çš„ä¼˜åŠ¿ï¼Œå› ä¸ºæ•°ç»„éœ€è¦é¢å¤–çš„ä»£ç æ¥å¤„ç†é‡å¤é¡¹ã€‚

```
const mySet = new Set([1, 1, 2])

mySet.add(3) // Successfully added

console.log(mySet.values()) // 1,2,3 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#summary)æ€»ç»“

åœ¨ç°å®ä¸–ç•Œçš„ä¸šåŠ¡åº”ç”¨ç¨‹åºä¸­ç¼–å†™ä»£ç æ—¶ï¼Œæœ‰è®¸å¤šè¿™æ ·çš„ä¾‹å­éœ€è¦æ‚¨å°å¿ƒè°¨æ…ã€‚é€Ÿåº¦æ˜¯æ¯ä¸ª web åº”ç”¨ç¨‹åºæœ€é‡è¦çš„éƒ¨åˆ†ä¹‹ä¸€ï¼Œè€ƒè™‘åˆ°ä»¥ä¸Šå‡ ç‚¹ï¼Œå°†ä¼šæé«˜ä»£ç çš„æ€§èƒ½ï¼Œä»è€Œè®©ç”¨æˆ·æ›´æ»¡æ„ğŸ˜Šã€‚

å¸Œæœ›è¿™èƒ½å¸®åŠ©ä½ å¼€å§‹æ€è€ƒï¼Œé™¤äº†åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆä¹‹å¤–ï¼Œè¿˜æœ‰ä»€ä¹ˆå…¶ä»–æ–¹æ³•å¯ä»¥è§£å†³åŒæ ·çš„é—®é¢˜ã€‚