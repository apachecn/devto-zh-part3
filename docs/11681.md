# ç”¨ CircleCI åˆ¶é€ è¶…å¿«ç”µå­ğŸš€

> åŸæ–‡:[https://dev . to/kontrollanten/super-fast-electron-builds-with-circle ci-5 ghn](https://dev.to/kontrollanten/super-fast-electron-builds-with-circleci--5ghn)

æœ€è¿‘æˆ‘ä»[ç‰¹æ‹‰ç»´æ–¯](https://travis-ci.org)åˆ‡æ¢åˆ° [CircleCI](http://circleci.com) ï¼Œå› ä¸ºæˆ‘åœ¨è®©æˆ‘çš„[ç‰¹æ‹‰ç»´æ–¯èµ›æ®µ](https://docs.travis-ci.com/user/build-stages/)å‡†ç¡®å·¥ä½œæ—¶é‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚ç»“æœæ˜¯å‹å€’æ€§çš„ã€‚

# [](#simple-docker-configuration)ç®€å•çš„ Docker é…ç½®

ç”±äº CircleCI ä»»åŠ¡å¯ä»¥åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œï¼Œé…ç½® T2 ç”µå­åˆ¶é€ å•†å¤šç‰ˆæœ¬å˜å¾—éå¸¸ç®€å•

```
# Travis
script:
  - |
    if [ "$TRAVIS_OS_NAME" == "linux" ]; then
      docker run --rm \
        --env-file <(env | grep -iE 'DEBUG|NODE_|ELECTRON_|YARN_|NPM_|CI|CIRCLE|TRAVIS|APPVEYOR_|CSC_|_TOKEN|_KEY|AWS_|STRIP|BUILD_') \
        -v ${PWD}:/project \
        -v ~/.cache/electron:/root/.cache/electron \
        -v ~/.cache/electron-builder:/root/.cache/electron-builder \
        electronuserland/builder:wine \
        /bin/bash -c "yarn --link-duplicates --pure-lockfile && yarn release --linux --win"
     fi

# CircleCI
deploy-linux:
  docker:
    - image: electronuserland/builder:wine
  steps:
    - run: yarn --link-duplicates --pure-lockfile
    - run: yarn release --linux --win 
```

Circle é…ç½®æ›´å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤ï¼Œå› ä¸ºä¸€åˆ‡éƒ½æ˜¯åŸºäº Docker çš„ï¼Œä½ ä¸éœ€è¦ä¼ é€’ä½ æƒ³åœ¨å®¹å™¨ä¸­ä½¿ç”¨çš„ç¯å¢ƒå˜é‡ã€‚

# [](#almighty-debug-support)å…¨èƒ½è°ƒè¯•æ”¯æŒ

æœ‰äº† Dockerï¼Œæ‚¨å¯ä»¥åœ¨æœ¬åœ°è¿è¡Œç›¸åŒç¯å¢ƒä¸‹çš„ä½œä¸šï¼Œè¿™ä½¿å¾—ä¸€åˆ‡éƒ½æ›´å®¹æ˜“è°ƒè¯•ã€‚å¦‚æœè¿™è¿˜ä¸å¤Ÿï¼Œæ‚¨è¿˜å¯ä»¥å°† SSH æ”¾å…¥æ„å»ºå®¹å™¨ã€‚

# [](#super-fast)è¶…å¿«

åœ¨æ¨é€æäº¤åçš„ 4 åˆ†é’Ÿå†…ï¼Œæˆ‘æ”¶åˆ°äº†æ¥è‡ª

*   æ—æŒº
*   ååº”å•å…ƒæµ‹è¯•
*   ç”µå­å•å…ƒæµ‹è¯•
*   e2e å…‰è°±æµ‹è¯•

ååˆ†é’Ÿåï¼Œæˆ‘ä¹Ÿå°†éƒ¨ç½² Linux å’Œ MacOS ç‰ˆæœ¬ï¼Œå¹¶å‡†å¤‡ä¸‹è½½ã€‚ä¸å†éœ€è¦æ’é˜Ÿ(è‡³å°‘ç›®å‰å¦‚æ­¤),ä¸å†éœ€è¦ç­‰å¾…ã€‚ç”±äº CI ç¯å¢ƒåº”è¯¥æ”¯æŒæˆ‘ä½œä¸ºä¸€åå¼€å‘äººå‘˜ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºåé¦ˆè¦å¿«ï¼Œæˆ‘æ°¸è¿œä¸å¿…ç­‰å¾…è¶…è¿‡ 5-10 åˆ†é’Ÿï¼Œç›´åˆ°æˆ‘å¾—åˆ°å›åº”ã€‚ä¸€ä¸ªå¾ˆå¤§çš„å¥½å¤„æ˜¯ï¼Œæˆ‘å†ä¹Ÿä¸ç”¨åœ¨æˆ‘çš„ç‰ˆæœ¬ä¸­çœ‹åˆ°éª„å‚²çš„æ——å¸œäº†ã€‚ğŸ¥³

è¦çœ‹æˆ‘çš„æ•´ä¸ªåœˆé…ç½®ï¼Œä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ã€‚