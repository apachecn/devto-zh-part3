# ä½¿ç”¨ Goutte åœ¨ PHP ä¸­è¿›è¡Œç½‘é¡µæŠ“å–

> åŸæ–‡:[https://dev.to/sayopaul/web-scraping-in-php-using-goutte-4p6h](https://dev.to/sayopaul/web-scraping-in-php-using-goutte--4p6h)

# [](#web-scraping-in-php-using-goutte)ä½¿ç”¨ Goutte åœ¨ PHP ä¸­è¿›è¡Œç½‘é¡µæŠ“å–

ä»Šå¤©æˆ‘å°†è°ˆè®ºä¸€äº›éå¸¸æ™®é€šçš„äº‹æƒ…ï¼Œç½‘ç»œæŠ“å–ã€‚æ ¹æ®æ‚¨æˆ–å®¢æˆ·çš„éœ€æ±‚ï¼Œå¯èƒ½ä¼šå‡ºç°éœ€è¦ä»ç½‘é¡µä¸­æå–æ•°æ®çš„æƒ…å†µã€‚

ä»€ä¹ˆæ˜¯ç½‘é¡µæŠ“å–ï¼Ÿ

æ ¹æ® [WebHarvy](https://www.webharvy.com) ï¼Œç½‘é¡µæŠ“å–(ä¹Ÿç§°ä¸ºå±å¹•æŠ“å–ã€ç½‘é¡µæ•°æ®æå–ã€ç½‘é¡µé‡‡é›†ç­‰ã€‚)æ˜¯ä¸€ç§ç”¨äºä»ç½‘ç«™ä¸­æå–å¤§é‡æ•°æ®çš„æŠ€æœ¯ã€‚æœ€ç®€å•çš„å½¢å¼ï¼Œç½‘ç»œæŠ“å–æ˜¯é€šè¿‡è„šæœ¬è·å–ç½‘é¡µå†…å®¹ã€‚å¥½äº†ï¼Œè®©æˆ‘ä»¬ç»§ç»­å­¦ä¹  PHP ä¸­çš„ web æŠ“å–ã€‚æœ€è¿‘ï¼Œæˆ‘éœ€è¦ç”¨ PHP ä¸ºä¸€ä¸ªå®¢æˆ·æŠ“å–ä¸€ä¸ªç½‘ç«™ï¼Œæ‰€ä»¥æˆ‘å¯»æ‰¾ç”¨ PHP è®¨è®º web æŠ“å–çš„æ–‡ç« ï¼Œæˆ‘å‘ç°å¾ˆå°‘ï¼Œè€Œä¸”å¤§å¤šæ•°éƒ½å·²ç»è¿‡æ—¶äº†ã€‚

ç„¶è€Œï¼Œåœ¨æˆ‘çš„ç ”ç©¶ä¸­ï¼Œæˆ‘é‡åˆ°äº†[Goutte](https://github.com/FriendsOfPHP/Goutte)ï¼›ä¸€ä¸ª(å¾ˆæ£’çš„)PHP å±å¹•æŠ“å–å’Œç½‘é¡µæŠ“å–åº“ã€‚åœ¨å…¶æ ¸å¿ƒï¼ŒGoutte æ˜¯ä¸€ä¸ªåŒ…è£…ä¸‰ä¸ª Symfony çš„ç»„æˆéƒ¨åˆ†(ä¸Šå¸ä¿ä½‘æ¨å¥‡ç…œğŸ™Œ) ;BrowserKitï¼ŒCssSelector å’Œ DomCrawlerã€‚å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œäº†è§£è¿™äº›ç»„ä»¶çš„ä½œç”¨å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒæœ‰åŠ©äºæˆ‘ä»¬äº†è§£ Goutte æœ‰å¤šå¼ºå¤§ã€‚

BrowserKit ç®€å•åœ°è¯´ï¼ŒBrowserKit ç»„ä»¶æ¨¡æ‹Ÿäº†çœŸå®æµè§ˆå™¨çš„è¡Œä¸ºã€‚è¿™æ˜¯ Goutte çš„åŸºæœ¬å…ƒç´ ã€‚

DomCrawlerDomCrawler ç»„ä»¶ç®€åŒ–äº† DOM(æ–‡æ¡£å¯¹è±¡æ¨¡å‹)çš„å¯¼èˆªã€‚DomCrawler å…è®¸æˆ‘ä»¬åƒè¿™æ ·å¯¼èˆª dom:

```
 $crawler = $crawler->filter('body > p'); 
```

æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å®ƒæä¾›çš„ä¸€äº›æ–¹æ³•éå† DOM ä¸Šçš„èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è·å¾—é¡µé¢ä¸»ä½“çš„ç¬¬ä¸€æ®µï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš:

```
 $crawler->filter('body > p')->eq(0); 
```

eq()æ–¹æ³•æ˜¯é›¶ç´¢å¼•çš„ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªæ•°å­—æ¥æŒ‡å®šæˆ‘ä»¬æƒ³è¦è®¿é—®çš„å…ƒç´ çš„ä½ç½®ã€‚
è¿˜æœ‰å…¶ä»–æ–¹æ³•å¦‚`siblings()`ã€`first()`ã€T2 çš„åˆ«åï¼Œåœ°ä¸‹ç®€ç§°`eq(0)`ã€`last()`ç­‰ã€‚

CssSelectorCssSelector æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ç»„ä»¶ï¼Œå®ƒå…è®¸æˆ‘ä»¬é€šè¿‡ CSS é€‰æ‹©å™¨æ¥é€‰æ‹©å…ƒç´ ã€‚å®ƒé€šè¿‡å°† CSS é€‰æ‹©å™¨è½¬æ¢æˆå®ƒä»¬çš„ XPath ç­‰ä»·ç‰©æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦é€‰æ‹©ä¸€ä¸ªå…·æœ‰åä¸ºâ€œfireâ€çš„ç±»çš„å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åš:

```
 $crawler->filter('.fire'); 
```

CssSelector ç»„ä»¶å¤ªç¥å¥‡äº†ï¼Œå®ƒç”šè‡³æ”¯æŒ CSS å¦‚ï¼›

```
 $crawler->filter('div[style*="max-height:175px; overflow: hidden;"]'); 
```

ä»¥ä¸Šæ„å‘³ç€æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªå…·æœ‰å†…è”æ ·å¼å±æ€§`"style=max-height:175px; overflow: hidden;"`çš„ div å…ƒç´ 

æ›´å¤šä¿¡æ¯ï¼Œè¯·åŠ¡å¿…é˜…è¯» [DomCrawler](https://symfony.com/doc/current/components/dom_crawler.html) ã€ [CssSelector](https://symfony.com/doc/current/components/css_selector.html) å’Œ [Goutte](https://github.com/FriendsOfPHP/Goutte) çš„æ–‡æ¡£ã€‚

å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å¯¹ä¸‰ä¸ªä¸»è¦ç»„ä»¶æœ‰äº†ä¸€ç‚¹æ¦‚å¿µï¼Œæ˜¯æ—¶å€™æŠŠæ‰€æœ‰çš„ä¸œè¥¿æ”¾åœ¨ä¸€èµ·ï¼Œå®é™…ä¸Šåšç‚¹ä»€ä¹ˆäº†ã€‚ç°åœ¨ä½ å¯èƒ½å·²ç»æ„è¯†åˆ°äº†ï¼Œè¯´åˆ°åˆ®æ“¦ï¼Œæ²¡æœ‰ç°æˆçš„æ–¹æ³•ã€‚ä½ å¯ä»¥è‡ªç”±æ¢ç´¢å’Œå°è¯•è®¸å¤šæ–¹æ³•æ¥è·å–æ•°æ®ã€‚ä½ å”¯ä¸€çš„é™åˆ¶å°±æ˜¯ä½ çš„åˆ›é€ åŠ›ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä¸å¾—ä¸å°† CssSelector å’Œ DomCrawler ç»“åˆèµ·æ¥ï¼Œä»¥ä¾¿å¾—åˆ°æˆ‘æƒ³è¦çš„ä¸œè¥¿(å®é™…ä¸Šï¼Œå¾ˆå¤šæ—¶å€™)ã€‚

åœ¨ä¸‹ä¸€ç¯‡[å¸–å­](https://dev.to/sayopaul/web-scraping-in-php-using-goutte---part-2-5e66)ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡æŠ“å– [Punch](https://punchng.com) çš„ç½‘ç«™ï¼ŒæŠŠæˆ‘ä»¬ç›®å‰æ‰€å­¦çš„ä¸€åˆ‡éƒ½æ”¾å…¥æ¸¸æˆä¸­ã€‚