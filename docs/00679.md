# æˆ‘åœ¨ä½¿ç”¨ Typescript å’Œ React æ—¶çš„å‘ç°

> åŸæ–‡:[https://dev . to/hurricane interactive/discoveries-I-made-while-using-type script-and-react-16lk](https://dev.to/hurricaneinteractive/discoveries-i-made-while-using-typescript-and-react-16lk)

> å›¾ç‰‡è‡´è°¢ [@ellladee](https://unsplash.com/photos/RFId0_7kep4)

è¿™ä¸ªæ˜ŸæœŸï¼Œæˆ‘ä¸€ç›´åœ¨ä½¿ç”¨ Typescript å¼€å‘ä¸€ä¸ª React åº”ç”¨ç¨‹åºï¼Œæˆ‘å‘ç°äº†ä¸€äº›éå¸¸æœ‰ç”¨çš„ä¸œè¥¿ã€‚è¿™æ˜¯æˆ‘ä½¿ç”¨ Typescript çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ä¹‹ä¸€ï¼Œåˆ°ç›®å‰ä¸ºæ­¢æˆ‘è¿˜ä¸æƒ³å›å»ã€‚å…¶ä¸­ä¸€äº›å‘ç°å¯èƒ½æ˜¯å¸¸è¯†ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ª Typescript æ–°æ‰‹æ¥è¯´ï¼Œå®ƒä»¬å¯¹äºç¼–å†™æ›´å¥½çš„ä»£ç éå¸¸æœ‰ç”¨ã€‚è‡³å°‘å¯¹æˆ‘æ¥è¯´æ˜¯è¿™æ ·ã€‚æ‰€ä»¥äº‹ä¸å®œè¿Ÿï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼

## [](#only-allow-specific-keys-on-an-object)åªå…è®¸ä¸€ä¸ªå¯¹è±¡ä¸Šçš„ç‰¹å®šå…³é”®ç‚¹

å½“æ‚¨æƒ³è¦é™åˆ¶å¯ä»¥æ·»åŠ åˆ°å¯¹è±¡çš„å…³é”®ç‚¹æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå…è®¸å¦ä¸€ä¸ª dev ä¼ é€’åº”è¯¥ç”¨ä½œäº‹ä»¶ä¾¦å¬å™¨çš„å‡½æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨åªå¸Œæœ›å¼€å‘äººå‘˜ä¼ é€’æœ‰æ•ˆçš„äº‹ä»¶ä¾¦å¬å™¨ï¼Œä»¥é¿å…ä»¤äººè®¨åŒçš„é”™è¯¯ã€‚

```
type TListenerTypes = "onload" | "progress" | "error"
type TListeners = {
  [k in TListenerTypes]: Function
}

// Passes!
const listenerObj: TListeners = {
  onload: () => {}
}

// Error
const errorObj: TListeners = {
  a: "something", // wrong type
  progress: () => {},
  d: 10 // not in objectKeys type
}

// Improvement added by this comment (https://dev.to/theodesp/comment/bd1k)
type TListenerTypes = "onload" | "progress" | "error"

const x: Record<TListenerTypes, Function> = {
    a: "something", // wrong type
    progress: () => {},
    d: 10 // wrong type
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#categorising-storybook-stories)åˆ†ç±»æ•…äº‹ä¹¦æ•…äº‹

åœ¨æˆ‘æ­£åœ¨åšçš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨[æ•…äº‹ä¹¦](https://storybook.js.org/)æ¥æµ‹è¯•æˆ‘ä»¬çš„ç»„ä»¶ã€‚ä¸€æ—¦ä½ æ·»åŠ äº†å‡ ä¸ªæ•…äº‹ï¼Œä½ å°±å¼€å§‹å¸Œæœ›æœ‰ä¸€ç§æ–¹æ³•å°†å®ƒä»¬å½’ç±»åˆ°ç›¸å…³çš„ç»„ä¸­ã€‚å¹¸è¿çš„æ˜¯æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘æ€ä¹ˆæ¨èæ•…äº‹ä¹¦éƒ½ä¸ä¸ºè¿‡ã€‚è¿™æ˜¯**è¶…çº§**æœ‰ç”¨çš„è§†è§‰ç‹¬ç«‹æµ‹è¯•ç»„ä»¶ã€‚å€ŸåŠ©*æ’ä»¶*çš„åŠ›é‡ï¼Œä½ å¯ä»¥è¿›è¡Œå¯è®¿é—®æ€§æ£€æŸ¥ã€æ˜/æš—æ¨¡å¼æµ‹è¯•ç­‰ã€‚

```
// uncategorised
storiesOf("Button", module).add(...)

// categorised under "Form"
storiesOf("Form|Selectbox", module).add(...) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#passing-a-component-as-props)ä¼ é€’ä¸€ä¸ªç»„ä»¶ä½œä¸ºé“å…·

å½“æˆ‘æƒ³åœ¨ä½¿ç”¨ [React è·¯ç”±å™¨](https://reacttraining.com/react-router/web/api/Route/render-func)æ—¶å£°æ˜ä¸€ä¸ªå®šåˆ¶çš„`<Route>`ç»„ä»¶æ—¶ï¼Œè¿™å°±æˆäº†ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘éœ€è¦ä¸€ç§æ–¹æ³•å°†ç»„ä»¶ä¼ é€’ç»™è‡ªå®šä¹‰çš„`<Route>`ï¼Œç„¶åèƒ½å¤Ÿå‘ˆç°è¯¥ç»„ä»¶ã€‚è¿™ä»¤äººæƒŠè®¶åœ°è®¨åŒã€‚**æç¤º**ï¼Œå¦‚æœä½ èƒ½å¤ŸæŸ¥çœ‹å…¶ä»–æ¨¡å—çš„ç±»å‹å®šä¹‰ï¼Œ**å»åšå§ï¼**æˆ‘ä»ç°æœ‰çš„ä»£ç åº“ä¸­æ‰¾åˆ°äº†ç›¸å½“å¤šçš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬è¿™ä¸ªï¼›

```
import { ComponentType } from "react"
import { RouteProps } from "react-router-dom"

interface ICustomRoute extends RouteProps {
  // Allows you to pass in components and then render them
  component: ComponentType<any>
}

const CustomRoute = ({
  component: Component,
  ...rest
}: ICustomRoute) => (
  <Route
    {...rest}
    render={props => (
      <Component {...props} />
    )}
  /> ) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#allow-native-html-attributes-as-props)å…è®¸åŸç”Ÿ HTML å±æ€§ä½œä¸ºé“å…·

å‡è®¾æ‚¨æƒ³è¦åˆ›å»ºä¸€ä¸ª`<Input />`ç»„ä»¶ï¼Œå®ƒåº”è¯¥æ¥å—ä¸€ä¸ª`<input />`å…ƒç´ çš„æ‰€æœ‰å±æ€§ä»¥åŠä¸€ä¸ªé¢å¤–çš„`theme`å¯¹è±¡ã€‚ä¸ºäº†é˜²æ­¢ä½ ä¸ºç»„ä»¶åˆ›å»ºè‡ªå®šä¹‰å®šä¹‰ï¼Œæœ€å¥½æ˜¯æ‰©å±•ä¸€ä¸ª`<input />`å…ƒç´ çš„å¯ç”¨å±æ€§ï¼Œè€Œä¸”ï¼Œ**ä½ å¯ä»¥ï¼**

```
import { HTMLAttributes } from "react"

type Theme = "light" | "dark"
interface IProps extends HTMLAttributes<HTMLInputElement> {
  // additional props if need
  theme: {
    variation: Theme
  }
}

// You might want to extract certain props and your custom props
// instead of just spreading all the props
// if you don't have additional props swap IProps for HTMLAttributes<HTMLInputElement>
const Input ({ theme, ...props }: IProps) => (
  <input
    {...props}
    className={`input input--${theme.variation}`}
  /> )

// Usage
<Input
  onChange={(e) => handle(e)}
  value={this.state.name}
  name="name"
  id="id"
  theme={{
    variation: "light"
  }}
/> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#get-device-orientation)è·å–è®¾å¤‡æ–¹ä½

è¿™ä¸æ˜¯çœŸæ­£çš„ Typescript æˆ– React ç›¸å…³ï¼Œä½†æ˜¯ï¼Œå®ƒå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ã€‚æˆ‘å®Œå…¨å¯ä»¥æƒ³è±¡è¿™å¯¹ä¸€ä¸ªå¾ˆé…·ä½†ä¹Ÿå¾ˆæ²¡ç”¨çš„åŠŸèƒ½å¾ˆæœ‰ç”¨ã€‚åœ¨ [MDN](https://developer.mozilla.org/en-US/docs/Web/API/Detecting_device_orientation) ä¸Šäº†è§£æ›´å¤šä¿¡æ¯ã€‚

```
// Check if it is supported
if (window.DeviceOrientationEvent) {
  window.addEventListener("deviceorientation", function(e) {
    console.log({
      x: e.alpha,
      y: e.beta,
      z: e.gamma
    })
  }, false)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#wrapping-up)åŒ…è£…å®Œæ¯•

æ¯å‘¨æˆ‘ä»¬éƒ½å­¦ä¹ æ–°çš„æŠ€æœ¯å’Œä¸åŒçš„æ€ç»´æ–¹å¼ã€‚æˆ‘å»ºè®®ä»»ä½•äººè®°ä¸‹ä½ å­¦åˆ°çš„ä¸åŒæŠ€æœ¯ã€‚ä½ ä¸ä»…ä¼šåˆ›å»ºä¸€ä¸ªå°çš„çŸ¥è¯†åº“ï¼Œå½“ä½ çœ‹åˆ°è‡ªå·±å–å¾—çš„è¿›æ­¥æ—¶ï¼Œä½ ä¹Ÿä¼šå˜å¾—æ›´æœ‰åŠ¨åŠ›ã€‚

* * *

è°¢è°¢ä½ çœ‹æˆ‘çš„æ–‡ç« ï¼Œå®ƒçœŸçš„æ„ä¹‰é‡å¤§ï¼â¤ï¸ï¼Œè¯·æä¾›ä»»ä½•åé¦ˆæˆ–æ„è§ï¼Œæˆ‘æ€»æ˜¯æœŸå¾…æ”¹è¿›å’Œæœ‰æ„ä¹‰çš„è®¨è®ºã€‚è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘çš„ [#myweekinjs](http://myweekinjs.com) æŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœä½ æœ‰å…´è¶£äº†è§£çš„è¯ï¼Œæˆ‘æœ‰ä¸€äº›æœ‰è¶£çš„æ–‡ç« ã€‚

### [](#until-next-time)ğŸ‘‹ä¸‹æ¬¡è§ï¼