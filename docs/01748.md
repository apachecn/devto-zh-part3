# æˆ‘çš„â€œå“‡ï¼Œæˆ‘ä¸çŸ¥é“ï¼â€ç©ç¬‘æ—¶åˆ»

> åŸæ–‡:[https://dev . to/briwa/my-whoa-I-not-know-the-moments-with-jest-3a3h](https://dev.to/briwa/my-whoa-i-didn-t-know-that-moments-with-jest-3a3h)

Jest ä¸€ç›´æ˜¯æˆ‘çš„é¦–é€‰å•å…ƒæµ‹è¯•å·¥å…·ã€‚å®ƒå¦‚æ­¤å¼ºå¤§ï¼Œæˆ‘å¼€å§‹è®¤ä¸ºæˆ‘ä¸€ç›´æ²¡æœ‰å……åˆ†åˆ©ç”¨å®ƒã€‚è™½ç„¶æµ‹è¯•é€šè¿‡äº†ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæˆ‘åœ¨è¿™é‡Œå’Œé‚£é‡Œé‡æ„äº†æˆ‘çš„æµ‹è¯•ï¼Œå› ä¸ºæˆ‘ä¸çŸ¥é“ Jest å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚æ¯æ¬¡æˆ‘æŸ¥çœ‹ Jest æ–‡æ¡£éƒ½æ˜¯ä¸åŒçš„ä»£ç ã€‚

æ‰€ä»¥ï¼Œæˆ‘å°†ä¸ Jest åˆ†äº«ä¸€äº›æˆ‘æœ€å–œæ¬¢çš„æŠ€å·§ï¼Œä½ ä»¬ä¸­çš„ä¸€äº›äººå¯èƒ½å·²ç»çŸ¥é“äº†ï¼Œå› ä¸ºä½ ä»¬æ²¡æœ‰åƒæˆ‘ä¸€æ ·è·³è¿‡é˜…è¯»è¿™äº›æ–‡æ¡£(çœŸå¯è€»)ï¼Œä½†æˆ‘å¸Œæœ›è¿™å¯¹é‚£äº›è·³è¿‡çš„äººæœ‰æ‰€å¸®åŠ©ï¼

FWIWï¼Œæˆ‘ä½¿ç”¨ Jest v24.8.0 ä½œä¸ºå‚è€ƒï¼Œæ‰€ä»¥è¯·æ³¨æ„ï¼Œå¦‚æœæŸäº›ä¸œè¥¿åœ¨æ‚¨å½“å‰ä½¿ç”¨çš„ Jest ç‰ˆæœ¬ä¸Šä¸èµ·ä½œç”¨ã€‚åŒæ ·ï¼Œè¿™äº›ä¾‹å­å¹¶ä¸ä»£è¡¨å®é™…çš„æµ‹è¯•ä»£ç ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªæ¼”ç¤ºã€‚

### [](#1-raw-tobe-endraw-vs-raw-toequal-endraw-)#1ã€‚`.toBe`å¯¹`.toEqual`

èµ·åˆï¼Œæ‰€æœ‰è¿™äº›ä¸»å¼ å¯¹æˆ‘æ¥è¯´éƒ½å¾ˆå¥½

```
expect('foo').toEqual('foo')
expect(1).toEqual(1)
expect(['foo']).toEqual(['foo']) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å§šå†›åˆ©ç”¨[æŸ´](https://www.chaijs.com/api/assert/)æ¥åšç­‰å¼æ–­è¨€(`to.equal`)ï¼Œè¿™å¾ˆè‡ªç„¶ã€‚äº‹å®ä¸Šï¼ŒJest ä¸ä¼šæŠ±æ€¨ï¼Œè¿™äº›æ–­è¨€ä¼šåƒå¾€å¸¸ä¸€æ ·è¿‡å»ã€‚

ä½†æ˜¯ï¼ŒJest æœ‰`.toBe`å’Œ`.toEqual`ã€‚å‰è€…ç”¨äºä½¿ç”¨ [`Object.is`](https://github.com/facebook/jest/blob/v24.8.0/packages/expect/src/matchers.ts#L76) æ–­è¨€ç›¸ç­‰ï¼Œåè€…ç”¨äºæ–­è¨€å¯¹è±¡å’Œæ•°ç»„ä¸Šçš„æ·±åº¦ç›¸ç­‰ã€‚ç°åœ¨ï¼Œ`.toEqual`å¯ä»¥ä½¿ç”¨ [`Object.is`](https://github.com/facebook/jest/blob/v24.8.0/packages/expect/src/jasmineUtils.ts#L91) ï¼Œå¦‚æœäº‹å®è¯æ˜å®ƒä¸éœ€è¦æ·±åº¦ç›¸ç­‰ï¼Œæ¯”å¦‚åœ¨åŸå§‹å€¼ä¸Šæ–­è¨€ç›¸ç­‰ï¼Œè¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆå‰é¢çš„ä¾‹å­é€šè¿‡å¾—å¾ˆå¥½ã€‚

```
expect('foo').toBe('foo')
expect(1).toBe(1)
expect(['foo']).toEqual(['foo']) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å› æ­¤ï¼Œå¦‚æœä½ å·²ç»çŸ¥é“ä½ æ­£åœ¨æµ‹è¯•ä»€ä¹ˆæ ·çš„å€¼ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨`.toBe`è·³è¿‡`.toEqual`ä¸­çš„æ‰€æœ‰å‡è®¾ã€‚

ä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯ä½¿ç”¨`.toBe`æ–­è¨€éåŸå§‹å€¼ç›¸ç­‰ã€‚

```
expect(['foo']).toBe(['foo']) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ æŸ¥çœ‹[çš„æºä»£ç ](https://github.com/facebook/jest/blob/v24.8.0/packages/expect/src/matchers.ts#L90)ï¼Œå½“`.toBe`å¤±è´¥æ—¶ï¼Œå®ƒä¼šé€šè¿‡è°ƒç”¨[è¢«`.toEqual`ä½¿ç”¨çš„å‡½æ•°](https://github.com/facebook/jest/blob/v24.8.0/packages/expect/src/matchers.ts#L562)æ¥å°è¯•æŸ¥çœ‹ä½ æ˜¯å¦ç¡®å®çŠ¯äº†é‚£ä¸ªé”™è¯¯ã€‚è¿™å¯èƒ½æ˜¯ä¼˜åŒ–æµ‹è¯•æ—¶çš„ä¸€ä¸ªç“¶é¢ˆã€‚

å¦‚æœæ‚¨ç¡®å®šæ‚¨æ–­è¨€çš„æ˜¯åŸå§‹å€¼ï¼Œé‚£ä¹ˆæ‚¨çš„ä»£ç å¯ä»¥è¿™æ ·é‡æ„ï¼Œä»¥è¾¾åˆ°ä¼˜åŒ–çš„ç›®çš„:

```
expect(Object.is('foo', 'foo')).toBe(true) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æŸ¥çœ‹[æ–‡æ¡£](https://jestjs.io/docs/en/expect#tobevalue)ä¸­çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚

### [](#2-more-befitting-matchers)#2ã€‚æ›´åˆé€‚çš„åª’äºº

ä»æŠ€æœ¯ä¸Šè®²ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`.toBe`æ¥æ–­è¨€ä»»ä½•ç±»å‹çš„å€¼ã€‚ä½¿ç”¨ Jestï¼Œæ‚¨å¯ä»¥ç‰¹åˆ«ä½¿ç”¨æŸäº›åŒ¹é…å™¨ï¼Œä½¿æ‚¨çš„æµ‹è¯•æ›´å…·å¯è¯»æ€§(åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ›´ç®€çŸ­)ã€‚

```
// ğŸ¤”
expect([1,2,3].length).toBe(3)

// ğŸ˜
expect([1,2,3]).toHaveLength(3) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
const canBeUndefined = foo()

// ğŸ¤”
expect(typeof canBeUndefined !== 'undefined').toBe(true)

// ğŸ¤”
expect(typeof canBeUndefined).not.toBe('undefined')

// ğŸ¤”
expect(canBeUndefined).not.toBe(undefined)

// ğŸ˜
expect(canBeUndefined).toBeDefined() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
class Foo {
  constructor(param) {
    this.param = param
  }
}

// ğŸ¤”
expect(new Foo('bar') instanceof Foo).toBe(true)

// ğŸ˜
expect(new Foo('bar')).toBeInstanceOf(Foo) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™äº›åªæ˜¯æˆ‘ä»[æ–‡æ¡£](https://jestjs.io/docs/en/expect)ä¸­çš„ä¸€é•¿ä¸²ç¬‘è¯åŒ¹é…å™¨ä¸­æŒ‘é€‰å‡ºæ¥çš„å‡ ä¸ªï¼Œä½ å¯ä»¥çœ‹çœ‹å…¶ä½™çš„ã€‚

### [](#3-snapshot-testing-on-a-nonui-elements)#3ã€‚å¯¹é UI å…ƒç´ è¿›è¡Œå¿«ç…§æµ‹è¯•

ä½ å¯èƒ½å¬è¯´è¿‡å…³äº[å¿«ç…§æµ‹è¯•çš„ç¬‘è¯](https://jestjs.io/docs/en/snapshot-testing)ï¼Œå®ƒå¸®åŠ©ä½ ç›‘æ§ UI å…ƒç´ çš„å˜åŒ–ã€‚ä½†æ˜¯å¿«ç…§æµ‹è¯•å¹¶ä¸å±€é™äºæ­¤ã€‚

è€ƒè™‘è¿™ä¸ªä¾‹å­:

```
const allEmployees = getEmployees()
const happyEmployees = giveIncrementByPosition(allEmployees)

expect(happyEmployees[0].nextMonthPaycheck).toBe(1000)
expect(happyEmployees[1].nextMonthPaycheck).toBe(5000)
expect(happyEmployees[2].nextMonthPaycheck).toBe(4000)
// ...etc 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ ä¸å¾—ä¸é›‡ç”¨è¶Šæ¥è¶Šå¤šçš„å‘˜å·¥ï¼Œé‚£å°±å¤ªä¹å‘³äº†ã€‚æ­¤å¤–ï¼Œå¦‚æœç»“æœæ˜¯æ¯ä¸ªé›‡å‘˜æœ‰æ›´å¤šçš„æ–­è¨€è¦åšï¼Œç”¨é›‡å‘˜æ•°ä¹˜ä»¥æ–°æ–­è¨€çš„æ•°é‡ï¼Œæ‚¨å°±æ˜ç™½äº†ã€‚

é€šè¿‡å¿«ç…§æµ‹è¯•ï¼Œæ‰€æœ‰è¿™äº›éƒ½å¯ä»¥ç®€å•åœ°å®Œæˆ:

```
const allEmployees = getEmployees()
const happyEmployees = giveIncrementByPosition(allEmployees)

expect(happyEmployees).toMatchSnapshot() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ— è®ºä½•æ—¶å‡ºç°å›å½’ï¼Œæ‚¨éƒ½ä¼šç¡®åˆ‡åœ°çŸ¥é“èŠ‚ç‚¹ä¸­çš„å“ªæ£µæ ‘ä¸å¿«ç…§ä¸åŒ¹é…ã€‚

ç°åœ¨ï¼Œè¿™ç§ä¾¿åˆ©æ˜¯æœ‰ä»£ä»·çš„:å®ƒæ›´å®¹æ˜“å‡ºé”™ã€‚æ‚¨å¯èƒ½ä¸çŸ¥é“å¿«ç…§å®é™…ä¸Šæ˜¯é”™è¯¯çš„ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯ä¼šæäº¤å®ƒã€‚å› æ­¤ï¼Œä»”ç»†æ£€æŸ¥æ‚¨çš„å¿«ç…§ï¼Œå°±å¥½åƒå®ƒæ˜¯æ‚¨è‡ªå·±çš„æ–­è¨€ä»£ç ä¸€æ ·(å› ä¸ºå®ƒå°±æ˜¯)ã€‚

å½“ç„¶ï¼Œå¿«ç…§æµ‹è¯•è¿˜æœ‰æ›´å¤šçš„å†…å®¹ã€‚æŸ¥çœ‹å®Œæ•´çš„[æ–‡æ¡£](https://jestjs.io/docs/en/snapshot-testing)ã€‚

### [](#4-raw-describeeach-endraw-and-raw-testeach-endraw-)#4ã€‚`describe.each`å’Œ`test.each`

æ‚¨æ˜¯å¦ç¼–å†™è¿‡ç±»ä¼¼çš„æµ‹è¯•ï¼Ÿ

```
describe('When I am a supervisor', () => {
  test('I should have a supervisor badge', () => {
    const employee = new Employee({ level: 'supervisor' })

    expect(employee.badges).toContain('badge-supervisor')
  })

  test('I should have a supervisor level', () => {
    const employee = new Employee({ level: 'supervisor' })

    expect(employee.level).toBe('supervisor')
  })
})

describe('When I am a manager', () => {
  test('I should have a manager badge', () => {
    const employee = new Employee({ level: 'manager' })

    expect(employee.badges).toContain('badge-manager')
  })

  test('I should have a manager level', () => {
    const employee = new Employee({ level: 'manager' })

    expect(employee.level).toBe('manager')
  })
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ˜¯åˆ»æ„é‡å¤ï¼Œå¯¹ä¸å¯¹ï¼Ÿæƒ³è±¡ç”¨æ›´å¤šçš„æ¡ˆä¾‹æ¥åšã€‚

ä½¿ç”¨`describe.each`å’Œ`test.each`ï¼Œæ‚¨å¯ä»¥å°†ä»£ç å‹ç¼©å¦‚ä¸‹:

```
const levels = [['manager'], ['supervisor']]
const privileges = [['badges', 'toContain', 'badge-'], ['level', 'toBe', '']]

describe.each(levels)('When I am a %s', (level) => {
  test.each(privileges)(`I should have a ${level} %s`, (kind, assert, prefix) => {
    const employee = new Employee({ level })

    expect(employee[kind])[assert](`${prefix}${level}`)
  })
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶è€Œï¼Œæˆ‘è¿˜æ²¡æœ‰åœ¨æˆ‘è‡ªå·±çš„æµ‹è¯•ä¸­å®é™…ä½¿ç”¨å®ƒï¼Œå› ä¸ºæˆ‘æ›´å–œæ¬¢æˆ‘çš„æµ‹è¯•æ˜¯å†—é•¿çš„ï¼Œä½†æ˜¯æˆ‘åªæ˜¯è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„æŠ€å·§ã€‚

æŸ¥çœ‹[æ–‡æ¡£](https://jestjs.io/docs/en/api#describeeachtable-name-fn-timeout)äº†è§£æ›´å¤šå…³äºå‚æ•°çš„ç»†èŠ‚(å‰§é€:è¡¨æ ¼è¯­æ³•çœŸçš„å¾ˆé…·)ã€‚

### [](#5-mocking-global-functions-once)#5ã€‚å˜²ç¬‘å…¨å±€å‡½æ•°ä¸€æ¬¡

åœ¨æŸäº›æ—¶å€™ï¼Œä½ å¿…é¡»æµ‹è¯•ä¸€äº›ä¾èµ–äºç‰¹å®šæµ‹è¯•ç”¨ä¾‹ä¸Šçš„å…¨å±€å‡½æ•°çš„ä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ Javascript å¯¹è±¡`Date`è·å–å½“å‰æ—¥æœŸä¿¡æ¯çš„å‡½æ•°ï¼Œæˆ–è€…ä¾èµ–äºå®ƒçš„åº“ã€‚æ£˜æ‰‹çš„éƒ¨åˆ†æ˜¯ï¼Œå¦‚æœå®ƒæ˜¯å…³äºå½“å‰æ—¥æœŸçš„ï¼Œæ‚¨æ°¸è¿œæ— æ³•å¾—åˆ°æ­£ç¡®çš„æ–­è¨€ã€‚

```
function foo () {
  return Date.now()
}

expect(foo()).toBe(Date.now())
// âŒ This would throw occasionally:
// expect(received).toBe(expected) // Object.is equality
// 
// Expected: 1558881400838
// Received: 1558881400837 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ€ç»ˆï¼Œæ‚¨å¿…é¡»è¦†ç›–`Date`å…¨å±€å¯¹è±¡ï¼Œä»¥ä¾¿å®ƒæ˜¯ä¸€è‡´çš„å’Œå¯æ§çš„:

```
function foo () {
  return Date.now()
}

Date.now = () => 1234567890123

expect(foo()).toBe(1234567890123) // âœ… 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶è€Œï¼Œè¿™è¢«è®¤ä¸ºæ˜¯ä¸€ç§ä¸å¥½çš„åšæ³•ï¼Œå› ä¸ºè¦†ç›–åœ¨æµ‹è¯•ä¹‹é—´æŒç»­å­˜åœ¨ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–ä¾èµ–äº`Date.now`çš„æµ‹è¯•ï¼Œä½ ä¸ä¼šæ³¨æ„åˆ°å®ƒï¼Œä½†æ˜¯å®ƒæ­£åœ¨æ³„æ¼ã€‚

```
test('First test', () => {
  function foo () {
    return Date.now()
  }

  Date.now = () => 1234567890123

  expect(foo()).toBe(1234567890123) // âœ…
})

test('Second test', () => {
  function foo () {
    return Date.now()
  }

  expect(foo()).not.toBe(1234567890123) // âŒ ???
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘æ›¾ç»ç”¨ä¸€ç§ä¸ä¼šæ³„éœ²çš„æ–¹å¼â€˜é»‘â€™è¿‡å®ƒ:

```
test('First test', () => {
  function foo () {
    return Date.now()
  }

  const oriDateNow = Date.now
  Date.now = () => 1234567890123

  expect(foo()).toBe(1234567890123) // âœ…
  Date.now = oriDateNow
})

test('Second test', () => {
  function foo () {
    return Date.now()
  }

  expect(foo()).not.toBe(1234567890123) // âœ… as expected
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶è€Œï¼Œæœ‰ä¸€ç§æ›´å¥½ã€æ›´ç®€å•çš„æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹:

```
test('First test', () => {
  function foo () {
    return Date.now()
  }

  jest.spyOn(Date, 'now').mockImplementationOnce(() => 1234567890123)

  expect(foo()).toBe(1234567890123) // âœ…
})

test('Second test', () => {
  function foo () {
    return Date.now()
  }

  expect(foo()).not.toBe(1234567890123) // âœ… as expected
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ€»ä¹‹ï¼Œ`jest.spyOn`ç›‘è§†å…¨å±€`Date`å¯¹è±¡å¹¶æ¨¡ä»¿`now`å‡½æ•°çš„å®ç°ï¼Œåªä¸ºäº†ä¸€æ¬¡è°ƒç”¨ã€‚è¿™åè¿‡æ¥ä¼šä½¿`Date.now`åœ¨å‰©ä½™çš„æµ‹è¯•ä¸­ä¿æŒä¸å˜ã€‚

å…³äºå¼€ç©ç¬‘çš„è¯é¢˜ï¼Œè‚¯å®šæœ‰æ›´å¤šçš„å†…å®¹ã€‚è¯·åŠ¡å¿…æŸ¥çœ‹å®Œæ•´çš„[æ–‡æ¡£](https://jestjs.io/docs/en/mock-functions)äº†è§£æ›´å¤šè¯¦æƒ…ã€‚

* * *

è¿™ç¯‡æ–‡ç« è¶Šæ¥è¶Šé•¿ï¼Œæˆ‘æƒ³å°±å†™åˆ°è¿™é‡Œå§ã€‚è¿™äº›ä»…ä»…æ˜¯ Jest åŠŸèƒ½çš„çš®æ¯›ï¼Œæˆ‘åªæ˜¯å¼ºè°ƒäº†æˆ‘çš„æœ€çˆ±ã€‚å¦‚æœä½ æœ‰å…¶ä»–æœ‰è¶£çš„äº‹å®ï¼Œä¹Ÿè®©æˆ‘çŸ¥é“ã€‚

æ­¤å¤–ï¼Œå¦‚æœä½ ç»å¸¸ä½¿ç”¨ Jestï¼Œè¯·æŸ¥çœ‹ä¸€ä¸‹ [Majestic](https://github.com/Raathigesh/majestic) ï¼Œè¿™æ˜¯ Jest çš„ä¸€ä¸ªé›¶é…ç½® GUIï¼Œæ˜¯ä»æ¯ç‡¥çš„ç»ˆç«¯è¾“å‡ºä¸­é€ƒç¦»çš„ä¸€ä¸ªå¥½æ–¹æ³•ã€‚æˆ‘ä¸ç¡®å®šä½œè€…æ˜¯å¦åœ¨ dev.to ä¸­ï¼Œä½†æ˜¯å¯¹ç€é‚£ä¸ªäººå¤§å£°å–Šå‡ºæ¥ã€‚

ä¸€å¦‚æ—¢å¾€ï¼Œæ„Ÿè°¢æ‚¨é˜…è¯»æˆ‘çš„å¸–å­ï¼

* * *

å°é¢å›¾ç‰‡æ¥è‡ª[https://jestjs.io/](https://jestjs.io/)