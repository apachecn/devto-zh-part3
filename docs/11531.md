# å¸¦æœ‰ F#çš„ Azure å‡½æ•°

> åŸæ–‡:[https://dev.to/azure/azure-functions-with-f-2l3c](https://dev.to/azure/azure-functions-with-f-2l3c)

æˆ‘å¼€å§‹ç€æ‰‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ [Azure Functions v2](https://docs.microsoft.com/en-us/azure/azure-functions/?WT.mc_id=devto-blog-aapowell) ä½œä¸ºä¸€ä¸ªç®€å•çš„ API åç«¯ã€‚

Azure å‡½æ•°æ”¯æŒè®¸å¤šä¸åŒçš„è¯­è¨€ï¼Œå¦‚ [Java](https://azure.microsoft.com/en-us/blog/announcing-the-general-availability-of-java-support-in-azure-functions/?WT.mc_id=devto-blog-aapowell) ã€ [Python(åœ¨ç¼–å†™æ—¶é¢„è§ˆ)](https://docs.microsoft.com/en-us/azure/azure-functions/functions-create-first-function-python?WT.mc_id=devto-blog-aapowell)ã€ [TypeScript(å½“ç„¶è¿˜æœ‰ JavaScript)](https://azure.microsoft.com/en-us/blog/improving-the-typescript-support-in-azure-functions/?WT.mc_id=devto-blog-aapowell) ï¼Œå½“ç„¶è¿˜æœ‰ C#ã€‚é‚£ä¹ˆæœ‰è¿™ä¹ˆå¤šé€‰æ‹©ï¼Œæˆ‘æƒ³é€‰æ‹©ä»€ä¹ˆå‘¢ï¼Ÿ

å—¯ï¼Œæˆ‘è‡ªç„¶å†³å®šç”¨ F#ï¼Œå®ƒçš„*æœ‰ç‚¹åƒ v1 ä¸­çš„*ã€‚æ¯•ç«Ÿï¼Œå®ƒæ˜¯ä¸€ç§ CLR è¯­è¨€ï¼Œæ‰€ä»¥æ²¡æœ‰ç†ç”±ä¸åƒ C#é‚£æ ·åœ¨ v2 ä¸­å·¥ä½œã€‚

ä½†ä¸å¹¸çš„æ˜¯ï¼Œæ²¡æœ‰å¯ç”¨çš„æ¨¡æ¿ï¼Œæ‰€ä»¥å¼€å§‹ä¼¼ä¹æœ‰ç‚¹æ£˜æ‰‹ã€‚

## [](#creating-an-f-functions-application)åˆ›å»º F#å‡½æ•°åº”ç”¨ç¨‹åº

è¦åˆ›å»ºä¸€ä¸ª F#å‡½æ•°åº”ç”¨ç¨‹åºï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯æŒ‰ç…§ [Visual Studio ä»£ç æŒ‡ä»¤](https://docs.microsoft.com/en-us/azure/azure-functions/functions-create-first-function-vs-code?WT.mc_id=devto-blog-aapowell)å®‰è£…æ‰©å±•ã€‚

ä¸€æ—¦ VS ä»£ç å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„[æ–°åŠŸèƒ½é¡¹ç›®](https://docs.microsoft.com/en-us/azure/azure-functions/functions-create-first-function-vs-code?WT.mc_id=devto-blog-aapowell#create-an-azure-functions-project)é€‰æ‹© C#ä½œä¸ºè¯­è¨€ã€‚

ç°åœ¨åˆ°äº†æ£˜æ‰‹çš„éƒ¨åˆ†ï¼Œå°†æ‚¨çš„`csproj`æ–‡ä»¶é‡å‘½åä¸º`fsproj`ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªå¯¹`FSharp.Core`çš„å¼•ç”¨ã€‚

ä½ å°±å¤§åŠŸå‘Šæˆäº†ï¼

å¥½å§ï¼Œå…¶å®ä¹Ÿæ²¡é‚£ä¹ˆéš¾ï¼Œå¯¹å§ï¼å› ä¸ºå®ƒéƒ½åœ¨ CLR ä¸Šï¼Œè€Œä¸”æ˜¯ä¸€ä¸ª. NET æ ¸å¿ƒåº”ç”¨ç¨‹åºï¼Œ`dotnet` cli å·¥å…·å°†ä¼šå·¥ä½œï¼æ‚¨ç”šè‡³å¯ä»¥ä» F#å‡½æ•°çš„ VS ä»£ç ä¸­è·å¾—è°ƒè¯•æ”¯æŒã€‚

ç°åœ¨ä½ å·²ç»å‡†å¤‡å¥½ç”¨ F#åˆ›å»ºä¸€ä¸ªå‡½æ•°äº†ï¼

ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ HTTP è§¦å‘å™¨:

```
module HttpTrigger

open Microsoft.Azure.WebJobs
open Microsoft.AspNetCore.Mvc
open Microsoft.Azure.WebJobs.Extensions.Http
open Microsoft.AspNetCore.Http
open System.IO
open System.Text

[<FunctionName("HttpTrigger")>]
let httpTriggerFunction ([<HttpTrigger(AuthorizationLevel.Function, "post", Route = null)>] req : HttpRequest) =
    async {
        use reader = new StreamReader(req.Body, Encoding.UTF8)
        let! body = reader.ReadToEndAsync() |> Async.AwaitTask
        return OkObjectResult body
    } |> Async.StartAsTask 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯·æ³¨æ„ï¼Œå¦‚æœä½ ç”¨`async`åšä»»ä½•äº‹æƒ…ï¼Œä½ éœ€è¦å°†å®ƒè½¬æ¢æˆ`Task<'T>`æ¥è¿”å›ï¼Œå› ä¸ºå‡½æ•°ä¸»æœºæœŸæœ›çš„æ˜¯å¼‚æ­¥çš„ C#ä»»åŠ¡ APIï¼Œè€Œä¸æ˜¯ F#çš„å¼‚æ­¥å·¥ä½œæµğŸ˜¦ã€‚

## [](#caveats)æ³¨æ„äº‹é¡¹

è¿™é‡Œæœ‰ä¸€ä¸ªå°è­¦å‘Šï¼Œå› ä¸º VS ä»£ç æ‰©å±•ä¸ç†è§£ F#ä½ ä¸èƒ½ç”¨å®ƒæ¥ç»™ä½ çš„é¡¹ç›®æ·»åŠ æ–°å‡½æ•°ï¼Œä½ å¿…é¡»æ‰‹åŠ¨å®Œæˆï¼Œç„¶åä½ å¿…é¡»çŸ¥é“ä½ éœ€è¦çš„ NuGet åŒ…æ˜¯ä»€ä¹ˆã€‚æˆ‘å‘ç°ï¼Œå¦‚æœæˆ‘éœ€è¦æŸ¥æ‰¾ç±»å‹åŠå…¶åŒ…ï¼Œåªéœ€æ‰“å¼€å¦ä¸€ä¸ª VS ä»£ç çª—å£å¹¶åˆ›å»ºä¸€ä¸ª C#çª—å£å°±è¶³å¤Ÿç®€å•äº†ã€‚

æ‚¨è¿˜ä¼šå‘ç°`.vscode/settings.json`æ–‡ä»¶åŒ…å«`"azureFunctions.projectLanguage": "C#"`ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æŠŠå®ƒæ”¹æˆ`F#`ï¼Œä½†æ˜¯å®ƒä¼šç»™ä½ ä¸€ä¸ªè­¦å‘Šï¼Œå› ä¸ºæ‰©å±•ä¸ç†è§£å®ƒã€‚æˆ‘æŠŠå®ƒä¿ç•™ä¸º C#ï¼Œå› ä¸ºå®ƒä¸ä¼šå›°æ‰°æˆ‘ã€‚

## [](#conclusion)ç»“è®º

è™½ç„¶å·¥å…·å¯èƒ½ä¸å­˜åœ¨ï¼Œä½†ç”¨ F#åˆ›å»º Azure å‡½æ•°çœŸçš„æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ã€‚