# Uri ç»„åˆä¹‹è°œ

> åŸæ–‡:[https://dev . to/joaofbantunes/the-uri-composition-mystery-2mjl](https://dev.to/joaofbantunes/the-uri-composition-mystery-2mjl)

## [T1ã€‘ç®€ä»‹](#intro)

è¿™å°†æ˜¯å…¶ä¸­ä¸€ä¸ªä»¤äººç¾æ„§çš„å¸–å­ï¼Œæˆ‘ä¼šç”¨å®ƒæ¥ç¡®ä¿ä¸‹æ¬¡æˆ‘é‡åˆ°åŒæ ·çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä¸ä¼šæµªè´¹æ—¶é—´å»è§£å†³å®ƒğŸ˜›ã€‚

## [](#so-whats-the-problem)é‚£ä¹ˆï¼Œæœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ

æ‰€ä»¥æˆ‘ä½¿ç”¨äº†ä¸€ä¸ª`HttpClient`ï¼Œä¸ºè¯·æ±‚ä¼ é€’äº†ä¸€ä¸ª`Uri`ã€‚ä¸ºäº†æ„é€ `Uri`ï¼Œä½¿ç”¨äº†å¾—åˆ°ä¸¤ä¸ª`Uri`çš„æ„é€ å‡½æ•°ï¼Œç¬¬ä¸€ä¸ª`Uri`ä»£è¡¨åŸºå€ï¼Œæ‰€ä»¥æ˜¯ç»å¯¹çš„`Uri`ï¼Œè€Œç¬¬äºŒä¸ªåº”è¯¥æ˜¯ç›¸å¯¹åœ°å€ã€‚

è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼ŒæŸ¥çœ‹ä¸‹é¢çš„ä»£ç ï¼Œæ‚¨å¸Œæœ›å°†ä»€ä¹ˆå†…å®¹å†™å…¥æ§åˆ¶å°ï¼Ÿ

```
var baseUri = new Uri("https://api.dev/v3");
var routeUri = new Uri("stuff", UriKind.Relative);
var fullUri = new Uri(baseUri, routeUri);

Console.WriteLine(fullUri); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘çš„æœŸæœ›æ˜¯`https://api.dev/v3/stuff`ï¼Œä½†æ˜¯ï¼Œå”‰ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬å¾—åˆ°çš„ï¼è¾“å‡ºæ˜¯`https://api.dev/stuff`ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰åœ¨åŸºå€åé¢åŠ ä¸€ä¸ª`/`ã€‚å¦‚æœåŸºå€ä»¥`/`ç»“å°¾ï¼Œé‚£ä¹ˆç»„åˆå°†æŒ‰é¢„æœŸå·¥ä½œã€‚

ä½†æ˜¯ç­‰ç­‰ï¼è¿˜æœ‰æ›´å¤š...

å³ä½¿åŸºå€ä¸­æœ‰æ–œæ ï¼Œå¦‚æœç›¸å¯¹åœ°å€ä»¥æ–œæ å¼€å¤´ï¼Œå®ƒä¹Ÿå°†æ›¿æ¢åŸºå€çš„ç›¸å¯¹éƒ¨åˆ†ã€‚

æ‰€ä»¥ï¼Œä¸‹é¢çš„ä»£ç :

```
var baseUri = new Uri("https://api.dev/v3/");
var routeUri = new Uri("/stuff", UriKind.Relative);
var fullUri = new Uri(baseUri, routeUri);

Console.WriteLine(fullUri); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¹Ÿä¼šè¾“å‡º`https://api.dev/stuff`ã€‚

## [](#adding-insult-to-injury)â€œé›ªä¸ŠåŠ éœœâ€

æ¯”æˆ‘åœ¨è¿™ä¸Šé¢æµªè´¹çš„æ—¶é—´æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™ç§è¡Œä¸ºåœ¨[æ–‡æ¡£](https://docs.microsoft.com/en-us/dotnet/api/system.uri.-ctor?view=netcore-2.2#System_Uri__ctor_System_Uri_System_Uri_)ä¸­æœ‰æè¿°ã€‚

> è¯„è®º
> 
> æ­¤æ„é€ å‡½æ•°é€šè¿‡ç»„åˆç»å¯¹ Uri å®ä¾‹ baseUri å’Œç›¸å¯¹ Uri å®ä¾‹ relative Uri æ¥åˆ›å»ºæ–°çš„ Uri å®ä¾‹ã€‚å¦‚æœ relativeUri æ˜¯ä¸€ä¸ªç»å¯¹ Uri å®ä¾‹(åŒ…å«ä¸€ä¸ªæ–¹æ¡ˆã€ä¸»æœºåå’Œä¸€ä¸ªå¯é€‰çš„ç«¯å£å·)ï¼Œåˆ™åªä½¿ç”¨ relativeUri åˆ›å»º Uri å®ä¾‹ã€‚
> 
> å¦‚æœ baseUri æœ‰ç›¸å¯¹éƒ¨åˆ†(æ¯”å¦‚/api)ï¼Œé‚£ä¹ˆå¦‚æœ baseUri çš„ç›¸å¯¹éƒ¨åˆ†è¦ä¿ç•™åœ¨æ„é€ çš„ Uri ä¸­ï¼Œé‚£ä¹ˆç›¸å¯¹éƒ¨åˆ†å¿…é¡»ä»¥æ–œæ (æ¯”å¦‚/api/)ç»“æŸã€‚
> 
> æ­¤å¤–ï¼Œå¦‚æœ relativeUri ä»¥æ–œæ å¼€å¤´ï¼Œé‚£ä¹ˆå®ƒå°†æ›¿æ¢ baseUri çš„ä»»ä½•ç›¸å¯¹éƒ¨åˆ†
> 
> æ­¤æ„é€ å‡½æ•°ä¸ç¡®ä¿ Uri å¼•ç”¨å¯è®¿é—®çš„èµ„æºã€‚

è¿™ç§è¡Œä¸ºå¯¹æˆ‘æ¥è¯´å¤ªå¥‡æ€ªäº†(å°½ç®¡å¯èƒ½æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç†ç”±)ï¼Œæˆ‘æ²¡æœ‰è€ƒè™‘æŸ¥çœ‹æ–‡æ¡£ï¼Œè€Œæ˜¯ç»§ç»­æœç´¢ä»£ç ï¼Œå¯»æ‰¾å…¶ä»–åŸå› ã€‚

## [](#outro)å…¶ä»–

æ€»ç»“ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç¡®ä¿`Uri`ç»„åˆè¿è¡Œè‰¯å¥½ï¼Œæˆ‘ä»¬åº”è¯¥ç”¨ä¸€ä¸ª`/`ç»“æŸåŸºå€ï¼Œå¹¶ä¸”ç”¨ä¸€ä¸ª**è€Œä¸æ˜¯**å¼€å§‹ç›¸å…³éƒ¨åˆ†ã€‚

```
var baseUri = new Uri("https://api.dev/v3/");
var routeUri = new Uri("stuff", UriKind.Relative);
var fullUri = new Uri(baseUri, routeUri);

Console.WriteLine(fullUri);
// outputs -> https://api.dev/v3/stuff 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¸Œæœ›ä¸‹æ¬¡æˆ‘èƒ½è®°ä½è¿™ä¸€ç‚¹ï¼ğŸ™ƒ