# ç”¨ git é‡ç½®å’Œé‡ç½®ğŸ§¶è§£å†³æ£˜æ‰‹çš„æƒ…å†µ

> åŸæ–‡:[https://dev . to/Alec cool 213/resolving-tricky-situations-with-git-reset-and-rebase-1529](https://dev.to/aleccool213/resolving-tricky-situations-with-git-reset-and-rebase-1529)

> æƒ³è¦æ›´å¤šè¿™æ ·çš„ç²¾å½©å†…å®¹ï¼Ÿè®¿é—®: [https://blog.alec.coffee](//alec.coffee)

æ‚¨åº”è¯¥å…³å¿ƒæ‚¨çš„ Git å†å²æœ‰å¤šå¹²å‡€ã€‚å®ƒæä¾›äº†ä¸€ç§ä¸å…¶ä»–å¼€å‘äººå‘˜äº¤æµä»£ç åº“å˜æ›´çš„æ–¹å¼ï¼Œä½†æ˜¯è¿™æ ·åšéœ€è¦ä¸€äº›æ€è€ƒå’Œæ„å›¾ã€‚è§è¿‡è¿™ä¹ˆå¹²å‡€çš„å—ï¼Ÿ

[![A clean Git history](../Images/5402748a07d707ac11cb79c72c9eaac6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--k0eF9-Sz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://res.cloudinary.com/dscgr6mcw/image/upload/v1557317705/git-post/1.png)

å¤§æ¦‚ä¸ä¼šã€‚ä¸ºä»€ä¹ˆï¼Ÿå¼€å‘äººå‘˜ç»å¸¸å¤ªæ‡’(æœ‰å……åˆ†çš„ç†ç”±),åœ¨ä¼˜å…ˆçº§æ–¹é¢æŠŠ Git organization æ”¾åœ¨`nice-to-haves`å’Œ`TODO`æ—è¾¹ã€‚å€ŸåŠ©`git reset`å’Œ`git rebase`çš„åŠ›é‡ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºæ‹¥æœ‰ä¸€ä¸ªå¹²å‡€æ˜“è¯»çš„å†å²æ˜¯å¿«é€Ÿè€Œå®¹æ˜“çš„ï¼

è®©æˆ‘ä»¬é¦–å…ˆå‘æ‚¨ä»‹ç»ä¸€äº› Git æŠ€å·§ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°å°†å®ƒä»¬é›†æˆåˆ°æ‚¨çš„å·¥ä½œæµç¨‹ä¸­ã€‚è¿™äº›æŠ€å·§ä¸ä»…å¯ä»¥å¸®åŠ©æ‚¨ç†è§£ä½¿ç”¨ CLI æ—¶çš„ Gitï¼Œè¿˜å¯ä»¥å¸®åŠ©æ‚¨ç†è§£ GUI å®¢æˆ·ç«¯ã€‚è¿™äº›ä¸»é¢˜æˆ‘ä»æœªåœ¨ Git æ•™ç¨‹ä¸­çœ‹åˆ°è¿‡ï¼Œä¹Ÿæ˜¯æˆ‘è‡ªå·±æˆ–ä»åˆ«äººé‚£é‡Œäº†è§£åˆ°çš„ğŸ»å’ŒåŒäº‹ä¸€èµ·ã€‚

## WIP å·¥ä½œæµ

ä½ ç»å¸¸ä¼šå‘ç°è‡ªå·±å¤„äºè¿™ç§æƒ…å†µ:

[![](../Images/7164d17e8f6609d7c2bb7898c5462a5f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--nzNU4fAR--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://res.cloudinary.com/dscgr6mcw/image/upload/v1557317705/git-post/2.gif)

æ‚¨åˆšåˆšå¼€å§‹å¤„ç†ä¸€ä¸ªæ–°çš„åˆ†æ”¯ï¼Œé‡æ„äº†ä¸€æ®µä»£ç ï¼Œå®‰è£…äº†ä¸€ä¸ªåŒ…ï¼Œå¹¶ç¼–å†™äº†è¯¥åŠŸèƒ½æ‰€éœ€ä»£ç çš„ä¸€åŠã€‚

ä¸‹åˆ 6 ç‚¹å·¦å³ï¼Œä½ æ‰¿è¯ºä¸€åˆ‡æ¥ä¿å­˜ä½ çš„è¿›å±•ã€‚

[![](../Images/a8a72232aabd5b55e8e5da040f13572a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--PkofX1ij--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://res.cloudinary.com/dscgr6mcw/image/upload/v1557317705/git-post/3.gif)

å½“ä½ å›åˆ°è¿™ä¸ªé¡¹ç›®æ—¶ï¼Œä½ æ„è¯†åˆ°ï¼Œâ€œå“¦ï¼Œä¸ï¼å°†å®ƒæ”¾å…¥å•ç‹¬çš„æäº¤ä¸­ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ï¼â€ã€‚å¥½å§ï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¸è¿™ä¹ˆæƒ³ï¼Œä½†æ˜¯ï¼Œå—¯ï¼Œä½ å¯èƒ½å’Œæˆ‘ä¸€æ ·æ‡’ã€‚

```
 git reset HEAD~1 
```

ä½ çš„æœ‹å‹åœ¨è¿™é‡Œå—ï¼Ÿè¿™å°†åœ¨æ‚¨çš„`wip`æäº¤ä¹‹å‰é‡ç½®æ‚¨çš„å½“å‰å¤´ï¼Œä½†æ˜¯æ‚¨çš„å·¥ä½œæ ‘(æ‚¨çš„æ‰€æœ‰æ–‡ä»¶æ›´æ”¹)å°†è¢«ä¿ç•™ä»¥ç»§ç»­ç¼–è¾‘ã€‚

[![](../Images/926dfa3afa4be71f521df321d0f4689f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--BW4ijRKg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://res.cloudinary.com/dscgr6mcw/image/upload/v1557317705/git-post/4.gif)

> è¿™æ˜¯è¿™ä¸ªä¼Ÿå¤§å¸ä»¤éƒ¨çš„ä¼—å¤šèƒ½åŠ›ä¹‹ä¸€ã€‚æˆ‘å»ºè®®ä½ å¤šç ”ç©¶ä¸€ä¸‹è¿™ä¸ªã€‚

å‰å®³ï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹å•ç‹¬æäº¤ä¸€äº›ä¸œè¥¿æ¥åšä¸€äº›ä¸é”™çš„æäº¤äº†ï¼

[![](../Images/1c7528bbd47722c0cf8705ec9823391e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--NptgfIrZ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://res.cloudinary.com/dscgr6mcw/image/upload/v1557317705/git-post/5.gif)

æˆ‘ä»¬çš„æäº¤ç°åœ¨æ›´æœ‰æ„ä¹‰äº†ï¼è®©æˆ‘ä»¬æ‰”ä¸€ä¸ªğŸ”§å˜æˆä¸œè¥¿ã€‚

## [](#rewriting-history-the-right-way)æ”¹å†™å†å²...æ­£ç¡®çš„æ–¹å¼

ä½ å·²ç»åœ¨ä¸€ä¸ªåˆ†æ”¯ä¸Šå·¥ä½œäº†ä¸€æ®µæ—¶é—´ï¼Œä½ æ‰€æœ‰çš„æäº¤éƒ½å¾ˆå¥½å¹¶ä¸”å¾ˆæœ‰æ¡ç†ï¼Œä½†æ˜¯æœ‰äººè¯„è®ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œä»£ç é€€å›äº†ä¸¤æ¬¡æäº¤ğŸ˜±

æ‚¨åœ¨æ–‡ä»¶ä¸­çŠ¯äº†ä¸€ä¸ªå°é”™è¯¯ï¼Œéœ€è¦å¿«é€Ÿæ›´æ”¹ã€‚

[![opening-a-file-for-a-change](../Images/11d7fb81ef30a52afd5b5630f40b4162.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--4CpiWtYr--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://res.cloudinary.com/dscgr6mcw/image/upload/v1557317705/git-post/6.gif)

è¿™ç§å˜åŒ–åœ¨æŠ€æœ¯ä¸Šä¸ä¸€ä¸ªæ—§çš„æäº¤ç›¸å…³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åŠæ—¶è¿”å›å¹¶åœ¨é‚£é‡Œæ’å…¥å®ƒå‘¢ï¼Ÿ

```
 git stash; git rebase -i HEAD~insert_commit_history_depth 
```

è¿™å°†ä¿å­˜æˆ‘ä»¬çš„å•è¡Œæ›´æ”¹ä¾›ä»¥åä½¿ç”¨ï¼Œå¹¶å°†æˆ‘ä»¬å¸¦åˆ°äº¤äº’å¼ rebase å±å¹•ã€‚è®©æˆ‘ä»¬ç»§ç»­ç¼–è¾‘æˆ‘ä»¬æƒ³è¦å°†æ›´æ”¹å¼•å…¥æäº¤ã€‚

[![](../Images/46501664e66b4cff80c9a7cacc19902b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Zpo0Eq2E--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://res.cloudinary.com/dscgr6mcw/image/upload/v1557317705/git-post/7.gif)

æ—¢ç„¶æˆ‘ä»¬æ­£åœ¨ç¼–è¾‘æ—§çš„æäº¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„æ›´æ”¹å¸¦å›æ¥ã€‚

```
 git stash pop; git add .; git rebase --continue 
```

è¿™å°†æŠŠæˆ‘ä»¬ä¹‹å‰è—åœ¨ git ç´¢å¼•ä¸­çš„æ›´æ”¹ï¼Œæ·»åŠ åˆ°æˆ‘ä»¬æƒ³è¦ç¼–è¾‘çš„ commit ä¸­ï¼Œç„¶åç»§ç»­ã€‚

å°±æ˜¯è¿™æ ·ï¼è¦æ›´å¿«åœ°åšåˆ°è¿™ä¸€ç‚¹ï¼Œæœ‰ä¸€ä»¶äº‹æ˜¯å°†è¿™äº›å‘½ä»¤ä¸²åˆ«ååŒ–ä¸ºå¿«æ·æ–¹å¼ã€‚

### [](#shoutout-to-some-kickarse-tools)å¯¹ä¸€äº›ç‰›é€¼å·¥å…·å¤§å–Šå¤§å«

ä¸¤ä¸ª Git å·¥å…·çš„ S/Oï¼Œå®ƒä»¬æœ€è¿‘åˆ‡å…¥äº†æˆ‘çš„å·¥ä½œæµï¼Œå› ä¸ºå®ƒä»¬éå¸¸å®ç”¨å’Œæ¼‚äº®:

*   Gitup æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœ€å°åŒ–çš„å·¥å…·ï¼Œå®ƒä¸ä¼šå°è¯•åšå¤ªå¤šçš„äº‹æƒ…ã€‚å®ƒçš„åˆ†æ”¯è§†å›¾ï¼Œå­˜å‚¨æŸ¥çœ‹å™¨å’Œé›†æˆæ˜¯äº†ä¸èµ·çš„ã€‚Git CLI ç”¨æˆ·çš„ç»ä½³å¼€æºä¼´ä¾£ã€‚
*   gitmoji-cli ä½¿å¾—å¯è§†åŒ–åœ°ç»„ç»‡æäº¤å˜å¾—éå¸¸å®¹æ˜“ã€‚å®ƒä¸ä»…é€šè¿‡å¼ºè¿«ä½ åˆ†ç±»æ¥ç»„ç»‡ä½ çš„æäº¤ï¼Œè€Œä¸”è¿˜æœ‰è¡¨æƒ…ç¬¦å·ï¼ğŸ’¸

> å–œæ¬¢è¿™ä¸ªå¸–å­ï¼Ÿè€ƒè™‘ç»™æˆ‘ä¹°ä¸€æ¯å’–å•¡æ¥æ”¯æŒæˆ‘å†™æ›´å¤šçš„ä¸œè¥¿ã€‚
> 
> æƒ³æ”¶åˆ°æœ‰æ–°å¸–å­çš„å­£åº¦é‚®ä»¶å—ï¼Ÿ[æ³¨å†Œæˆ‘çš„ç®€è®¯](https://mailchi.mp/f91826b80eb3/alecbrunelleemailsignup)