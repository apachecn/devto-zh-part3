# æé«˜æ‚¨çš„ Ruby Skillz:ç¼–å†™ç´§å‡‘ä»£ç 

> åŸæ–‡:[https://dev . to/Molly/level-up-your-ruby-skillz-writing-compact-code-438k](https://dev.to/molly/level-up-your-ruby-skillz-writing-compact-code-438k)

æˆ‘ä»¬éƒ½æœ‰è¿‡è¿™æ ·çš„ç»å†ï¼Œæˆ‘ä»¬å‘å‡ºä¸€ä¸ªæˆ‘ä»¬è§‰å¾—è¶…çº§ç´§å‡‘å’Œä»¤äººæ•¬ç•çš„æ‹‰åŠ¨è¯·æ±‚(PR)ã€‚å®ƒè¢«ç›–äº†â€œæ‰¹å‡†â€çš„ç« ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬çš„ä»£ç å®é™…ä¸Šæ²¡æœ‰æˆ‘ä»¬æƒ³è±¡çš„é‚£ä¹ˆä¸¥å¯†ã€‚æˆ‘ä»¬å…¬å¼€äº†æˆ‘ä»¬çš„å…¬å…±å…³ç³»ï¼Œå¬å–äº†ä¸€å †éå¸¸å¥½çš„å»ºè®®ï¼Œå‘Šè¯‰æˆ‘ä»¬å¦‚ä½•æ›´ä¸¥æ ¼åœ°æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ã€‚

è¿™åœ¨ä½ åˆšå¼€å§‹çš„æ—¶å€™æ˜¯å¾ˆå¸¸è§çš„ï¼Œäº‹å®ä¸Šè¿™ä¹Ÿæ˜¯æˆ‘å­¦ä¹ è¿™äº›æŠ€å·§çš„åŸå› ã€‚æ„Ÿè°¢è®¸å¤šä¼˜ç§€çš„é«˜çº§å¼€å‘äººå‘˜ä»ä¸€å¼€å§‹å°±é˜…è¯»å¹¶è¯„è®ºæˆ‘çš„ä»£ç ï¼Œæˆ‘å·²ç»å­¦ä¼šäº†å¦‚ä½•ç¼–å†™éå¸¸ç®€æ´çš„ä»£ç ã€‚ä½†æˆ‘ä¼šè®©ä½ çŸ¥é“ä¸€ä¸ªç§˜å¯†ï¼Œå®ƒæ°¸è¿œä¸ä¼šç»“æŸã€‚æˆ‘å·²ç»è¿™æ ·åšäº† 7 å¹´ï¼Œæˆ‘ä»ç„¶èƒ½å¾—åˆ°å…³äºå¦‚ä½•å†™æ›´å¥½çš„ä»£ç çš„å»ºè®®ã€‚

ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„æ–¹æ³•ï¼Œä½ å¯ä»¥ç”¨ä¸€äº›[è¯­æ³•ç³–](https://en.wikipedia.org/wiki/Syntactic_sugar)æ¥å¼ºåŒ–åŸºæœ¬çš„ Ruby é€»è¾‘ã€‚è¯­æ³•ç³–æ˜¯ç¼–ç¨‹è¯­è¨€(å¦‚ Ruby)ä¸­çš„è¯­æ³•ï¼Œæ—¨åœ¨ä½¿å†…å®¹æ›´å®¹æ˜“é˜…è¯»æˆ–è¡¨è¾¾ã€‚

*   [å¸ƒå°”/æ¡ä»¶](#booleans)
*   [å˜é‡èµ‹å€¼](#assignment)
*   [ä¿æŠ¤æ¡æ¬¾](#guard_clause)
*   [è°ƒç”¨æ–¹æ³•](#calling_methods)
*   [å®‰å…¨å¯¼èˆªä»ª](#safety_navigator)
*   [æ•£åˆ—å’Œæ•°ç»„](#hashes_arrays)

# [](#booleansconditionals)å¸ƒå°”/æ¡ä»¶å¥

### [](#ternary-operator)ä¸‰å…ƒè¿ç®—ç¬¦

ä¸ºäº†è®¾ç½®å˜é‡ï¼Œè®©æˆ‘ä»¬ä»ä¸€äº›åŸºæœ¬çš„å¸ƒå°”é€»è¾‘å¼€å§‹ã€‚å¦‚æœ`y`æ˜¯å¶æ•°ï¼Œæˆ‘ä»¬å¸Œæœ›è®¾ç½®`x`ç­‰äº 1ï¼Œå¦‚æœ`y`æ˜¯å¥‡æ•°ï¼Œæˆ‘ä»¬å¸Œæœ›è®¾ç½®`x`ç­‰äº 2ã€‚è¿™æ˜¯æˆ‘ä»¬åœ¨å¯åŠ¨ Ruby æ—¶è¢«æ•™å¯¼çš„æ–¹æ³•ã€‚

```
if y.even?
  x = 1
else
  x = 2
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šé¢ç»™å‡ºäº†ä¸¤ä¸ªèµ‹å€¼è¯­å¥ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬å¿…é¡»æ”¹å˜å˜é‡ xï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä¸¤ä¸ªåœ°æ–¹æ”¹å˜ï¼Œè¿™æ˜¯ä¸ç†æƒ³çš„ã€‚ç®€åŒ–ä»£ç çš„ä¸€ç§æ–¹æ³•æ˜¯è¿™æ ·åš:

```
x = if y.even?
  1
else 
  2
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæˆ‘ä»¬åªåšä¸€æ¬¡`x`èµ‹å€¼ï¼Œè¿™ç¨å¾®ç®€å•ä¸€ç‚¹ã€‚ä½†å³ä½¿æœ‰äº†ä»¥ä¸Šå†…å®¹ï¼Œæˆ‘ä»¬ä¹Ÿè¦å ç”¨ 5 è¡Œæ¥å®Œæˆã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æŠŠå®ƒç®€åŒ–åˆ°ä¸€è¡Œã€‚

```
x = y.even? ? 1 : 2 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`?`è¢«ç§°ä¸º[ä¸‰å…ƒè¿ç®—ç¬¦](https://www.w3resource.com/ruby/ruby-ternary-operator.php)ã€‚ä¸‰å…ƒè¿ç®—ç¬¦é€»è¾‘ä½¿ç”¨â€œ(æ¡ä»¶)ï¼Ÿ(çœŸè¿”å›å€¼):(å‡è¿”å›å€¼)â€è¯­å¥æ¥ç¼©çŸ­ if/else ç»“æ„ã€‚å®ƒé¦–å…ˆè®¡ç®—ä¸€ä¸ªè¡¨è¾¾å¼çš„çœŸå€¼æˆ–å‡å€¼ï¼Œç„¶åæ ¹æ®è®¡ç®—ç»“æœæ‰§è¡Œä¸¤ä¸ªç»™å®šè¯­å¥ä¸­çš„ä¸€ä¸ªã€‚è¯­æ³•å¦‚ä¸‹:

```
test-expression ? if-true-expression : if-false-expression 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å¯¹äºåŠ å¼ºé€»è¾‘è¯­å¥éå¸¸æœ‰ç”¨ã€‚

### [](#inline-booleansconditionals)å†…è”å¸ƒå°”/æ¡ä»¶

é™¤äº†å·§å¦™çš„ä¸‰å…ƒè¿ç®—ç¬¦ä¹‹å¤–ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦ä¸€ç§å°†å¸ƒå°”é€»è¾‘å‹ç¼©æˆä¸€è¡Œçš„æ–¹æ³•ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåŸºæœ¬çš„æ–¹æ³•å’Œä¸€äº›å¸ƒå°”é€»è¾‘ã€‚

```
def say_number_type(number)
  if number.even?
    puts "I am even!"
  end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†æ›´ç®€æ´ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™å¸ƒå°”å€¼:

```
def say_number_type(number)
  puts "I am even!" if number.even?
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åŒæ ·å¯ä»¥ç”¨`unless`
æ¥å®Œæˆ

```
def say_number_type(number)
  puts "I am even!" unless number.odd?
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ³¨æ„:ä½¿ç”¨å†…è”å¸ƒå°”æˆ–æ¡ä»¶æœ‰æ—¶è¢«ç§°ä¸ºä½¿ç”¨â€œä¿®é¥°è¯­è¯­æ³•â€ã€‚

# [](#variable-assignment)å˜é‡èµ‹å€¼

å‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬æƒ³æ ¹æ®å¦ä¸€ä¸ªå˜é‡æ˜¯å¦å­˜åœ¨æ¥ç»™å®ƒèµ‹å€¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¸‹é¢æœ‰å˜é‡`a`å’Œ`b`ã€‚å¦‚æœ`a`å­˜åœ¨(ä¸ä¸ºé›¶)ï¼Œæˆ‘ä»¬å¸Œæœ›è®¾ç½®`x`ç­‰äº`a`ã€‚å¦‚æœ`a`ä¸ºé›¶ï¼Œæˆ‘ä»¬å¸Œæœ›è®¾ç½®`x`ç­‰äº`b`ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·åšã€‚

```
if a.nil?
  x = b
else 
  x = a
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ–è€…ï¼Œæ ¹æ®æˆ‘ä»¬åœ¨ä¸Šé¢å­¦åˆ°çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥åš

```
x = a.nil? ? b : a 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶è€Œï¼Œåœ¨å¤„ç†å¯èƒ½çš„é›¶å€¼æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ç®¡é“æ“ä½œç¬¦ä½¿å…¶æ›´åŠ ç®€æ´ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
x = a || b 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœ`a`ä¸ä¸ºé›¶ï¼Œèµ‹å€¼è¯­å¥å°†æŠŠ`a`çš„å€¼èµ‹ç»™`x`ã€‚å¦‚æœ`a`ä¸ºé›¶ï¼Œå®ƒä¼šå°†`b`çš„å€¼èµ‹ç»™ xã€‚

```
irb(main)> a = 1
=> 1
irb(main)> b = 2
=> 2
irb(main)> x = a || b
=> 1

irb(main)> a = nil
=> nil
irb(main)> x = a || b
=> 2 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å¯ä»¥åœ¨ä¸¤ä¸ªå˜é‡ä¹‹é—´ä½¿ç”¨ç®¡é“è¿ç®—ç¬¦ï¼Œä¹Ÿå¯ä»¥åœ¨ç­‰å·ä¸¤è¾¹ä½¿ç”¨ã€‚å‡è®¾æˆ‘ä»¬æƒ³è®©`x`ç­‰äº`a`ï¼Œä½†å‰ææ˜¯`x`ä¸ºé›¶ã€‚å¦‚æœ`x`ä¸ä¸ºé›¶ï¼Œæˆ‘ä»¬å¸Œæœ›ä¿ç•™`x`çš„å€¼ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†åš:

```
x ||= a 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸‹é¢æ˜¯ä¸€ä¸ªæ§åˆ¶å°ç¤ºä¾‹ï¼Œå±•ç¤ºäº†è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„:

```
irb(main)> x = 1
=> 1
irb(main)> a = 2
=> 2
irb(main)> x ||= a
=> 1
irb(main)> x = nil
=> nil
irb(main)> x ||= a
=> 2 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ˜¯å‘Šè¯‰ rubyï¼Œåªæœ‰å½“`x`ä¸ºé›¶æ—¶ï¼Œæ‰å°†`a`çš„å€¼èµ‹ç»™`x`ã€‚å½“ä½ é¢„è®¡ä¼šæœ‰è¿çº¦ï¼Œä½†åˆä¸èƒ½æŒ‡æœ›å®ƒä¼šå‡ºç°æ—¶ï¼Œè¿™å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚å‡è®¾ä½ æœ‰ä¸‹é¢çš„æ–¹æ³•

```
def add_one(number)
  number + 1
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœ`number`ä¸ºé›¶ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬è¯•å›¾ç»™å®ƒåŠ  1 æ—¶ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ª`NoMethodError`ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™æ ·åšæ¥é¿å…äº§ç”Ÿé”™è¯¯

```
def add_one(number)
  number ||= 0
  number + 1
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`number ||= 0`å°†ç¡®ä¿å¦‚æœæ²¡æœ‰å®šä¹‰`number`,æˆ‘ä»¬çš„æ–¹æ³•ä¸ä¼šäº§ç”Ÿé”™è¯¯ï¼Œå› ä¸ºå®ƒå°†è¢«è®¾ç½®ä¸º 0ã€‚å¦‚æœä½ æƒ³æ›´è¿›ä¸€æ­¥ï¼Œä½ å¯ä»¥æŠŠèµ‹å€¼æ“ä½œç¬¦å’Œå‚æ•°æ”¾åœ¨ä¸€èµ·ï¼ğŸ¤¯

```
def add_one(number = 0)
  number + 1
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå¦‚æœä½ ä¸ç»™å®ƒä¼ é€’ä¸€ä¸ªæ•°å­—ï¼Œruby ä¼šæŠŠæ•°å­—è®¾ç½®ä¸º 0ã€‚

```
irb(main)>  add_one
=> 1
irb(main)>  add_one(1)
=> 2 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#guard-clause)å®ˆå«æ¡æ¬¾

å¦‚æœæ»¡è¶³æŸäº›æ¡ä»¶ï¼Œé‚£ä¹ˆ[ä¿æŠ¤æ¡æ¬¾](https://medium.com/the-code-review/en-garde-how-you-can-refactor-nested-ifs-with-guard-clauses-in-ruby-1ff728b7a0cd)å°±æ˜¯æå‰é€€å‡ºä¸€ä¸ªæ–¹æ³•ã€‚ä¿æŠ¤å­å¥å¯ä»¥å¸®åŠ©æ‚¨ç²¾ç®€æ–¹æ³•é€»è¾‘å¹¶ç¼–å†™æ›´ä¼˜åŒ–çš„ä»£ç ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼Œçœ‹çœ‹æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°å®ƒã€‚æ¯”æ–¹è¯´ä½ æœ‰ä¸‹é¢çš„æ–¹æ³•`tester`

```
def tester(arg)
  if arg == 1
    # logic
  else
   'error'
  end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„å‚æ•°`arg`ä¸ç­‰äº 1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†è¿”å›ä¸€ä¸ªè¡¨ç¤ºâ€œé”™è¯¯â€çš„å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„ guard å­å¥æ¥ç®€åŒ–è¿™ä¸ª`tester`æ–¹æ³•ã€‚

```
def tester(arg)
 return 'error' unless arg == 1 # Guard Clause
 # logic
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“æˆ‘ä»¬å¼€å§‹æˆ‘ä»¬çš„æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬ç«‹å³æ£€æŸ¥`arg`çš„å€¼æ˜¯å¦ç­‰äº 1ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œæˆ‘ä»¬ç«‹å³è¿”å›ã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æƒ³è¦åšä»€ä¹ˆï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨æ–¹æ³•ä¸­åˆ°å¤„æ‘¸ç´¢ã€‚è¿™åœ¨ä¼˜åŒ–ä»£ç æ—¶å°¤å…¶æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œç•™æ„è¿™æ ·çš„æƒ…å†µ:

```
def tester(arg)
  user = User.find(123)
  event = Event.find(123)

  if arg == 1
    # logic
  else
    'error'
  end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç”šè‡³åœ¨åˆ°è¾¾ if/else å¸ƒå°”ä¹‹å‰å°±åœ¨æ”¶é›†æ•°æ®å’Œæ‰§è¡Œé€»è¾‘ã€‚æœ€åï¼Œå¦‚æœ`arg`ä¸ç­‰äº 1ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªæ˜¯æµªè´¹äº†å¤§é‡çš„æ—¶é—´å’Œèµ„æºæ¥æ”¶é›†æˆ‘ä»¬ä¸éœ€è¦çš„æ•°æ®ã€‚é€šè¿‡åœ¨æ–¹æ³•çš„ç¬¬ä¸€è¡Œæ£€æŸ¥æ‚¨çš„æ¡ä»¶ï¼Œguard å­å¥å¯ä»¥ç¡®ä¿è¿™äº›èµ„æºä¸ä¼šè¢«æµªè´¹ã€‚

æˆ‘æƒ³è¡¥å……çš„å¦ä¸€ä¸ªå°ç»†èŠ‚æ˜¯ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ä¸€ä¸ª guard å­å¥æ ¹æ®ä¸€ä¸ªæ¡ä»¶è¿”å› nilï¼Œä½ å¯ä»¥è¿™æ ·åš:

```
def tester(arg)
  return unless arg == 1
  # logic
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå•ç‹¬ä½¿ç”¨`return`å°±å¥½åƒä½ å†™äº†`return nil`ä¸€æ ·ã€‚

```
def tester(arg)
  # nil is unnecessary 
  return nil unless arg == 1
  # logic
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶è€Œï¼Œåœ¨ Ruby ä¸­ï¼Œè¿™ç§æƒ…å†µä¸‹ä¸éœ€è¦æ˜¾å¼å®šä¹‰ nilã€‚ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œ`return unless arg == 1`æ˜¯ä½ æƒ³å¦‚ä½•å†™å®ƒï¼Œä»¥åŠä½ å°†å¦‚ä½•çœ‹å¾…åˆ«äººå†™çš„å®ƒã€‚

# [](#calling-methods)è°ƒç”¨æ–¹æ³•

å‡è®¾æ‚¨æ­£åœ¨å¤„ç†ä¸€ç»„å“åº”æŸä¸ªæ–¹æ³•çš„å¯¹è±¡ï¼Œå¹¶ä¸”æ‚¨æƒ³è¦ä½¿ç”¨ç±»ä¼¼äº`map`çš„æ–¹æ³•æ¥æ”¶é›†è¯¥æ–¹æ³•çš„ç»“æœã€‚é€šå¸¸ï¼Œä½ ä¼šè¿™æ ·åš:

```
a = [1, 2, 3, 4]
string_list = a.map{|obj| obj.to_s}
# string_list = ["1", "2", "3", "4"] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç‚¹è¯­æ³•ç³–æ¥è¿›ä¸€æ­¥ç®€åŒ–è¿™ä¸€è¿‡ç¨‹ï¼Œä½†ä»ç„¶ä¼šå¾—åˆ°ç›¸åŒçš„ç»“æœã€‚

```
string_list = a.map(&:to_s)
# string_list = ["1", "2", "3", "4"] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬çš„å¯¹è±¡é›†(åœ¨æœ¬ä¾‹ä¸­æ˜¯æ•´æ•°)å“åº”çš„ä»»ä½•æ–¹æ³•éƒ½å¯ä»¥ä½¿ç”¨`&:method`è¯­æ³•åœ¨æ¯ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨ã€‚å¦‚æœä½ æƒ³äº†è§£ Ruby åˆ°åº•åœ¨åšä»€ä¹ˆï¼Œæˆ‘å»ºè®®ä½ è¯»ä¸€è¯»è¿™ç¯‡[åšå®¢æ–‡ç« ](https://www.brianstorti.com/understanding-ruby-idiom-map-with-symbol/)ã€‚

# [](#safety-navigator)å®‰å…¨å¯¼èˆªä»ª

ä½ ä»¬ä¸­æœ‰å¤šå°‘äººä»¥å‰å†™è¿‡è¿™æ ·çš„ä»£ç ï¼Ÿâœ‹æˆ‘å½“ç„¶æœ‰ï¼

```
def friends_name(user)
  return unless user.present?
  friend = user.friend
  if friend.present?
    friend.name
  end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œè¿›è¡Œäº†å¤§é‡çš„å­˜åœ¨æ£€æŸ¥ï¼Œåªæ˜¯ä¸ºäº†ç¡®ä¿æˆ‘ä»¬æ°¸è¿œä¸ä¼šåœ¨ä¸€ä¸ª nil å¯¹è±¡ä¸Šè°ƒç”¨ä¸€ä¸ªæ–¹æ³•å¹¶å¾—åˆ°å¯æ€•çš„`# NoMethodError`ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Ruby çš„å®‰å…¨å¯¼èˆªå™¨ï¼Œè€Œä¸æ˜¯åšæ‰€æœ‰è¿™äº›æ£€æŸ¥ï¼å¦‚æœåœ¨ä¸€ä¸ª nil å¯¹è±¡ä¸Šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œ[å®‰å…¨å¯¼èˆªå™¨](https://rubyinrails.com/2017/11/17/safe-navigation-operator-ampersand-dot-in-ruby/)å°†ç®€å•åœ°è¿”å› nilã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„æ–¹æ³•ç®€åŒ–ä¸º:

```
def friends_name(user)
  user&.friend&.name
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœè¯¥é“¾ä¸­çš„ä»»ä½•å¯¹è±¡ä¸¢å¤±ï¼Œæˆ‘ä»¬å°†ç®€å•åœ°è¿”å›é›¶ã€‚è¿™é‡Œæ˜¯å¦ä¸€ä¸ªç®€å•çš„æ§åˆ¶å°ç¤ºä¾‹ï¼Œå¸Œæœ›æœ‰åŠ©äºè¿›ä¸€æ­¥é˜æ˜å®‰å…¨å¯¼èˆªå™¨çš„å·¥ä½œåŸç†ã€‚

```
irb> [].last.to_s
=> ""
irb> [].last.even?
NoMethodError: undefined method `even?' for nil:NilClass
    from (irb):3
    from /usr/bin/irb:11:in `<main>'
irb> [].last&.even?
=> nil 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#hashes-and-arrays)æ•£åˆ—å’Œæ•°ç»„

### [](#brackets-vs-doend)æ‹¬å· vs do/end

åœ¨æˆ‘çš„[å“ˆå¸Œ](https://dev.to/molly_struve/level-up-your-ruby-skillz-working-with-hashes-4bid)å’Œ[æ•°ç»„](https://dev.to/molly_struve/level-up-your-ruby-skillz-working-with-arrays-hnn)æ•™ç¨‹ä¸­ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨å¤§é‡ do/end å—ç¬¦å·æ¥å¸®åŠ©å¼„æ¸…æ¥šå‘ç”Ÿäº†ä»€ä¹ˆé€»è¾‘ã€‚ç„¶è€Œï¼Œæ‹¬å·ç¬¦å·æ˜¯ç¼–å†™æ›´ç´§å‡‘ä»£ç çš„å¥½æ–¹æ³•ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨æ•™ç¨‹ä¸­çœ‹åˆ°çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªé“¾æ¥ä¸€å †é€»è¾‘çš„å¥½æ–¹æ³•ã€‚

```
result = [1, 2, 3, 4].map{|n| n + 2}.select{|n| n.even?}.reject{|n| n == 6} 
# result = [4] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ä½ å¯èƒ½ä¼šæƒ³ï¼Œæ—¢ç„¶æœ‰è¿™ä¹ˆå¤šé€‰æ‹©ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“è¯¥ç”¨ä»€ä¹ˆå‘¢ï¼Ÿï¼é€šå¸¸ï¼Œä¸€ä¸ªå¥½çš„ç»éªŒæ³•åˆ™æ˜¯:

*   å¦‚æœä¸€è¡Œä»£ç æ­£åœ¨å—ä¸­æ‰§è¡Œï¼Œé‚£ä¹ˆä½¿ç”¨æ‹¬å·ã€‚
*   å¦‚æœä½ çš„é€»è¾‘ä¸æ­¢ä¸€è¡Œï¼Œä½¿ç”¨ do/end ç¬¦å·ã€‚

å•çº¿æ‹¬å·ç¤ºä¾‹:

```
a = [1, 2, 3]
a.map{|number| number + 10} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¤šè¡Œ do/end ç¤ºä¾‹:

```
a = [1, 2, 3]
a.map do |number|
  if number.even?
    puts "I am even"
    number/2
  else
    puts "I am odd"
    number
  end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯·è®°ä½ï¼Œæœ‰äº›åœ°æ–¹æˆ–äººå¯èƒ½æœ‰ä¸åŒçš„é£æ ¼ã€‚å½“ä½ åœ¨ä¸€ä¸ªæ–°çš„åœ°æ–¹å¼€å§‹æ—¶ï¼Œè¦æ—¶åˆ»æ³¨æ„åˆ«äººåœ¨åšä»€ä¹ˆã€‚å½“ä½ å¼€å§‹çš„æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šæƒ³è·Ÿéšä»–ä»¬çš„é¢†å¯¼ã€‚éšç€ä½ è·å¾—æ›´å¤šçš„ç»éªŒï¼Œä½ ä¼šå½¢æˆè‡ªå·±çš„é£æ ¼å’Œä¹ æƒ¯ã€‚

### [](#chaining)é“¾æ¥

å¾ˆå¿«æˆ‘æƒ³å›åˆ°æˆ‘ä¸Šé¢ä½¿ç”¨çš„é“¾æ¥ç¤ºä¾‹:

```
result = [1, 2, 3, 4].map{|n| n + 2}.select{|n| n.even?}.reject{|n| n == 6} 
# result = [4] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ®µä»£ç éå¸¸ç®€å•ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°†æ¯ä¸€æ­¥é“¾æ¥èµ·æ¥æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå¯ä»¥ä½¿å®ƒæ›´åŠ ç®€æ´ã€‚ç„¶è€Œï¼Œå¦‚æœæ¯ä¸€æ­¥çš„é€»è¾‘éƒ½å¾ˆå¤æ‚ï¼Œæœ‰æ—¶ä½ å¯èƒ½ä¼šä¸ºäº†å¯è¯»æ€§è€ŒæŠŠå®ƒä»¬åˆ†å¼€ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼Œè¯´æ˜äº†å¦‚ä½•å°†å®ƒæ‹†åˆ†ä»¥æé«˜å¯è¯»æ€§ã€‚

```
plus_two_array = [1, 2, 3, 4].map{|n| n + 2}
even_numbers_array = plus_two_array.select{|n| n.even?}
remove_the_sixes_array = even_numbers_array.reject{|n| n == 6} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¯ä¸ªæ­¥éª¤åŠå…¶ç»“æœéƒ½æœ‰æ˜ç¡®çš„å®šä¹‰ï¼Œè¿™ä½¿å¾—æ›´å¤æ‚çš„é€»è¾‘æ›´å®¹æ˜“ç†è§£ã€‚æˆ‘ä¹‹æ‰€ä»¥è¦æŒ‡å‡ºè¿™ä¸€ç‚¹ï¼Œæ˜¯å› ä¸ºæœ‰æ—¶å€™ç¼–å†™æœ€ç´§å‡‘çš„ä»£ç å¹¶ä¸é€‚åˆæŸç§æƒ…å†µã€‚æ‰€æœ‰è¿™äº›ç­–ç•¥éƒ½å¾ˆæ£’ï¼Œä½†æ˜¯è¦çŸ¥é“æœ‰æ—¶å€™ä½ å¯èƒ½ä¼šä¸ºäº†å¯è¯»æ€§è€Œç‰ºç‰²ç´§å‡‘çš„ä»£ç ã€‚

# [](#but-wait-theres-more)ä½†æ˜¯ç­‰ç­‰ï¼Œè¿˜æœ‰ï¼

[![](../Images/c2463a7841b6c1c64cc13dd929fa51d5.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--FCdbP5ya--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ydyqwc602h0ydzuoc9s9.gif)

æ˜¾ç„¶ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è®©ä½ å†™å‡ºæ›´ç®€æ´ç´§å‡‘çš„ä»£ç ã€‚è¿™åªæ˜¯ä¸€ä¸ªå¾ˆå°çš„åˆ—è¡¨ï¼Œä½†æˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚å¦‚æœä½ å‘ç°äº†å…¶ä»–æœ‰åŠ©äºä½ æ”¹è¿›ä»£ç çš„æŠ€å·§ï¼Œè¯·åœ¨è¯„è®ºä¸­æå‡ºæ¥ã€‚ä¸€å¦‚æ—¢å¾€ï¼Œå¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–ä»»ä½•éœ€è¦æ¾„æ¸…çš„äº‹æƒ…ï¼Œè¯·ä¸è¦çŠ¹è±«åœ°é—®ï¼

å¦‚æœä½ æƒ³å¿«é€Ÿå‚è€ƒè¿™äº›æ–¹æ³•ï¼Œæˆ‘åšäº†ä¸€ä¸ª[æ–¹ä¾¿çš„å¤‡å¿˜å•](https://paper.dropbox.com/doc/Tricks-For-Writing-Compact-Ruby-Code--AeAl8FR15SMDlf_JW9BrymB1AQ-IAfGvmx5cKZ6s38UM4Rrl)ï¼Œé‡Œé¢æœ‰æ¯ä¸ªä¾‹å­çš„ä»£ç ã€‚