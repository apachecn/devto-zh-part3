# è§’åº¦æ–¹å‘

> åŸæ–‡:[https://dev.to/gugadev/angular-directives-3n2n](https://dev.to/gugadev/angular-directives-3n2n)

ç­–ç•¥æ˜¯æ›´æ”¹ç»„ä»¶å¤–è§‚æˆ–è¡Œä¸ºçš„å±æ€§ã€‚æƒ³è±¡ä¸€ä¸‹å®ƒå°±åƒä¸€ä¸ª CSS/JS ä»£ç â€œæ³¨å…¥å™¨â€ã€‚æŒ‡ä»¤æ˜¯ä¸€ä¸ªè£…é¥°ç”¨â€œ`@Directive`â€è£…é¥°çš„ç±»ï¼Œè£…é¥°è€…æ¥å—å¯¹è±¡ã€‚åœ¨å¯¹è±¡çš„å±æ€§ä¸­ï¼Œæˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ªç§°ä¸ºâ€œ`selector`â€çš„ escencialï¼Œé€šè¿‡å®ƒï¼Œæˆ‘ä»¬å‘æ‚¨æä¾›äº†è¦æ³¨å…¥åˆ°å…¶ä»–ç»„ä»¶ä¸­çš„å±æ€§çš„åç§°ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒçœ‹èµ·æ¥æ€ä¹ˆæ ·:

```
import { Directive } from '@angular/core'

@Directive({
  selector: '[myAwesomeAttribute]'
})
export class MyAwesomeDirective {

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œé‚£å°±åœ¨æ„ä»¶çš„æ¨¡æ¿ä¸­:

```
<div myAwesomeAttribute></div> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½†æ˜¯ï¼ŒæŒ‡ä»¤æœ¬èº«å¹¶ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚è¦ä¿®æ”¹å›¾å…ƒçš„å¤–è§‚æˆ–è¡Œä¸ºï¼Œå¿…é¡»ä½¿ç”¨æŸäº›å·¥å…·-ä»€ä¹ˆ

### [](#cambiando-la-apariencia)æ”¹å˜å¤–è²Œ

è‹¥è¦å°† CSS ç±»æ³¨å…¥å…ƒç´ ä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ‰§è¡Œæ­¤æ“ä½œ:

*   ä¹Œæ¡‘å¤š`ElementRef`
*   ä¹Œæ¡‘å¤š`@HostBinding`

**ElementRef**

å…è®¸æˆ‘ä»¬è®¿é—®ç­–ç•¥çš„æœ¬åœ°(ä¸»æœº)å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸»æœºæ˜¯`div`å…ƒç´ ï¼Œæˆ‘ä»¬å°†ä» DOM ä¸­è·å–è¯¥å…ƒç´ ã€‚è¿™æ ·åšçš„æ–¹å¼å¦‚ä¸‹:

```
constructor(ref: ElementRef) {
  const el = ref.nativeElement as HTMLElement
  el.classList.add('my-awesome-class')
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šé¢çš„ä»£ç å‘Šè¯‰è§’å„¿:â€œå˜¿ï¼Œæˆ‘è¦ä½ æŠŠæˆ‘æ³¨å…¥æ„é€ å‡½æ•°ä¸­ï¼Œå¼•ç”¨è¿™ä¸ªæŒ‡ä»¤å£æ¸´ä¹‹å¤„çš„å…ƒç´ ã€‚â€ã€‚å®Œæˆæ­¤æ“ä½œåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å±æ€§`nativeElement`è®¿é—® DOM å…ƒç´ ã€‚ä»è¿™é‡Œå¼€å§‹ï¼Œè¦çœ‹ä½ æƒ³å¯¹ä»–åšä»€ä¹ˆäº†ã€‚

**ä¸»æœºç»‘å®š**

é€šè¿‡è¿™ç§è£…é¥°ï¼Œæˆ‘ä»¬å¯ä»¥â€œç»‘å®šâ€ä¸»æœºä¸Šçš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å‘Šè¯‰ä½ è¦æ³¨å…¥å“ªäº› css ç±»è€Œæ— éœ€ä½¿ç”¨ feo `ElementRef`ã€‚è¿™æ˜¯é€šè¿‡å°†ç›®æ ‡å…ƒç´ çš„å±æ€§/å±æ€§åç§°ä½œä¸ºè£…é¥°å±æ€§æ¥å®Œæˆçš„ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸Šé¢çš„ç¤ºä¾‹å¦‚ä½•ä½¿ç”¨æ­¤æ–¹æ³•ã€‚

```
// Lo hacemos directamente como propiedad
@HostBinding('class') elementClass = 'my-awesome-class' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è€Œè¿™è¶³ä»¥æŠŠâ€˜t0â€™è¯¾æ³¨å…¥å…ƒç´ ä¸­ã€‚

### [](#cambiando-el-comportamiento)æ”¹å˜è¡Œä¸º

æˆ‘ä»¬çœ‹åˆ°äº†`@HostBinding`å¦‚ä½•è®©æˆ‘ä»¬æ”¹å˜å¤–è²Œã€‚è¿˜æœ‰å¦ä¸€ä½åä¸º`@HostListener`çš„è£…é¥°å®¶ï¼Œä½¿æˆ‘ä»¬å¾—ä»¥**å€¾å¬**å…ƒç´ çš„äº‹ä»¶ï¼Œå¹¶æ‰©å±•å…¶åŠŸèƒ½ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªä¾‹å­:

```
import { Directive, HostListener } from '@angular/core'

@Directive({
  selector: '[myAwesomeAttribute]'
})
export class MyAwesomeDirective {
  @HostListener('click')
  onElementClick() {
    // hacer algo
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬æˆåŠŸåœ°æ‰©å±•äº†ç›®æ ‡å…ƒç´ çš„åŠŸèƒ½ã€‚ç®€å•å—ï¼Ÿ

## [](#estableciendo-valores)è®¾ç½®å€¼

ç­–ç•¥è¿˜å…è®¸æˆ‘ä»¬ä»ä¸»æœºè®¾ç½®å€¼ã€‚è¿™æ˜¯é€šè¿‡ä¸ç»„ä»¶ç›¸åŒçš„æ–¹å¼å®ç°çš„:é€šè¿‡è£…é¥°å™¨`@Input`ã€‚

```
// como propiedad
@Input() property: string 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬ä¼šè¿™æ ·ä½¿ç”¨å®ƒ:

```
<div myAwesomeDirective="hi"></div> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

* * *

## [](#ejemplo)ä¾‹

è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ï¼ŒåŒ…æ‹¬æˆ‘ä»¬æ‰€çœ‹åˆ°çš„æŒ‡ä»¤çš„ä¸‰ä¸ªç‰¹å¾:`@HostListener`ã€`@HostListener`å’Œ`@Input`ã€‚

```
@Directive({
  selector: '[appMemoButton]'
})
export class MemoButtonDirective {
  @Input('appMemoButton') key: string
  @HostBinding('class') elementClass = 'btn btn--memo'

  @HostListener('click')
  public onClick() {
    const counter = parseInt(localStorage.getItem(this.key), 10)
    localStorage.setItem(this.key, counter + 1)
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
<button appMemoButton="registerButtonClicks">Register</button> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä»¥ä¸Šä¾‹å­ç›¸å½“ç®€å•ã€‚ä¸€èˆ¬çš„æƒ³æ³•æ˜¯åœ¨æµè§ˆå™¨ä¸­ä¿å­˜å•å‡»æŒ‰é’®çš„æ¬¡æ•°ã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å‡å®šæ¯ä¸ªæŒ‰é’®éƒ½å°†è‡ªå·±çš„ id ä¼ é€’åˆ°ç­–ç•¥ä¸­ä»¥è¿›è¡Œä¿å­˜ï¼Œå¹¶ä¸”ä¸ä¼šä¸å…¶ä»–æŒ‰é’®æ··æ·†ã€‚

```
@Input('appMemoButton') key: string 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸‹é¢æ˜¯æ·»åŠ æˆ‘ä»¬ä»¥å‰å®šä¹‰çš„ CSS ç±»ã€‚

```
@HostBinding('class') elementClass = 'btn btn--memo' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ€åï¼Œå½“æ‚¨æŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬ä¼šæˆªå–äº‹ä»¶ï¼Œä»¥æ–°å¢ä¸€ä¸ªå•ä½åˆ°æŒ‰é’®çš„ç‚¹å‡»è®¡æ•°ä¸­ã€‚

```
@HostListener('click')
public onClick() {
  const counter = parseInt(localStorage.getItem(this.key), 10)
  localStorage.setItem(this.key, counter + 1)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

* * *

## ç»“è®º

å‡†åˆ™å¯èƒ½éå¸¸æœ‰ç”¨ï¼›ç”¨é€”å¤šç§å¤šæ ·ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥æ·»åŠ ä¸»é¢˜ã€æ‰©å±•äº‹ä»¶ç­‰ã€‚ä¾‹å¦‚ï¼ŒUI å¥—ä»¶æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„ç”¨æ³•ï¼Œå®ƒé€šè¿‡ç­–ç•¥å®šä¹‰æŒ‰é’®ç±»å‹ã€æ–‡æœ¬æ¡†ã€ä¸‹æ‹‰åˆ—è¡¨ç­‰ã€‚ä½ ç»™ä»–çš„ç”¨æ³•ä¸€å¦‚æ—¢å¾€åœ°å–å†³äºä½ ã€‚ğŸ˜‰