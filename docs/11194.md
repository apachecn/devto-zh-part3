# å¯è®¿é—®æ€§ä¼˜å…ˆ:ä¸‹æ‹‰åˆ—è¡¨(é€‰æ‹©)

> åŸæ–‡:[https://dev . to/link 2t wenty/accessibility-first-drop down-select-3ji 5](https://dev.to/link2twenty/accessibility-first-dropdown-select-3ji5)

æœ‰ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä¸€ç›´åœ¨æ€è€ƒå¦‚ä½•ä½¿ç”¨ä¸å¯å®šåˆ¶çš„`select`å…ƒç´ æ¥åˆ¶ä½œä¸€ä¸ªå¯è®¿é—®çš„ jQuery-esc é€‰æ‹©èœå•ã€‚å½“ç„¶ï¼Œå¦‚æœä½ å¯ä»¥ä¸éœ€è¦å®šåˆ¶`select`å°±å»åšï¼Œæœ¬åœ°äººæ€»æ˜¯èµ¢å®¶ã€‚

jQuery çš„å®ç°:
[![jQuery SelectMenu](../Images/58dd0d68e41f88356277f9802a0787a9.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--3dzrihOb--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/v0bohelkr2g9uxztxq7y.png)

æˆ‘æœ‰ä¸€ä¸ªå¾ˆå¥½çš„â€œæ¦‚å¿µè¯æ˜â€,å¹¶å†³å®šåœ¨ä¸€ç¯‡å¸–å­ä¸­å……å®å®ƒï¼Œä½†å°±åœ¨é‚£æ—¶ï¼Œ [@emmabostian](https://dev.to/emmabostian) å‘å¸ƒäº†å¥¹å…³äºç±»ä¼¼å†…å®¹çš„ç²¾å½©å¸–å­ã€‚å»ºè®®ä½ ä¹Ÿçœ‹çœ‹å¥¹çš„æ–‡ç« ï¼ŒçœŸçš„å¾ˆä¸é”™ã€‚

[![emmabostian](../Images/4aea9f7300e85fce3647ca9a5e10bd6e.png)](/emmabostian) [## åˆ›å»ºè‡ªå®šä¹‰çš„ã€å¯è®¿é—®çš„ä¸‹æ‹‰èœå•

### è‰¾ç›Â·åšæ–¯è…¾Â·âœ¨1919 å¹´ 2 æœˆ 28 æ—¥ 17 åˆ†é’Ÿé˜…è¯»

#html #a11y #javascript](/emmabostian/creating-a-custom-accessible-drop-down-3gmo)

è¿™æ˜¯æˆ‘çš„æˆå“ï¼Œä¸‹é¢æˆ‘å°†å›é¡¾ä¸€ä¸‹æˆ‘åšäº†ä»€ä¹ˆä»¥åŠä¸ºä»€ä¹ˆåš:

[https://jsfiddle.net/link2twenty/rj1q38ok//embedded/result//dark](https://jsfiddle.net/link2twenty/rj1q38ok//embedded/result//dark)

## [](#requirements)è¦æ±‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åŒæ—¶æ”¯æŒé”®ç›˜å’Œé¼ æ ‡ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬çœ‹çœ‹[è§„èŒƒ](https://www.w3.org/TR/wai-aria-practices/examples/listbox/listbox-collapsible.html)ï¼Œçœ‹çœ‹é¢„æœŸçš„è¡Œä¸ºæ˜¯ä»€ä¹ˆã€‚

### [](#keyboard)é”®ç›˜

*   **è¾“å…¥é”®**ï¼Œåˆ‡æ¢åˆ—è¡¨æ¡†çš„å¯è§æ€§
*   **é€€å‡ºé”®**ï¼Œéšè—åˆ—è¡¨æ¡†
*   **å‘ä¸‹ç®­å¤´**ï¼Œé€‰æ‹©åˆ—è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªé€‰é¡¹
*   **å‘ä¸Šç®­å¤´**ï¼Œé€‰æ‹©åˆ—è¡¨ä¸­çš„ä¸Šä¸€ä¸ªé€‰é¡¹
*   **Home é”®**ï¼Œé€‰æ‹©åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªé€‰é¡¹
*   **ç»“æŸé”®**ï¼Œé€‰æ‹©åˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªé€‰é¡¹

### [](#mouse)é¼ æ ‡

*   **ç‚¹å‡»è¾“å…¥**ï¼Œåˆ‡æ¢åˆ—è¡¨æ¡†å¯è§æ€§
*   **ç‚¹å‡»å…³é—­è¾“å…¥**ï¼Œéšè—åˆ—è¡¨æ¡†
*   **ç‚¹å‡»é€‰é¡¹**ï¼Œå°†é€‰é¡¹è®¾ç½®ä¸ºæ´»åŠ¨ï¼Œéšè—åˆ—è¡¨æ¡†

çœ‹ç€è§„æ ¼ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼Œä½†æˆ‘æ€»æ˜¯æ„¿æ„çº æ­£ã€‚

## [](#markup)Markup

ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº† [`<details>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/details) å…ƒç´ ï¼Œå®ƒå…·æœ‰æˆ‘æƒ³è¦å†…ç½®çš„æ˜¾ç¤ºå’Œéšè—åŠŸèƒ½ã€‚

æˆ‘è¿˜åœ¨ä¸€ä¸ªç»„ä¸­ä½¿ç”¨å•é€‰æŒ‰é’®æ¥å…è®¸æˆ‘å­˜å‚¨å“ªä¸ªå€¼æ˜¯æ­£ç¡®çš„ã€‚å¦‚æœä½ æƒ³è¦çš„è¯ï¼Œä½ å¯ä»¥ç®€å•åœ°æ·»åŠ `checked`åˆ°é»˜è®¤é€‰é¡¹ã€‚

```
<details id="example_select" class="select_container">
  <summary>--</summary>
  <div class="select">
    <label class="select__option">
      <input type="radio" name="example" value="slower">Slower
    </label>
    <label class="select__option">
      <input type="radio" name="example" value="slow">Slow
    </label>
    <label class="select__option">
      <input type="radio" name="example" value="medium">Medium
    </label>
    <label class="select__option">
      <input type="radio" name="example" value="fast">Fast
    </label>
    <label class="select__option">
      <input type="radio" name="example" value="faster">Faster
    </label>
  </div>
</details> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[https://jsfiddle.net/link2twenty/cdwhouk4//embedded/result,html//dark](https://jsfiddle.net/link2twenty/cdwhouk4//embedded/result,html//dark)

æ²¡æœ‰é£æ ¼ï¼Œä½ çœŸçš„å¯ä»¥çœ‹åˆ°è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬åªæœ‰ä¸€ä¸ªç®€å•çš„å•é€‰æŒ‰é’®åˆ—è¡¨ã€‚

## [](#styles)æ ·å¼

åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä¸ä¼šåœ¨è¿™é‡Œè¿›å…¥å¤ªå¤šçš„ç»†èŠ‚ï¼Œè¿™åªæ˜¯æˆ‘çš„åå¥½ã€‚ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°æˆ‘æŠŠå®ƒå¼„å¾—çœ‹èµ·æ¥åƒæ˜¯ jQuery è®¡æ•°å™¨çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯ä½ å¯ä»¥åšä½ æƒ³åšçš„ã€‚

```
details.select_container {
  display: inline-block;
  width: 200px;
  border: 1px solid #c5c5c5;
  border-radius: 3px;
  position: relative;
  color: #454545;
}

details.select_container[open] {
  border-radius: 3px 3px 0 0;
}

details.select_container summary::after {
  content: "\00203A";
  position: absolute;
  right: 12px;
  top: calc(50%);
  transform: translateY(-50%) rotate(90deg);
  pointer-events: none;
}

details.select_container[open] summary::after {
  content: "\002039";
}

details.select_container summary {
  cursor: pointer;
  padding: 6px 12px;
  background: #f6f6f6;
  list-style: none;
}

details.select_container summary::-webkit-details-marker {
  display: none;
}

details.select_container summary:hover {
  background: #ededed;
}

details.select_container .select {
  position: absolute;
  display: flex;
  flex-direction: column;
  border: 1px solid #c5c5c5;
  width: 100%;
  left: -1px;
  border-radius: 0 0 3px 3px;
  background: #fff;
}

details.select_container .select__option {
  cursor: pointer;
  padding: 6px 12px;
}

details.select_container .select:hover .select__option.active {
  background: #fff;
  color: #454545;
}

details.select_container .select__option.active,
details.select_container .select:hover .select__option.active:hover,
details.select_container .select__option:hover {
  background: #007fff;
  color: #fff;
}

details.select_container .select__option input {
  display: none;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[https://jsfiddle.net/link2twenty/mqkznt6o//embedded/result,css//dark](https://jsfiddle.net/link2twenty/mqkznt6o//embedded/result,css//dark)

æ€»ä¹‹ï¼Œèªæ˜çš„äº‹æƒ…éƒ½å‘ç”Ÿåœ¨ javascript ä¸Šã€‚

## [](#javascript)JavaScript

ä¸è¿‡å»çš„é¡¹ç›®ä¸åŒï¼Œæˆ‘ä½¿ç”¨ JS æ¥è®¾ç½®æ‰€æœ‰çš„ aria å±æ€§ï¼Œè¿™åªæ˜¯æ„å‘³ç€æ‚¨ä¸å¿…è®°å¾—è¿™æ ·åšï¼Œè¿™æ˜¯ä¸€ä¸ªèƒœåˆ©ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªç±»ï¼Œä¸æ˜¯å› ä¸ºä½ å¿…é¡»è¿™æ ·åšï¼Œè€Œæ˜¯å› ä¸ºæˆ‘å–œæ¬¢å®ƒä»¬ã€‚

æˆ‘ä¸ä¼šè®²å¤ªå¤šçš„ç»†èŠ‚ï¼Œä½ å¯ä»¥è‡ªå·±è¯»ä¸€è¯»ï¼Œå¦‚æœæœ‰ä»€ä¹ˆä¸æ˜ç™½çš„åœ°æ–¹ï¼Œå°½ç®¡é—®ï¼Œä½†æ˜¯æˆ‘ä¼šæåˆ°`this.mouseDown`å’Œå®ƒä¸ºä»€ä¹ˆå­˜åœ¨ã€‚

å½“é€‰æ‹©èœå•å¤±å»ç„¦ç‚¹æ—¶ï¼Œæˆ‘å†³å®šä½¿ç”¨`focusout`æ¥å…³é—­å®ƒï¼Œä½†æ˜¯å‘ç°æˆ‘çš„`click`äº‹ä»¶ä¸å†å·¥ä½œã€‚ç»è¿‡ä¸€ç‚¹æŒ–æ˜ï¼Œæˆ‘æ„è¯†åˆ°ç„¦ç‚¹åœ¨é¼ æ ‡æŒ‰ä¸‹æ—¶ä¸¢å¤±äº†ï¼Œä½†æ˜¯åœ¨é¼ æ ‡æŠ¬èµ·æ—¶ç‚¹å‡»è¢«æ¿€å‘äº†ã€‚ä¸ºäº†å¦å®šè¿™ä¸€ç‚¹ï¼Œæˆ‘ä¸å¾—ä¸å¬é¼ æ ‡æŒ‰ä¸‹æˆ‘çš„é€‰é¡¹ï¼Œå¹¶é˜²æ­¢`focusout`é€ æˆéº»çƒ¦ã€‚

```
class detailSelect {
  constructor(container) {
    this.container = document.querySelector(container);
    this.options = document.querySelectorAll(`${container} > .select > .select__option`);
    this.value = this.container.querySelector('summary').textContent;
    this.mouseDown = false;
    this._addEventListeners();
    this._setAria();
    this.updateValue();
  }

  // Private function to set event listeners
  _addEventListeners() {
    this.container.addEventListener('toggle', () => {
      if (this.container.open) return;
      this.updateValue();
    })

    this.container.addEventListener('focusout', e => {
      if (this.mouseDown) return;
      this.container.removeAttribute('open');
    })

    this.options.forEach(opt => {
      opt.addEventListener('mousedown', () => {
        this.mouseDown = true;
      })
      opt.addEventListener('mouseup', () => {
        this.mouseDown = false;
        this.container.removeAttribute('open');
      })
    })

    this.container.addEventListener('keyup', e => {
      const keycode = e.which;
      const current = [...this.options].indexOf(this.container.querySelector('.active'));
      switch (keycode) {
        case 27: // ESC
          this.container.removeAttribute('open');
          break;
        case 35: // END
          e.preventDefault();
          if (!this.container.open) this.container.setAttribute('open', '');
          this.setChecked(this.options[this.options.length - 1].querySelector('input'))
          break;
        case 36: // HOME
          e.preventDefault();
          if (!this.container.open) this.container.setAttribute('open', '');
          this.setChecked(this.options[0].querySelector('input'))
          break;
        case 38: // UP
          e.preventDefault();
          if (!this.container.open) this.container.setAttribute('open', '');
          this.setChecked(this.options[current > 0 ? current - 1 : 0].querySelector('input'));
          break;
        case 40: // DOWN
          e.preventDefault();
          if (!this.container.open) this.container.setAttribute('open', '');
          this.setChecked(this.options[current < this.options.length - 1 ? current + 1 : this.options.length - 1].querySelector('input'));
          break;
      }
    })
  }

  _setAria() {
    this.container.setAttribute('aria-haspopup', 'listbox');
    this.container.querySelector('.select').setAttribute('role', 'listbox');
    const summary = this.container.querySelector('summary');
    summary.setAttribute('aria-label', `unselected listbox`);
    summary.setAttribute('aria-live', `polite`);
    this.options.forEach(opt => {
      opt.setAttribute('role', 'option');
    });
  }

  updateValue(e) {
    const that = this.container.querySelector('input:checked');
    if (!that) return;
    this.setValue(that)
  }

  setChecked(that) {
    that.checked = true;
    this.setValue(that)
  }

  setValue(that) {
    if (this.value == that.value) return;

    const summary = this.container.querySelector('summary');
    const pos = [...this.options].indexOf(that.parentNode) + 1;
    summary.textContent = that.parentNode.textContent;
    summary.setAttribute('aria-label', `${that.value}, listbox ${pos} of ${this.options.length}`);
    this.value = that.value;

    this.options.forEach(opt => {
      opt.classList.remove('active');
      opt.setAttribute('aria-selected', 'false');
    })
    that.parentNode.classList.add('active');
    that.parentNode.setAttribute('aria-selected', 'true');

    this.container.dispatchEvent(new Event('change'));
  }
}

const details = new detailSelect('#example_select'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åæˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­

```
const details = new detailSelect('#example_select'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[https://jsfiddle.net/link2twenty/rj1q38ok//embedded/result,js//dark](https://jsfiddle.net/link2twenty/rj1q38ok//embedded/result,js//dark)

å¦‚æœæˆ‘èƒ½åšå¾—æ›´å¥½ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘çœŸçš„å¾ˆæƒ³å¬å¬ä½ çš„æ„è§ã€‚

## [](#fin)é³

è¿™æ˜¯æˆ‘ä»¬åœ¨`Accessibility first`ç³»åˆ—ä¸­çš„å¦ä¸€ç¯‡æ–‡ç« ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ï¼Œæ²¡æœ‰æ„šè ¢çš„é—®é¢˜ã€‚ä¸€å¦‚æ—¢å¾€ï¼Œè¯·éšæ„ä½¿ç”¨è¿™äº›æŠ€å·§ï¼Œå¦‚æœæˆ‘è¯´é”™äº†/åšé”™äº†ä»€ä¹ˆï¼Œè¯·éšæ—¶çº æ­£æˆ‘ã€‚

å†æ¬¡æ„Ÿè°¢ã€‚
â¤ğŸ¦„ğŸ¦„ğŸ§ â¤ğŸ¦„â¤â¤ğŸ¦„