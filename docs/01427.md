# æˆ‘åšäº†ä¸€ä¸ª Chrome æ‰©å±•ã€‚æ¾å¼›æ¸ é“åˆ†ç»„

> åŸæ–‡:[https://dev . to/yamada shy/slack-channels-grouping-I-made-a-chrome-extension-258 b](https://dev.to/yamadashy/slack-channels-grouping-i-made-a-chrome-extension-258b)

å¤ªå¤šçš„é¢‘é“è®©çœ¼ç›ç—›è‹¦ğŸ˜«æˆ‘åšäº†ä¸€ä¸ª Chrome æ‰©å±•ï¼Œå¾ˆå¥½åœ°å°†é¢‘é“åˆ†ç»„ã€‚

| ![](../Images/799f95306583e5d447a71c974aab1397.png) | ![](../Images/164dbefcc4976d2c28a95d5dda328c5e.png) |
| 

<center>åŸä»¶</center>

 | 

<center>åˆ†ç»„</center>

 |

åœ¨æ­¤å®‰è£…

*   Chrome: [Slack é¢‘é“åˆ†ç»„- Chrome ç½‘ç»œå•†åº—](https://chrome.google.com/webstore/detail/slack-channels-grouping/lcbnhfianneihfgkmfncnhpkpghedbkm?authuser=0)
*   Firefox: [Slack é¢‘é“åˆ†ç»„â€”â€”è·å¾—ä»¥ä¸‹æ‰©å±•ğŸ¦Šç«ç‹](https://addons.mozilla.org/firefox/addon/slack-channels-grouping/)

# [](#feature)ç‰¹å¾

å®ƒé€šè¿‡è¿å­—ç¬¦å’Œä¸‹åˆ’çº¿å°†é¢‘é“åˆ†ç»„ã€‚

*   åŠ¨ç‰©ç‹—
*   åŠ¨ç‰© _ çŒ«

å®ƒè§‚å¯Ÿ DOM æ›´æ–°ï¼Œå› æ­¤å®ƒæ”¯æŒé¢‘é“åˆ›å»ºå’Œé‡å‘½åã€‚
å¦‚æœé€‰é¡¹å¡æœªæ¿€æ´»ï¼ŒDOM è§‚å¯Ÿå…³é—­ã€‚

# [](#why)ä¸ºä»€ä¹ˆ

åœ¨æˆ‘çš„å›¢é˜Ÿä¸­ï¼Œæœ‰ä¸€æ¡è§„åˆ™æ˜¯åœ¨é¢‘é“åç§°ä¸­æ·»åŠ â€œå‰ç¼€-â€ã€‚éšç€é¢‘é“æ•°é‡çš„ä¸æ–­å¢åŠ ï¼Œå¾ˆéš¾åŒºåˆ†â€œèŠå¤©â€å’Œâ€œä¿±ä¹éƒ¨â€ğŸ¤”

æ‰€ä»¥æˆ‘æŠŠå®ƒåšå¾—å°½å¯èƒ½çš„è§†è§‰å‹å¥½ã€‚

# [](#about-development)å…³äºå‘å±•

æˆ‘å†™çš„æ˜¯ä»¥ä¸‹å‡ ä¸ªå…³é”®è¯ã€‚

*   web æ‰©å±•-å·¥å…·ç®±
    *   ç½‘ç»œåŒ…
    *   ä»¥æ‰“å­—æ‰“çš„æ–‡ä»¶
*   é¡µé¢å¯è§æ€§ API
*   requestIdleCallback

## web extension-å·¥å…·ç®±

webextension-toolbox æ˜¯ Chromeã€Firefox ç­‰çš„æ‰©å±•åˆ›å»ºå·¥å…·ã€‚
[web extension-å·¥å…·ç®±/web extension-å·¥å…·ç®±- GitHub](https://github.com/webextension-toolbox/webextension-toolbox)

ä½ å¯ä»¥è½»æ¾è¾“å‡º Chrome å’Œ Firefox æ‰©å±•ï¼Œè€Œä¸ç”¨è€ƒè™‘è·¨æµè§ˆå™¨æ”¯æŒã€‚

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆä¸€ä¸ªæ¨¡æ¿ï¼Œ

```
yarn global add yo generator-web-extension
yo web-extension 
```

å¼€å§‹å¼€å‘ï¼Œ

```
yarn dev chrome 
```

è¾“å‡º zipï¼Œ

```
yarn build chrome 
```

åªéœ€ä¸Šä¼ åˆ° [Chrome ç½‘ç»œå•†åº—ä»ªè¡¨æ¿](https://chrome.google.com/webstore/devconsole/)ã€‚

è¿™å¤ªå®¹æ˜“äº†ï¼

### [](#webpack)webpack

webextension-toolbox ç”¨ webpack æ„å»ºï¼Œä½†æ˜¯å³ä½¿ä½ ä»æœªæ¥è§¦è¿‡ webpack ä¹Ÿå¯ä»¥å¼€å‘ã€‚å¦‚æœä½ ç†Ÿæ‚‰ webpackï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰©å±•å®ƒã€‚

### [](#typescript)æ‰“å­—ç¨¿

æœ€è¿‘æˆ‘ä¸€ç›´åœ¨ç§¯æä½¿ç”¨ TypeScriptï¼Œæˆ‘ä¹Ÿä½¿ç”¨äº†å®ƒã€‚

å¦‚æœä½¿ç”¨ typescript å’Œ webextension-toolboxï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªæ–‡ä»¶`webextension-toolbox-config.js`æ¥è¦†ç›–é…ç½®ã€‚

```
module.exports = {
  webpack: (config, { dev, vendor }) => {
    config.resolve.extensions.push('.ts')
    config.module.rules.push({
      test: /\.ts$/,
      loader: 'ts-loader'
    })
    return config
  }
} 
```

å¦‚æœæ˜¯å¤§è§„æ¨¡çš„æ‰©å±•ï¼ŒTypeScript çš„å¥½å¤„æ˜¯å¾ˆå¤§çš„ã€‚

## [](#page-visibility-api)é¡µé¢å¯è§æ€§ API

è¿™ä¸ª API è§‚å¯Ÿé¡µé¢æ˜¯å¦å¯è§ã€‚
[é¡µé¢å¯è§æ€§ API-Web API | MDN](https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API)

è¿™ä¸ªæ‰©å±•ä½¿ç”¨ MutationObserver è§‚å¯Ÿ DOMã€‚æˆ‘ä¸æƒ³è®©å®ƒç»§ç»­å·¥ä½œï¼Œæ‰€ä»¥æˆ‘ç”¨è¿™ä¸ª API æ¥æ§åˆ¶å®ƒã€‚

```
document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    // Stop observing
  } else {
    // Restart observing
  }
} 
```

## [](#requestidlecallback)è¯·æ±‚å›è°ƒ

è¿™ä¸ª API åœ¨äº‹ä»¶å¾ªç¯ç©ºé—²æ—¶æ‰§è¡Œå¤„ç†ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šé˜»å¡å…¶ä»–å¤„ç†ã€‚è¿™ç¯‡æ–‡ç« å¾ˆå¥½åœ°ä»‹ç»äº†è¿™ä¸ª APIã€‚
[ä½¿ç”¨ requestIdleCallback | Web | Google å¼€å‘è€…](https://developers.google.com/web/updates/2015/08/using-requestidlecallback)

```
requestIdleCallback(() => {
  // execute
}, {
  timeout: 3000 // Forced execution if not executed after 3 seconds
}) 
```

è¯¥ API ç”¨äºå¯¹é¢‘é“åˆ—è¡¨è¿›è¡Œåˆ†ç»„ã€‚

# [](#lastly)æœ€å

ç¬¬ä¸€æ¬¡çŸ¥é“ webextension-toolboxï¼Œä½†æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå¾ˆæ£’ã€‚
å¯ä»¥å¿«é€Ÿåˆ›å»ºè·¨æµè§ˆå™¨æ‰©å±•ï¼Œå¿«æ¥è¯•è¯•å§ï¼ğŸ˜„